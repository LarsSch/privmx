/*************************************************************
This file is distributed under the PrivMX Web Freeware License
See LICENSE.TXT in the main folder of the software package
or https://privmx.com/web-freeware-license
Copyright (c) 2017 Simplito Sp. z o.o.
**************************************************************/
mailRequire=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){var r=n;r.bignum=e("bn.js"),r.define=e("./asn1/api").define,r.base=e("./asn1/base"),r.constants=e("./asn1/constants"),r.decoders=e("./asn1/decoders"),r.encoders=e("./asn1/encoders")},{"./asn1/api":2,"./asn1/base":4,"./asn1/constants":8,"./asn1/decoders":10,"./asn1/encoders":13,"bn.js":26}],2:[function(e,t,n){function r(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}var i=e("../asn1"),o=e("inherits"),s=n;s.define=function(e,t){return new r(e,t)},r.prototype._createNamed=function(t){var n;try{n=e("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(r){n=function(e){this._initNamed(e)}}return o(n,t),n.prototype._initNamed=function(e){t.call(this,e)},new n(this)},r.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i.decoders[e])),this.decoders[e]},r.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},r.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(i.encoders[e])),this.encoders[e]},r.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)}},{"../asn1":1,inherits:102,vm:690}],3:[function(e,t,n){function r(e,t){return s.call(this,t),Buffer.isBuffer(e)?(this.base=e,this.offset=0,void(this.length=e.length)):void this.error("Input not Buffer")}function i(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return e instanceof i||(e=new i(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=Buffer.byteLength(e);else{if(!Buffer.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}var o=e("inherits"),s=e("../base").Reporter,Buffer=e("buffer").Buffer;o(r,s),n.DecoderBuffer=r,r.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},r.prototype.restore=function(e){var t=new r(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,s.prototype.restore.call(this,e.reporter),t},r.prototype.isEmpty=function(){return this.offset===this.length},r.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},r.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var n=new r(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+e,this.offset+=e,n},r.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},n.EncoderBuffer=i,i.prototype.join=function(e,t){return e||(e=new Buffer(this.length)),t||(t=0),0===this.length?e:(Array.isArray(this.value)?this.value.forEach(function(n){n.join(e,t),t+=n.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):Buffer.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length),e)}},{"../base":4,buffer:590,inherits:102}],4:[function(e,t,n){var r=n;r.Reporter=e("./reporter").Reporter,r.DecoderBuffer=e("./buffer").DecoderBuffer,r.EncoderBuffer=e("./buffer").EncoderBuffer,r.Node=e("./node")},{"./buffer":3,"./node":5,"./reporter":6}],5:[function(e,t,n){function r(e,t){var n={};this._baseState=n,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n["default"]=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}var i=e("../base").Reporter,o=e("../base").EncoderBuffer,s=e("../base").DecoderBuffer,a=e("minimalistic-assert"),u=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(u),f=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];t.exports=r;var l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];r.prototype.clone=function(){var e=this._baseState,t={};l.forEach(function(n){t[n]=e[n]});var n=new this.constructor(t.parent);return n._baseState=t,n},r.prototype._wrap=function(){var e=this._baseState;c.forEach(function(t){this[t]=function(){var n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}},this)},r.prototype._init=function(e){var t=this._baseState;a(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),a.equal(t.children.length,1,"Root node can have only one child")},r.prototype._useArgs=function(e){var t=this._baseState,n=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==n.length&&(a(null===t.children),t.children=n,n.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(a(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(n){n==(0|n)&&(n|=0);var r=e[n];t[r]=n}),t}))},f.forEach(function(e){r.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),u.forEach(function(e){r.prototype[e]=function(){var t=this._baseState,n=Array.prototype.slice.call(arguments);return a(null===t.tag),t.tag=e,this._useArgs(n),this}}),r.prototype.use=function(e){a(e);var t=this._baseState;return a(null===t.use),t.use=e,this},r.prototype.optional=function(){var e=this._baseState;return e.optional=!0,this},r.prototype.def=function(e){var t=this._baseState;return a(null===t["default"]),t["default"]=e,t.optional=!0,this},r.prototype.explicit=function(e){var t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.explicit=e,this},r.prototype.implicit=function(e){var t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.implicit=e,this},r.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},r.prototype.key=function(e){var t=this._baseState;return a(null===t.key),t.key=e,this},r.prototype.any=function(){var e=this._baseState;return e.any=!0,this},r.prototype.choice=function(e){var t=this._baseState;return a(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},r.prototype.contains=function(e){var t=this._baseState;return a(null===t.use),t.contains=e,this},r.prototype._decode=function(e,t){var n=this._baseState;if(null===n.parent)return e.wrapResult(n.children[0]._decode(e,t));var r=n["default"],i=!0,o=null;if(null!==n.key&&(o=e.enterKey(n.key)),n.optional){var a=null;if(null!==n.explicit?a=n.explicit:null!==n.implicit?a=n.implicit:null!==n.tag&&(a=n.tag),null!==a||n.any){if(i=this._peekTag(e,a,n.any),e.isError(i))return i}else{var u=e.save();try{null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t),i=!0}catch(c){i=!1}e.restore(u)}}var f;if(n.obj&&i&&(f=e.enterObject()),i){if(null!==n.explicit){var l=this._decodeTag(e,n.explicit);if(e.isError(l))return l;e=l}var h=e.offset;if(null===n.use&&null===n.choice){if(n.any)var u=e.save();var p=this._decodeTag(e,null!==n.implicit?n.implicit:n.tag,n.any);if(e.isError(p))return p;n.any?r=e.raw(u):e=p}if(t&&t.track&&null!==n.tag&&t.track(e.path(),h,e.length,"tagged"),t&&t.track&&null!==n.tag&&t.track(e.path(),e.offset,e.length,"content"),r=n.any?r:null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t),e.isError(r))return r;if(n.any||null!==n.choice||null===n.children||n.children.forEach(function(n){n._decode(e,t)}),n.contains&&("octstr"===n.tag||"bitstr"===n.tag)){var d=new s(r);r=this._getUse(n.contains,e._reporterState.obj)._decode(d,t)}}return n.obj&&i&&(r=e.leaveObject(f)),null===n.key||null===r&&i!==!0?null!==o&&e.exitKey(o):e.leaveKey(o,n.key,r),r},r.prototype._decodeGeneric=function(e,t,n){var r=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,r.args[0],n):/str$/.test(e)?this._decodeStr(t,e,n):"objid"===e&&r.args?this._decodeObjid(t,r.args[0],r.args[1],n):"objid"===e?this._decodeObjid(t,null,null,n):"gentime"===e||"utctime"===e?this._decodeTime(t,e,n):"null_"===e?this._decodeNull(t,n):"bool"===e?this._decodeBool(t,n):"objDesc"===e?this._decodeStr(t,e,n):"int"===e||"enum"===e?this._decodeInt(t,r.args&&r.args[0],n):null!==r.use?this._getUse(r.use,t._reporterState.obj)._decode(t,n):t.error("unknown tag: "+e)},r.prototype._getUse=function(e,t){var n=this._baseState;return n.useDecoder=this._use(e,t),a(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},r.prototype._decodeChoice=function(e,t){var n=this._baseState,r=null,i=!1;return Object.keys(n.choice).some(function(o){var s=e.save(),a=n.choice[o];try{var u=a._decode(e,t);if(e.isError(u))return!1;r={type:o,value:u},i=!0}catch(c){return e.restore(s),!1}return!0},this),i?r:e.error("Choice not matched")},r.prototype._createEncoderBuffer=function(e){return new o(e,this.reporter)},r.prototype._encode=function(e,t,n){var r=this._baseState;if(null===r["default"]||r["default"]!==e){var i=this._encodeValue(e,t,n);if(void 0!==i&&!this._skipDefault(i,t,n))return i}},r.prototype._encodeValue=function(e,t,n){var r=this._baseState;if(null===r.parent)return r.children[0]._encode(e,t||new i);var o=null;if(this.reporter=t,r.optional&&void 0===e){if(null===r["default"])return;e=r["default"]}var s=null,a=!1;if(r.any)o=this._createEncoderBuffer(e);else if(r.choice)o=this._encodeChoice(e,t);else if(r.contains)s=this._getUse(r.contains,n)._encode(e,t),a=!0;else if(r.children)s=r.children.map(function(n){if("null_"===n._baseState.tag)return n._encode(null,t,e);if(null===n._baseState.key)return t.error("Child should have a key");var r=t.enterKey(n._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var i=n._encode(e[n._baseState.key],t,e);return t.leaveKey(r),i},this).filter(function(e){return e}),s=this._createEncoderBuffer(s);else if("seqof"===r.tag||"setof"===r.tag){if(!r.args||1!==r.args.length)return t.error("Too many args for : "+r.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var u=this.clone();u._baseState.implicit=null,s=this._createEncoderBuffer(e.map(function(n){var r=this._baseState;return this._getUse(r.args[0],e)._encode(n,t)},u))}else null!==r.use?o=this._getUse(r.use,n)._encode(e,t):(s=this._encodePrimitive(r.tag,e),a=!0);var o;if(!r.any&&null===r.choice){var c=null!==r.implicit?r.implicit:r.tag,f=null===r.implicit?"universal":"context";null===c?null===r.use&&t.error("Tag could be ommited only for .use()"):null===r.use&&(o=this._encodeComposite(c,a,f,s))}return null!==r.explicit&&(o=this._encodeComposite(r.explicit,!1,"context",o)),o},r.prototype._encodeChoice=function(e,t){var n=this._baseState,r=n.choice[e.type];return r||a(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),r._encode(e.value,t)},r.prototype._encodePrimitive=function(e,t){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},r.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},r.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},{"../base":4,"minimalistic-assert":134}],6:[function(e,t,n){function r(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function i(e,t){this.path=e,this.rethrow(t)}var o=e("inherits");n.Reporter=r,r.prototype.isError=function(e){return e instanceof i},r.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},r.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},r.prototype.enterKey=function(e){return this._reporterState.path.push(e)},r.prototype.exitKey=function(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)},r.prototype.leaveKey=function(e,t,n){var r=this._reporterState;this.exitKey(e),null!==r.obj&&(r.obj[t]=n)},r.prototype.path=function(){return this._reporterState.path.join("/")},r.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},r.prototype.leaveObject=function(e){var t=this._reporterState,n=t.obj;return t.obj=e,n},r.prototype.error=function(e){var t,n=this._reporterState,r=e instanceof i;if(t=r?e:new i(n.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack),!n.options.partial)throw t;return r||n.errors.push(t),t},r.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},o(i,Error),i.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,i),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}},{inherits:102}],7:[function(e,t,n){var r=e("../constants");n.tagClass={0:"universal",1:"application",2:"context",3:"private"},n.tagClassByName=r._reverse(n.tagClass),n.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},n.tagByName=r._reverse(n.tag)},{"../constants":8}],8:[function(e,t,n){var r=n;r._reverse=function(e){var t={};return Object.keys(e).forEach(function(n){(0|n)==n&&(n=0|n);var r=e[n];t[r]=n}),t},r.der=e("./der")},{"./der":7}],9:[function(e,t,n){function r(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new i,this.tree._init(e.body)}function i(e){c.Node.call(this,"der",e)}function o(e,t){var n=e.readUInt8(t);if(e.isError(n))return n;var r=l.tagClass[n>>6],i=0===(32&n);if(31===(31&n)){var o=n;for(n=0;128===(128&o);){if(o=e.readUInt8(t),e.isError(o))return o;n<<=7,n|=127&o}}else n&=31;var s=l.tag[n];return{cls:r,primitive:i,tag:n,tagStr:s}}function s(e,t,n){var r=e.readUInt8(n);if(e.isError(r))return r;if(!t&&128===r)return null;if(0===(128&r))return r;var i=127&r;if(i>4)return e.error("length octect is too long");r=0;for(var o=0;o<i;o++){r<<=8;var s=e.readUInt8(n);if(e.isError(s))return s;r|=s}return r}var a=e("inherits"),u=e("../../asn1"),c=u.base,f=u.bignum,l=u.constants.der;t.exports=r,r.prototype.decode=function(e,t){return e instanceof c.DecoderBuffer||(e=new c.DecoderBuffer(e,t)),this.tree._decode(e,t)},a(i,c.Node),i.prototype._peekTag=function(e,t,n){if(e.isEmpty())return!1;var r=e.save(),i=o(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(r),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||n)},i.prototype._decodeTag=function(e,t,n){var r=o(e,'Failed to decode tag of "'+t+'"');if(e.isError(r))return r;var i=s(e,r.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!n&&r.tag!==t&&r.tagStr!==t&&r.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(r.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');var a=e.save(),u=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(u)?u:(i=e.offset-a.offset,e.restore(a),e.skip(i,'Failed to match body of: "'+t+'"'))},i.prototype._skipUntilEnd=function(e,t){for(;;){var n=o(e,t);if(e.isError(n))return n;var r=s(e,n.primitive,t);if(e.isError(r))return r;var i;if(i=n.primitive||null!==r?e.skip(r):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===n.tagStr)break}},i.prototype._decodeList=function(e,t,n,r){for(var i=[];!e.isEmpty();){var o=this._peekTag(e,"end");if(e.isError(o))return o;var s=n.decode(e,"der",r);if(e.isError(s)&&o)break;i.push(s)}return i},i.prototype._decodeStr=function(e,t){if("bitstr"===t){var n=e.readUInt8();return e.isError(n)?n:{unused:n,data:e.raw()}}if("bmpstr"===t){var r=e.raw();if(r.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");for(var i="",o=0;o<r.length/2;o++)i+=String.fromCharCode(r.readUInt16BE(2*o));return i}if("numstr"===t){var s=e.raw().toString("ascii");return this._isNumstr(s)?s:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){var a=e.raw().toString("ascii");return this._isPrintstr(a)?a:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},i.prototype._decodeObjid=function(e,t,n){for(var r,i=[],o=0;!e.isEmpty();){var s=e.readUInt8();o<<=7,o|=127&s,0===(128&s)&&(i.push(o),o=0)}128&s&&i.push(o);var a=i[0]/40|0,u=i[0]%40;if(r=n?i:[a,u].concat(i.slice(1)),t){var c=t[r.join(" ")];void 0===c&&(c=t[r.join(".")]),void 0!==c&&(r=c)}return r},i.prototype._decodeTime=function(e,t){var n=e.raw().toString();if("gentime"===t)var r=0|n.slice(0,4),i=0|n.slice(4,6),o=0|n.slice(6,8),s=0|n.slice(8,10),a=0|n.slice(10,12),u=0|n.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");var r=0|n.slice(0,2),i=0|n.slice(2,4),o=0|n.slice(4,6),s=0|n.slice(6,8),a=0|n.slice(8,10),u=0|n.slice(10,12);r=r<70?2e3+r:1900+r}return Date.UTC(r,i-1,o,s,a,u,0)},i.prototype._decodeNull=function(e){return null},i.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},i.prototype._decodeInt=function(e,t){var n=e.raw(),r=new f(n);return t&&(r=t[r.toString(10)]||r),r},i.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},{"../../asn1":1,inherits:102}],10:[function(e,t,n){var r=n;r.der=e("./der"),r.pem=e("./pem")},{"./der":9,"./pem":11}],11:[function(e,t,n){function r(e){o.call(this,e),this.enc="pem"}var i=e("inherits"),Buffer=e("buffer").Buffer,o=e("./der");i(r,o),t.exports=r,r.prototype.decode=function(e,t){for(var n=e.toString().split(/[\r\n]+/g),r=t.label.toUpperCase(),i=/^-----(BEGIN|END) ([^-]+)-----$/,s=-1,a=-1,u=0;u<n.length;u++){var c=n[u].match(i);if(null!==c&&c[2]===r){if(s!==-1){if("END"!==c[1])break;a=u;break}if("BEGIN"!==c[1])break;s=u}}if(s===-1||a===-1)throw new Error("PEM section not found for: "+r);var f=n.slice(s+1,a).join("");f.replace(/[^a-z0-9\+\/=]+/gi,"");var l=new Buffer(f,"base64");return o.prototype.decode.call(this,l,t)}},{"./der":9,buffer:590,inherits:102}],12:[function(e,t,n){function r(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new i,this.tree._init(e.body)}function i(e){c.Node.call(this,"der",e)}function o(e){return e<10?"0"+e:e}function s(e,t,n,r){var i;if("seqof"===e?e="seq":"setof"===e&&(e="set"),f.tagByName.hasOwnProperty(e))i=f.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return r.error("Unknown tag: "+e);i=e}return i>=31?r.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=f.tagClassByName[n||"universal"]<<6)}var a=e("inherits"),Buffer=e("buffer").Buffer,u=e("../../asn1"),c=u.base,f=u.constants.der;t.exports=r,r.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},a(i,c.Node),i.prototype._encodeComposite=function(e,t,n,r){var i=s(e,t,n,this.reporter);if(r.length<128){var o=new Buffer(2);return o[0]=i,o[1]=r.length,this._createEncoderBuffer([o,r])}for(var a=1,u=r.length;u>=256;u>>=8)a++;var o=new Buffer(2+a);o[0]=i,o[1]=128|a;for(var u=1+a,c=r.length;c>0;u--,c>>=8)o[u]=255&c;return this._createEncoderBuffer([o,r])},i.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var n=new Buffer(2*e.length),r=0;r<e.length;r++)n.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(n)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)?this._createEncoderBuffer(e):"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},i.prototype._encodeObjid=function(e,t,n){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var r=0;r<e.length;r++)e[r]|=0}else if(Array.isArray(e)){e=e.slice();for(var r=0;r<e.length;r++)e[r]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}for(var i=0,r=0;r<e.length;r++){var o=e[r];for(i++;o>=128;o>>=7)i++}for(var s=new Buffer(i),a=s.length-1,r=e.length-1;r>=0;r--){var o=e[r];for(s[a--]=127&o;(o>>=7)>0;)s[a--]=128|127&o}return this._createEncoderBuffer(s)},i.prototype._encodeTime=function(e,t){var n,r=new Date(e);return"gentime"===t?n=[o(r.getFullYear()),o(r.getUTCMonth()+1),o(r.getUTCDate()),o(r.getUTCHours()),o(r.getUTCMinutes()),o(r.getUTCSeconds()),"Z"].join(""):"utctime"===t?n=[o(r.getFullYear()%100),o(r.getUTCMonth()+1),o(r.getUTCDate()),o(r.getUTCHours()),o(r.getUTCMinutes()),o(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(n,"octstr")},i.prototype._encodeNull=function(){return this._createEncoderBuffer("")},i.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!Buffer.isBuffer(e)){var n=e.toArray();!e.sign&&128&n[0]&&n.unshift(0),e=new Buffer(n)}if(Buffer.isBuffer(e)){var r=e.length;0===e.length&&r++;var i=new Buffer(r);return e.copy(i),0===e.length&&(i[0]=0),this._createEncoderBuffer(i)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var r=1,o=e;o>=256;o>>=8)r++;for(var i=new Array(r),o=i.length-1;o>=0;o--)i[o]=255&e,e>>=8;return 128&i[0]&&i.unshift(0),this._createEncoderBuffer(new Buffer(i))},i.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},i.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},i.prototype._skipDefault=function(e,t,n){var r,i=this._baseState;if(null===i["default"])return!1;var o=e.join();if(void 0===i.defaultBuffer&&(i.defaultBuffer=this._encodeValue(i["default"],t,n).join()),o.length!==i.defaultBuffer.length)return!1;for(r=0;r<o.length;r++)if(o[r]!==i.defaultBuffer[r])return!1;return!0}},{"../../asn1":1,buffer:590,inherits:102}],13:[function(e,t,n){var r=n;r.der=e("./der"),r.pem=e("./pem")},{"./der":12,"./pem":14}],14:[function(e,t,n){function r(e){o.call(this,e),this.enc="pem"}var i=e("inherits"),o=e("./der");i(r,o),t.exports=r,r.prototype.encode=function(e,t){for(var n=o.prototype.encode.call(this,e),r=n.toString("base64"),i=["-----BEGIN "+t.label+"-----"],s=0;s<r.length;s+=64)i.push(r.slice(s,s+64));return i.push("-----END "+t.label+"-----"),i.join("\n")}},{"./der":12,inherits:102}],15:[function(e,t,n){t.exports=function(e){function t(t){if(0===t.length)return"";for(var n=[0],r=0;r<t.length;++r){for(var i=0,s=t[r];i<n.length;++i)s+=n[i]<<8,n[i]=s%o,s=s/o|0;for(;s>0;)n.push(s%o),s=s/o|0}for(var a="",u=0;0===t[u]&&u<t.length-1;++u)a+=e[0];for(var c=n.length-1;c>=0;--c)a+=e[n[c]];return a}function n(e){if(0===e.length)return[];for(var t=[0],n=0;n<e.length;n++){var r=i[e[n]];if(void 0===r)return;for(var a=0,u=r;a<t.length;++a)u+=t[a]*o,t[a]=255&u,u>>=8;for(;u>0;)t.push(255&u),u>>=8}for(var c=0;e[c]===s&&c<e.length-1;++c)t.push(0);return t.reverse()}function r(e){var t=n(e);if(t)return t;throw new Error("Non-base"+o+" character")}for(var i={},o=e.length,s=e.charAt(0),a=0;a<e.length;a++)i[e.charAt(a)]=a;return{encode:t,decodeUnsafe:n,decode:r}}},{}],16:[function(e,t,n){t.exports=t.exports={name:"bigi",version:"1.4.2"}},{}],17:[function(e,t,n){(function(Buffer){function n(e,t){var n=new Buffer(e,"utf8"),r=new Buffer(c(t),"utf8");return d(n,r,2048,64,"sha512")}function r(e,t){return n(e,t).toString("hex")}function i(e,t){t=t||m;var n=e.split(" ");h(n.length%3===0,"Invalid mnemonic");var r=n.every(function(e){return t.indexOf(e)>-1});h(r,"Invalid mnemonic");var i=n.map(function(e){var n=t.indexOf(e);return l(n.toString(2),"0",11)}).join(""),o=32*Math.floor(i.length/33),s=i.slice(0,o),a=i.slice(o),c=s.match(/(.{1,8})/g).map(function(e){return parseInt(e,2)}),f=new Buffer(c),p=u(f);return h(p===a,"Invalid mnemonic checksum"),f.toString("hex")}function o(e,t){t=t||m;var n=new Buffer(e,"hex"),r=f([].slice.call(n)),i=u(n),o=r+i,s=o.match(/(.{1,11})/g),a=s.map(function(e){var n=parseInt(e,2);return t[n]});return a.join(" ")}function s(e,t,n){e=e||128,t=t||g;var r=t(e/8).toString("hex");return o(r,n)}function a(e,t){try{i(e,t)}catch(n){return!1}return!0}function u(e){var t=p("sha256").update(e).digest(),n=8*e.length,r=n/32;return f([].slice.call(t)).slice(0,r)}function c(e){return"mnemonic"+(y.nfkd(e)||"")}function f(e){return e.map(function(e){return l(e.toString(2),"0",8)}).join("")}function l(e,t,n){for(;e.length<n;)e=t+e;return e}var h=e("assert"),p=e("create-hash"),d=e("pbkdf2").pbkdf2Sync,g=e("randombytes"),y=e("unorm"),m=e("./wordlists/en.json");t.exports={mnemonicToSeed:n,mnemonicToSeedHex:r,mnemonicToEntropy:i,entropyToMnemonic:o,generateMnemonic:s,validateMnemonic:a,wordlists:{EN:m}}}).call(this,e("buffer").Buffer)},{"./wordlists/en.json":18,assert:561,buffer:590,"create-hash":51,pbkdf2:142,randombytes:329,unorm:393}],18:[function(e,t,n){t.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"];
},{}],19:[function(e,t,n){(function(Buffer){function n(e){if(!(this instanceof n))return new n(e);if(this._bufs=[],this.length=0,"function"==typeof e){this._callback=e;var t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",function(e){e.on("error",t)}),this.on("unpipe",function(e){e.removeListener("error",t)})}else this.append(e);r.call(this)}var r=e("readable-stream/duplex"),i=e("util");i.inherits(n,r),n.prototype._offset=function(e){var t,n=0,r=0;if(0===e)return[0,0];for(;r<this._bufs.length;r++){if(t=n+this._bufs[r].length,e<t||r==this._bufs.length-1)return[r,e-n];n=t}},n.prototype.append=function(e){var t=0;if(Buffer.isBuffer(e))this._appendBuffer(e);else if(Array.isArray(e))for(;t<e.length;t++)this.append(e[t]);else if(e instanceof n)for(;t<e._bufs.length;t++)this.append(e._bufs[t]);else null!=e&&("number"==typeof e&&(e=e.toString()),this._appendBuffer(new Buffer(e)));return this},n.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},n.prototype._write=function(e,t,n){this._appendBuffer(e),"function"==typeof n&&n()},n.prototype._read=function(e){return this.length?(e=Math.min(e,this.length),this.push(this.slice(0,e)),void this.consume(e)):this.push(null)},n.prototype.end=function(e){r.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},n.prototype.get=function(e){return this.slice(e,e+1)[0]},n.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},n.prototype.copy=function o(e,t,n,r){if(("number"!=typeof n||n<0)&&(n=0),("number"!=typeof r||r>this.length)&&(r=this.length),n>=this.length)return e||new Buffer(0);if(r<=0)return e||new Buffer(0);var i,s,o=!!e,a=this._offset(n),u=r-n,c=u,f=o&&t||0,l=a[1];if(0===n&&r==this.length){if(!o)return 1===this._bufs.length?this._bufs[0]:Buffer.concat(this._bufs,this.length);for(s=0;s<this._bufs.length;s++)this._bufs[s].copy(e,f),f+=this._bufs[s].length;return e}if(c<=this._bufs[a[0]].length-l)return o?this._bufs[a[0]].copy(e,t,l,l+c):this._bufs[a[0]].slice(l,l+c);for(o||(e=new Buffer(u)),s=a[0];s<this._bufs.length;s++){if(i=this._bufs[s].length-l,!(c>i)){this._bufs[s].copy(e,f,l,l+c);break}this._bufs[s].copy(e,f,l),f+=i,c-=i,l&&(l=0)}return e},n.prototype.shallowSlice=function(e,t){e=e||0,t=t||this.length,e<0&&(e+=this.length),t<0&&(t+=this.length);var r=this._offset(e),i=this._offset(t),o=this._bufs.slice(r[0],i[0]+1);return 0!=r[1]&&(o[0]=o[0].slice(r[1])),0==i[1]?o.pop():o[o.length-1]=o[o.length-1].slice(0,i[1]),new n(o)},n.prototype.toString=function(e,t,n){return this.slice(t,n).toString(e)},n.prototype.consume=function(e){for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},n.prototype.duplicate=function(){for(var e=0,t=new n;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},n.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var t in e)!function(t){n.prototype[t]=function(n){return this.slice(n,n+e[t])[t](0)}}(t)}(),t.exports=n}).call(this,e("buffer").Buffer)},{buffer:590,"readable-stream/duplex":21,util:689}],20:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],21:[function(e,t,n){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":22}],22:[function(e,t,n){"use strict";function r(e){return this instanceof r?(c.call(this,e),f.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||a(o,this)}function o(e){e.end()}var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=r;var a=e("process-nextick-args"),u=e("core-util-is");u.inherits=e("inherits");var c=e("./_stream_readable"),f=e("./_stream_writable");u.inherits(r,c);for(var l=s(f.prototype),h=0;h<l.length;h++){var p=l[h];r.prototype[p]||(r.prototype[p]=f.prototype[p])}},{"./_stream_readable":23,"./_stream_writable":24,"core-util-is":50,inherits:102,"process-nextick-args":325}],23:[function(e,t,n){(function(n){"use strict";function r(e,t,n){return"function"==typeof e.prependListener?e.prependListener(t,n):void(e._events&&e._events[t]?M(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n))}function i(t,n){P=P||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof P&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new U,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(F||(F=e("string_decoder/").StringDecoder),this.decoder=new F(t.encoding),this.encoding=t.encoding)}function o(t){return P=P||e("./_stream_duplex"),this instanceof o?(this._readableState=new i(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),void R.call(this)):new o(t)}function s(e,t,n,r,i){var o=f(t,n);if(o)e.emit("error",o);else if(null===n)t.reading=!1,l(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&i){var u=new Error("stream.unshift() after end event");e.emit("error",u)}else{var c;!t.decoder||i||r||(n=t.decoder.write(n),c=!t.objectMode&&0===n.length),i||(t.reading=!1),c||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&h(e))),d(e,t)}else i||(t.reading=!1);return a(t)}function a(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function u(e){return e>=j?e=j:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function c(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=u(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function f(e,t){var n=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function l(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,h(e)}}function h(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(L("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?T(p,e):p(e))}function p(e){L("emit readable"),e.emit("readable"),w(e)}function d(e,t){t.readingMore||(t.readingMore=!0,T(g,e,t))}function g(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(L("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function y(e){return function(){var t=e._readableState;L("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&O(e,"data")&&(t.flowing=!0,w(e))}}function m(e){L("readable nexttick read 0"),e.read(0)}function v(e,t){t.resumeScheduled||(t.resumeScheduled=!0,T(b,e,t))}function b(e,t){t.reading||(L("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),w(e),t.flowing&&!t.reading&&e.read(0)}function w(e){var t=e._readableState;for(L("flow",t.flowing);t.flowing&&null!==e.read(););}function E(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=_(e,t.buffer,t.decoder),n}function _(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?S(e,t):k(e,t),r}function S(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(i+=s===o.length?o:o.slice(0,e),e-=s,0===e){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}function k(e,t){var n=B.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,s),e-=s,0===e){s===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}function C(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,T(x,t,e))}function x(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function I(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function A(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}t.exports=o;var P,T=e("process-nextick-args"),M=e("isarray");o.ReadableState=i;var R,O=(e("events").EventEmitter,function(e,t){return e.listeners(t).length});!function(){try{R=e("stream")}catch(t){}finally{R||(R=e("events").EventEmitter)}}();var Buffer=e("buffer").Buffer,B=e("buffer-shims"),D=e("core-util-is");D.inherits=e("inherits");var N=e("util"),L=void 0;L=N&&N.debuglog?N.debuglog("stream"):function(){};var F,U=e("./internal/streams/BufferList");D.inherits(o,R),o.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding,t!==n.encoding&&(e=B.from(e,t),t="")),s(this,n,e,t,!1)},o.prototype.unshift=function(e){var t=this._readableState;return s(this,t,e,"",!0)},o.prototype.isPaused=function(){return this._readableState.flowing===!1},o.prototype.setEncoding=function(t){return F||(F=e("string_decoder/").StringDecoder),this._readableState.decoder=new F(t),this._readableState.encoding=t,this};var j=8388608;o.prototype.read=function(e){L("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return L("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?C(this):h(this),null;if(e=c(e,t),0===e&&t.ended)return 0===t.length&&C(this),null;var r=t.needReadable;L("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,L("length less than watermark",r)),t.ended||t.reading?(r=!1,L("reading or ended",r)):r&&(L("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=c(n,t)));var i;return i=e>0?E(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&C(this)),null!==i&&this.emit("data",i),i},o.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},o.prototype.pipe=function(e,t){function i(e){L("onunpipe"),e===h&&s()}function o(){L("onend"),e.end()}function s(){L("cleanup"),e.removeListener("close",c),e.removeListener("finish",f),e.removeListener("drain",m),e.removeListener("error",u),e.removeListener("unpipe",i),h.removeListener("end",o),h.removeListener("end",s),h.removeListener("data",a),v=!0,!p.awaitDrain||e._writableState&&!e._writableState.needDrain||m()}function a(t){L("ondata"),b=!1;var n=e.write(t);!1!==n||b||((1===p.pipesCount&&p.pipes===e||p.pipesCount>1&&A(p.pipes,e)!==-1)&&!v&&(L("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,b=!0),h.pause())}function u(t){L("onerror",t),l(),e.removeListener("error",u),0===O(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",f),l()}function f(){L("onfinish"),e.removeListener("close",c),l()}function l(){L("unpipe"),h.unpipe(e)}var h=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=e;break;case 1:p.pipes=[p.pipes,e];break;default:p.pipes.push(e)}p.pipesCount+=1,L("pipe count=%d opts=%j",p.pipesCount,t);var d=(!t||t.end!==!1)&&e!==n.stdout&&e!==n.stderr,g=d?o:s;p.endEmitted?T(g):h.once("end",g),e.on("unpipe",i);var m=y(h);e.on("drain",m);var v=!1,b=!1;return h.on("data",a),r(e,"error",u),e.once("close",c),e.once("finish",f),e.emit("pipe",h),p.flowing||(L("pipe resume"),h.resume()),e},o.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var o=A(t.pipes,e);return o===-1?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},o.prototype.on=function(e,t){var n=R.prototype.on.call(this,e,t);if("data"===e)this._readableState.flowing!==!1&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&h(this,r):T(m,this))}return n},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){var e=this._readableState;return e.flowing||(L("resume"),e.flowing=!0,v(this,e)),this},o.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this},o.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(L("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(L("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return I(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){L("wrapped _read",t),n&&(n=!1,e.resume())},r},o._fromList=E}).call(this,e("_process"))},{"./_stream_duplex":22,"./internal/streams/BufferList":25,_process:592,buffer:590,"buffer-shims":46,"core-util-is":50,events:630,inherits:102,isarray:20,"process-nextick-args":325,"string_decoder/":375,util:564}],24:[function(e,t,n){(function(n){"use strict";function r(){}function i(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function o(t,n){S=S||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof S&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=t.decodeStrings===!1;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){d(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}function s(t){return S=S||e("./_stream_duplex"),T.call(s,this)||this instanceof S?(this._writableState=new o(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),void I.call(this)):new s(t)}function a(e,t){var n=new Error("write after end");e.emit("error",n),k(t,n)}function u(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):Buffer.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),k(r,o),i=!1),i}function c(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=P.from(t,n)),t}function f(e,t,n,r,o){n=c(t,n,r),Buffer.isBuffer(n)&&(r="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new i(n,r,o),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else l(e,t,!1,s,n,r,o);return a}function l(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function h(e,t,n,r,i){--t.pendingcb,n?k(i,r):i(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function p(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function d(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(p(n),t)h(e,n,r,t,i);else{var o=v(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||m(e,n),r?C(g,e,n,o,i):g(e,n,o,i)}}function g(e,t,n,r){n||y(e,t),t.pendingcb--,r(),w(e,t)}function y(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function m(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0;n;)i[s]=n,n=n.next,s+=1;l(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new _(t)}else{for(;n;){var a=n.chunk,u=n.encoding,c=n.callback,f=t.objectMode?1:a.length;if(l(e,t,!1,f,a,u,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function v(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function w(e,t){var n=v(t);return n&&(0===t.pendingcb?(b(e,t),t.finished=!0,e.emit("finish")):b(e,t)),n}function E(e,t,n){t.ending=!0,w(e,t),n&&(t.finished?k(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function _(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}t.exports=s;var S,k=e("process-nextick-args"),C=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?setImmediate:k;s.WritableState=o;var x=e("core-util-is");x.inherits=e("inherits");var I,A={deprecate:e("util-deprecate")};!function(){try{I=e("stream")}catch(t){}finally{I||(I=e("events").EventEmitter)}}();var Buffer=e("buffer").Buffer,P=e("buffer-shims");x.inherits(s,I),o.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(o.prototype,"buffer",{get:A.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}();var T;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(T=Function.prototype[Symbol.hasInstance],Object.defineProperty(s,Symbol.hasInstance,{value:function(e){return!!T.call(this,e)||e&&e._writableState instanceof o}})):T=function(e){return e instanceof this},s.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},s.prototype.write=function(e,t,n){var i=this._writableState,o=!1;return"function"==typeof t&&(n=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=r),i.ended?a(this,n):u(this,i,e,n)&&(i.pendingcb++,o=f(this,i,e,t,n)),o},s.prototype.cork=function(){var e=this._writableState;e.corked++},s.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||m(this,e))},s.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},s.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},s.prototype._writev=null,s.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||E(this,r,n)}}).call(this,e("_process"))},{"./_stream_duplex":22,_process:592,buffer:590,"buffer-shims":46,"core-util-is":50,events:630,inherits:102,"process-nextick-args":325,"util-deprecate":394}],25:[function(e,t,n){"use strict";function r(){this.head=null,this.tail=null,this.length=0}var i=(e("buffer").Buffer,e("buffer-shims"));t.exports=r,r.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},r.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},r.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},r.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t=i.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t}},{buffer:590,"buffer-shims":46}],26:[function(e,t,n){!function(t,n){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function BN(e,t,n){return BN.isBN(e)?e:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))))}function o(e,t,n){for(var r=0,i=Math.min(e.length,n),o=t;o<i;o++){var s=e.charCodeAt(o)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function s(e,t,n,r){for(var i=0,o=Math.min(e.length,n),s=t;s<o;s++){var a=e.charCodeAt(s)-48;i*=r,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}function a(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=(e.words[r]&1<<i)>>>i}return t}function u(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,u=s/67108864|0;n.words[0]=a;for(var c=1;c<r;c++){for(var f=u>>>26,l=67108863&u,h=Math.min(c,t.length-1),p=Math.max(0,c-e.length+1);p<=h;p++){var d=c-p|0;i=0|e.words[d],o=0|t.words[p],s=i*o+l,f+=s/67108864|0,l=67108863&s}n.words[c]=0|l,u=0|f}return 0!==u?n.words[c]=0|u:n.length--,n.strip()}function c(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var s=i;i=0;for(var a=67108863&r,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var f=o-c,l=0|e.words[f],h=0|t.words[c],p=l*h,d=67108863&p;s=s+(p/67108864|0)|0,d=d+a|0,a=67108863&d,s=s+(d>>>26)|0,i+=s>>>26,s&=67108863}n.words[o]=a,r=s,s=i}return 0!==r?n.words[o]=r:n.length--,n.strip()}function f(e,t,n){var r=new l;return r.mulp(e,t,n)}function l(e,t){this.x=e,this.y=t}function h(e,t){this.name=e,this.p=new BN(t,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function p(){h.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function d(){h.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function g(){h.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function y(){h.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function m(e){if("string"==typeof e){var t=BN._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function v(e){m.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=BN:n.BN=BN,BN.BN=BN,BN.wordSize=26;var Buffer;try{Buffer=e("buffer").Buffer}catch(b){}BN.isBN=function(e){return e instanceof BN||null!==e&&"object"==typeof e&&e.constructor.wordSize===BN.wordSize&&Array.isArray(e.words)},BN.max=function(e,t){return e.cmp(t)>0?e:t},BN.min=function(e,t){return e.cmp(t)<0?e:t},BN.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36),e=e.toString().replace(/\s+/g,"");var i=0;"-"===e[0]&&i++,16===t?this._parseHex(e,i):this._parseBase(e,t,i),"-"===e[0]&&(this.negative=1),this.strip(),"le"===n&&this._initArray(this.toArray(),t,n)},BN.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},BN.prototype._initArray=function(e,t,n){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===n)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,a+=24,a>=26&&(a-=26,o++);else if("le"===n)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,a+=24,a>=26&&(a-=26,o++);return this.strip()},BN.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,i,s=0;for(n=e.length-6,r=0;n>=t;n-=6)i=o(e,n,n+6),this.words[r]|=i<<s&67108863,this.words[r+1]|=i>>>26-s&4194303,s+=24,s>=26&&(s-=26,r++);n+6!==t&&(i=o(e,t,n+6),this.words[r]|=i<<s&67108863,this.words[r+1]|=i>>>26-s&4194303),this.strip()},BN.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var o=e.length-n,a=o%r,u=Math.min(o,o-a)+n,c=0,f=n;f<u;f+=r)c=s(e,f,f+r,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var l=1;for(c=s(e,f,e.length,t),f=0;f<a;f++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},BN.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},BN.prototype.clone=function(){var e=new BN(null);return this.copy(e),e},BN.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},BN.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},BN.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var w=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],E=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function(e,t){e=e||10,t=0|t||1;var n;if(16===e||"hex"===e){n="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);o=a>>>24-i&16777215,n=0!==o||s!==this.length-1?w[6-u.length]+u+n:u+n,i+=2,i>=26&&(i-=26,s--)}for(0!==o&&(n=o.toString(16)+n);n.length%t!==0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var c=E[e],f=_[e];n="";var l=this.clone();for(l.negative=0;!l.isZero();){var h=l.modn(f).toString(e);l=l.idivn(f),n=l.isZero()?h+n:w[c-h.length]+h+n}for(this.isZero()&&(n="0"+n);n.length%t!==0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},BN.prototype.toJSON=function(){return this.toString(16)},BN.prototype.toBuffer=function(e,t){return r("undefined"!=typeof Buffer),this.toArrayLike(Buffer,e,t)},BN.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},BN.prototype.toArrayLike=function(e,t,n){var i=this.byteLength(),o=n||Math.max(1,i);r(i<=o,"byte array longer than desired length"),r(o>0,"Requested array length <= 0"),this.strip();var s,a,u="le"===t,c=new e(o),f=this.clone();if(u){for(a=0;!f.isZero();a++)s=f.andln(255),f.iushrn(8),c[a]=s;for(;a<o;a++)c[a]=0}else{for(a=0;a<o-i;a++)c[a]=0;for(a=0;!f.isZero();a++)s=f.andln(255),f.iushrn(8),c[o-a-1]=s}return c},Math.clz32?BN.prototype._countBits=function(e){return 32-Math.clz32(e)}:BN.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},BN.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0===(8191&t)&&(n+=13,t>>>=13),0===(127&t)&&(n+=7,t>>>=7),0===(15&t)&&(n+=4,t>>>=4),0===(3&t)&&(n+=2,t>>>=2),0===(1&t)&&n++,n},BN.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},BN.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},BN.prototype.ior=function(e){return r(0===(this.negative|e.negative)),this.iuor(e)},BN.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},BN.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},BN.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,
this.strip()},BN.prototype.iand=function(e){return r(0===(this.negative|e.negative)),this.iuand(e)},BN.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},BN.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},BN.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},BN.prototype.ixor=function(e){return r(0===(this.negative|e.negative)),this.iuxor(e)},BN.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},BN.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},BN.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this.strip()},BN.prototype.notn=function(e){return this.clone().inotn(e)},BN.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var n=e/26|0,i=e%26;return this._expand(n+1),t?this.words[n]=this.words[n]|1<<i:this.words[n]=this.words[n]&~(1<<i),this.strip()},BN.prototype.iadd=function(e){var t;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();var n,r;this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,o=0;o<r.length;o++)t=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<n.length;o++)t=(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},BN.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},BN.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;var r,i;n>0?(r=this,i=e):(r=e,i=this);for(var o=0,s=0;s<i.length;s++)t=(0|r.words[s])-(0|i.words[s])+o,o=t>>26,this.words[s]=67108863&t;for(;0!==o&&s<r.length;s++)t=(0|r.words[s])+o,o=t>>26,this.words[s]=67108863&t;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this.strip()},BN.prototype.sub=function(e){return this.clone().isub(e)};var S=function(e,t,n){var r,i,o,s=e.words,a=t.words,u=n.words,c=0,f=0|s[0],l=8191&f,h=f>>>13,p=0|s[1],d=8191&p,g=p>>>13,y=0|s[2],m=8191&y,v=y>>>13,b=0|s[3],w=8191&b,E=b>>>13,_=0|s[4],S=8191&_,k=_>>>13,C=0|s[5],x=8191&C,I=C>>>13,A=0|s[6],P=8191&A,T=A>>>13,M=0|s[7],R=8191&M,O=M>>>13,B=0|s[8],D=8191&B,N=B>>>13,L=0|s[9],F=8191&L,U=L>>>13,j=0|a[0],z=8191&j,K=j>>>13,H=0|a[1],q=8191&H,V=H>>>13,W=0|a[2],G=8191&W,Y=W>>>13,X=0|a[3],$=8191&X,J=X>>>13,Q=0|a[4],Z=8191&Q,ee=Q>>>13,te=0|a[5],ne=8191&te,re=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,fe=0|a[8],le=8191&fe,he=fe>>>13,pe=0|a[9],de=8191&pe,ge=pe>>>13;n.negative=e.negative^t.negative,n.length=19,r=Math.imul(l,z),i=Math.imul(l,K),i=i+Math.imul(h,z)|0,o=Math.imul(h,K);var ye=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(d,z),i=Math.imul(d,K),i=i+Math.imul(g,z)|0,o=Math.imul(g,K),r=r+Math.imul(l,q)|0,i=i+Math.imul(l,V)|0,i=i+Math.imul(h,q)|0,o=o+Math.imul(h,V)|0;var me=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(me>>>26)|0,me&=67108863,r=Math.imul(m,z),i=Math.imul(m,K),i=i+Math.imul(v,z)|0,o=Math.imul(v,K),r=r+Math.imul(d,q)|0,i=i+Math.imul(d,V)|0,i=i+Math.imul(g,q)|0,o=o+Math.imul(g,V)|0,r=r+Math.imul(l,G)|0,i=i+Math.imul(l,Y)|0,i=i+Math.imul(h,G)|0,o=o+Math.imul(h,Y)|0;var ve=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(w,z),i=Math.imul(w,K),i=i+Math.imul(E,z)|0,o=Math.imul(E,K),r=r+Math.imul(m,q)|0,i=i+Math.imul(m,V)|0,i=i+Math.imul(v,q)|0,o=o+Math.imul(v,V)|0,r=r+Math.imul(d,G)|0,i=i+Math.imul(d,Y)|0,i=i+Math.imul(g,G)|0,o=o+Math.imul(g,Y)|0,r=r+Math.imul(l,$)|0,i=i+Math.imul(l,J)|0,i=i+Math.imul(h,$)|0,o=o+Math.imul(h,J)|0;var be=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(S,z),i=Math.imul(S,K),i=i+Math.imul(k,z)|0,o=Math.imul(k,K),r=r+Math.imul(w,q)|0,i=i+Math.imul(w,V)|0,i=i+Math.imul(E,q)|0,o=o+Math.imul(E,V)|0,r=r+Math.imul(m,G)|0,i=i+Math.imul(m,Y)|0,i=i+Math.imul(v,G)|0,o=o+Math.imul(v,Y)|0,r=r+Math.imul(d,$)|0,i=i+Math.imul(d,J)|0,i=i+Math.imul(g,$)|0,o=o+Math.imul(g,J)|0,r=r+Math.imul(l,Z)|0,i=i+Math.imul(l,ee)|0,i=i+Math.imul(h,Z)|0,o=o+Math.imul(h,ee)|0;var we=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(x,z),i=Math.imul(x,K),i=i+Math.imul(I,z)|0,o=Math.imul(I,K),r=r+Math.imul(S,q)|0,i=i+Math.imul(S,V)|0,i=i+Math.imul(k,q)|0,o=o+Math.imul(k,V)|0,r=r+Math.imul(w,G)|0,i=i+Math.imul(w,Y)|0,i=i+Math.imul(E,G)|0,o=o+Math.imul(E,Y)|0,r=r+Math.imul(m,$)|0,i=i+Math.imul(m,J)|0,i=i+Math.imul(v,$)|0,o=o+Math.imul(v,J)|0,r=r+Math.imul(d,Z)|0,i=i+Math.imul(d,ee)|0,i=i+Math.imul(g,Z)|0,o=o+Math.imul(g,ee)|0,r=r+Math.imul(l,ne)|0,i=i+Math.imul(l,re)|0,i=i+Math.imul(h,ne)|0,o=o+Math.imul(h,re)|0;var Ee=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(P,z),i=Math.imul(P,K),i=i+Math.imul(T,z)|0,o=Math.imul(T,K),r=r+Math.imul(x,q)|0,i=i+Math.imul(x,V)|0,i=i+Math.imul(I,q)|0,o=o+Math.imul(I,V)|0,r=r+Math.imul(S,G)|0,i=i+Math.imul(S,Y)|0,i=i+Math.imul(k,G)|0,o=o+Math.imul(k,Y)|0,r=r+Math.imul(w,$)|0,i=i+Math.imul(w,J)|0,i=i+Math.imul(E,$)|0,o=o+Math.imul(E,J)|0,r=r+Math.imul(m,Z)|0,i=i+Math.imul(m,ee)|0,i=i+Math.imul(v,Z)|0,o=o+Math.imul(v,ee)|0,r=r+Math.imul(d,ne)|0,i=i+Math.imul(d,re)|0,i=i+Math.imul(g,ne)|0,o=o+Math.imul(g,re)|0,r=r+Math.imul(l,oe)|0,i=i+Math.imul(l,se)|0,i=i+Math.imul(h,oe)|0,o=o+Math.imul(h,se)|0;var _e=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(R,z),i=Math.imul(R,K),i=i+Math.imul(O,z)|0,o=Math.imul(O,K),r=r+Math.imul(P,q)|0,i=i+Math.imul(P,V)|0,i=i+Math.imul(T,q)|0,o=o+Math.imul(T,V)|0,r=r+Math.imul(x,G)|0,i=i+Math.imul(x,Y)|0,i=i+Math.imul(I,G)|0,o=o+Math.imul(I,Y)|0,r=r+Math.imul(S,$)|0,i=i+Math.imul(S,J)|0,i=i+Math.imul(k,$)|0,o=o+Math.imul(k,J)|0,r=r+Math.imul(w,Z)|0,i=i+Math.imul(w,ee)|0,i=i+Math.imul(E,Z)|0,o=o+Math.imul(E,ee)|0,r=r+Math.imul(m,ne)|0,i=i+Math.imul(m,re)|0,i=i+Math.imul(v,ne)|0,o=o+Math.imul(v,re)|0,r=r+Math.imul(d,oe)|0,i=i+Math.imul(d,se)|0,i=i+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0,r=r+Math.imul(l,ue)|0,i=i+Math.imul(l,ce)|0,i=i+Math.imul(h,ue)|0,o=o+Math.imul(h,ce)|0;var Se=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(D,z),i=Math.imul(D,K),i=i+Math.imul(N,z)|0,o=Math.imul(N,K),r=r+Math.imul(R,q)|0,i=i+Math.imul(R,V)|0,i=i+Math.imul(O,q)|0,o=o+Math.imul(O,V)|0,r=r+Math.imul(P,G)|0,i=i+Math.imul(P,Y)|0,i=i+Math.imul(T,G)|0,o=o+Math.imul(T,Y)|0,r=r+Math.imul(x,$)|0,i=i+Math.imul(x,J)|0,i=i+Math.imul(I,$)|0,o=o+Math.imul(I,J)|0,r=r+Math.imul(S,Z)|0,i=i+Math.imul(S,ee)|0,i=i+Math.imul(k,Z)|0,o=o+Math.imul(k,ee)|0,r=r+Math.imul(w,ne)|0,i=i+Math.imul(w,re)|0,i=i+Math.imul(E,ne)|0,o=o+Math.imul(E,re)|0,r=r+Math.imul(m,oe)|0,i=i+Math.imul(m,se)|0,i=i+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,r=r+Math.imul(d,ue)|0,i=i+Math.imul(d,ce)|0,i=i+Math.imul(g,ue)|0,o=o+Math.imul(g,ce)|0,r=r+Math.imul(l,le)|0,i=i+Math.imul(l,he)|0,i=i+Math.imul(h,le)|0,o=o+Math.imul(h,he)|0;var ke=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(F,z),i=Math.imul(F,K),i=i+Math.imul(U,z)|0,o=Math.imul(U,K),r=r+Math.imul(D,q)|0,i=i+Math.imul(D,V)|0,i=i+Math.imul(N,q)|0,o=o+Math.imul(N,V)|0,r=r+Math.imul(R,G)|0,i=i+Math.imul(R,Y)|0,i=i+Math.imul(O,G)|0,o=o+Math.imul(O,Y)|0,r=r+Math.imul(P,$)|0,i=i+Math.imul(P,J)|0,i=i+Math.imul(T,$)|0,o=o+Math.imul(T,J)|0,r=r+Math.imul(x,Z)|0,i=i+Math.imul(x,ee)|0,i=i+Math.imul(I,Z)|0,o=o+Math.imul(I,ee)|0,r=r+Math.imul(S,ne)|0,i=i+Math.imul(S,re)|0,i=i+Math.imul(k,ne)|0,o=o+Math.imul(k,re)|0,r=r+Math.imul(w,oe)|0,i=i+Math.imul(w,se)|0,i=i+Math.imul(E,oe)|0,o=o+Math.imul(E,se)|0,r=r+Math.imul(m,ue)|0,i=i+Math.imul(m,ce)|0,i=i+Math.imul(v,ue)|0,o=o+Math.imul(v,ce)|0,r=r+Math.imul(d,le)|0,i=i+Math.imul(d,he)|0,i=i+Math.imul(g,le)|0,o=o+Math.imul(g,he)|0,r=r+Math.imul(l,de)|0,i=i+Math.imul(l,ge)|0,i=i+Math.imul(h,de)|0,o=o+Math.imul(h,ge)|0;var Ce=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(F,q),i=Math.imul(F,V),i=i+Math.imul(U,q)|0,o=Math.imul(U,V),r=r+Math.imul(D,G)|0,i=i+Math.imul(D,Y)|0,i=i+Math.imul(N,G)|0,o=o+Math.imul(N,Y)|0,r=r+Math.imul(R,$)|0,i=i+Math.imul(R,J)|0,i=i+Math.imul(O,$)|0,o=o+Math.imul(O,J)|0,r=r+Math.imul(P,Z)|0,i=i+Math.imul(P,ee)|0,i=i+Math.imul(T,Z)|0,o=o+Math.imul(T,ee)|0,r=r+Math.imul(x,ne)|0,i=i+Math.imul(x,re)|0,i=i+Math.imul(I,ne)|0,o=o+Math.imul(I,re)|0,r=r+Math.imul(S,oe)|0,i=i+Math.imul(S,se)|0,i=i+Math.imul(k,oe)|0,o=o+Math.imul(k,se)|0,r=r+Math.imul(w,ue)|0,i=i+Math.imul(w,ce)|0,i=i+Math.imul(E,ue)|0,o=o+Math.imul(E,ce)|0,r=r+Math.imul(m,le)|0,i=i+Math.imul(m,he)|0,i=i+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0,r=r+Math.imul(d,de)|0,i=i+Math.imul(d,ge)|0,i=i+Math.imul(g,de)|0,o=o+Math.imul(g,ge)|0;var xe=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(F,G),i=Math.imul(F,Y),i=i+Math.imul(U,G)|0,o=Math.imul(U,Y),r=r+Math.imul(D,$)|0,i=i+Math.imul(D,J)|0,i=i+Math.imul(N,$)|0,o=o+Math.imul(N,J)|0,r=r+Math.imul(R,Z)|0,i=i+Math.imul(R,ee)|0,i=i+Math.imul(O,Z)|0,o=o+Math.imul(O,ee)|0,r=r+Math.imul(P,ne)|0,i=i+Math.imul(P,re)|0,i=i+Math.imul(T,ne)|0,o=o+Math.imul(T,re)|0,r=r+Math.imul(x,oe)|0,i=i+Math.imul(x,se)|0,i=i+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,r=r+Math.imul(S,ue)|0,i=i+Math.imul(S,ce)|0,i=i+Math.imul(k,ue)|0,o=o+Math.imul(k,ce)|0,r=r+Math.imul(w,le)|0,i=i+Math.imul(w,he)|0,i=i+Math.imul(E,le)|0,o=o+Math.imul(E,he)|0,r=r+Math.imul(m,de)|0,i=i+Math.imul(m,ge)|0,i=i+Math.imul(v,de)|0,o=o+Math.imul(v,ge)|0;var Ie=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(F,$),i=Math.imul(F,J),i=i+Math.imul(U,$)|0,o=Math.imul(U,J),r=r+Math.imul(D,Z)|0,i=i+Math.imul(D,ee)|0,i=i+Math.imul(N,Z)|0,o=o+Math.imul(N,ee)|0,r=r+Math.imul(R,ne)|0,i=i+Math.imul(R,re)|0,i=i+Math.imul(O,ne)|0,o=o+Math.imul(O,re)|0,r=r+Math.imul(P,oe)|0,i=i+Math.imul(P,se)|0,i=i+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,r=r+Math.imul(x,ue)|0,i=i+Math.imul(x,ce)|0,i=i+Math.imul(I,ue)|0,o=o+Math.imul(I,ce)|0,r=r+Math.imul(S,le)|0,i=i+Math.imul(S,he)|0,i=i+Math.imul(k,le)|0,o=o+Math.imul(k,he)|0,r=r+Math.imul(w,de)|0,i=i+Math.imul(w,ge)|0,i=i+Math.imul(E,de)|0,o=o+Math.imul(E,ge)|0;var Ae=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(F,Z),i=Math.imul(F,ee),i=i+Math.imul(U,Z)|0,o=Math.imul(U,ee),r=r+Math.imul(D,ne)|0,i=i+Math.imul(D,re)|0,i=i+Math.imul(N,ne)|0,o=o+Math.imul(N,re)|0,r=r+Math.imul(R,oe)|0,i=i+Math.imul(R,se)|0,i=i+Math.imul(O,oe)|0,o=o+Math.imul(O,se)|0,r=r+Math.imul(P,ue)|0,i=i+Math.imul(P,ce)|0,i=i+Math.imul(T,ue)|0,o=o+Math.imul(T,ce)|0,r=r+Math.imul(x,le)|0,i=i+Math.imul(x,he)|0,i=i+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0,r=r+Math.imul(S,de)|0,i=i+Math.imul(S,ge)|0,i=i+Math.imul(k,de)|0,o=o+Math.imul(k,ge)|0;var Pe=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(F,ne),i=Math.imul(F,re),i=i+Math.imul(U,ne)|0,o=Math.imul(U,re),r=r+Math.imul(D,oe)|0,i=i+Math.imul(D,se)|0,i=i+Math.imul(N,oe)|0,o=o+Math.imul(N,se)|0,r=r+Math.imul(R,ue)|0,i=i+Math.imul(R,ce)|0,i=i+Math.imul(O,ue)|0,o=o+Math.imul(O,ce)|0,r=r+Math.imul(P,le)|0,i=i+Math.imul(P,he)|0,i=i+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0,r=r+Math.imul(x,de)|0,i=i+Math.imul(x,ge)|0,i=i+Math.imul(I,de)|0,o=o+Math.imul(I,ge)|0;var Te=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(F,oe),i=Math.imul(F,se),i=i+Math.imul(U,oe)|0,o=Math.imul(U,se),r=r+Math.imul(D,ue)|0,i=i+Math.imul(D,ce)|0,i=i+Math.imul(N,ue)|0,o=o+Math.imul(N,ce)|0,r=r+Math.imul(R,le)|0,i=i+Math.imul(R,he)|0,i=i+Math.imul(O,le)|0,o=o+Math.imul(O,he)|0,r=r+Math.imul(P,de)|0,i=i+Math.imul(P,ge)|0,i=i+Math.imul(T,de)|0,o=o+Math.imul(T,ge)|0;var Me=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(F,ue),i=Math.imul(F,ce),i=i+Math.imul(U,ue)|0,o=Math.imul(U,ce),r=r+Math.imul(D,le)|0,i=i+Math.imul(D,he)|0,i=i+Math.imul(N,le)|0,o=o+Math.imul(N,he)|0,r=r+Math.imul(R,de)|0,i=i+Math.imul(R,ge)|0,i=i+Math.imul(O,de)|0,o=o+Math.imul(O,ge)|0;var Re=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(F,le),i=Math.imul(F,he),i=i+Math.imul(U,le)|0,o=Math.imul(U,he),r=r+Math.imul(D,de)|0,i=i+Math.imul(D,ge)|0,i=i+Math.imul(N,de)|0,o=o+Math.imul(N,ge)|0;var Oe=(c+r|0)+((8191&i)<<13)|0;c=(o+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul(F,de),i=Math.imul(F,ge),i=i+Math.imul(U,de)|0,o=Math.imul(U,ge);var Be=(c+r|0)+((8191&i)<<13)|0;return c=(o+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,u[0]=ye,u[1]=me,u[2]=ve,u[3]=be,u[4]=we,u[5]=Ee,u[6]=_e,u[7]=Se,u[8]=ke,u[9]=Ce,u[10]=xe,u[11]=Ie,u[12]=Ae,u[13]=Pe,u[14]=Te,u[15]=Me,u[16]=Re,u[17]=Oe,u[18]=Be,0!==c&&(u[19]=c,n.length++),n};Math.imul||(S=u),BN.prototype.mulTo=function(e,t){var n,r=this.length+e.length;return n=10===this.length&&10===e.length?S(this,e,t):r<63?u(this,e,t):r<1024?c(this,e,t):f(this,e,t)},l.prototype.makeRBT=function(e){for(var t=new Array(e),n=BN.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},l.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},l.prototype.permute=function(e,t,n,r,i,o){for(var s=0;s<o;s++)r[s]=t[e[s]],i[s]=n[e[s]]},l.prototype.transform=function(e,t,n,r,i,o){this.permute(o,e,t,n,r,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),f=0;f<i;f+=a)for(var l=u,h=c,p=0;p<s;p++){var d=n[f+p],g=r[f+p],y=n[f+p+s],m=r[f+p+s],v=l*y-h*m;m=l*m+h*y,y=v,n[f+p]=d+y,r[f+p]=g+m,n[f+p+s]=d-y,r[f+p+s]=g-m,p!==a&&(v=u*l-c*h,h=u*h+c*l,l=v)}},l.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},l.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},l.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},l.prototype.convert13b=function(e,t,n,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],n[2*s]=8191&o,o>>>=13,n[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)n[s]=0;r(0===o),r(0===(o&-8192))},l.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},l.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),o=this.stub(r),s=new Array(r),a=new Array(r),u=new Array(r),c=new Array(r),f=new Array(r),l=new Array(r),h=n.words;h.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,c,r),this.transform(s,o,a,u,r,i),this.transform(c,o,f,l,r,i);for(var p=0;p<r;p++){var d=a[p]*f[p]-u[p]*l[p];u[p]=a[p]*l[p]+u[p]*f[p],a[p]=d}return this.conjugate(a,u,r),this.transform(a,u,h,o,r,i),this.conjugate(h,o,r),this.normalize13b(h,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n.strip()},BN.prototype.mul=function(e){var t=new BN(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},BN.prototype.mulf=function(e){var t=new BN(null);return t.words=new Array(this.length+e.length),f(this,e,t)},BN.prototype.imul=function(e){return this.clone().mulTo(e,this)},BN.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,n=0;n<this.length;n++){var i=(0|this.words[n])*e,o=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=o>>>26,this.words[n]=67108863&o}return 0!==t&&(this.words[n]=t,this.length++),this},BN.prototype.muln=function(e){return this.clone().imuln(e)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(e){var t=a(e);if(0===t.length)return new BN(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var i=n.sqr();r<t.length;r++,i=i.sqr())0!==t[r]&&(n=n.mul(i));return n},BN.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,n=e%26,i=(e-n)/26,o=67108863>>>26-n<<26-n;if(0!==n){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,u=(0|this.words[t])-a<<n;this.words[t]=u|s,s=a>>>26-n}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},BN.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},BN.prototype.iushrn=function(e,t,n){r("number"==typeof e&&e>=0);var i;i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,u=n;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var f=0;for(c=this.length-1;c>=0&&(0!==f||c>=i);c--){var l=0|this.words[c];this.words[c]=f<<26-o|l>>>o,f=l&a}return u&&0!==f&&(u.words[u.length++]=f),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},BN.prototype.ishrn=function(e,t,n){return r(0===this.negative),this.iushrn(e,t,n)},BN.prototype.shln=function(e){return this.clone().ishln(e)},BN.prototype.ushln=function(e){return this.clone().iushln(e)},BN.prototype.shrn=function(e){return this.clone().ishrn(e)},BN.prototype.ushrn=function(e){return this.clone().iushrn(e)},BN.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return!1;var o=this.words[n];return!!(o&i)},BN.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},BN.prototype.maskn=function(e){return this.clone().imaskn(e)},BN.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},BN.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},BN.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},BN.prototype.addn=function(e){return this.clone().iaddn(e)},BN.prototype.subn=function(e){return this.clone().isubn(e)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(e,t,n){var i,o=e.length+n;this._expand(o);var s,a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+n])+a;var u=(0|e.words[i])*t;s-=67108863&u,a=(s>>26)-(u/67108864|0),this.words[i+n]=67108863&s}for(;i<this.length-n;i++)s=(0|this.words[i+n])+a,a=s>>26,this.words[i+n]=67108863&s;if(0===a)return this.strip();for(r(a===-1),a=0,i=0;i<this.length;i++)s=-(0|this.words[i])+a,a=s>>26,this.words[i]=67108863&s;return this.negative=1,this.strip()},BN.prototype._wordDiv=function(e,t){var n=this.length-e.length,r=this.clone(),i=e,o=0|i.words[i.length-1],s=this._countBits(o);n=26-s,0!==n&&(i=i.ushln(n),r.iushln(n),o=0|i.words[i.length-1]);var a,u=r.length-i.length;if("mod"!==t){a=new BN(null),a.length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var f=r.clone()._ishlnsubmul(i,1,u);0===f.negative&&(r=f,a&&(a.words[u]=1));for(var l=u-1;l>=0;l--){var h=67108864*(0|r.words[i.length+l])+(0|r.words[i.length+l-1]);for(h=Math.min(h/o|0,67108863),r._ishlnsubmul(i,h,l);0!==r.negative;)h--,r.negative=0,r._ishlnsubmul(i,1,l),r.isZero()||(r.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),r.strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:a||null,mod:r}},BN.prototype.divmod=function(e,t,n){if(r(!e.isZero()),this.isZero())return{div:new BN(0),mod:new BN(0)};var i,o,s;return 0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(i=s.div.neg()),"div"!==t&&(o=s.mod.neg(),n&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(i=s.div.neg()),{div:i,mod:s.mod}):0!==(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(o=s.mod.neg(),n&&0!==o.negative&&o.isub(e)),{div:s.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new BN(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new BN(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new BN(this.modn(e.words[0]))}:this._wordDiv(e,t)},BN.prototype.div=function(e){return this.divmod(e,"div",!1).div},BN.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},BN.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},BN.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},BN.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,n=0,i=this.length-1;i>=0;i--)n=(t*n+(0|this.words[i]))%e;return n},BN.prototype.idivn=function(e){r(e<=67108863);for(var t=0,n=this.length-1;n>=0;n--){var i=(0|this.words[n])+67108864*t;this.words[n]=i/e|0,t=i%e}return this.strip()},BN.prototype.divn=function(e){return this.clone().idivn(e)},BN.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new BN(1),o=new BN(0),s=new BN(0),a=new BN(1),u=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++u;for(var c=n.clone(),f=t.clone();!t.isZero();){for(var l=0,h=1;0===(t.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(t.iushrn(l);l-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(c),o.isub(f)),i.iushrn(1),o.iushrn(1);for(var p=0,d=1;0===(n.words[0]&d)&&p<26;++p,d<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(c),a.isub(f)),s.iushrn(1),a.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(s),o.isub(a)):(n.isub(t),s.isub(i),a.isub(o))}return{a:s,b:a,gcd:n.iushln(u)}},BN.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new BN(1),o=new BN(0),s=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var a=0,u=1;0===(t.words[0]&u)&&a<26;++a,u<<=1);if(a>0)for(t.iushrn(a);a-- >0;)i.isOdd()&&i.iadd(s),i.iushrn(1);for(var c=0,f=1;0===(n.words[0]&f)&&c<26;++c,f<<=1);if(c>0)for(n.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(s),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(o)):(n.isub(t),o.isub(i))}var l;return l=0===t.cmpn(1)?i:o,l.cmpn(0)<0&&l.iadd(e),l},BN.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var o=t;t=n,n=o}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},BN.prototype.invm=function(e){return this.egcd(e).a.umod(e)},BN.prototype.isEven=function(){return 0===(1&this.words[0])},BN.prototype.isOdd=function(){return 1===(1&this.words[0])},BN.prototype.andln=function(e){return this.words[0]&e},BN.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var o=i,s=n;0!==o&&s<this.length;s++){var a=0|this.words[s];a+=o,o=a>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(e){var t=e<0;if(0!==this.negative&&!t)return-1;if(0===this.negative&&t)return 1;this.strip();var n;if(this.length>1)n=1;else{t&&(e=-e),r(e<=67108863,"Number is too big");var i=0|this.words[0];n=i===e?0:i<e?-1:1}return 0!==this.negative?0|-n:n},BN.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},BN.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},BN.prototype.gtn=function(e){return 1===this.cmpn(e)},BN.prototype.gt=function(e){return 1===this.cmp(e)},BN.prototype.gten=function(e){return this.cmpn(e)>=0},BN.prototype.gte=function(e){return this.cmp(e)>=0},BN.prototype.ltn=function(e){return this.cmpn(e)===-1},BN.prototype.lt=function(e){return this.cmp(e)===-1},BN.prototype.lten=function(e){return this.cmpn(e)<=0},BN.prototype.lte=function(e){return this.cmp(e)<=0},BN.prototype.eqn=function(e){return 0===this.cmpn(e)},BN.prototype.eq=function(e){return 0===this.cmp(e)},BN.red=function(e){return new m(e)},BN.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},BN.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(e){return this.red=e,this},BN.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},BN.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},BN.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},BN.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},BN.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},BN.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},BN.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},BN.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},BN.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var k={k256:null,p224:null,p192:null,p25519:null};h.prototype._tmp=function(){var e=new BN(null);return e.words=new Array(Math.ceil(this.n/13)),e},h.prototype.ireduce=function(e){var t,n=e;do this.split(n,this.tmp),n=this.imulK(n),n=n.iadd(this.tmp),t=n.bitLength();while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):n.strip(),n},h.prototype.split=function(e,t){e.iushrn(this.n,0,t)},h.prototype.imulK=function(e){return e.imul(this.k)},i(p,h),p.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&n,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&n)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},p.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(d,h),i(g,h),i(y,h),y.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},BN._prime=function C(e){if(k[e])return k[e];var C;if("k256"===e)C=new p;else if("p224"===e)C=new d;else if("p192"===e)C=new g;else{if("p25519"!==e)throw new Error("Unknown prime "+e);C=new y}return k[e]=C,C},m.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},m.prototype._verify2=function(e,t){r(0===(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},m.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},m.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},m.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},m.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},m.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},m.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},m.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},m.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},m.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},m.prototype.isqr=function(e){return this.imul(e,e.clone())},m.prototype.sqr=function(e){return this.mul(e,e)},m.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2===1),3===t){var n=this.m.add(new BN(1)).iushrn(2);return this.pow(e,n)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);r(!i.isZero());var s=new BN(1).toRed(this),a=s.redNeg(),u=this.m.subn(1).iushrn(1),c=this.m.bitLength();for(c=new BN(2*c*c).toRed(this);0!==this.pow(c,u).cmp(a);)c.redIAdd(a);for(var f=this.pow(c,i),l=this.pow(e,i.addn(1).iushrn(1)),h=this.pow(e,i),p=o;0!==h.cmp(s);){for(var d=h,g=0;0!==d.cmp(s);g++)d=d.redSqr();r(g<p);var y=this.pow(f,new BN(1).iushln(p-g-1));l=l.redMul(y),f=y.redSqr(),h=h.redMul(f),p=g}return l},m.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},m.prototype.pow=function(e,t){if(t.isZero())return new BN(1);if(0===t.cmpn(1))return e.clone();var n=4,r=new Array(1<<n);r[0]=new BN(1).toRed(this),r[1]=e;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],e);var o=r[0],s=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),i=t.length-1;i>=0;i--){
for(var c=t.words[i],f=u-1;f>=0;f--){var l=c>>f&1;o!==r[0]&&(o=this.sqr(o)),0!==l||0!==s?(s<<=1,s|=l,a++,(a===n||0===i&&0===f)&&(o=this.mul(o,r[s]),a=0,s=0)):a=0}u=26}return o},m.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},m.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},BN.mont=function(e){return new v(e)},i(v,m),v.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},v.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},v.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},v.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new BN(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},v.prototype.invm=function(e){var t=this.imod(e._invmp(this.m).mul(this.r2));return t._forceRed(this)}}("undefined"==typeof t||t,this)},{}],27:[function(e,t,n){function r(e){this.rand=e}var i;if(t.exports=function(e){return i||(i=new r(null)),i.generate(e)},t.exports.Rand=r,r.prototype.generate=function(e){return this._rand(e)},"object"==typeof window)window.crypto&&window.crypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}:window.msCrypto&&window.msCrypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return window.msCrypto.getRandomValues(t),t}:r.prototype._rand=function(){throw new Error("Not implemented yet")};else try{var o=e("crypto");r.prototype._rand=function(e){return o.randomBytes(e)}}catch(s){r.prototype._rand=function(e){for(var t=new Uint8Array(e),n=0;n<t.length;n++)t[n]=this.rand.getByte();return t}}},{crypto:564}],28:[function(e,t,n){(function(Buffer){function e(e){var t,n;return t=e>s||e<0?(n=Math.abs(e)%s,e<0?s-n:n):e}function t(e){for(var t=0;t<e.length;e++)e[t]=0;return!1}function r(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function i(e){for(var t=e.length/4,n=new Array(t),r=-1;++r<t;)n[r]=e.readUInt32BE(4*r);return n}function o(e){this._key=i(e),this._doReset()}var s=Math.pow(2,32);r.prototype.init=function(){var e,t,n,r,i,o,s,a,u,c;for(e=function(){var e,n;for(n=[],t=e=0;e<256;t=++e)t<128?n.push(t<<1):n.push(t<<1^283);return n}(),i=0,u=0,t=c=0;c<256;t=++c)n=u^u<<1^u<<2^u<<3^u<<4,n=n>>>8^255&n^99,this.SBOX[i]=n,this.INV_SBOX[n]=i,o=e[i],s=e[o],a=e[s],r=257*e[n]^16843008*n,this.SUB_MIX[0][i]=r<<24|r>>>8,this.SUB_MIX[1][i]=r<<16|r>>>16,this.SUB_MIX[2][i]=r<<8|r>>>24,this.SUB_MIX[3][i]=r,r=16843009*a^65537*s^257*o^16843008*i,this.INV_SUB_MIX[0][n]=r<<24|r>>>8,this.INV_SUB_MIX[1][n]=r<<16|r>>>16,this.INV_SUB_MIX[2][n]=r<<8|r>>>24,this.INV_SUB_MIX[3][n]=r,0===i?i=u=1:(i=o^e[e[e[a^o]]],u^=e[e[u]]);return!0};var a=new r;o.blockSize=16,o.prototype.blockSize=o.blockSize,o.keySize=32,o.prototype.keySize=o.keySize,o.prototype._doReset=function(){var e,t,n,r,i,o;for(n=this._key,t=n.length,this._nRounds=t+6,i=4*(this._nRounds+1),this._keySchedule=[],r=0;r<i;r++)this._keySchedule[r]=r<t?n[r]:(o=this._keySchedule[r-1],r%t===0?(o=o<<8|o>>>24,o=a.SBOX[o>>>24]<<24|a.SBOX[o>>>16&255]<<16|a.SBOX[o>>>8&255]<<8|a.SBOX[255&o],o^=a.RCON[r/t|0]<<24):t>6&&r%t===4?o=a.SBOX[o>>>24]<<24|a.SBOX[o>>>16&255]<<16|a.SBOX[o>>>8&255]<<8|a.SBOX[255&o]:void 0,this._keySchedule[r-t]^o);for(this._invKeySchedule=[],e=0;e<i;e++)r=i-e,o=this._keySchedule[r-(e%4?0:4)],this._invKeySchedule[e]=e<4||r<=4?o:a.INV_SUB_MIX[0][a.SBOX[o>>>24]]^a.INV_SUB_MIX[1][a.SBOX[o>>>16&255]]^a.INV_SUB_MIX[2][a.SBOX[o>>>8&255]]^a.INV_SUB_MIX[3][a.SBOX[255&o]];return!0},o.prototype.encryptBlock=function(e){e=i(new Buffer(e));var t=this._doCryptBlock(e,this._keySchedule,a.SUB_MIX,a.SBOX),n=new Buffer(16);return n.writeUInt32BE(t[0],0),n.writeUInt32BE(t[1],4),n.writeUInt32BE(t[2],8),n.writeUInt32BE(t[3],12),n},o.prototype.decryptBlock=function(e){e=i(new Buffer(e));var t=[e[3],e[1]];e[1]=t[0],e[3]=t[1];var n=this._doCryptBlock(e,this._invKeySchedule,a.INV_SUB_MIX,a.INV_SBOX),r=new Buffer(16);return r.writeUInt32BE(n[0],0),r.writeUInt32BE(n[3],4),r.writeUInt32BE(n[2],8),r.writeUInt32BE(n[1],12),r},o.prototype.scrub=function(){t(this._keySchedule),t(this._invKeySchedule),t(this._key)},o.prototype._doCryptBlock=function(t,n,r,i){var o,s,a,u,c,f,l,h,p;s=t[0]^n[0],a=t[1]^n[1],u=t[2]^n[2],c=t[3]^n[3],o=4;for(var d=1;d<this._nRounds;d++)f=r[0][s>>>24]^r[1][a>>>16&255]^r[2][u>>>8&255]^r[3][255&c]^n[o++],l=r[0][a>>>24]^r[1][u>>>16&255]^r[2][c>>>8&255]^r[3][255&s]^n[o++],h=r[0][u>>>24]^r[1][c>>>16&255]^r[2][s>>>8&255]^r[3][255&a]^n[o++],p=r[0][c>>>24]^r[1][s>>>16&255]^r[2][a>>>8&255]^r[3][255&u]^n[o++],s=f,a=l,u=h,c=p;return f=(i[s>>>24]<<24|i[a>>>16&255]<<16|i[u>>>8&255]<<8|i[255&c])^n[o++],l=(i[a>>>24]<<24|i[u>>>16&255]<<16|i[c>>>8&255]<<8|i[255&s])^n[o++],h=(i[u>>>24]<<24|i[c>>>16&255]<<16|i[s>>>8&255]<<8|i[255&a])^n[o++],p=(i[c>>>24]<<24|i[s>>>16&255]<<16|i[a>>>8&255]<<8|i[255&u])^n[o++],[e(f),e(l),e(h),e(p)]},n.AES=o}).call(this,e("buffer").Buffer)},{buffer:590}],29:[function(e,t,n){(function(Buffer){function n(e,t,r,s){if(!(this instanceof n))return new n(e,t,r);o.call(this),this._finID=Buffer.concat([r,new Buffer([0,0,0,1])]),r=Buffer.concat([r,new Buffer([0,0,0,2])]),this._cipher=new i.AES(t),this._prev=new Buffer(r.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=s,this._alen=0,this._len=0,r.copy(this._prev),this._mode=e;var u=new Buffer(4);u.fill(0),this._ghash=new a(this._cipher.encryptBlock(u)),this._authTag=null,this._called=!1}function r(e,t){var n=0;e.length!==t.length&&n++;for(var r=Math.min(e.length,t.length),i=-1;++i<r;)n+=e[i]^t[i];return n}var i=e("./aes"),o=e("cipher-base"),s=e("inherits"),a=e("./ghash"),u=e("buffer-xor");s(n,o),t.exports=n,n.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=new Buffer(t),t.fill(0),this._ghash.update(t))}this._called=!0;var n=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(n),this._len+=e.length,n},n.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=u(this._ghash["final"](8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(r(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=e;this._cipher.scrub()},n.prototype.getAuthTag=function(){if(!this._decrypt&&Buffer.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},n.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},n.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length}}).call(this,e("buffer").Buffer)},{"./aes":28,"./ghash":33,buffer:590,"buffer-xor":47,"cipher-base":49,inherits:102}],30:[function(e,t,n){function r(){return Object.keys(s)}var i=e("./encrypter");n.createCipher=n.Cipher=i.createCipher,n.createCipheriv=n.Cipheriv=i.createCipheriv;var o=e("./decrypter");n.createDecipher=n.Decipher=o.createDecipher,n.createDecipheriv=n.Decipheriv=o.createDecipheriv;var s=e("./modes");n.listCiphers=n.getCiphers=r},{"./decrypter":31,"./encrypter":32,"./modes":34}],31:[function(e,t,n){(function(Buffer){function t(e,n,i){return this instanceof t?(u.call(this),this._cache=new r,this._last=void 0,this._cipher=new a.AES(n),this._prev=new Buffer(i.length),i.copy(this._prev),this._mode=e,void(this._autopadding=!0)):new t(e,n,i)}function r(){return this instanceof r?void(this.cache=new Buffer("")):new r}function i(e){for(var t=e[15],n=-1;++n<t;)if(e[n+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}function o(e,n,r){var i=f[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=new Buffer(r)),"string"==typeof n&&(n=new Buffer(n)),n.length!==i.key/8)throw new TypeError("invalid key length "+n.length);if(r.length!==i.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===i.type?new l(d[i.mode],n,r,(!0)):"auth"===i.type?new h(d[i.mode],n,r,(!0)):new t(d[i.mode],n,r)}function s(e,t){var n=f[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=p(t,!1,n.key,n.iv);return o(e,r.key,r.iv)}var a=e("./aes"),u=e("cipher-base"),c=e("inherits"),f=e("./modes"),l=e("./streamCipher"),h=e("./authCipher"),p=e("evp_bytestokey");c(t,u),t.prototype._update=function(e){this._cache.add(e);for(var t,n,r=[];t=this._cache.get(this._autopadding);)n=this._mode.decrypt(this,t),r.push(n);return Buffer.concat(r)},t.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return i(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},t.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},r.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},r.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},r.prototype.flush=function(){if(this.cache.length)return this.cache};var d={ECB:e("./modes/ecb"),CBC:e("./modes/cbc"),CFB:e("./modes/cfb"),CFB8:e("./modes/cfb8"),CFB1:e("./modes/cfb1"),OFB:e("./modes/ofb"),CTR:e("./modes/ctr"),GCM:e("./modes/ctr")};n.createDecipher=s,n.createDecipheriv=o}).call(this,e("buffer").Buffer)},{"./aes":28,"./authCipher":29,"./modes":34,"./modes/cbc":35,"./modes/cfb":36,"./modes/cfb1":37,"./modes/cfb8":38,"./modes/ctr":39,"./modes/ecb":40,"./modes/ofb":41,"./streamCipher":42,buffer:590,"cipher-base":49,evp_bytestokey:74,inherits:102}],32:[function(e,t,n){(function(Buffer){function t(e,n,i){return this instanceof t?(a.call(this),this._cache=new r,this._cipher=new s.AES(n),this._prev=new Buffer(i.length),i.copy(this._prev),this._mode=e,void(this._autopadding=!0)):new t(e,n,i)}function r(){return this instanceof r?void(this.cache=new Buffer("")):new r}function i(e,n,r){var i=c[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=new Buffer(r)),"string"==typeof n&&(n=new Buffer(n)),n.length!==i.key/8)throw new TypeError("invalid key length "+n.length);if(r.length!==i.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===i.type?new l(p[i.mode],n,r):"auth"===i.type?new h(p[i.mode],n,r):new t(p[i.mode],n,r)}function o(e,t){var n=c[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=f(t,!1,n.key,n.iv);return i(e,r.key,r.iv)}var s=e("./aes"),a=e("cipher-base"),u=e("inherits"),c=e("./modes"),f=e("evp_bytestokey"),l=e("./streamCipher"),h=e("./authCipher");u(t,a),t.prototype._update=function(e){this._cache.add(e);for(var t,n,r=[];t=this._cache.get();)n=this._mode.encrypt(this,t),r.push(n);return Buffer.concat(r)},t.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if("10101010101010101010101010101010"!==e.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},t.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},r.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},r.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},r.prototype.flush=function(){for(var e=16-this.cache.length,t=new Buffer(e),n=-1;++n<e;)t.writeUInt8(e,n);var r=Buffer.concat([this.cache,t]);return r};var p={ECB:e("./modes/ecb"),CBC:e("./modes/cbc"),CFB:e("./modes/cfb"),CFB8:e("./modes/cfb8"),CFB1:e("./modes/cfb1"),OFB:e("./modes/ofb"),CTR:e("./modes/ctr"),GCM:e("./modes/ctr")};n.createCipheriv=i,n.createCipher=o}).call(this,e("buffer").Buffer)},{"./aes":28,"./authCipher":29,"./modes":34,"./modes/cbc":35,"./modes/cfb":36,"./modes/cfb1":37,"./modes/cfb8":38,"./modes/ctr":39,"./modes/ecb":40,"./modes/ofb":41,"./streamCipher":42,buffer:590,"cipher-base":49,evp_bytestokey:74,inherits:102}],33:[function(e,t,n){(function(Buffer){function e(e){this.h=e,this.state=new Buffer(16),this.state.fill(0),this.cache=new Buffer("")}function n(e){return[e.readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)]}function r(e){e=e.map(i);var t=new Buffer(16);return t.writeUInt32BE(e[0],0),t.writeUInt32BE(e[1],4),t.writeUInt32BE(e[2],8),t.writeUInt32BE(e[3],12),t}function i(e){var t,n;return t=e>a||e<0?(n=Math.abs(e)%a,e<0?a-n:n):e}function o(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}var s=new Buffer(16);s.fill(0),t.exports=e,e.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},e.prototype._multiply=function(){for(var e,t,i,s=n(this.h),a=[0,0,0,0],u=-1;++u<128;){for(t=0!==(this.state[~~(u/8)]&1<<7-u%8),t&&(a=o(a,s)),i=0!==(1&s[3]),e=3;e>0;e--)s[e]=s[e]>>>1|(1&s[e-1])<<31;s[0]=s[0]>>>1,i&&(s[0]=s[0]^225<<24)}this.state=r(a)},e.prototype.update=function(e){this.cache=Buffer.concat([this.cache,e]);for(var t;this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},e.prototype["final"]=function(e,t){return this.cache.length&&this.ghash(Buffer.concat([this.cache,s],16)),this.ghash(r([0,e,0,t])),this.state};var a=Math.pow(2,32)}).call(this,e("buffer").Buffer)},{buffer:590}],34:[function(e,t,n){n["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},n["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},n["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},n["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},n["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},n["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},n.aes128=n["aes-128-cbc"],n.aes192=n["aes-192-cbc"],n.aes256=n["aes-256-cbc"],n["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},n["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},n["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},n["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},n["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},n["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},n["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},n["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},n["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},n["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},n["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},n["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},n["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},n["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},n["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},n["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},n["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},n["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}},{}],35:[function(e,t,n){var r=e("buffer-xor");n.encrypt=function(e,t){var n=r(t,e._prev);return e._prev=e._cipher.encryptBlock(n),e._prev},n.decrypt=function(e,t){var n=e._prev;e._prev=t;var i=e._cipher.decryptBlock(t);return r(i,n)}},{"buffer-xor":47}],36:[function(e,t,n){(function(Buffer){function t(e,t,n){var i=t.length,o=r(t,e._cache);return e._cache=e._cache.slice(i),e._prev=Buffer.concat([e._prev,n?t:o]),o}var r=e("buffer-xor");n.encrypt=function(e,n,r){for(var i,o=new Buffer("");n.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=new Buffer("")),!(e._cache.length<=n.length)){o=Buffer.concat([o,t(e,n,r)]);break}i=e._cache.length,o=Buffer.concat([o,t(e,n.slice(0,i),r)]),n=n.slice(i)}return o}}).call(this,e("buffer").Buffer)},{buffer:590,"buffer-xor":47}],37:[function(e,t,n){(function(Buffer){function e(e,n,r){for(var i,o,s,a=-1,u=8,c=0;++a<u;)i=e._cipher.encryptBlock(e._prev),o=n&1<<7-a?128:0,s=i[0]^o,c+=(128&s)>>a%8,e._prev=t(e._prev,r?o:s);return c}function t(e,t){var n=e.length,r=-1,i=new Buffer(e.length);for(e=Buffer.concat([e,new Buffer([t])]);++r<n;)i[r]=e[r]<<1|e[r+1]>>7;return i}n.encrypt=function(t,n,r){for(var i=n.length,o=new Buffer(i),s=-1;++s<i;)o[s]=e(t,n[s],r);return o}}).call(this,e("buffer").Buffer)},{buffer:590}],38:[function(e,t,n){(function(Buffer){function e(e,t,n){var r=e._cipher.encryptBlock(e._prev),i=r[0]^t;return e._prev=Buffer.concat([e._prev.slice(1),new Buffer([n?t:i])]),i}n.encrypt=function(t,n,r){for(var i=n.length,o=new Buffer(i),s=-1;++s<i;)o[s]=e(t,n[s],r);return o}}).call(this,e("buffer").Buffer)},{buffer:590}],39:[function(e,t,n){(function(Buffer){function t(e){for(var t,n=e.length;n--;){if(t=e.readUInt8(n),255!==t){t++,e.writeUInt8(t,n);break}e.writeUInt8(0,n)}}function r(e){var n=e._cipher.encryptBlock(e._prev);return t(e._prev),n}var i=e("buffer-xor");n.encrypt=function(e,t){for(;e._cache.length<t.length;)e._cache=Buffer.concat([e._cache,r(e)]);var n=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,n)}}).call(this,e("buffer").Buffer)},{buffer:590,"buffer-xor":47}],40:[function(e,t,n){n.encrypt=function(e,t){return e._cipher.encryptBlock(t)},n.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},{}],41:[function(e,t,n){(function(Buffer){function t(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}var r=e("buffer-xor");n.encrypt=function(e,n){for(;e._cache.length<n.length;)e._cache=Buffer.concat([e._cache,t(e)]);var i=e._cache.slice(0,n.length);return e._cache=e._cache.slice(n.length),r(n,i)}}).call(this,e("buffer").Buffer)},{buffer:590,"buffer-xor":47}],42:[function(e,t,n){(function(Buffer){function n(e,t,o,s){return this instanceof n?(i.call(this),this._cipher=new r.AES(t),this._prev=new Buffer(o.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=s,o.copy(this._prev),void(this._mode=e)):new n(e,t,o)}var r=e("./aes"),i=e("cipher-base"),o=e("inherits");o(n,i),t.exports=n,n.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},n.prototype._final=function(){this._cipher.scrub()}}).call(this,e("buffer").Buffer)},{"./aes":28,buffer:590,"cipher-base":49,inherits:102}],43:[function(e,t,n){var r=e("base-x"),i="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";t.exports=r(i)},{"base-x":15}],44:[function(e,t,n){(function(Buffer){"use strict";function n(e){var t=s("sha256").update(e).digest();return s("sha256").update(t).digest()}function r(e){var t=n(e);return o.encode(Buffer.concat([e,t],e.length+4))}function i(e){var t=new Buffer(o.decode(e)),r=t.slice(0,-4),i=t.slice(-4),s=n(r);if(i[0]^s[0]|i[1]^s[1]|i[2]^s[2]|i[3]^s[3])throw new Error("Invalid checksum");return r}var o=e("bs58"),s=e("create-hash");t.exports={encode:r,decode:i}}).call(this,e("buffer").Buffer)},{bs58:45,buffer:590,"create-hash":51}],45:[function(e,t,n){function r(e){if(0===e.length)return"";var t,n,r=[0];for(t=0;t<e.length;t++){for(n=0;n<r.length;n++)r[n]<<=8;r[0]+=e[t];var i=0;for(n=0;n<r.length;++n)r[n]+=i,i=r[n]/u|0,r[n]%=u;for(;i;)r.push(i%u),i=i/u|0}for(t=0;0===e[t]&&t<e.length-1;t++)r.push(0);for(var s="",t=r.length-1;t>=0;t--)s+=o[r[t]];return s}function i(e){if(0===e.length)return[];var t,n,r=[0];for(t=0;t<e.length;t++){var i=e[t];if(!(i in s))throw new Error("Non-base58 character");for(n=0;n<r.length;n++)r[n]*=u;r[0]+=s[i];var o=0;for(n=0;n<r.length;++n)r[n]+=o,o=r[n]>>8,r[n]&=255;for(;o;)r.push(255&o),o>>=8}for(t=0;"1"===e[t]&&t<e.length-1;t++)r.push(0);return r.reverse()}for(var o="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",s={},a=0;a<o.length;a++)s[o.charAt(a)]=a;var u=58;t.exports={encode:r,decode:i}},{}],46:[function(e,t,n){(function(t){"use strict";var r=e("buffer"),Buffer=r.Buffer,i=r.SlowBuffer,o=r.kMaxLength||2147483647;n.alloc=function(e,t,n){if("function"==typeof Buffer.alloc)return Buffer.alloc(e,t,n);if("number"==typeof n)throw new TypeError("encoding must not be number");if("number"!=typeof e)throw new TypeError("size must be a number");if(e>o)throw new RangeError("size is too large");var r=n,i=t;void 0===i&&(r=void 0,i=0);var s=new Buffer(e);if("string"==typeof i)for(var a=new Buffer(i,r),u=a.length,c=-1;++c<e;)s[c]=a[c%u];else s.fill(i);return s},n.allocUnsafe=function(e){if("function"==typeof Buffer.allocUnsafe)return Buffer.allocUnsafe(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(e>o)throw new RangeError("size is too large");return new Buffer(e)},n.from=function(e,n,r){if("function"==typeof Buffer.from&&(!t.Uint8Array||Uint8Array.from!==Buffer.from))return Buffer.from(e,n,r);if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("string"==typeof e)return new Buffer(e,n);if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){var i=n;if(1===arguments.length)return new Buffer(e);"undefined"==typeof i&&(i=0);var o=r;if("undefined"==typeof o&&(o=e.byteLength-i),i>=e.byteLength)throw new RangeError("'offset' is out of bounds");if(o>e.byteLength-i)throw new RangeError("'length' is out of bounds");return new Buffer(e.slice(i,i+o))}if(Buffer.isBuffer(e)){var s=new Buffer(e.length);return e.copy(s,0,0,e.length),s}if(e){if(Array.isArray(e)||"undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return new Buffer(e);if("Buffer"===e.type&&Array.isArray(e.data))return new Buffer(e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},n.allocUnsafeSlow=function(e){if("function"==typeof Buffer.allocUnsafeSlow)return Buffer.allocUnsafeSlow(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(e>=o)throw new RangeError("size is too large");return new i(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:590}],47:[function(e,t,n){(function(Buffer){t.exports=function(e,t){for(var n=Math.min(e.length,t.length),r=new Buffer(n),i=0;i<n;++i)r[i]=e[i]^t[i];return r}}).call(this,e("buffer").Buffer)},{buffer:590}],48:[function(e,t,n){!function(r){"use strict";function o(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}var r=function(e,t,n){if("undefined"==typeof e&&(e=r.DEFAULT_CAPACITY),"undefined"==typeof t&&(t=r.DEFAULT_ENDIAN),"undefined"==typeof n&&(n=r.DEFAULT_NOASSERT),!n){if(e=0|e,e<0)throw RangeError("Illegal capacity");t=!!t,n=!!n}this.buffer=0===e?s:new ArrayBuffer(e),this.view=0===e?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian="undefined"!=typeof t&&!!t,this.noAssert=!!n};r.VERSION="3.5.5",r.LITTLE_ENDIAN=!0,r.BIG_ENDIAN=!1,r.DEFAULT_CAPACITY=16,r.DEFAULT_ENDIAN=r.BIG_ENDIAN,r.DEFAULT_NOASSERT=!1,r.Long=e||null;var o=r.prototype,s=new ArrayBuffer(0),a=String.fromCharCode;r.allocate=function(e,t,n){return new r(e,t,n)},r.concat=function(e,t,n,i){"boolean"!=typeof t&&"string"==typeof t||(i=n,n=t,t=void 0);for(var o,s=0,a=0,u=e.length;a<u;++a)r.isByteBuffer(e[a])||(e[a]=r.wrap(e[a],t)),o=e[a].limit-e[a].offset,o>0&&(s+=o);if(0===s)return new r(0,n,i);var c,f=new r(s,n,i),l=new Uint8Array(f.buffer);for(a=0;a<u;)c=e[a++],o=c.limit-c.offset,o<=0||(l.set(new Uint8Array(c.buffer).subarray(c.offset,c.limit),f.offset),f.offset+=o);return f.limit=f.offset,f.offset=0,f},r.isByteBuffer=function(e){return(e&&e instanceof r)===!0},r.type=function(){return ArrayBuffer},r.wrap=function(e,t,n,s){if("string"!=typeof t&&(s=n,n=t,t=void 0),"string"==typeof e)switch("undefined"==typeof t&&(t="utf8"),t){case"base64":return r.fromBase64(e,n);case"hex":return r.fromHex(e,n);case"binary":return r.fromBinary(e,n);case"utf8":return r.fromUTF8(e,n);case"debug":return r.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!=typeof e)throw TypeError("Illegal buffer");var a;if(r.isByteBuffer(e))return a=o.clone.call(e),a.markedOffset=-1,a;if(e instanceof Uint8Array)a=new r(0,n,s),e.length>0&&(a.buffer=e.buffer,a.offset=e.byteOffset,a.limit=e.byteOffset+e.length,a.view=e.length>0?new DataView(e.buffer):null);else if(e instanceof ArrayBuffer)a=new r(0,n,s),e.byteLength>0&&(a.buffer=e,a.offset=0,a.limit=e.byteLength,a.view=e.byteLength>0?new DataView(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");for(a=new r(e.length,n,s),a.limit=e.length,i=0;i<e.length;++i)a.view.setUint8(i,e[i])}return a},o.writeInt8=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view.setInt8(t,e),n&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view.getInt8(e);return t&&(this.offset+=1),n},o.readByte=o.readInt8,o.writeUint8=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view.setUint8(t,e),n&&(this.offset+=1),this},o.readUint8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view.getUint8(e);return t&&(this.offset+=1),n},o.writeInt16=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.view.setInt16(t,e,this.littleEndian),n&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=this.view.getInt16(e,this.littleEndian);return t&&(this.offset+=2),n},o.readShort=o.readInt16,o.writeUint16=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.view.setUint16(t,e,this.littleEndian),n&&(this.offset+=2),this},o.readUint16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=this.view.getUint16(e,this.littleEndian);return t&&(this.offset+=2),n},o.writeInt32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.view.setInt32(t,e,this.littleEndian),n&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=this.view.getInt32(e,this.littleEndian);return t&&(this.offset+=4),n},o.readInt=o.readInt32,o.writeUint32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.view.setUint32(t,e,this.littleEndian),n&&(this.offset+=4),this},o.readUint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=this.view.getUint32(e,this.littleEndian);return t&&(this.offset+=4),n},e&&(o.writeInt64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),n+=8;var i=this.buffer.byteLength;return n>i&&this.resize((i*=2)>n?i:n),n-=8,this.littleEndian?(this.view.setInt32(n,t.low,!0),this.view.setInt32(n+4,t.high,!0)):(this.view.setInt32(n,t.high,!1),this.view.setInt32(n+4,t.low,!1)),r&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength);
}var r=this.littleEndian?new e(this.view.getInt32(t,!0),this.view.getInt32(t+4,!0),(!1)):new e(this.view.getInt32(t+4,!1),this.view.getInt32(t,!1),(!1));return n&&(this.offset+=8),r},o.readLong=o.readInt64,o.writeUint64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),n+=8;var i=this.buffer.byteLength;return n>i&&this.resize((i*=2)>n?i:n),n-=8,this.littleEndian?(this.view.setInt32(n,t.low,!0),this.view.setInt32(n+4,t.high,!0)):(this.view.setInt32(n,t.high,!1),this.view.setInt32(n+4,t.low,!1)),r&&(this.offset+=8),this},o.readUint64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=this.littleEndian?new e(this.view.getInt32(t,!0),this.view.getInt32(t+4,!0),(!0)):new e(this.view.getInt32(t+4,!1),this.view.getInt32(t,!1),(!0));return n&&(this.offset+=8),r}),o.writeFloat32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.view.setFloat32(t,e,this.littleEndian),n&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=this.view.getFloat32(e,this.littleEndian);return t&&(this.offset+=4),n},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=8,this.view.setFloat64(t,e,this.littleEndian),n&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=this.view.getFloat64(e,this.littleEndian);return t&&(this.offset+=8),n},o.readDouble=o.readFloat64,r.MAX_VARINT32_BYTES=5,r.calculateVarint32=function(e){return e>>>=0,e<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},r.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},r.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},o.writeVarint32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var i,o=r.calculateVarint32(e);t+=o;var s=this.buffer.byteLength;return t>s&&this.resize((s*=2)>t?s:t),t-=o,this.view.setUint8(t,i=128|e),e>>>=0,e>=128?(i=e>>7|128,this.view.setUint8(t+1,i),e>=16384?(i=e>>14|128,this.view.setUint8(t+2,i),e>=1<<21?(i=e>>21|128,this.view.setUint8(t+3,i),e>=1<<28?(this.view.setUint8(t+4,e>>28&15),o=5):(this.view.setUint8(t+3,127&i),o=4)):(this.view.setUint8(t+2,127&i),o=3)):(this.view.setUint8(t+1,127&i),o=2)):(this.view.setUint8(t,127&i),o=1),n?(this.offset+=o,this):o},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(r.zigZagEncode32(e),t)},o.readVarint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r,i=0,o=0;do{if(r=e+i,!this.noAssert&&r>this.limit){var s=Error("Truncated");throw s.truncated=!0,s}n=this.view.getUint8(r),i<5&&(o|=(127&n)<<7*i>>>0),++i}while(128===(128&n));return o=0|o,t?(this.offset+=i,o):{value:o,length:i}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"==typeof t?t.value=r.zigZagDecode32(t.value):t=r.zigZagDecode32(t),t},e&&(r.MAX_VARINT64_BYTES=10,r.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10},r.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},r.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(t,n){var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned());var o=r.calculateVarint64(t),s=t.toInt()>>>0,a=t.shiftRightUnsigned(28).toInt()>>>0,u=t.shiftRightUnsigned(56).toInt()>>>0;n+=o;var c=this.buffer.byteLength;switch(n>c&&this.resize((c*=2)>n?c:n),n-=o,o){case 10:this.view.setUint8(n+9,u>>>7&1);case 9:this.view.setUint8(n+8,9!==o?128|u:127&u);case 8:this.view.setUint8(n+7,8!==o?a>>>21|128:a>>>21&127);case 7:this.view.setUint8(n+6,7!==o?a>>>14|128:a>>>14&127);case 6:this.view.setUint8(n+5,6!==o?a>>>7|128:a>>>7&127);case 5:this.view.setUint8(n+4,5!==o?128|a:127&a);case 4:this.view.setUint8(n+3,4!==o?s>>>21|128:s>>>21&127);case 3:this.view.setUint8(n+2,3!==o?s>>>14|128:s>>>14&127);case 2:this.view.setUint8(n+1,2!==o?s>>>7|128:s>>>7&127);case 1:this.view.setUint8(n,1!==o?128|s:127&s)}return i?(this.offset+=o,this):o},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(r.zigZagEncode64(e),t)},o.readVarint64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,t<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var r=t,i=0,o=0,s=0,a=0;if(a=this.view.getUint8(t++),i=127&a,128&a&&(a=this.view.getUint8(t++),i|=(127&a)<<7,128&a&&(a=this.view.getUint8(t++),i|=(127&a)<<14,128&a&&(a=this.view.getUint8(t++),i|=(127&a)<<21,128&a&&(a=this.view.getUint8(t++),o=127&a,128&a&&(a=this.view.getUint8(t++),o|=(127&a)<<7,128&a&&(a=this.view.getUint8(t++),o|=(127&a)<<14,128&a&&(a=this.view.getUint8(t++),o|=(127&a)<<21,128&a&&(a=this.view.getUint8(t++),s=127&a,128&a&&(a=this.view.getUint8(t++),s|=(127&a)<<7,128&a))))))))))throw Error("Buffer overrun");var u=e.fromBits(i|o<<28,o>>>4|s<<24,!1);return n?(this.offset=t,u):{value:u,length:t-r}},o.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=r.zigZagDecode64(n.value):n=r.zigZagDecode64(n),n}),o.writeCString=function(e,n){var r="undefined"==typeof n;r&&(n=this.offset);var i,o=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(i=0;i<o;++i)if(0===e.charCodeAt(i))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}o=c.calculateUTF16asUTF8(t(e))[1],n+=o+1;var s=this.buffer.byteLength;return n>s&&this.resize((s*=2)>n?s:n),n-=o+1,c.encodeUTF16toUTF8(t(e),function(e){this.view.setUint8(n++,e)}.bind(this)),this.view.setUint8(n++,0),r?(this.offset=n,this):o},o.readCString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r,i=e,o=-1;return c.decodeUTF8toUTF16(function(){if(0===o)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(o=this.view.getUint8(e++))?null:o}.bind(this),r=n(),!0),t?(this.offset=e,r()):{string:r(),length:e-i}},o.writeIString=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=n;i=c.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+i;var s=this.buffer.byteLength;if(n>s&&this.resize((s*=2)>n?s:n),n-=4+i,this.view.setUint32(n,i,this.littleEndian),n+=4,c.encodeUTF16toUTF8(t(e),function(e){this.view.setUint8(n++,e)}.bind(this)),n!==o+4+i)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+i));return r?(this.offset=n,this):n-o},o.readIString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var r,i=0,o=e;i=this.view.getUint32(e,this.littleEndian),e+=4;var s,a=e+i;return c.decodeUTF8toUTF16(function(){return e<a?this.view.getUint8(e++):null}.bind(this),s=n(),this.noAssert),r=s(),t?(this.offset=e,r):{string:r,length:e-o}},r.METRICS_CHARS="c",r.METRICS_BYTES="b",o.writeUTF8String=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=n;i=c.calculateUTF16asUTF8(t(e))[1],n+=i;var s=this.buffer.byteLength;return n>s&&this.resize((s*=2)>n?s:n),n-=i,c.encodeUTF16toUTF8(t(e),function(e){this.view.setUint8(n++,e)}.bind(this)),r?(this.offset=n,this):n-o},o.writeString=o.writeUTF8String,r.calculateUTF8Chars=function(e){return c.calculateUTF16asUTF8(t(e))[0]},r.calculateUTF8Bytes=function(e){return c.calculateUTF16asUTF8(t(e))[1]},o.readUTF8String=function(e,t,i){"number"==typeof t&&(i=t,t=void 0);var o="undefined"==typeof i;if(o&&(i=this.offset),"undefined"==typeof t&&(t=r.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var s,a=0,u=i;if(t===r.METRICS_CHARS){if(s=n(),c.decodeUTF8(function(){return a<e&&i<this.limit?this.view.getUint8(i++):null}.bind(this),function(e){++a,c.UTF8toUTF16(e,s)}.bind(this)),a!==e)throw RangeError("Illegal range: Truncated data, "+a+" == "+e);return o?(this.offset=i,s()):{string:s(),length:i-u}}if(t===r.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof i||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+"+e+") <= "+this.buffer.byteLength)}var f=i+e;if(c.decodeUTF8toUTF16(function(){return i<f?this.view.getUint8(i++):null}.bind(this),s=n(),this.noAssert),i!==f)throw RangeError("Illegal range: Truncated data, "+i+" == "+f);return o?(this.offset=i,s()):{string:s(),length:i-u}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(e,n){var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var o,s,a=n;o=c.calculateUTF16asUTF8(t(e),this.noAssert)[1],s=r.calculateVarint32(o),n+=s+o;var u=this.buffer.byteLength;if(n>u&&this.resize((u*=2)>n?u:n),n-=s+o,n+=this.writeVarint32(o,n),c.encodeUTF16toUTF8(t(e),function(e){this.view.setUint8(n++,e)}.bind(this)),n!==a+o+s)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+o+s));return i?(this.offset=n,this):n-a},o.readVString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r,i=this.readVarint32(e),o=e;e+=i.length,i=i.value;var s=e+i,a=n();return c.decodeUTF8toUTF16(function(){return e<s?this.view.getUint8(e++):null}.bind(this),a,this.noAssert),r=a(),t?(this.offset=e,r):{string:r,length:e-o}},o.append=function(e,t,n){"number"!=typeof t&&"string"==typeof t||(n=t,t=void 0);var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof r||(e=r.wrap(e,t));var o=e.limit-e.offset;if(o<=0)return this;n+=o;var s=this.buffer.byteLength;return n>s&&this.resize((s*=2)>n?s:n),n-=o,new Uint8Array(this.buffer,n).set(new Uint8Array(e.buffer).subarray(e.offset,e.limit)),e.offset+=o,i&&(this.offset+=o),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.byteLength},o.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},o.clone=function(e){var t=new r(0,this.littleEndian,this.noAssert);if(e){var n=new ArrayBuffer(this.buffer.byteLength);new Uint8Array(n).set(this.buffer),t.buffer=n,t.view=new DataView(n)}else t.buffer=this.buffer,t.view=this.view;return t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},o.compact=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var n=t-e;if(0===n)return this.buffer=s,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var r=new ArrayBuffer(n);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(e,t)),this.buffer=r,this.view=new DataView(r),this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},o.copy=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new r(0,this.littleEndian,this.noAssert);var n=t-e,i=new r(n,this.littleEndian,this.noAssert);return i.offset=0,i.limit=n,i.markedOffset>=0&&(i.markedOffset-=e),this.copyTo(i,0,e,t),i},o.copyTo=function(e,t,n,i){var o,s;if(!this.noAssert&&!r.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(s="undefined"==typeof t)?e.offset:0|t,n=(o="undefined"==typeof n)?this.offset:0|n,i="undefined"==typeof i?this.limit:0|i,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||i>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var a=i-n;return 0===a?e:(e.ensureCapacity(t+a),new Uint8Array(e.buffer).set(new Uint8Array(this.buffer).subarray(n,i),t),o&&(this.offset+=a),s&&(e.offset+=a),this)},o.ensureCapacity=function(e){var t=this.buffer.byteLength;return t<e?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,n){var r="undefined"==typeof t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),"undefined"==typeof t&&(t=this.offset),"undefined"==typeof n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!==0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;t<n;)this.view.setUint8(t++,e);return r&&(this.offset=t),this},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e="undefined"==typeof e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,e<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian="undefined"==typeof e||!!e,this},o.BE=function(e){return this.littleEndian="undefined"!=typeof e&&!e,this},o.prepend=function(e,t,n){"number"!=typeof t&&"string"==typeof t||(n=t,t=void 0);var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,n<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof r||(e=r.wrap(e,t));var o=e.limit-e.offset;if(o<=0)return this;var s,a=o-n;if(a>0){var u=new ArrayBuffer(this.buffer.byteLength+a);s=new Uint8Array(u),s.set(new Uint8Array(this.buffer).subarray(n,this.buffer.byteLength),o),this.buffer=u,this.view=new DataView(u),this.offset+=a,this.markedOffset>=0&&(this.markedOffset+=a),this.limit+=a,n+=a}else s=new Uint8Array(this.buffer);return s.set(new Uint8Array(e.buffer).subarray(e.offset,e.limit),n-o),e.offset=e.limit,i&&(this.offset-=o),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if(e|=0,e<0)throw RangeError("Illegal capacity: 0 <= "+e)}if(this.buffer.byteLength<e){var t=new ArrayBuffer(e);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t,this.view=new DataView(t)}return this},o.reverse=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(e,t)),this.view=new DataView(this.buffer),this)},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},o.slice=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},o.toBuffer=function(e){var t=this.offset,n=this.limit;if(t>n){var r=t;t=n,n=r}if(!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!==0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(!e&&0===t&&n===this.buffer.byteLength)return this.buffer;if(t===n)return s;var i=new ArrayBuffer(n-t);return new Uint8Array(i).set(new Uint8Array(this.buffer).subarray(t,n),0),i},o.toArrayBuffer=o.toBuffer,o.toString=function(e,t,n){if("undefined"==typeof e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(e="utf8",t=e,n=t),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var u=function(){for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],n=[],r=0,i=t.length;r<i;++r)n[t[r]]=r;return e.encode=function(e,n){for(var r,i;null!==(r=e());)n(t[r>>2&63]),i=(3&r)<<4,null!==(r=e())?(i|=r>>4&15,n(t[63&(i|r>>4&15)]),i=(15&r)<<2,null!==(r=e())?(n(t[63&(i|r>>6&3)]),n(t[63&r])):(n(t[63&i]),n(61))):(n(t[63&i]),n(61),n(61))},e.decode=function(e,t){function r(e){throw Error("Illegal character code: "+e)}for(var i,o,s;null!==(i=e());)if(o=n[i],"undefined"==typeof o&&r(i),null!==(i=e())&&(s=n[i],"undefined"==typeof s&&r(i),t(o<<2>>>0|(48&s)>>4),null!==(i=e()))){if(o=n[i],"undefined"==typeof o){if(61===i)break;r(i)}if(t((15&s)<<4>>>0|(60&o)>>2),null!==(i=e())){if(s=n[i],"undefined"==typeof s){if(61===i)break;r(i)}t((3&o)<<6>>>0|s)}}},e.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},e}();o.toBase64=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;return u.encode(function(){return e<t?this.view.getUint8(e++):null}.bind(this),r=n()),r()},r.fromBase64=function(e,n,i){if(!i){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%4!==0)throw TypeError("Illegal str: Length not a multiple of 4")}var o=new r(e.length/4*3,n,i),s=0;return u.decode(t(e),function(e){o.view.setUint8(s++,e)}),o.limit=s,o},r.btoa=function(e){return r.fromBinary(e).toBase64()},r.atob=function(e){return r.fromBase64(e).toBinary()},o.toBinary=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return"";for(var n=[],r=[];e<t;)n.push(this.view.getUint8(e++)),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},r.fromBinary=function(e,t,n){if(!n&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");for(var i,o=0,s=e.length,a=new r(s,t,n);o<s;){if(i=e.charCodeAt(o),!n&&i>255)throw RangeError("Illegal charCode at "+o+": 0 <= "+i+" <= 255");a.view.setUint8(o++,i)}return a.limit=s,a},o.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",s="";n<r;){if(n!==-1&&(t=this.view.getUint8(n),i+=t<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16===0&&n!==r){for(;i.length<51;)i+=" ";s+=i+o+"\n",i=o=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";s+=i+o+"\n"}return e?s:i},r.fromDebug=function(e,t,n){for(var i,o,s=e.length,a=new r((s+1)/3|0,t,n),u=0,c=0,f=!1,l=!1,h=!1,p=!1,d=!1;u<s;){switch(i=e.charAt(u++)){case"!":if(!n){if(l||h||p){d=!0;break}l=h=p=!0}a.offset=a.markedOffset=a.limit=c,f=!1;break;case"|":if(!n){if(l||p){d=!0;break}l=p=!0}a.offset=a.limit=c,f=!1;break;case"[":if(!n){if(l||h){d=!0;break}l=h=!0}a.offset=a.markedOffset=c,f=!1;break;case"<":if(!n){if(l){d=!0;break}l=!0}a.offset=c,f=!1;break;case"]":if(!n){if(p||h){d=!0;break}p=h=!0}a.limit=a.markedOffset=c,f=!1;break;case">":if(!n){if(p){d=!0;break}p=!0}a.limit=c,f=!1;break;case"'":if(!n){if(h){d=!0;break}h=!0}a.markedOffset=c,f=!1;break;case" ":f=!1;break;default:if(!n&&f){d=!0;break}if(o=parseInt(i+e.charAt(u++),16),!n&&(isNaN(o)||o<0||o>255))throw TypeError("Illegal str: Not a debug encoded string");a.view.setUint8(c++,o),f=!0}if(d)throw TypeError("Illegal str: Invalid symbol at "+u)}if(!n){if(!l||!p)throw TypeError("Illegal str: Missing offset or limit");if(c<a.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+s)}return a},o.toHex=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);e<t;)n=this.view.getUint8(e++),n<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},r.fromHex=function(e,t,n){if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!==0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var i,o=e.length,s=new r(o/2|0,t),a=0,u=0;a<o;a+=2){if(i=parseInt(e.substring(a,a+2),16),!n&&(!isFinite(i)||i<0||i>255))throw TypeError("Illegal str: Contains non-hex characters");s.view.setUint8(u++,i)}return s.limit=u,s};var c=function(){var e={};return e.MAX_CODEPOINT=1114111,e.encodeUTF8=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(n>>6&31|192),t(63&n|128)):n<65536?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null},e.decodeUTF8=function(e,t){for(var n,r,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0===(128&n))t(n);else if(192===(224&n))null===(r=e())&&s([n,r]),t((31&n)<<6|63&r);else if(224===(240&n))(null===(r=e())||null===(i=e()))&&s([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!==(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&s([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},e.UTF16toUTF8=function(e,t){for(var n,r=null;;){if(null===(n=null!==r?r:e()))break;n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n)}null!==r&&t(r)},e.UTF8toUTF16=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(n-=65536,t((n>>10)+55296),t(n%1024+56320)),n=null},e.encodeUTF16toUTF8=function(t,n){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,n)})},e.decodeUTF8toUTF16=function(t,n){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,n)})},e.calculateCodePoint=function(e){return e<128?1:e<2048?2:e<65536?3:4},e.calculateUTF8=function(t){for(var n,r=0;null!==(n=t());)r+=e.calculateCodePoint(n);return r},e.calculateUTF16asUTF8=function(t){var n=0,r=0;return e.UTF16toUTF8(t,function(t){++n,r+=e.calculateCodePoint(t)}),[n,r]},e}();return o.toUTF8=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{c.decodeUTF8toUTF16(function(){return e<t?this.view.getUint8(e++):null}.bind(this),r=n())}catch(i){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},r.fromUTF8=function(e,n,i){if(!i&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var o=new r(c.calculateUTF16asUTF8(t(e),!0)[1],n,i),s=0;return c.encodeUTF16toUTF8(t(e),function(e){o.view.setUint8(s++,e)}),o.limit=s,o},r}"function"==typeof e&&"object"==typeof t&&t&&"object"==typeof n&&n?t.exports=function(){var t;try{t=e("long")}catch(n){}return o(t)}():"function"==typeof define&&define.amd?define("ByteBuffer",["Long"],function(e){return o(e)}):(r.dcodeIO=r.dcodeIO||{}).ByteBuffer=o(r.dcodeIO.Long)}(this)},{"long":133}],49:[function(e,t,n){(function(Buffer){function n(e){r.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this["final"]=this._finalOrDigest,this._decoder=null,this._encoding=null}var r=e("stream").Transform,i=e("inherits"),o=e("string_decoder").StringDecoder;t.exports=n,i(n,r),
n.prototype.update=function(e,t,n){"string"==typeof e&&(e=new Buffer(e,t));var r=this._update(e);return this.hashMode?this:(n&&(r=this._toString(r,n)),r)},n.prototype.setAutoPadding=function(){},n.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},n.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},n.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},n.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(i){r=i}finally{n(r)}},n.prototype._flush=function(e){var t;try{this.push(this._final())}catch(n){t=n}finally{e(t)}},n.prototype._finalOrDigest=function(e){var t=this._final()||new Buffer("");return e&&(t=this._toString(t,e,!0)),t},n.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new o(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r}}).call(this,e("buffer").Buffer)},{buffer:590,inherits:102,stream:669,string_decoder:685}],50:[function(e,t,n){(function(Buffer){function e(e){return Array.isArray?Array.isArray(e):"[object Array]"===g(e)}function t(e){return"boolean"==typeof e}function r(e){return null===e}function i(e){return null==e}function o(e){return"number"==typeof e}function s(e){return"string"==typeof e}function a(e){return"symbol"==typeof e}function u(e){return void 0===e}function c(e){return"[object RegExp]"===g(e)}function f(e){return"object"==typeof e&&null!==e}function l(e){return"[object Date]"===g(e)}function h(e){return"[object Error]"===g(e)||e instanceof Error}function p(e){return"function"==typeof e}function d(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function g(e){return Object.prototype.toString.call(e)}n.isArray=e,n.isBoolean=t,n.isNull=r,n.isNullOrUndefined=i,n.isNumber=o,n.isString=s,n.isSymbol=a,n.isUndefined=u,n.isRegExp=c,n.isObject=f,n.isDate=l,n.isError=h,n.isFunction=p,n.isPrimitive=d,n.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:e("../../../../node_modules/is-buffer/index.js")})},{"../../../../node_modules/is-buffer/index.js":641}],51:[function(e,t,n){(function(Buffer){"use strict";function n(e){u.call(this,"digest"),this._hash=e,this.buffers=[]}function r(e){u.call(this,"digest"),this._hash=e}var i=e("inherits"),o=e("./md5"),s=e("ripemd160"),a=e("sha.js"),u=e("cipher-base");i(n,u),n.prototype._update=function(e){this.buffers.push(e)},n.prototype._final=function(){var e=Buffer.concat(this.buffers),t=this._hash(e);return this.buffers=null,t},i(r,u),r.prototype._update=function(e){this._hash.update(e)},r.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return e=e.toLowerCase(),"md5"===e?new n(o):"rmd160"===e||"ripemd160"===e?new n(s):new r(a(e))}}).call(this,e("buffer").Buffer)},{"./md5":53,buffer:590,"cipher-base":49,inherits:102,ripemd160:330,"sha.js":340}],52:[function(e,t,n){(function(Buffer){"use strict";function e(e,t){if(e.length%i!==0){var n=e.length+(i-e.length%i);e=Buffer.concat([e,o],n)}for(var r=[],s=t?e.readInt32BE:e.readInt32LE,a=0;a<e.length;a+=i)r.push(s.call(e,a));return r}function t(e,t,n){for(var r=new Buffer(t),i=n?r.writeInt32BE:r.writeInt32LE,o=0;o<e.length;o++)i.call(r,e[o],4*o,!0);return r}function r(n,r,i,o){Buffer.isBuffer(n)||(n=new Buffer(n));var a=r(e(n,o),n.length*s);return t(a,i,o)}var i=4,o=new Buffer(i);o.fill(0);var s=8;n.hash=r}).call(this,e("buffer").Buffer)},{buffer:590}],53:[function(e,t,n){"use strict";function r(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,r=-271733879,i=-1732584194,f=271733878,l=0;l<e.length;l+=16){var h=n,p=r,d=i,g=f;n=o(n,r,i,f,e[l+0],7,-680876936),f=o(f,n,r,i,e[l+1],12,-389564586),i=o(i,f,n,r,e[l+2],17,606105819),r=o(r,i,f,n,e[l+3],22,-1044525330),n=o(n,r,i,f,e[l+4],7,-176418897),f=o(f,n,r,i,e[l+5],12,1200080426),i=o(i,f,n,r,e[l+6],17,-1473231341),r=o(r,i,f,n,e[l+7],22,-45705983),n=o(n,r,i,f,e[l+8],7,1770035416),f=o(f,n,r,i,e[l+9],12,-1958414417),i=o(i,f,n,r,e[l+10],17,-42063),r=o(r,i,f,n,e[l+11],22,-1990404162),n=o(n,r,i,f,e[l+12],7,1804603682),f=o(f,n,r,i,e[l+13],12,-40341101),i=o(i,f,n,r,e[l+14],17,-1502002290),r=o(r,i,f,n,e[l+15],22,1236535329),n=s(n,r,i,f,e[l+1],5,-165796510),f=s(f,n,r,i,e[l+6],9,-1069501632),i=s(i,f,n,r,e[l+11],14,643717713),r=s(r,i,f,n,e[l+0],20,-373897302),n=s(n,r,i,f,e[l+5],5,-701558691),f=s(f,n,r,i,e[l+10],9,38016083),i=s(i,f,n,r,e[l+15],14,-660478335),r=s(r,i,f,n,e[l+4],20,-405537848),n=s(n,r,i,f,e[l+9],5,568446438),f=s(f,n,r,i,e[l+14],9,-1019803690),i=s(i,f,n,r,e[l+3],14,-187363961),r=s(r,i,f,n,e[l+8],20,1163531501),n=s(n,r,i,f,e[l+13],5,-1444681467),f=s(f,n,r,i,e[l+2],9,-51403784),i=s(i,f,n,r,e[l+7],14,1735328473),r=s(r,i,f,n,e[l+12],20,-1926607734),n=a(n,r,i,f,e[l+5],4,-378558),f=a(f,n,r,i,e[l+8],11,-2022574463),i=a(i,f,n,r,e[l+11],16,1839030562),r=a(r,i,f,n,e[l+14],23,-35309556),n=a(n,r,i,f,e[l+1],4,-1530992060),f=a(f,n,r,i,e[l+4],11,1272893353),i=a(i,f,n,r,e[l+7],16,-155497632),r=a(r,i,f,n,e[l+10],23,-1094730640),n=a(n,r,i,f,e[l+13],4,681279174),f=a(f,n,r,i,e[l+0],11,-358537222),i=a(i,f,n,r,e[l+3],16,-722521979),r=a(r,i,f,n,e[l+6],23,76029189),n=a(n,r,i,f,e[l+9],4,-640364487),f=a(f,n,r,i,e[l+12],11,-421815835),i=a(i,f,n,r,e[l+15],16,530742520),r=a(r,i,f,n,e[l+2],23,-995338651),n=u(n,r,i,f,e[l+0],6,-198630844),f=u(f,n,r,i,e[l+7],10,1126891415),i=u(i,f,n,r,e[l+14],15,-1416354905),r=u(r,i,f,n,e[l+5],21,-57434055),n=u(n,r,i,f,e[l+12],6,1700485571),f=u(f,n,r,i,e[l+3],10,-1894986606),i=u(i,f,n,r,e[l+10],15,-1051523),r=u(r,i,f,n,e[l+1],21,-2054922799),n=u(n,r,i,f,e[l+8],6,1873313359),f=u(f,n,r,i,e[l+15],10,-30611744),i=u(i,f,n,r,e[l+6],15,-1560198380),r=u(r,i,f,n,e[l+13],21,1309151649),n=u(n,r,i,f,e[l+4],6,-145523070),f=u(f,n,r,i,e[l+11],10,-1120210379),i=u(i,f,n,r,e[l+2],15,718787259),r=u(r,i,f,n,e[l+9],21,-343485551),n=c(n,h),r=c(r,p),i=c(i,d),f=c(f,g)}return Array(n,r,i,f)}function i(e,t,n,r,i,o){return c(f(c(c(t,e),c(r,o)),i),n)}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function u(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}function c(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function f(e,t){return e<<t|e>>>32-t}var l=e("./helpers");t.exports=function(e){return l.hash(e,r,16)}},{"./helpers":52}],54:[function(e,t,n){(function(Buffer){"use strict";function n(e,t){o.call(this),"string"==typeof t&&(t=new Buffer(t));var n="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=t,t.length>n?t=r(e).update(t).digest():t.length<n&&(t=Buffer.concat([t,s],n));for(var i=this._ipad=new Buffer(n),a=this._opad=new Buffer(n),u=0;u<n;u++)i[u]=54^t[u],a[u]=92^t[u];this._hash=r(e).update(i)}var r=e("create-hash/browser"),i=e("inherits"),o=e("stream").Transform,s=new Buffer(128);s.fill(0),i(n,o),n.prototype.update=function(e,t){return this._hash.update(e,t),this},n.prototype._transform=function(e,t,n){this._hash.update(e),n()},n.prototype._flush=function(e){this.push(this.digest()),e()},n.prototype.digest=function(e){var t=this._hash.digest();return r(this._alg).update(this._opad).update(t).digest(e)},t.exports=function(e,t){return new n(e,t)}}).call(this,e("buffer").Buffer)},{buffer:590,"create-hash/browser":51,inherits:102,stream:669}],55:[function(e,t,n){var r=r||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in r,o=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},s=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),a=e.webkitRequestFileSystem,u=e.requestFileSystem||a||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f="application/octet-stream",l=0,h=500,p=function(t){var r=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?r():setTimeout(r,h)},d=function(e,t,n){t=[].concat(t);for(var r=t.length;r--;){var i=e["on"+t[r]];if("function"==typeof i)try{i.call(e,n||e)}catch(o){c(o)}}},g=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},y=function(t,c,h){h||(t=g(t));var y,m,v,b=this,w=t.type,E=!1,_=function(){d(b,"writestart progress write writeend".split(" "))},S=function(){if(m&&s&&"undefined"!=typeof FileReader){var r=new FileReader;return r.onloadend=function(){var e=r.result;m.location.href="data:attachment/file"+e.slice(e.search(/[,;]/)),b.readyState=b.DONE,_()},r.readAsDataURL(t),void(b.readyState=b.INIT)}if(!E&&y||(y=n().createObjectURL(t)),m)m.location.href=y;else{var i=e.open(y,"_blank");void 0==i&&s&&(e.location.href=y)}b.readyState=b.DONE,_(),p(y)},k=function(e){return function(){if(b.readyState!==b.DONE)return e.apply(this,arguments)}},C={create:!0,exclusive:!1};return b.readyState=b.INIT,c||(c="download"),i?(y=n().createObjectURL(t),void setTimeout(function(){r.href=y,r.download=c,o(r),_(),p(y),b.readyState=b.DONE})):(e.chrome&&w&&w!==f&&(v=t.slice||t.webkitSlice,t=v.call(t,0,t.size,f),E=!0),a&&"download"!==c&&(c+=".download"),(w===f||a)&&(m=e),u?(l+=t.size,void u(e.TEMPORARY,l,k(function(e){e.root.getDirectory("saved",C,k(function(e){var n=function(){e.getFile(c,C,k(function(e){e.createWriter(k(function(n){n.onwriteend=function(t){m.location.href=e.toURL(),b.readyState=b.DONE,d(b,"writeend",t),p(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&S()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=b["on"+e]}),n.write(t),b.abort=function(){n.abort(),b.readyState=b.DONE},b.readyState=b.WRITING}),S)}),S)};e.getFile(c,{create:!1},k(function(e){e.remove(),n()}),k(function(e){e.code===e.NOT_FOUND_ERR?n():S()}))}),S)}),S)):void S())},m=y.prototype,v=function(e,t,n){return new y(e,t,n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=g(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(m.abort=function(){var e=this;e.readyState=e.DONE,d(e,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,v)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof t&&t.exports?t.exports.saveAs=r:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return r})},{}],56:[function(e,t,n){"use strict";var r=n;r.version=e("../package.json").version,r.utils=e("./elliptic/utils"),r.rand=e("brorand"),r.hmacDRBG=e("./elliptic/hmac-drbg"),r.curve=e("./elliptic/curve"),r.curves=e("./elliptic/curves"),r.ec=e("./elliptic/ec"),r.eddsa=e("./elliptic/eddsa")},{"../package.json":72,"./elliptic/curve":59,"./elliptic/curves":62,"./elliptic/ec":63,"./elliptic/eddsa":66,"./elliptic/hmac-drbg":69,"./elliptic/utils":71,brorand:27}],57:[function(e,t,n){"use strict";function r(e,t){this.type=e,this.p=new BN(t.p,16),this.red=t.prime?BN.red(t.prime):BN.mont(this.p),this.zero=new BN(0).toRed(this.red),this.one=new BN(1).toRed(this.red),this.two=new BN(2).toRed(this.red),this.n=t.n&&new BN(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4)}function i(e,t){this.curve=e,this.type=t,this.precomputed=null}var BN=e("bn.js"),o=e("../../elliptic"),s=o.utils,a=s.getNAF,u=s.getJSF,c=s.assert;t.exports=r,r.prototype.point=function(){throw new Error("Not implemented")},r.prototype.validate=function(){throw new Error("Not implemented")},r.prototype._fixedNafMul=function(e,t){c(e.precomputed);var n=e._getDoubles(),r=a(t,1),i=(1<<n.step+1)-(n.step%2===0?2:1);i/=3;for(var o=[],s=0;s<r.length;s+=n.step){for(var u=0,t=s+n.step-1;t>=s;t--)u=(u<<1)+r[t];o.push(u)}for(var f=this.jpoint(null,null,null),l=this.jpoint(null,null,null),h=i;h>0;h--){for(var s=0;s<o.length;s++){var u=o[s];u===h?l=l.mixedAdd(n.points[s]):u===-h&&(l=l.mixedAdd(n.points[s].neg()))}f=f.add(l)}return f.toP()},r.prototype._wnafMul=function(e,t){var n=4,r=e._getNAFPoints(n);n=r.wnd;for(var i=r.points,o=a(t,n),s=this.jpoint(null,null,null),u=o.length-1;u>=0;u--){for(var t=0;u>=0&&0===o[u];u--)t++;if(u>=0&&t++,s=s.dblp(t),u<0)break;var f=o[u];c(0!==f),s="affine"===e.type?f>0?s.mixedAdd(i[f-1>>1]):s.mixedAdd(i[-f-1>>1].neg()):f>0?s.add(i[f-1>>1]):s.add(i[-f-1>>1].neg())}return"affine"===e.type?s.toP():s},r.prototype._wnafMulAdd=function(e,t,n,r){for(var i=this._wnafT1,o=this._wnafT2,s=this._wnafT3,c=0,f=0;f<r;f++){var l=t[f],h=l._getNAFPoints(e);i[f]=h.wnd,o[f]=h.points}for(var f=r-1;f>=1;f-=2){var p=f-1,d=f;if(1===i[p]&&1===i[d]){var g=[t[p],null,null,t[d]];0===t[p].y.cmp(t[d].y)?(g[1]=t[p].add(t[d]),g[2]=t[p].toJ().mixedAdd(t[d].neg())):0===t[p].y.cmp(t[d].y.redNeg())?(g[1]=t[p].toJ().mixedAdd(t[d]),g[2]=t[p].add(t[d].neg())):(g[1]=t[p].toJ().mixedAdd(t[d]),g[2]=t[p].toJ().mixedAdd(t[d].neg()));var y=[-3,-1,-5,-7,0,7,5,1,3],m=u(n[p],n[d]);c=Math.max(m[0].length,c),s[p]=new Array(c),s[d]=new Array(c);for(var v=0;v<c;v++){var b=0|m[0][v],w=0|m[1][v];s[p][v]=y[3*(b+1)+(w+1)],s[d][v]=0,o[p]=g}}else s[p]=a(n[p],i[p]),s[d]=a(n[d],i[d]),c=Math.max(s[p].length,c),c=Math.max(s[d].length,c)}for(var E=this.jpoint(null,null,null),_=this._wnafT4,f=c;f>=0;f--){for(var S=0;f>=0;){for(var k=!0,v=0;v<r;v++)_[v]=0|s[v][f],0!==_[v]&&(k=!1);if(!k)break;S++,f--}if(f>=0&&S++,E=E.dblp(S),f<0)break;for(var v=0;v<r;v++){var l,C=_[v];0!==C&&(C>0?l=o[v][C-1>>1]:C<0&&(l=o[v][-C-1>>1].neg()),E="affine"===l.type?E.mixedAdd(l):E.add(l))}}for(var f=0;f<r;f++)o[f]=null;return E.toP()},r.BasePoint=i,i.prototype.eq=function(){throw new Error("Not implemented")},i.prototype.validate=function(){return this.curve.validate(this)},r.prototype.decodePoint=function(e,t){e=s.toArray(e,t);var n=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1===2*n){6===e[0]?c(e[e.length-1]%2===0):7===e[0]&&c(e[e.length-1]%2===1);var r=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return r}if((2===e[0]||3===e[0])&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),3===e[0]);throw new Error("Unknown point format")},i.prototype.encodeCompressed=function(e){return this.encode(e,!0)},i.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))},i.prototype.encode=function(e,t){return s.encode(this._encode(t),e)},i.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},i.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},i.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<t;i+=e){for(var o=0;o<e;o++)r=r.dbl();n.push(r)}return{step:e,points:n}},i.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)t[i]=t[i-1].add(r);return{wnd:e,points:t}},i.prototype._getBeta=function(){return null},i.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}},{"../../elliptic":56,"bn.js":26}],58:[function(e,t,n){"use strict";function r(e){this.twisted=1!==(0|e.a),this.mOneA=this.twisted&&(0|e.a)===-1,this.extended=this.mOneA,a.call(this,"edwards",e),this.a=new BN(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),u(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|e.c)}function Point(e,t,n,r,i){a.BasePoint.call(this,e,"projective"),null===t&&null===n&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN(t,16),this.y=new BN(n,16),this.z=r?new BN(r,16):this.curve.one,this.t=i&&new BN(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var i=e("../curve"),o=e("../../elliptic"),BN=e("bn.js"),s=e("inherits"),a=i.base,u=o.utils.assert;s(r,a),t.exports=r,r.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},r.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},r.prototype.jpoint=function(e,t,n,r){return this.point(e,t,n,r)},r.prototype.pointFromX=function(e,t){e=new BN(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),r=this.c2.redSub(this.a.redMul(n)),i=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=r.redMul(i.redInvm()),s=o.redSqrt();if(0!==s.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var a=s.fromRed().isOdd();return(t&&!a||!t&&a)&&(s=s.redNeg()),this.point(e,s)},r.prototype.pointFromY=function(e,t){e=new BN(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),r=n.redSub(this.one),i=n.redMul(this.d).redAdd(this.one),o=r.redMul(i.redInvm());if(0===o.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var s=o.redSqrt();if(0!==s.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return s.isOdd()!==t&&(s=s.redNeg()),this.point(s,e)},r.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),r=t.redMul(this.a).redAdd(n),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return 0===r.cmp(i)},s(Point,a.BasePoint),r.prototype.pointFromJSON=function(e){return Point.fromJSON(this,e)},r.prototype.point=function(e,t,n,r){return new Point(this,e,t,n,r)},Point.fromJSON=function(e,t){return new Point(e,t[0],t[1],t[2])},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},Point.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=r.redAdd(t),s=o.redSub(n),a=r.redSub(t),u=i.redMul(s),c=o.redMul(a),f=i.redMul(a),l=s.redMul(o);return this.curve.point(u,c,l,f)},Point.prototype._projDbl=function(){var e,t,n,r=this.x.redAdd(this.y).redSqr(),i=this.x.redSqr(),o=this.y.redSqr();if(this.curve.twisted){var s=this.curve._mulA(i),a=s.redAdd(o);if(this.zOne)e=r.redSub(i).redSub(o).redMul(a.redSub(this.curve.two)),t=a.redMul(s.redSub(o)),n=a.redSqr().redSub(a).redSub(a);else{var u=this.z.redSqr(),c=a.redSub(u).redISub(u);e=r.redSub(i).redISub(o).redMul(c),t=a.redMul(s.redSub(o)),n=a.redMul(c)}}else{var s=i.redAdd(o),u=this.curve._mulC(this.c.redMul(this.z)).redSqr(),c=s.redSub(u).redSub(u);e=this.curve._mulC(r.redISub(s)).redMul(c),t=this.curve._mulC(s).redMul(i.redISub(o)),n=s.redMul(c)}return this.curve.point(e,t,n)},Point.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Point.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(t),s=i.redSub(r),a=i.redAdd(r),u=n.redAdd(t),c=o.redMul(s),f=a.redMul(u),l=o.redMul(u),h=s.redMul(a);return this.curve.point(c,f,h,l)},Point.prototype._projAdd=function(e){var t,n,r=this.z.redMul(e.z),i=r.redSqr(),o=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(o).redMul(s),u=i.redSub(a),c=i.redAdd(a),f=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(s),l=r.redMul(u).redMul(f);return this.curve.twisted?(t=r.redMul(c).redMul(s.redSub(this.curve._mulA(o))),n=u.redMul(c)):(t=r.redMul(c).redMul(s.redSub(o)),n=this.curve._mulC(u).redMul(c)),this.curve.point(l,t,n)},Point.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},Point.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},Point.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2)},Point.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},Point.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Point.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Point.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},Point.prototype.toP=Point.prototype.normalize,Point.prototype.mixedAdd=Point.prototype.add},{"../../elliptic":56,"../curve":59,"bn.js":26,inherits:102}],59:[function(e,t,n){"use strict";var r=n;r.base=e("./base"),r["short"]=e("./short"),r.mont=e("./mont"),r.edwards=e("./edwards")},{"./base":57,"./edwards":58,"./mont":60,"./short":61}],60:[function(e,t,n){"use strict";function r(e){s.call(this,"mont",e),this.a=new BN(e.a,16).toRed(this.red),this.b=new BN(e.b,16).toRed(this.red),this.i4=new BN(4).toRed(this.red).redInvm(),this.two=new BN(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function Point(e,t,n){s.BasePoint.call(this,e,"projective"),null===t&&null===n?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN(t,16),this.z=new BN(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var i=e("../curve"),BN=e("bn.js"),o=e("inherits"),s=i.base,a=e("../../elliptic"),u=a.utils;o(r,s),t.exports=r,r.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),r=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t),i=r.redSqrt();return 0===i.redSqr().cmp(r)},o(Point,s.BasePoint),r.prototype.decodePoint=function(e,t){return this.point(u.toArray(e,t),1)},r.prototype.point=function(e,t){return new Point(this,e,t)},r.prototype.pointFromJSON=function(e){return Point.fromJSON(this,e)},Point.prototype.precompute=function(){},Point.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Point.fromJSON=function(e,t){return new Point(e,t[0],t[1]||e.one)},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},Point.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),n=this.x.redSub(this.z),r=n.redSqr(),i=t.redSub(r),o=t.redMul(r),s=i.redMul(r.redAdd(this.curve.a24.redMul(i)));return this.curve.point(o,s)},Point.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),r=this.x.redSub(this.z),i=e.x.redAdd(e.z),o=e.x.redSub(e.z),s=o.redMul(n),a=i.redMul(r),u=t.z.redMul(s.redAdd(a).redSqr()),c=t.x.redMul(s.redISub(a).redSqr());return this.curve.point(u,c)},Point.prototype.mul=function(e){for(var t=e.clone(),n=this,r=this.curve.point(null,null),i=this,o=[];0!==t.cmpn(0);t.iushrn(1))o.push(t.andln(1));for(var s=o.length-1;s>=0;s--)0===o[s]?(n=n.diffAdd(r,i),r=r.dbl()):(r=n.diffAdd(r,i),n=n.dbl());return r},Point.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},Point.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../../elliptic":56,"../curve":59,"bn.js":26,inherits:102}],61:[function(e,t,n){"use strict";function r(e){u.call(this,"short",e),this.a=new BN(e.a,16).toRed(this.red),this.b=new BN(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function Point(e,t,n,r){u.BasePoint.call(this,e,"affine"),null===t&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN(t,16),this.y=new BN(n,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function i(e,t,n,r){u.BasePoint.call(this,e,"jacobian"),null===t&&null===n&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN(0)):(this.x=new BN(t,16),this.y=new BN(n,16),this.z=new BN(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var o=e("../curve"),s=e("../../elliptic"),BN=e("bn.js"),a=e("inherits"),u=o.base,c=s.utils.assert;a(r,u),t.exports=r,r.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,n;if(e.beta)t=new BN(e.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);t=r[0].cmp(r[1])<0?r[0]:r[1],t=t.toRed(this.red)}if(e.lambda)n=new BN(e.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(t))?n=i[0]:(n=i[1],c(0===this.g.mul(n).x.cmp(this.g.x.redMul(t))))}var o;return o=e.basis?e.basis.map(function(e){return{a:new BN(e.a,16),b:new BN(e.b,16)}}):this._getEndoBasis(n),{beta:t,lambda:n,basis:o}}},r.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:BN.mont(e),n=new BN(2).toRed(t).redInvm(),r=n.redNeg(),i=new BN(3).toRed(t).redNeg().redSqrt().redMul(n),o=r.redAdd(i).fromRed(),s=r.redSub(i).fromRed();return[o,s]},r.prototype._getEndoBasis=function(e){for(var t,n,r,i,o,s,a,u,c,f=this.n.ushrn(Math.floor(this.n.bitLength()/2)),l=e,h=this.n.clone(),p=new BN(1),d=new BN(0),g=new BN(0),y=new BN(1),m=0;0!==l.cmpn(0);){var v=h.div(l);u=h.sub(v.mul(l)),c=g.sub(v.mul(p));var b=y.sub(v.mul(d));if(!r&&u.cmp(f)<0)t=a.neg(),n=p,r=u.neg(),i=c;else if(r&&2===++m)break;a=u,h=l,l=u,g=p,p=c,y=d,d=b}o=u.neg(),s=c;var w=r.sqr().add(i.sqr()),E=o.sqr().add(s.sqr());return E.cmp(w)>=0&&(o=t,s=n),r.negative&&(r=r.neg(),i=i.neg()),o.negative&&(o=o.neg(),s=s.neg()),[{a:r,b:i},{a:o,b:s}]},r.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],r=t[1],i=r.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),s=i.mul(n.a),a=o.mul(r.a),u=i.mul(n.b),c=o.mul(r.b),f=e.sub(s).sub(a),l=u.add(c).neg();return{k1:f,k2:l}},r.prototype.pointFromX=function(e,t){e=new BN(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),r=n.redSqrt();if(0!==r.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var i=r.fromRed().isOdd();return(t&&!i||!t&&i)&&(r=r.redNeg()),this.point(e,r)},r.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,r=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},r.prototype._endoWnafMulAdd=function(e,t){for(var n=this._endoWnafT1,r=this._endoWnafT2,i=0;i<e.length;i++){var o=this._endoSplit(t[i]),s=e[i],a=s._getBeta();o.k1.negative&&(o.k1.ineg(),s=s.neg(!0)),o.k2.negative&&(o.k2.ineg(),a=a.neg(!0)),n[2*i]=s,n[2*i+1]=a,r[2*i]=o.k1,r[2*i+1]=o.k2}for(var u=this._wnafMulAdd(1,n,r,2*i),c=0;c<2*i;c++)n[c]=null,r[c]=null;return u},a(Point,u.BasePoint),r.prototype.point=function(e,t,n){return new Point(this,e,t,n)},r.prototype.pointFromJSON=function(e,t){return Point.fromJSON(this,e,t)},Point.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,r=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},Point.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Point.fromJSON=function(e,t,n){function r(t){return e.point(t[0],t[1],n)}"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],n);if(!t[2])return i;var o=t[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(r))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(r))}},i},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return this.inf},Point.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},Point.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),r=e.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(r),o=i.redSqr().redISub(this.x.redAdd(this.x)),s=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,s)},Point.prototype.getX=function(){return this.x.fromRed()},Point.prototype.getY=function(){return this.y.fromRed()},Point.prototype.mul=function(e){return e=new BN(e,16),this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Point.prototype.mulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},Point.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},Point.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return t},Point.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e},a(i,u.BasePoint),r.prototype.jpoint=function(e,t,n){return new i(this,e,t,n)},i.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(n,r)},i.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},i.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(t),i=e.x.redMul(n),o=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(n.redMul(this.z)),a=r.redSub(i),u=o.redSub(s);
if(0===a.cmpn(0))return 0!==u.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),f=c.redMul(a),l=r.redMul(c),h=u.redSqr().redIAdd(f).redISub(l).redISub(l),p=u.redMul(l.redISub(h)).redISub(o.redMul(f)),d=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(h,p,d)},i.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,r=e.x.redMul(t),i=this.y,o=e.y.redMul(t).redMul(this.z),s=n.redSub(r),a=i.redSub(o);if(0===s.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=s.redSqr(),c=u.redMul(s),f=n.redMul(u),l=a.redSqr().redIAdd(c).redISub(f).redISub(f),h=a.redMul(f.redISub(l)).redISub(i.redMul(c)),p=this.z.redMul(s);return this.curve.jpoint(l,h,p)},i.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}for(var r=this.curve.a,i=this.curve.tinv,o=this.x,s=this.y,a=this.z,u=a.redSqr().redSqr(),c=s.redAdd(s),n=0;n<e;n++){var f=o.redSqr(),l=c.redSqr(),h=l.redSqr(),p=f.redAdd(f).redIAdd(f).redIAdd(r.redMul(u)),d=o.redMul(l),g=p.redSqr().redISub(d.redAdd(d)),y=d.redISub(g),m=p.redMul(y);m=m.redIAdd(m).redISub(h);var v=c.redMul(a);n+1<e&&(u=u.redMul(h)),o=g,a=v,c=m}return this.curve.jpoint(o,c.redMul(i),a)},i.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},i.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(r).redISub(o);s=s.redIAdd(s);var a=r.redAdd(r).redIAdd(r),u=a.redSqr().redISub(s).redISub(s),c=o.redIAdd(o);c=c.redIAdd(c),c=c.redIAdd(c),e=u,t=a.redMul(s.redISub(u)).redISub(c),n=this.y.redAdd(this.y)}else{var f=this.x.redSqr(),l=this.y.redSqr(),h=l.redSqr(),p=this.x.redAdd(l).redSqr().redISub(f).redISub(h);p=p.redIAdd(p);var d=f.redAdd(f).redIAdd(f),g=d.redSqr(),y=h.redIAdd(h);y=y.redIAdd(y),y=y.redIAdd(y),e=g.redISub(p).redISub(p),t=d.redMul(p.redISub(e)).redISub(y),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)},i.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(r).redISub(o);s=s.redIAdd(s);var a=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),u=a.redSqr().redISub(s).redISub(s);e=u;var c=o.redIAdd(o);c=c.redIAdd(c),c=c.redIAdd(c),t=a.redMul(s.redISub(u)).redISub(c),n=this.y.redAdd(this.y)}else{var f=this.z.redSqr(),l=this.y.redSqr(),h=this.x.redMul(l),p=this.x.redSub(f).redMul(this.x.redAdd(f));p=p.redAdd(p).redIAdd(p);var d=h.redIAdd(h);d=d.redIAdd(d);var g=d.redAdd(d);e=p.redSqr().redISub(g),n=this.y.redAdd(this.z).redSqr().redISub(l).redISub(f);var y=l.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y),t=p.redMul(d.redISub(e)).redISub(y)}return this.curve.jpoint(e,t,n)},i.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),o=t.redSqr(),s=n.redSqr(),a=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i)),u=t.redAdd(t);u=u.redIAdd(u);var c=u.redMul(s),f=a.redSqr().redISub(c.redAdd(c)),l=c.redISub(f),h=s.redSqr();h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var p=a.redMul(l).redISub(h),d=n.redAdd(n).redMul(r);return this.curve.jpoint(f,p,d)},i.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),r=t.redSqr(),i=e.redAdd(e).redIAdd(e),o=i.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(r);s=s.redIAdd(s),s=s.redAdd(s).redIAdd(s),s=s.redISub(o);var a=s.redSqr(),u=r.redIAdd(r);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var c=i.redIAdd(s).redSqr().redISub(o).redISub(a).redISub(u),f=t.redMul(c);f=f.redIAdd(f),f=f.redIAdd(f);var l=this.x.redMul(a).redISub(f);l=l.redIAdd(l),l=l.redIAdd(l);var h=this.y.redMul(c.redMul(u.redISub(c)).redISub(s.redMul(a)));h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var p=this.z.redAdd(s).redSqr().redISub(n).redISub(a);return this.curve.jpoint(l,h,p)},i.prototype.mul=function(e,t){return e=new BN(e,t),this.curve._wnafMul(this,e)},i.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(0!==this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),i=n.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(r)).cmpn(0)},i.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},i.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../../elliptic":56,"../curve":59,"bn.js":26,inherits:102}],62:[function(e,t,n){"use strict";function r(e){"short"===e.type?this.curve=new a.curve["short"](e):"edwards"===e.type?this.curve=new a.curve.edwards(e):this.curve=new a.curve.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,u(this.g.validate(),"Invalid curve"),u(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function i(e,t){Object.defineProperty(o,e,{configurable:!0,enumerable:!0,get:function(){var n=new r(t);return Object.defineProperty(o,e,{configurable:!0,enumerable:!0,value:n}),n}})}var o=n,s=e("hash.js"),a=e("../elliptic"),u=a.utils.assert;o.PresetCurve=r,i("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),i("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),i("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),i("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),i("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),i("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"0",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),i("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var c;try{c=e("./precomputed/secp256k1")}catch(f){c=void 0}i("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})},{"../elliptic":56,"./precomputed/secp256k1":70,"hash.js":77}],63:[function(e,t,n){"use strict";function r(e){return this instanceof r?("string"==typeof e&&(s(i.curves.hasOwnProperty(e),"Unknown curve "+e),e=i.curves[e]),e instanceof i.curves.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),void(this.hash=e.hash||e.curve.hash)):new r(e)}var BN=e("bn.js"),i=e("../../elliptic"),o=i.utils,s=o.assert,a=e("./key"),u=e("./signature");t.exports=r,r.prototype.keyPair=function(e){return new a(this,e)},r.prototype.keyFromPrivate=function(e,t){return a.fromPrivate(this,e,t)},r.prototype.keyFromPublic=function(e,t){return a.fromPublic(this,e,t)},r.prototype.genKeyPair=function(e){e||(e={});for(var t=new i.hmacDRBG({hash:this.hash,pers:e.pers,entropy:e.entropy||i.rand(this.hash.hmacStrength),nonce:this.n.toArray()}),n=this.n.byteLength(),r=this.n.sub(new BN(2));;){var o=new BN(t.generate(n));if(!(o.cmp(r)>0))return o.iaddn(1),this.keyFromPrivate(o)}},r.prototype._truncateToN=function(e,t){var n=8*e.byteLength()-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},r.prototype.sign=function(e,t,n,r){"object"==typeof n&&(r=n,n=null),r||(r={}),t=this.keyFromPrivate(t,n),e=this._truncateToN(new BN(e,16));for(var o=this.n.byteLength(),s=t.getPrivate().toArray("be",o),a=e.toArray("be",o),c=new i.hmacDRBG({hash:this.hash,entropy:s,nonce:a,pers:r.pers,persEnc:r.persEnc}),f=this.n.sub(new BN(1)),l=0;!0;l++){var h=r.k?r.k(l):new BN(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(f)>=0)){var p=this.g.mul(h);if(!p.isInfinity()){var d=p.getX(),g=d.umod(this.n);if(0!==g.cmpn(0)){var y=h.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(y=y.umod(this.n),0!==y.cmpn(0)){var m=(p.getY().isOdd()?1:0)|(0!==d.cmp(g)?2:0);return r.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),m^=1),new u({r:g,s:y,recoveryParam:m})}}}}}},r.prototype.verify=function(e,t,n,r){e=this._truncateToN(new BN(e,16)),n=this.keyFromPublic(n,r),t=new u(t,"hex");var i=t.r,o=t.s;if(i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var s=o.invm(this.n),a=s.mul(e).umod(this.n),c=s.mul(i).umod(this.n),f=this.g.mulAdd(a,n.getPublic(),c);return!f.isInfinity()&&0===f.getX().umod(this.n).cmp(i)},r.prototype.recoverPubKey=function(e,t,n,r){s((3&n)===n,"The recovery param is more than two bits"),t=new u(t,r);var i=this.n,o=new BN(e),a=t.r,c=t.s,f=1&n,l=n>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");a=l?this.curve.pointFromX(a.add(this.curve.n),f):this.curve.pointFromX(a,f);var h=i.sub(o),p=t.r.invm(i);return this.g.mulAdd(h,a,c).mul(p)},r.prototype.getKeyRecoveryParam=function(e,t,n,r){if(t=new u(t,r),null!==t.recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(n))return i}throw new Error("Unable to find valid recovery factor")}},{"../../elliptic":56,"./key":64,"./signature":65,"bn.js":26}],64:[function(e,t,n){"use strict";function r(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var BN=e("bn.js");t.exports=r,r.fromPublic=function(e,t,n){return t instanceof r?t:new r(e,{pub:t,pubEnc:n})},r.fromPrivate=function(e,t,n){return t instanceof r?t:new r(e,{priv:t,privEnc:n})},r.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},r.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},r.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},r.prototype._importPrivate=function(e,t){this.priv=new BN(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},r.prototype._importPublic=function(e,t){return e.x||e.y?void(this.pub=this.ec.curve.point(e.x,e.y)):void(this.pub=this.ec.curve.decodePoint(e,t))},r.prototype.derive=function(e){return e.mul(this.priv).getX()},r.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)},r.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},r.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"bn.js":26}],65:[function(e,t,n){"use strict";function r(e,t){return e instanceof r?e:void(this._importDER(e,t)||(f(e.r&&e.s,"Signature without r or s"),this.r=new BN(e.r,16),this.s=new BN(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam))}function i(){this.place=0}function o(e,t){var n=e[t.place++];if(!(128&n))return n;for(var r=15&n,i=0,o=0,s=t.place;o<r;o++,s++)i<<=8,i|=e[s];return t.place=s,i}function s(e){for(var t=0,n=e.length-1;!e[t]&&!(128&e[t+1])&&t<n;)t++;return 0===t?e:e.slice(t)}function a(e,t){if(t<128)return void e.push(t);var n=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|n);--n;)e.push(t>>>(n<<3)&255);e.push(t)}var BN=e("bn.js"),u=e("../../elliptic"),c=u.utils,f=c.assert;t.exports=r,r.prototype._importDER=function(e,t){e=c.toArray(e,t);var n=new i;if(48!==e[n.place++])return!1;var r=o(e,n);if(r+n.place!==e.length)return!1;if(2!==e[n.place++])return!1;var s=o(e,n),a=e.slice(n.place,s+n.place);if(n.place+=s,2!==e[n.place++])return!1;var u=o(e,n);if(e.length!==u+n.place)return!1;var f=e.slice(n.place,u+n.place);return 0===a[0]&&128&a[1]&&(a=a.slice(1)),0===f[0]&&128&f[1]&&(f=f.slice(1)),this.r=new BN(a),this.s=new BN(f),this.recoveryParam=null,!0},r.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&n[0]&&(n=[0].concat(n)),t=s(t),n=s(n);!(n[0]||128&n[1]);)n=n.slice(1);var r=[2];a(r,t.length),r=r.concat(t),r.push(2),a(r,n.length);var i=r.concat(n),o=[48];return a(o,i.length),o=o.concat(i),c.encode(o,e)}},{"../../elliptic":56,"bn.js":26}],66:[function(e,t,n){"use strict";function r(e){if(a("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof r))return new r(e);var e=o.curves[e].curve;this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=i.sha512}var i=e("hash.js"),o=e("../../elliptic"),s=o.utils,a=s.assert,u=s.parseBytes,c=e("./key"),f=e("./signature");t.exports=r,r.prototype.sign=function(e,t){e=u(e);var n=this.keyFromSecret(t),r=this.hashInt(n.messagePrefix(),e),i=this.g.mul(r),o=this.encodePoint(i),s=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),a=r.add(s).umod(this.curve.n);return this.makeSignature({R:i,S:a,Rencoded:o})},r.prototype.verify=function(e,t,n){e=u(e),t=this.makeSignature(t);var r=this.keyFromPublic(n),i=this.hashInt(t.Rencoded(),r.pubBytes(),e),o=this.g.mul(t.S()),s=t.R().add(r.pub().mul(i));return s.eq(o)},r.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},r.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},r.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},r.prototype.makeSignature=function(e){return e instanceof f?e:new f(this,e)},r.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},r.prototype.decodePoint=function(e){e=s.parseBytes(e);var t=e.length-1,n=e.slice(0,t).concat(e[t]&-129),r=0!==(128&e[t]),i=s.intFromLE(n);return this.curve.pointFromY(i,r)},r.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},r.prototype.decodeInt=function(e){return s.intFromLE(e)},r.prototype.isPoint=function(e){return e instanceof this.pointClass}},{"../../elliptic":56,"./key":67,"./signature":68,"hash.js":77}],67:[function(e,t,n){"use strict";function r(e,t){this.eddsa=e,this._secret=a(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=a(t.pub)}var i=e("../../elliptic"),o=i.utils,s=o.assert,a=o.parseBytes,u=o.cachedProperty;r.fromPublic=function(e,t){return t instanceof r?t:new r(e,{pub:t})},r.fromSecret=function(e,t){return t instanceof r?t:new r(e,{secret:t})},r.prototype.secret=function(){return this._secret},u(r,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),u(r,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),u(r,"privBytes",function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[n]&=127,r[n]|=64,r}),u(r,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),u(r,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),u(r,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),r.prototype.sign=function(e){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},r.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},r.prototype.getSecret=function(e){return s(this._secret,"KeyPair is public only"),o.encode(this.secret(),e)},r.prototype.getPublic=function(e){return o.encode(this.pubBytes(),e)},t.exports=r},{"../../elliptic":56}],68:[function(e,t,n){"use strict";function r(e,t){this.eddsa=e,"object"!=typeof t&&(t=u(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof BN&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}var BN=e("bn.js"),i=e("../../elliptic"),o=i.utils,s=o.assert,a=o.cachedProperty,u=o.parseBytes;a(r,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),a(r,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),a(r,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),a(r,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),r.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},r.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},t.exports=r},{"../../elliptic":56,"bn.js":26}],69:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this.reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=s.toArray(e.entropy,e.entropyEnc),n=s.toArray(e.nonce,e.nonceEnc),i=s.toArray(e.pers,e.persEnc);a(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,i)}var i=e("hash.js"),o=e("../elliptic"),s=o.utils,a=s.assert;t.exports=r,r.prototype._init=function(e,t,n){var r=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this.reseed=1,this.reseedInterval=281474976710656},r.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},r.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},r.prototype.reseed=function(e,t,n,r){"string"!=typeof t&&(r=n,n=t,t=null),e=s.toBuffer(e,t),n=s.toBuffer(n,r),a(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this.reseed=1},r.prototype.generate=function(e,t,n,r){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(r=n,n=t,t=null),n&&(n=s.toArray(n,r),this._update(n));for(var i=[];i.length<e;)this.V=this._hmac().update(this.V).digest(),i=i.concat(this.V);var o=i.slice(0,e);return this._update(n),this.reseed++,s.encode(o,t)}},{"../elliptic":56,"hash.js":77}],70:[function(e,t,n){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]
}}},{}],71:[function(e,t,n){"use strict";function r(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}if(t){if("hex"===t){e=e.replace(/[^a-z0-9]+/gi,""),e.length%2!==0&&(e="0"+e);for(var r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}}else for(var r=0;r<e.length;r++){var i=e.charCodeAt(r),o=i>>8,s=255&i;o?n.push(o,s):n.push(s)}return n}function i(e){return 1===e.length?"0"+e:e}function o(e){for(var t="",n=0;n<e.length;n++)t+=i(e[n].toString(16));return t}function s(e,t){for(var n=[],r=1<<t+1,i=e.clone();i.cmpn(1)>=0;){var o;if(i.isOdd()){var s=i.andln(r-1);o=s>(r>>1)-1?(r>>1)-s:s,i.isubn(o)}else o=0;n.push(o);for(var a=0!==i.cmpn(0)&&0===i.andln(r-1)?t+1:1,u=1;u<a;u++)n.push(0);i.iushrn(a)}return n}function a(e,t){var n=[[],[]];e=e.clone(),t=t.clone();for(var r=0,i=0;e.cmpn(-r)>0||t.cmpn(-i)>0;){var o=e.andln(3)+r&3,s=t.andln(3)+i&3;3===o&&(o=-1),3===s&&(s=-1);var a;if(0===(1&o))a=0;else{var u=e.andln(7)+r&7;a=3!==u&&5!==u||2!==s?o:-o}n[0].push(a);var c;if(0===(1&s))c=0;else{var u=t.andln(7)+i&7;c=3!==u&&5!==u||2!==o?s:-s}n[1].push(c),2*r===a+1&&(r=1-r),2*i===c+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return n}function u(e,t,n){var r="_"+t;e.prototype[t]=function(){return void 0!==this[r]?this[r]:this[r]=n.call(this)}}function c(e){return"string"==typeof e?l.toArray(e,"hex"):e}function f(e){return new BN(e,"hex","le")}var l=n,BN=e("bn.js");l.assert=function(e,t){if(!e)throw new Error(t||"Assertion failed")},l.toArray=r,l.zero2=i,l.toHex=o,l.encode=function(e,t){return"hex"===t?o(e):e},l.getNAF=s,l.getJSF=a,l.cachedProperty=u,l.parseBytes=c,l.intFromLE=f},{"bn.js":26}],72:[function(e,t,n){t.exports=t.exports={name:"elliptic",version:"6.2.8"}},{}],73:[function(e,t,n){var r=e("once"),i=function(){},o=function(e){return e.setHeader&&"function"==typeof e.abort},s=function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length},a=function(e,t,n){if("function"==typeof t)return a(e,null,t);t||(t={}),n=r(n||i);var u=e._writableState,c=e._readableState,f=t.readable||t.readable!==!1&&e.readable,l=t.writable||t.writable!==!1&&e.writable,h=function(){e.writable||p()},p=function(){l=!1,f||n()},d=function(){f=!1,l||n()},g=function(e){n(e?new Error("exited with error code: "+e):null)},y=function(){return(!f||c&&c.ended)&&(!l||u&&u.ended)?void 0:n(new Error("premature close"))},m=function(){e.req.on("finish",p)};return o(e)?(e.on("complete",p),e.on("abort",y),e.req?m():e.on("request",m)):l&&!u&&(e.on("end",h),e.on("close",h)),s(e)&&e.on("exit",g),e.on("end",d),e.on("finish",p),t.error!==!1&&e.on("error",n),e.on("close",y),function(){e.removeListener("complete",p),e.removeListener("abort",y),e.removeListener("request",m),e.req&&e.req.removeListener("finish",p),e.removeListener("end",h),e.removeListener("close",h),e.removeListener("finish",p),e.removeListener("exit",g),e.removeListener("end",d),e.removeListener("error",n),e.removeListener("close",y)}};t.exports=a},{once:136}],74:[function(e,t,n){(function(Buffer){function n(e,t,n,i){Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),t&&!Buffer.isBuffer(t)&&(t=new Buffer(t,"binary")),n/=8,i=i||0;for(var o,s,a=0,u=0,c=new Buffer(n),f=new Buffer(i),l=0,h=[];;){if(l++>0&&h.push(o),h.push(e),t&&h.push(t),o=r(Buffer.concat(h)),h=[],s=0,n>0)for(;;){if(0===n)break;if(s===o.length)break;c[a++]=o[s],n--,s++}if(i>0&&s!==o.length)for(;;){if(0===i)break;if(s===o.length)break;f[u++]=o[s],i--,s++}if(0===n&&0===i)break}for(s=0;s<o.length;s++)o[s]=0;return{key:c,iv:f}}var r=e("create-hash/md5");t.exports=n}).call(this,e("buffer").Buffer)},{buffer:590,"create-hash/md5":53}],75:[function(e,t,n){function r(e,t,n){if(!a(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===u.call(e)?i(e,t,n):"string"==typeof e?o(e,t,n):s(e,t,n)}function i(e,t,n){for(var r=0,i=e.length;r<i;r++)c.call(e,r)&&t.call(n,e[r],r,e)}function o(e,t,n){for(var r=0,i=e.length;r<i;r++)t.call(n,e.charAt(r),r,e)}function s(e,t,n){for(var r in e)c.call(e,r)&&t.call(n,e[r],r,e)}var a=e("is-function");t.exports=r;var u=Object.prototype.toString,c=Object.prototype.hasOwnProperty},{"is-function":104}],76:[function(e,t,n){(function(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],77:[function(e,t,n){var r=n;r.utils=e("./hash/utils"),r.common=e("./hash/common"),r.sha=e("./hash/sha"),r.ripemd=e("./hash/ripemd"),r.hmac=e("./hash/hmac"),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},{"./hash/common":78,"./hash/hmac":79,"./hash/ripemd":80,"./hash/sha":81,"./hash/utils":82}],78:[function(e,t,n){function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var i=e("../hash"),o=i.utils,s=o.assert;n.BlockHash=r,r.prototype.update=function(e,t){if(e=o.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=o.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},r.prototype.digest=function(e){return this.update(this._pad()),s(null===this.pending),this._digest(e)},r.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else{r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0;for(var o=8;o<this.padLength;o++)r[i++]=0}return r}},{"../hash":77}],79:[function(e,t,n){function r(e,t,n){return this instanceof r?(this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,void this._init(o.toArray(t,n))):new r(e,t,n)}var i=e("../hash"),o=i.utils,s=o.assert;t.exports=r,r.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),s(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(var t=0;t<e.length;t++)e[t]^=54;this.inner=(new this.Hash).update(e);for(var t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},r.prototype.update=function(e,t){return this.inner.update(e,t),this},r.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},{"../hash":77}],80:[function(e,t,n){function r(){return this instanceof r?(p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new r}function i(e,t,n,r){return e<=15?t^n^r:e<=31?t&n|~t&r:e<=47?(t|~n)^r:e<=63?t&r|n&~r:t^(n|~r)}function o(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function s(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}var a=e("../hash"),u=a.utils,c=u.rotl32,f=u.sum32,l=u.sum32_3,h=u.sum32_4,p=a.common.BlockHash;u.inherits(r,p),n.ripemd160=r,r.blockSize=512,r.outSize=160,r.hmacStrength=192,r.padLength=64,r.prototype._update=function(e,t){for(var n=this.h[0],r=this.h[1],a=this.h[2],u=this.h[3],p=this.h[4],v=n,b=r,w=a,E=u,_=p,S=0;S<80;S++){var k=f(c(h(n,i(S,r,a,u),e[d[S]+t],o(S)),y[S]),p);n=p,p=u,u=c(a,10),a=r,r=k,k=f(c(h(v,i(79-S,b,w,E),e[g[S]+t],s(S)),m[S]),_),v=_,_=E,E=c(w,10),w=b,b=k}k=l(this.h[1],a,E),this.h[1]=l(this.h[2],u,_),this.h[2]=l(this.h[3],p,v),this.h[3]=l(this.h[4],n,b),this.h[4]=l(this.h[0],r,w),this.h[0]=k},r.prototype._digest=function(e){return"hex"===e?u.toHex32(this.h,"little"):u.split32(this.h,"little")};var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"../hash":77}],81:[function(e,t,n){function r(){return this instanceof r?(G.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=Y,void(this.W=new Array(64))):new r}function i(){return this instanceof i?(r.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new i}function o(){return this instanceof o?(G.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=X,void(this.W=new Array(160))):new o}function s(){return this instanceof s?(o.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new s}function a(){return this instanceof a?(G.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new a}function u(e,t,n){return e&t^~e&n}function c(e,t,n){return e&t^e&n^t&n}function f(e,t,n){return e^t^n}function l(e){return M(e,2)^M(e,13)^M(e,22)}function h(e){return M(e,6)^M(e,11)^M(e,25)}function p(e){return M(e,7)^M(e,18)^e>>>3}function d(e){return M(e,17)^M(e,19)^e>>>10}function g(e,t,n,r){return 0===e?u(t,n,r):1===e||3===e?f(t,n,r):2===e?c(t,n,r):void 0}function y(e,t,n,r,i,o){var s=e&n^~e&i;return s<0&&(s+=4294967296),s}function m(e,t,n,r,i,o){var s=t&r^~t&o;return s<0&&(s+=4294967296),s}function v(e,t,n,r,i,o){var s=e&n^e&i^n&i;return s<0&&(s+=4294967296),s}function b(e,t,n,r,i,o){var s=t&r^t&o^r&o;return s<0&&(s+=4294967296),s}function w(e,t){var n=N(e,t,28),r=N(t,e,2),i=N(t,e,7),o=n^r^i;return o<0&&(o+=4294967296),o}function E(e,t){var n=L(e,t,28),r=L(t,e,2),i=L(t,e,7),o=n^r^i;return o<0&&(o+=4294967296),o}function _(e,t){var n=N(e,t,14),r=N(e,t,18),i=N(t,e,9),o=n^r^i;return o<0&&(o+=4294967296),o}function S(e,t){var n=L(e,t,14),r=L(e,t,18),i=L(t,e,9),o=n^r^i;return o<0&&(o+=4294967296),o}function k(e,t){var n=N(e,t,1),r=N(e,t,8),i=F(e,t,7),o=n^r^i;return o<0&&(o+=4294967296),o}function C(e,t){var n=L(e,t,1),r=L(e,t,8),i=U(e,t,7),o=n^r^i;return o<0&&(o+=4294967296),o}function x(e,t){var n=N(e,t,19),r=N(t,e,29),i=F(e,t,6),o=n^r^i;return o<0&&(o+=4294967296),o}function I(e,t){var n=L(e,t,19),r=L(t,e,29),i=U(e,t,6),o=n^r^i;return o<0&&(o+=4294967296),o}var A=e("../hash"),P=A.utils,T=P.assert,M=P.rotr32,R=P.rotl32,O=P.sum32,B=P.sum32_4,D=P.sum32_5,N=P.rotr64_hi,L=P.rotr64_lo,F=P.shr64_hi,U=P.shr64_lo,j=P.sum64,z=P.sum64_hi,K=P.sum64_lo,H=P.sum64_4_hi,q=P.sum64_4_lo,V=P.sum64_5_hi,W=P.sum64_5_lo,G=A.common.BlockHash,Y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],X=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],$=[1518500249,1859775393,2400959708,3395469782];P.inherits(r,G),n.sha256=r,r.blockSize=512,r.outSize=256,r.hmacStrength=192,r.padLength=64,r.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=B(d(n[r-2]),n[r-7],p(n[r-15]),n[r-16]);var i=this.h[0],o=this.h[1],s=this.h[2],a=this.h[3],f=this.h[4],g=this.h[5],y=this.h[6],m=this.h[7];T(this.k.length===n.length);for(var r=0;r<n.length;r++){var v=D(m,h(f),u(f,g,y),this.k[r],n[r]),b=O(l(i),c(i,o,s));m=y,y=g,g=f,f=O(a,v),a=s,s=o,o=i,i=O(v,b)}this.h[0]=O(this.h[0],i),this.h[1]=O(this.h[1],o),this.h[2]=O(this.h[2],s),this.h[3]=O(this.h[3],a),this.h[4]=O(this.h[4],f),this.h[5]=O(this.h[5],g),this.h[6]=O(this.h[6],y),this.h[7]=O(this.h[7],m)},r.prototype._digest=function(e){return"hex"===e?P.toHex32(this.h,"big"):P.split32(this.h,"big")},P.inherits(i,r),n.sha224=i,i.blockSize=512,i.outSize=224,i.hmacStrength=192,i.padLength=64,i.prototype._digest=function(e){return"hex"===e?P.toHex32(this.h.slice(0,7),"big"):P.split32(this.h.slice(0,7),"big")},P.inherits(o,G),n.sha512=o,o.blockSize=1024,o.outSize=512,o.hmacStrength=192,o.padLength=128,o.prototype._prepareBlock=function(e,t){for(var n=this.W,r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=x(n[r-4],n[r-3]),o=I(n[r-4],n[r-3]),s=n[r-14],a=n[r-13],u=k(n[r-30],n[r-29]),c=C(n[r-30],n[r-29]),f=n[r-32],l=n[r-31];n[r]=H(i,o,s,a,u,c,f,l),n[r+1]=q(i,o,s,a,u,c,f,l)}},o.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,r=this.h[0],i=this.h[1],o=this.h[2],s=this.h[3],a=this.h[4],u=this.h[5],c=this.h[6],f=this.h[7],l=this.h[8],h=this.h[9],p=this.h[10],d=this.h[11],g=this.h[12],k=this.h[13],C=this.h[14],x=this.h[15];T(this.k.length===n.length);for(var I=0;I<n.length;I+=2){var A=C,P=x,M=_(l,h),R=S(l,h),O=y(l,h,p,d,g,k),B=m(l,h,p,d,g,k),D=this.k[I],N=this.k[I+1],L=n[I],F=n[I+1],U=V(A,P,M,R,O,B,D,N,L,F),H=W(A,P,M,R,O,B,D,N,L,F),A=w(r,i),P=E(r,i),M=v(r,i,o,s,a,u),R=b(r,i,o,s,a,u),q=z(A,P,M,R),G=K(A,P,M,R);C=g,x=k,g=p,k=d,p=l,d=h,l=z(c,f,U,H),h=K(f,f,U,H),c=a,f=u,a=o,u=s,o=r,s=i,r=z(U,H,q,G),i=K(U,H,q,G)}j(this.h,0,r,i),j(this.h,2,o,s),j(this.h,4,a,u),j(this.h,6,c,f),j(this.h,8,l,h),j(this.h,10,p,d),j(this.h,12,g,k),j(this.h,14,C,x)},o.prototype._digest=function(e){return"hex"===e?P.toHex32(this.h,"big"):P.split32(this.h,"big")},P.inherits(s,o),n.sha384=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?P.toHex32(this.h.slice(0,12),"big"):P.split32(this.h.slice(0,12),"big")},P.inherits(a,G),n.sha1=a,a.blockSize=512,a.outSize=160,a.hmacStrength=80,a.padLength=64,a.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=R(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);for(var i=this.h[0],o=this.h[1],s=this.h[2],a=this.h[3],u=this.h[4],r=0;r<n.length;r++){var c=~~(r/20),f=D(R(i,5),g(c,o,s,a),u,n[r],$[c]);u=a,a=s,s=R(o,30),o=i,i=f}this.h[0]=O(this.h[0],i),this.h[1]=O(this.h[1],o),this.h[2]=O(this.h[2],s),this.h[3]=O(this.h[3],a),this.h[4]=O(this.h[4],u)},a.prototype._digest=function(e){return"hex"===e?P.toHex32(this.h,"big"):P.split32(this.h,"big")}},{"../hash":77}],82:[function(e,t,n){function r(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t){e=e.replace(/[^a-z0-9]+/gi,""),e.length%2!==0&&(e="0"+e);for(var r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}}else for(var r=0;r<e.length;r++){var i=e.charCodeAt(r),o=i>>8,s=255&i;o?n.push(o,s):n.push(s)}else for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}function i(e){for(var t="",n=0;n<e.length;n++)t+=a(e[n].toString(16));return t}function o(e){var t=e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24;return t>>>0}function s(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=o(i)),n+=u(i.toString(16))}return n}function a(e){return 1===e.length?"0"+e:e}function u(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}function c(e,t,n,r){var i=n-t;m(i%4===0);for(var o=new Array(i/4),s=0,a=t;s<o.length;s++,a+=4){var u;u="big"===r?e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]:e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a],o[s]=u>>>0}return o}function f(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var o=e[r];"big"===t?(n[i]=o>>>24,n[i+1]=o>>>16&255,n[i+2]=o>>>8&255,n[i+3]=255&o):(n[i+3]=o>>>24,n[i+2]=o>>>16&255,n[i+1]=o>>>8&255,n[i]=255&o)}return n}function l(e,t){return e>>>t|e<<32-t}function h(e,t){return e<<t|e>>>32-t}function p(e,t){return e+t>>>0}function d(e,t,n){return e+t+n>>>0}function g(e,t,n,r){return e+t+n+r>>>0}function y(e,t,n,r,i){return e+t+n+r+i>>>0}function m(e,t){if(!e)throw new Error(t||"Assertion failed")}function v(e,t,n,r){var i=e[t],o=e[t+1],s=r+o>>>0,a=(s<r?1:0)+n+i;e[t]=a>>>0,e[t+1]=s}function b(e,t,n,r){var i=t+r>>>0,o=(i<t?1:0)+e+n;return o>>>0}function w(e,t,n,r){var i=t+r;return i>>>0}function E(e,t,n,r,i,o,s,a){var u=0,c=t;c=c+r>>>0,u+=c<t?1:0,c=c+o>>>0,u+=c<o?1:0,c=c+a>>>0,u+=c<a?1:0;var f=e+n+i+s+u;return f>>>0}function _(e,t,n,r,i,o,s,a){var u=t+r+o+a;return u>>>0}function S(e,t,n,r,i,o,s,a,u,c){var f=0,l=t;l=l+r>>>0,f+=l<t?1:0,l=l+o>>>0,f+=l<o?1:0,l=l+a>>>0,f+=l<a?1:0,l=l+c>>>0,f+=l<c?1:0;var h=e+n+i+s+u+f;return h>>>0}function k(e,t,n,r,i,o,s,a,u,c){var f=t+r+o+a+c;return f>>>0}function C(e,t,n){var r=t<<32-n|e>>>n;return r>>>0}function x(e,t,n){var r=e<<32-n|t>>>n;return r>>>0}function I(e,t,n){return e>>>n}function A(e,t,n){var r=e<<32-n|t>>>n;return r>>>0}var P=n,T=e("inherits");P.toArray=r,P.toHex=i,P.htonl=o,P.toHex32=s,P.zero2=a,P.zero8=u,P.join32=c,P.split32=f,P.rotr32=l,P.rotl32=h,P.sum32=p,P.sum32_3=d,P.sum32_4=g,P.sum32_5=y,P.assert=m,P.inherits=T,n.sum64=v,n.sum64_hi=b,n.sum64_lo=w,n.sum64_4_hi=E,n.sum64_4_lo=_,n.sum64_5_hi=S,n.sum64_5_lo=k,n.rotr64_hi=C,n.rotr64_lo=x,n.shr64_hi=I,n.shr64_lo=A},{inherits:102}],83:[function(e,t,n){"use strict";n.__esModule=!0;n.PUSH="PUSH",n.REPLACE="REPLACE",n.POP="POP"},{}],84:[function(e,t,n){"use strict";n.__esModule=!0;n.loopAsync=function(e,t,n){var r=0,i=!1,o=!1,s=!1,a=void 0,u=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=!0,o?void(a=t):void n.apply(void 0,t)},c=function f(){if(!i&&(s=!0,!o)){for(o=!0;!i&&r<e&&s;)s=!1,t(r++,f,u);return o=!1,i?void n.apply(void 0,a):void(r>=e&&s&&(i=!0,n()))}};c()}},{}],85:[function(e,t,n){"use strict";n.__esModule=!0,n.go=n.replaceLocation=n.pushLocation=n.startListener=n.getUserConfirmation=n.getCurrentLocation=void 0;var r=e("./LocationUtils"),i=e("./DOMUtils"),o=e("./DOMStateStorage"),s=e("./PathUtils"),a=e("./ExecutionEnvironment"),u="popstate",c="hashchange",f=a.canUseDOM&&!(0,i.supportsPopstateOnHashchange)(),l=function(e){var t=e&&e.key;return(0,r.createLocation)({pathname:window.location.pathname,search:window.location.search,hash:window.location.hash,state:t?(0,o.readState)(t):void 0},void 0,t)},h=n.getCurrentLocation=function(){var e=void 0;try{e=window.history.state||{}}catch(t){e={}}return l(e)},p=(n.getUserConfirmation=function(e,t){return t(window.confirm(e))},n.startListener=function(e){var t=function(t){void 0!==t.state&&e(l(t.state))};(0,i.addEventListener)(window,u,t);var n=function(){return e(h())};return f&&(0,i.addEventListener)(window,c,n),function(){(0,i.removeEventListener)(window,u,t),f&&(0,i.removeEventListener)(window,c,n)}},function(e,t){var n=e.state,r=e.key;void 0!==n&&(0,o.saveState)(r,n),t({key:r},(0,s.createPath)(e))});n.pushLocation=function(e){return p(e,function(e,t){return window.history.pushState(e,null,t)})},n.replaceLocation=function(e){return p(e,function(e,t){return window.history.replaceState(e,null,t)})},n.go=function(e){e&&window.history.go(e)}},{"./DOMStateStorage":86,"./DOMUtils":87,"./ExecutionEnvironment":88,"./LocationUtils":90,"./PathUtils":91}],86:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.readState=n.saveState=void 0;var i=e("warning"),o=r(i),s={QuotaExceededError:!0,QUOTA_EXCEEDED_ERR:!0},a={SecurityError:!0},u="@@History/",c=function(e){return u+e};n.saveState=function(e,n){if(!window.sessionStorage)return void("production"!==t.env.NODE_ENV?(0,o["default"])(!1,"[history] Unable to save state; sessionStorage is not available"):void 0);try{null==n?window.sessionStorage.removeItem(c(e)):window.sessionStorage.setItem(c(e),JSON.stringify(n))}catch(r){if(a[r.name])return void("production"!==t.env.NODE_ENV?(0,o["default"])(!1,"[history] Unable to save state; sessionStorage is not available due to security settings"):void 0);if(s[r.name]&&0===window.sessionStorage.length)return void("production"!==t.env.NODE_ENV?(0,o["default"])(!1,"[history] Unable to save state; sessionStorage is not available in Safari private mode"):void 0);throw r}},n.readState=function(e){var n=void 0;try{n=window.sessionStorage.getItem(c(e))}catch(r){if(a[r.name])return void("production"!==t.env.NODE_ENV?(0,o["default"])(!1,"[history] Unable to read state; sessionStorage is not available due to security settings"):void 0)}if(n)try{return JSON.parse(n)}catch(r){}}}).call(this,e("_process"))},{_process:592,warning:395}],87:[function(e,t,n){"use strict";n.__esModule=!0;n.addEventListener=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},n.removeEventListener=function(e,t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},n.supportsHistory=function(){var e=window.navigator.userAgent;return(e.indexOf("Android 2.")===-1&&e.indexOf("Android 4.0")===-1||e.indexOf("Mobile Safari")===-1||e.indexOf("Chrome")!==-1||e.indexOf("Windows Phone")!==-1)&&(window.history&&"pushState"in window.history)},n.supportsGoWithoutReloadUsingHash=function(){return window.navigator.userAgent.indexOf("Firefox")===-1},n.supportsPopstateOnHashchange=function(){return window.navigator.userAgent.indexOf("Trident")===-1}},{}],88:[function(e,t,n){"use strict";n.__esModule=!0;n.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement)},{}],89:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.replaceLocation=n.pushLocation=n.startListener=n.getCurrentLocation=n.go=n.getUserConfirmation=void 0;var i=e("./BrowserProtocol");Object.defineProperty(n,"getUserConfirmation",{enumerable:!0,get:function(){return i.getUserConfirmation}}),Object.defineProperty(n,"go",{enumerable:!0,get:function(){return i.go}});var o=e("warning"),s=r(o),a=e("./LocationUtils"),u=e("./DOMUtils"),c=e("./DOMStateStorage"),f=e("./PathUtils"),l="hashchange",h=function(){var e=window.location.href,t=e.indexOf("#");return t===-1?"":e.substring(t+1)},p=function(e){return window.location.hash=e},d=function(e){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,t>=0?t:0)+"#"+e)},g=n.getCurrentLocation=function(e,t){var n=e.decodePath(h()),r=(0,f.getQueryStringValueFromPath)(n,t),i=void 0;r&&(n=(0,f.stripQueryStringValueFromPath)(n,t),i=(0,c.readState)(r));var o=(0,f.parsePath)(n);return o.state=i,(0,a.createLocation)(o,void 0,r)},y=void 0,m=(n.startListener=function(e,t,n){var r=function(){var r=h(),i=t.encodePath(r);if(r!==i)d(i);else{var o=g(t,n);if(y&&o.key&&y.key===o.key)return;y=o,e(o)}},i=h(),o=t.encodePath(i);return i!==o&&d(o),(0,u.addEventListener)(window,l,r),function(){return(0,u.removeEventListener)(window,l,r)}},function(e,t,n,r){var i=e.state,o=e.key,s=t.encodePath((0,f.createPath)(e));void 0!==i&&(s=(0,f.addQueryStringValueToPath)(s,n,o),(0,c.saveState)(o,i)),y=e,r(s)});n.pushLocation=function(e,n,r){return m(e,n,r,function(e){h()!==e?p(e):"production"!==t.env.NODE_ENV?(0,s["default"])(!1,"You cannot PUSH the same path using hash history"):void 0})},n.replaceLocation=function(e,t,n){return m(e,t,n,function(e){h()!==e&&d(e)})}}).call(this,e("_process"))},{"./BrowserProtocol":85,"./DOMStateStorage":86,"./DOMUtils":87,"./LocationUtils":90,"./PathUtils":91,_process:592,warning:395}],90:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.locationsAreEqual=n.statesAreEqual=n.createLocation=n.createQuery=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=e("invariant"),a=r(s),u=e("warning"),c=r(u),f=e("./PathUtils"),l=e("./Actions"),h=(n.createQuery=function(e){return o(Object.create(null),e)},n.createLocation=function(){var e=arguments.length<=0||void 0===arguments[0]?"/":arguments[0],n=arguments.length<=1||void 0===arguments[1]?l.POP:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i="string"==typeof e?(0,f.parsePath)(e):e;"production"!==t.env.NODE_ENV?(0,c["default"])(!i.path,"Location descriptor objects should have a `pathname`, not a `path`."):void 0;var o=i.pathname||"/",s=i.search||"",a=i.hash||"",u=i.state;return{pathname:o,search:s,hash:a,state:u,action:n,key:r}},function(e){return"[object Date]"===Object.prototype.toString.call(e)}),p=n.statesAreEqual=function d(e,n){if(e===n)return!0;var r="undefined"==typeof e?"undefined":i(e),o="undefined"==typeof n?"undefined":i(n);if(r!==o)return!1;if("function"===r?"production"!==t.env.NODE_ENV?(0,a["default"])(!1,"You must not store functions in location state"):(0,a["default"])(!1):void 0,"object"===r){if(h(e)&&h(n)?"production"!==t.env.NODE_ENV?(0,a["default"])(!1,"You must not store Date objects in location state"):(0,a["default"])(!1):void 0,!Array.isArray(e)){var s=Object.keys(e),u=Object.keys(n);return s.length===u.length&&s.every(function(t){return d(e[t],n[t])})}return Array.isArray(n)&&e.length===n.length&&e.every(function(e,t){return d(e,n[t])})}return!1};n.locationsAreEqual=function(e,t){return e.key===t.key&&e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&p(e.state,t.state)}}).call(this,e("_process"))},{"./Actions":83,"./PathUtils":91,_process:592,invariant:103,warning:395}],91:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.createPath=n.parsePath=n.getQueryStringValueFromPath=n.stripQueryStringValueFromPath=n.addQueryStringValueToPath=void 0;var i=e("warning"),o=r(i),s=(n.addQueryStringValueToPath=function(e,t,n){var r=a(e),i=r.pathname,o=r.search,s=r.hash;return u({pathname:i,search:o+(o.indexOf("?")===-1?"?":"&")+t+"="+n,hash:s})},n.stripQueryStringValueFromPath=function(e,t){var n=a(e),r=n.pathname,i=n.search,o=n.hash;return u({pathname:r,search:i.replace(new RegExp("([?&])"+t+"=[a-zA-Z0-9]+(&?)"),function(e,t,n){return"?"===t?t:n}),hash:o})},n.getQueryStringValueFromPath=function(e,t){var n=a(e),r=n.search,i=r.match(new RegExp("[?&]"+t+"=([a-zA-Z0-9]+)"));return i&&i[1]},function(e){var t=e.match(/^(https?:)?\/\/[^\/]*/);return null==t?e:e.substring(t[0].length)}),a=n.parsePath=function(e){var n=s(e),r="",i="";"production"!==t.env.NODE_ENV?(0,o["default"])(e===n,'A path must be pathname + search + hash only, not a full URL like "%s"',e):void 0;var a=n.indexOf("#");a!==-1&&(i=n.substring(a),n=n.substring(0,a));var u=n.indexOf("?");return u!==-1&&(r=n.substring(u),n=n.substring(0,u)),""===n&&(n="/"),{pathname:n,search:r,hash:i}},u=n.createPath=function(e){if(null==e||"string"==typeof e)return e;var t=e.basename,n=e.pathname,r=e.search,i=e.hash,o=(t||"")+n;return r&&"?"!==r&&(o+=r),i&&(o+=i),o}}).call(this,e("_process"))},{_process:592,warning:395}],92:[function(e,t,n){"use strict";n.__esModule=!0,n.replaceLocation=n.pushLocation=n.getCurrentLocation=n.go=n.getUserConfirmation=void 0;var r=e("./BrowserProtocol");Object.defineProperty(n,"getUserConfirmation",{enumerable:!0,get:function(){return r.getUserConfirmation}}),Object.defineProperty(n,"go",{enumerable:!0,get:function(){return r.go}});var i=e("./LocationUtils"),o=e("./PathUtils");n.getCurrentLocation=function(){return(0,i.createLocation)(window.location)},n.pushLocation=function(e){return window.location.href=(0,o.createPath)(e),!1},n.replaceLocation=function(e){return window.location.replace((0,o.createPath)(e)),!1}},{"./BrowserProtocol":85,"./LocationUtils":90,"./PathUtils":91}],93:[function(e,t,n){(function(t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=e("invariant"),a=i(s),u=e("./ExecutionEnvironment"),c=e("./BrowserProtocol"),f=r(c),l=e("./RefreshProtocol"),h=r(l),p=e("./DOMUtils"),d=e("./createHistory"),g=i(d),y=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];u.canUseDOM?void 0:"production"!==t.env.NODE_ENV?(0,a["default"])(!1,"Browser history needs a DOM"):(0,a["default"])(!1);var n=e.forceRefresh||!(0,p.supportsHistory)(),r=n?h:f,i=r.getUserConfirmation,s=r.getCurrentLocation,c=r.pushLocation,l=r.replaceLocation,d=r.go,y=(0,g["default"])(o({getUserConfirmation:i},e,{getCurrentLocation:s,pushLocation:c,replaceLocation:l,go:d})),m=0,v=void 0,b=function(e,t){1===++m&&(v=f.startListener(y.transitionTo));var n=t?y.listenBefore(e):y.listen(e);return function(){n(),0===--m&&v()}},w=function(e){return b(e,!0)},E=function(e){return b(e,!1)};return o({},y,{listenBefore:w,listen:E})};n["default"]=y}).call(this,e("_process"))},{"./BrowserProtocol":85,"./DOMUtils":87,"./ExecutionEnvironment":88,"./RefreshProtocol":92,"./createHistory":95,
_process:592,invariant:103}],94:[function(e,t,n){(function(t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=e("warning"),a=i(s),u=e("invariant"),c=i(u),f=e("./ExecutionEnvironment"),l=e("./DOMUtils"),h=e("./HashProtocol"),p=r(h),d=e("./createHistory"),g=i(d),y="_k",m=function(e){return"/"===e.charAt(0)?e:"/"+e},v={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!"+e},decodePath:function(e){return"!"===e.charAt(0)?e.substring(1):e}},noslash:{encodePath:function(e){return"/"===e.charAt(0)?e.substring(1):e},decodePath:m},slash:{encodePath:m,decodePath:m}},b=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];f.canUseDOM?void 0:"production"!==t.env.NODE_ENV?(0,c["default"])(!1,"Hash history needs a DOM"):(0,c["default"])(!1);var n=e.queryKey,r=e.hashType;"production"!==t.env.NODE_ENV?(0,a["default"])(n!==!1,"Using { queryKey: false } no longer works. Instead, just don't use location state if you don't want a key in your URL query string"):void 0,"string"!=typeof n&&(n=y),null==r&&(r="slash"),r in v||("production"!==t.env.NODE_ENV?(0,a["default"])(!1,"Invalid hash type: %s",r):void 0,r="slash");var i=v[r],s=p.getUserConfirmation,u=function(){return p.getCurrentLocation(i,n)},h=function(e){return p.pushLocation(e,i,n)},d=function(e){return p.replaceLocation(e,i,n)},m=(0,g["default"])(o({getUserConfirmation:s},e,{getCurrentLocation:u,pushLocation:h,replaceLocation:d,go:p.go})),b=0,w=void 0,E=function(e,t){1===++b&&(w=p.startListener(m.transitionTo,i,n));var r=t?m.listenBefore(e):m.listen(e);return function(){r(),0===--b&&w()}},_=function(e){return E(e,!0)},S=function(e){return E(e,!1)},k=(0,l.supportsGoWithoutReloadUsingHash)(),C=function(e){"production"!==t.env.NODE_ENV?(0,a["default"])(k,"Hash history go(n) causes a full page reload in this browser"):void 0,m.go(e)},x=function(e){return"#"+i.encodePath(m.createHref(e))};return o({},m,{listenBefore:_,listen:S,go:C,createHref:x})};n["default"]=b}).call(this,e("_process"))},{"./DOMUtils":87,"./ExecutionEnvironment":88,"./HashProtocol":89,"./createHistory":95,_process:592,invariant:103,warning:395}],95:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=e("./AsyncUtils"),o=e("./PathUtils"),s=e("./runTransitionHook"),a=r(s),u=e("./Actions"),c=e("./LocationUtils"),f=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.getCurrentLocation,n=e.getUserConfirmation,r=e.pushLocation,s=e.replaceLocation,f=e.go,l=e.keyLength,h=void 0,p=void 0,d=[],g=[],y=[],m=function(){return p&&p.action===u.POP?y.indexOf(p.key):h?y.indexOf(h.key):-1},v=function(e){var t=m();h=e,h.action===u.PUSH?y=[].concat(y.slice(0,t+1),[h.key]):h.action===u.REPLACE&&(y[t]=h.key),g.forEach(function(e){return e(h)})},b=function(e){return d.push(e),function(){return d=d.filter(function(t){return t!==e})}},w=function(e){return g.push(e),function(){return g=g.filter(function(t){return t!==e})}},E=function(e,t){(0,i.loopAsync)(d.length,function(t,n,r){(0,a["default"])(d[t],e,function(e){return null!=e?r(e):n()})},function(e){n&&"string"==typeof e?n(e,function(e){return t(e!==!1)}):t(e!==!1)})},_=function(e){h&&(0,c.locationsAreEqual)(h,e)||p&&(0,c.locationsAreEqual)(p,e)||(p=e,E(e,function(t){if(p===e)if(p=null,t){if(e.action===u.PUSH){var n=(0,o.createPath)(h),i=(0,o.createPath)(e);i===n&&(0,c.statesAreEqual)(h.state,e.state)&&(e.action=u.REPLACE)}e.action===u.POP?v(e):e.action===u.PUSH?r(e)!==!1&&v(e):e.action===u.REPLACE&&s(e)!==!1&&v(e)}else if(h&&e.action===u.POP){var a=y.indexOf(h.key),l=y.indexOf(e.key);a!==-1&&l!==-1&&f(a-l)}}))},S=function(e){return _(P(e,u.PUSH))},k=function(e){return _(P(e,u.REPLACE))},C=function(){return f(-1)},x=function(){return f(1)},I=function(){return Math.random().toString(36).substr(2,l||6)},A=function(e){return(0,o.createPath)(e)},P=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?I():arguments[2];return(0,c.createLocation)(e,t,n)};return{getCurrentLocation:t,listenBefore:b,listen:w,transitionTo:_,push:S,replace:k,go:f,goBack:C,goForward:x,createKey:I,createPath:o.createPath,createHref:A,createLocation:P}};n["default"]=f},{"./Actions":83,"./AsyncUtils":84,"./LocationUtils":90,"./PathUtils":91,"./runTransitionHook":98}],96:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=e("warning"),s=r(o),a=e("invariant"),u=r(a),c=e("./LocationUtils"),f=e("./PathUtils"),l=e("./createHistory"),h=r(l),p=e("./Actions"),d=function(e){return e.filter(function(e){return e.state}).reduce(function(e,t){return e[t.key]=t.state,e},{})},g=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];Array.isArray(e)?e={entries:e}:"string"==typeof e&&(e={entries:[e]});var n=function(){var e=m[v],t=(0,f.createPath)(e),n=void 0,r=void 0;e.key&&(n=e.key,r=E(n));var o=(0,f.parsePath)(t);return(0,c.createLocation)(i({},o,{state:r}),void 0,n)},r=function(e){var t=v+e;return t>=0&&t<m.length},o=function(e){if(e){if(!r(e))return void("production"!==t.env.NODE_ENV?(0,s["default"])(!1,"Cannot go(%s) there is not enough history",e):void 0);v+=e;var o=n();g.transitionTo(i({},o,{action:p.POP}))}},a=function(e){v+=1,v<m.length&&m.splice(v),m.push(e),w(e.key,e.state)},l=function(e){m[v]=e,w(e.key,e.state)},g=(0,h["default"])(i({},e,{getCurrentLocation:n,pushLocation:a,replaceLocation:l,go:o})),y=e,m=y.entries,v=y.current;"string"==typeof m?m=[m]:Array.isArray(m)||(m=["/"]),m=m.map(function(e){return(0,c.createLocation)(e)}),null==v?v=m.length-1:v>=0&&v<m.length?void 0:"production"!==t.env.NODE_ENV?(0,u["default"])(!1,"Current index must be >= 0 and < %s, was %s",m.length,v):(0,u["default"])(!1);var b=d(m),w=function(e,t){return b[e]=t},E=function(e){return b[e]};return i({},g,{canGo:r})};n["default"]=g}).call(this,e("_process"))},{"./Actions":83,"./LocationUtils":90,"./PathUtils":91,"./createHistory":95,_process:592,invariant:103,warning:395}],97:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.locationsAreEqual=n.Actions=n.useQueries=n.useBeforeUnload=n.useBasename=n.createMemoryHistory=n.createHashHistory=n.createHistory=void 0;var o=e("./LocationUtils");Object.defineProperty(n,"locationsAreEqual",{enumerable:!0,get:function(){return o.locationsAreEqual}});var s=e("./createBrowserHistory"),a=i(s),u=e("./createHashHistory"),c=i(u),f=e("./createMemoryHistory"),l=i(f),h=e("./useBasename"),p=i(h),d=e("./useBeforeUnload"),g=i(d),y=e("./useQueries"),m=i(y),v=e("./Actions"),b=r(v);n.createHistory=a["default"],n.createHashHistory=c["default"],n.createMemoryHistory=l["default"],n.useBasename=p["default"],n.useBeforeUnload=g["default"],n.useQueries=m["default"],n.Actions=b},{"./Actions":83,"./LocationUtils":90,"./createBrowserHistory":93,"./createHashHistory":94,"./createMemoryHistory":96,"./useBasename":99,"./useBeforeUnload":100,"./useQueries":101}],98:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=e("warning"),o=r(i),s=function(e,n,r){var i=e(n,r);e.length<2?r(i):"production"!==t.env.NODE_ENV?(0,o["default"])(void 0===i,'You should not "return" in a transition hook with a callback argument; call the callback instead'):void 0};n["default"]=s}).call(this,e("_process"))},{_process:592,warning:395}],99:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=e("./runTransitionHook"),s=r(o),a=e("./PathUtils"),u=function(e){return function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e(t),r=t.basename,o=function(e){return e?(r&&null==e.basename&&(0===e.pathname.indexOf(r)?(e.pathname=e.pathname.substring(r.length),e.basename=r,""===e.pathname&&(e.pathname="/")):e.basename=""),e):e},u=function(e){if(!r)return e;var t="string"==typeof e?(0,a.parsePath)(e):e,n=t.pathname,o="/"===r.slice(-1)?r:r+"/",s="/"===n.charAt(0)?n.slice(1):n,u=o+s;return i({},t,{pathname:u})},c=function(){return o(n.getCurrentLocation())},f=function(e){return n.listenBefore(function(t,n){return(0,s["default"])(e,o(t),n)})},l=function(e){return n.listen(function(t){return e(o(t))})},h=function(e){return n.push(u(e))},p=function(e){return n.replace(u(e))},d=function(e){return n.createPath(u(e))},g=function(e){return n.createHref(u(e))},y=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return o(n.createLocation.apply(n,[u(e)].concat(r)))};return i({},n,{getCurrentLocation:c,listenBefore:f,listen:l,push:h,replace:p,createPath:d,createHref:g,createLocation:y})}};n["default"]=u},{"./PathUtils":91,"./runTransitionHook":98}],100:[function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=e("invariant"),s=r(o),a=e("./DOMUtils"),u=e("./ExecutionEnvironment"),c=function(e){var t=function(t){var n=e();if("string"==typeof n)return(t||window.event).returnValue=n,n};return(0,a.addEventListener)(window,"beforeunload",t),function(){return(0,a.removeEventListener)(window,"beforeunload",t)}},f=function(e){return u.canUseDOM?void 0:"production"!==t.env.NODE_ENV?(0,s["default"])(!1,"useBeforeUnload only works in DOM environments"):(0,s["default"])(!1),function(t){var n=e(t),r=[],o=void 0,s=function(){for(var e=void 0,t=0,n=r.length;null==e&&t<n;++t)e=r[t].call();return e},a=function(e){return 1===r.push(e)&&(o=c(s)),function(){r=r.filter(function(t){return t!==e}),0===r.length&&o&&(o(),o=null)}};return i({},n,{listenBeforeUnload:a})}};n["default"]=f}).call(this,e("_process"))},{"./DOMUtils":87,"./ExecutionEnvironment":88,_process:592,invariant:103}],101:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=e("query-string"),s=e("./runTransitionHook"),a=r(s),u=e("./LocationUtils"),c=e("./PathUtils"),f=function(e){return(0,o.stringify)(e).replace(/%20/g,"+")},l=o.parse,h=function(e){return function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e(t),r=t.stringifyQuery,o=t.parseQueryString;"function"!=typeof r&&(r=f),"function"!=typeof o&&(o=l);var s=function(e){return e?(null==e.query&&(e.query=o(e.search.substring(1))),e):e},h=function(e,t){if(null==t)return e;var n="string"==typeof e?(0,c.parsePath)(e):e,o=r(t),s=o?"?"+o:"";return i({},n,{search:s})},p=function(){return s(n.getCurrentLocation())},d=function(e){return n.listenBefore(function(t,n){return(0,a["default"])(e,s(t),n)})},g=function(e){return n.listen(function(t){return e(s(t))})},y=function(e){return n.push(h(e,e.query))},m=function(e){return n.replace(h(e,e.query))},v=function(e){return n.createPath(h(e,e.query))},b=function(e){return n.createHref(h(e,e.query))},w=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var o=n.createLocation.apply(n,[h(e,e.query)].concat(r));return e.query&&(o.query=(0,u.createQuery)(e.query)),s(o)};return i({},n,{getCurrentLocation:p,listenBefore:d,listen:g,push:y,replace:m,createPath:v,createHref:b,createLocation:w})}};n["default"]=h},{"./LocationUtils":90,"./PathUtils":91,"./runTransitionHook":98,"query-string":328}],102:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],103:[function(e,t,n){(function(e){"use strict";var n=function(t,n,r,i,o,s,a,u){if("production"!==e.env.NODE_ENV&&void 0===n)throw new Error("invariant requires an error message argument");if(!t){var c;if(void 0===n)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[r,i,o,s,a,u],l=0;c=new Error(n.replace(/%s/g,function(){return f[l++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}};t.exports=n}).call(this,e("_process"))},{_process:592}],104:[function(e,t,n){function r(e){var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=r;var i=Object.prototype.toString},{}],105:[function(e,t,n){(function(e){!function(e,r){"function"==typeof define&&define.amd?define(function(){return e.is=r()}):"object"==typeof n?t.exports=r():e.is=r()}(this,function(){function t(e){return function(){return!e.apply(null,f.call(arguments))}}function n(e){return function(){var t=f.call(arguments),n=t.length;1===n&&u.array(t[0])&&(t=t[0],n=t.length);for(var r=0;r<n;r++)if(!e.call(null,t[r]))return!1;return!0}}function r(e){return function(){var t=f.call(arguments),n=t.length;1===n&&u.array(t[0])&&(t=t[0],n=t.length);for(var r=0;r<n;r++)if(e.call(null,t[r]))return!0;return!1}}function i(e,t){u[e]=function(n){return t[e].test(n)}}function o(){var e=u;for(var i in e)if(l.call(e,i)&&u["function"](e[i]))for(var o=e[i].api||["not","all","any"],s=0;s<o.length;s++)"not"===o[s]&&(u.not[i]=t(u[i])),"all"===o[s]&&(u.all[i]=n(u[i])),"any"===o[s]&&(u.any[i]=r(u[i]))}var s=this||e,a=s.is,u={};u.VERSION="0.8.0",u.not={},u.all={},u.any={};var c=Object.prototype.toString,f=Array.prototype.slice,l=Object.prototype.hasOwnProperty;u.arguments=function(e){return u.not["null"](e)&&("[object Arguments]"===c.call(e)||"object"==typeof e&&"callee"in e)},u.array=Array.isArray||function(e){return"[object Array]"===c.call(e)},u["boolean"]=function(e){return e===!0||e===!1||"[object Boolean]"===c.call(e)},u.date=function(e){return"[object Date]"===c.call(e)},u.error=function(e){return"[object Error]"===c.call(e)},u["function"]=function(e){return"[object Function]"===c.call(e)||"function"==typeof e},u.nan=function(e){return e!==e},u["null"]=function(e){return null===e},u.number=function(e){return u.not.nan(e)&&"[object Number]"===c.call(e)},u.object=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},u.json=function(e){return"[object Object]"===c.call(e)},u.regexp=function(e){return"[object RegExp]"===c.call(e)},u.sameType=function(e,t){return u.nan(e)||u.nan(t)?u.nan(e)===u.nan(t):c.call(e)===c.call(t)},u.sameType.api=["not"],u.string=function(e){return"[object String]"===c.call(e)},u["char"]=function(e){return u.string(e)&&1===e.length},u.undefined=function(e){return void 0===e},u.empty=function(e){if(u.object(e)){var t=Object.getOwnPropertyNames(e).length;return!!(0===t||1===t&&u.array(e)||2===t&&u.arguments(e))}return""===e},u.existy=function(e){return null!==e&&void 0!==e},u.truthy=function(e){return u.existy(e)&&e!==!1&&u.not.nan(e)&&""!==e&&0!==e},u.falsy=t(u.truthy),u.space=function(e){if(u["char"](e)){var t=e.charCodeAt(0);return t>8&&t<14||32===t}return!1},u.equal=function(e,t){return u.all.number(e,t)?e===t&&1/e===1/t:u.all.string(e,t)||u.all.regexp(e,t)?""+e==""+t:!!u.all["boolean"](e,t)&&e===t},u.equal.api=["not"],u.even=function(e){return u.number(e)&&e%2===0},u.odd=function(e){return u.number(e)&&e%2===1},u.positive=function(e){return u.number(e)&&e>0},u.negative=function(e){return u.number(e)&&e<0},u.above=function(e,t){return u.all.number(e,t)&&e>t},u.above.api=["not"],u.under=function(e,t){return u.all.number(e,t)&&e<t},u.under.api=["not"],u.within=function(e,t,n){return u.all.number(e,t,n)&&e>t&&e<n},u.within.api=["not"],u.decimal=function(e){return u.number(e)&&e%1!==0},u.integer=function(e){return u.number(e)&&e%1===0},u.finite=isFinite||function(e){return e!==1/0&&e!==-(1/0)&&u.not.nan(e)},u.infinite=t(u.finite);var h={url:/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,creditCard:/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/,alphaNumeric:/^[A-Za-z0-9]+$/,timeString:/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/,dateString:/^(1[0-2]|0?[1-9])\/(3[01]|[12][0-9]|0?[1-9])\/(?:[0-9]{2})?[0-9]{2}$/,usZipCode:/^[0-9]{5}(?:-[0-9]{4})?$/,caPostalCode:/^(?!.*[DFIOQU])[A-VXY][0-9][A-Z]\s?[0-9][A-Z][0-9]$/,ukPostCode:/^[A-Z]{1,2}[0-9RCHNQ][0-9A-Z]?\s?[0-9][ABD-HJLNP-UW-Z]{2}$|^[A-Z]{2}-?[0-9]{4}$/,nanpPhone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,eppPhone:/^\+[0-9]{1,3}\.[0-9]{4,14}(?:x.+)?$/,socialSecurityNumber:/^(?!000|666)[0-8][0-9]{2}-(?!00)[0-9]{2}-(?!0000)[0-9]{4}$/,affirmative:/^(?:1|t(?:rue)?|y(?:es)?|ok(?:ay)?)$/,hexadecimal:/^[0-9a-fA-F]+$/,hexColor:/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,ipv4:/^(?:(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/,ipv6:/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,ip:/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/};for(var p in h)h.hasOwnProperty(p)&&i(p,h);u.include=function(e,t){return e.indexOf(t)>-1},u.include.api=["not"],u.upperCase=function(e){return u.string(e)&&e===e.toUpperCase()},u.lowerCase=function(e){return u.string(e)&&e===e.toLowerCase()},u.startWith=function(e,t){return u.string(e)&&0===e.indexOf(t)},u.startWith.api=["not"],u.endWith=function(e,t){return u.string(e)&&e.indexOf(t)>-1&&e.indexOf(t)===e.length-t.length},u.endWith.api=["not"],u.capitalized=function(e){if(u.not.string(e))return!1;for(var t=e.split(" "),n=[],r=0;r<t.length;r++)n.push(t[r][0]===t[r][0].toUpperCase());return u.all.truthy.apply(null,n)},u.palindrome=function(e){return u.string(e)&&e==e.split("").reverse().join("")};var d=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],g=["january","february","march","april","may","june","july","august","september","october","november","december"];if(u.today=function(e){var t=new Date,n=t.toDateString();return u.date(e)&&e.toDateString()===n},u.yesterday=function(e){var t=new Date,n=new Date(t.setDate(t.getDate()-1)).toDateString();return u.date(e)&&e.toDateString()===n},u.tomorrow=function(e){var t=new Date,n=new Date(t.setDate(t.getDate()+1)).toDateString();return u.date(e)&&e.toDateString()===n},u.past=function(e){var t=new Date;return u.date(e)&&e.getTime()<t.getTime()},u.future=t(u.past),u.day=function(e,t){return u.date(e)&&t.toLowerCase()===d[e.getDay()]},u.day.api=["not"],u.month=function(e,t){return u.date(e)&&t.toLowerCase()===g[e.getMonth()]},u.month.api=["not"],u.year=function(e,t){return u.date(e)&&u.number(t)&&t===e.getFullYear()},u.year.api=["not"],u.leapYear=function(e){return u.number(e)&&(e%4===0&&e%100!==0||e%400===0)},u.weekend=function(e){return u.date(e)&&(6===e.getDay()||0===e.getDay())},u.weekday=t(u.weekend),u.inDateRange=function(e,t,n){if(u.not.date(e)||u.not.date(t)||u.not.date(n))return!1;var r=e.getTime(),i=t.getTime(),o=n.getTime();return r>i&&r<o},u.inDateRange.api=["not"],u.inLastWeek=function(e){return u.inDateRange(e,new Date((new Date).setDate((new Date).getDate()-7)),new Date)},u.inLastMonth=function(e){return u.inDateRange(e,new Date((new Date).setMonth((new Date).getMonth()-1)),new Date)},u.inLastYear=function(e){return u.inDateRange(e,new Date((new Date).setFullYear((new Date).getFullYear()-1)),new Date)},u.inNextWeek=function(e){return u.inDateRange(e,new Date,new Date((new Date).setDate((new Date).getDate()+7)))},u.inNextMonth=function(e){return u.inDateRange(e,new Date,new Date((new Date).setMonth((new Date).getMonth()+1)))},u.inNextYear=function(e){return u.inDateRange(e,new Date,new Date((new Date).setFullYear((new Date).getFullYear()+1)))},u.quarterOfYear=function(e,t){return u.date(e)&&u.number(t)&&t===Math.floor((e.getMonth()+3)/3)},u.quarterOfYear.api=["not"],u.dayLightSavingTime=function(e){var t=new Date(e.getFullYear(),0,1),n=new Date(e.getFullYear(),6,1),r=Math.max(t.getTimezoneOffset(),n.getTimezoneOffset());return e.getTimezoneOffset()<r},"undefined"!=typeof window){var y="navigator"in window&&"userAgent"in navigator&&navigator.userAgent.toLowerCase()||"",m="navigator"in window&&"vendor"in navigator&&navigator.vendor.toLowerCase()||"",v="navigator"in window&&"appVersion"in navigator&&navigator.appVersion.toLowerCase()||"";u.chrome=function(){return/chrome|chromium/i.test(y)&&/google inc/.test(m)},u.chrome.api=["not"],u.firefox=function(){return/firefox/i.test(y)},u.firefox.api=["not"],u.edge=function(){return/edge/i.test(y)},u.edge.api=["not"],u.ie=function(e){return e?e>=11?"ActiveXObject"in window:new RegExp("msie "+e).test(y):/msie/i.test(y)||"ActiveXObject"in window},u.ie.api=["not"],u.opera=function(){return/^Opera\//.test(y)||/\x20OPR\//.test(y)},u.opera.api=["not"],u.safari=function(){return/safari/i.test(y)&&/apple computer/i.test(m)},u.safari.api=["not"],u.ios=function(){return u.iphone()||u.ipad()||u.ipod()},u.ios.api=["not"],u.iphone=function(){return/iphone/i.test(y)},u.iphone.api=["not"],u.ipad=function(){return/ipad/i.test(y)},u.ipad.api=["not"],u.ipod=function(){return/ipod/i.test(y)},u.ipod.api=["not"],u.android=function(){return/android/i.test(y)},u.android.api=["not"],u.androidPhone=function(){return/android/i.test(y)&&/mobile/i.test(y)},u.androidPhone.api=["not"],u.androidTablet=function(){return/android/i.test(y)&&!/mobile/i.test(y)},u.androidTablet.api=["not"],u.blackberry=function(){return/blackberry/i.test(y)||/BB10/i.test(y)},u.blackberry.api=["not"],u.desktop=function(){return u.not.mobile()&&u.not.tablet()},u.desktop.api=["not"],u.linux=function(){return/linux/i.test(v)},u.linux.api=["not"],u.mac=function(){return/mac/i.test(v)},u.mac.api=["not"],u.windows=function(){return/win/i.test(v)},u.windows.api=["not"],u.windowsPhone=function(){return u.windows()&&/phone/i.test(y)},u.windowsPhone.api=["not"],u.windowsTablet=function(){return u.windows()&&u.not.windowsPhone()&&/touch/i.test(y)},u.windowsTablet.api=["not"],u.mobile=function(){return u.iphone()||u.ipod()||u.androidPhone()||u.blackberry()||u.windowsPhone()},u.mobile.api=["not"],u.tablet=function(){return u.ipad()||u.androidTablet()||u.windowsTablet()},u.tablet.api=["not"],u.online=function(){return navigator.onLine},u.online.api=["not"],u.offline=t(u.online),u.offline.api=["not"],u.touchDevice=function(){return"ontouchstart"in window||"DocumentTouch"in window&&document instanceof DocumentTouch},u.touchDevice.api=["not"]}return u.propertyCount=function(e,t){if(!u.object(e)||!u.number(t))return!1;if(Object.keys)return Object.keys(e).length===t;var n,r=[];for(n in e)l.call(e,n)&&r.push(n);return r.length===t},u.propertyCount.api=["not"],u.propertyDefined=function(e,t){return u.object(e)&&u.string(t)&&t in e},u.propertyDefined.api=["not"],u.windowObject=function(e){return"object"==typeof e&&"setInterval"in e},u.domNode=function(e){return u.object(e)&&e.nodeType>0},u.inArray=function(e,t){if(u.not.array(t))return!1;for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1},u.inArray.api=["not"],u.sorted=function(e){if(u.not.array(e))return!1;for(var t=0;t<e.length;t++)if(e[t]>e[t+1])return!1;return!0},o(),u.setRegexp=function(e,t){for(var n in h)l.call(h,n)&&t===n&&(h[n]=e)},u.setNamespace=function(){return s.is=a,this},u})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],106:[function(e,t,n){var r=e("jquery");!function(e){function t(t,r){var i,o,s,a=t.nodeName.toLowerCase();return"area"===a?(i=t.parentNode,o=i.name,!(!t.href||!o||"map"!==i.nodeName.toLowerCase())&&(s=e("img[usemap='#"+o+"']")[0],!!s&&n(s))):(/^(input|select|textarea|button|object)$/.test(a)?!t.disabled:"a"===a?t.href||r:r)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var n=this.css("position"),r="absolute"===n,i=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return(!r||"static"!==t.css("position"))&&i.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==n&&o.length?o:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(n){return t(n,!isNaN(e.attr(n,"tabindex")))},tabbable:function(n){var r=e.attr(n,"tabindex"),i=isNaN(r);return(i||r>=0)&&t(n,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function r(t,n,r,o){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return void 0===t?s["inner"+n].call(this):this.each(function(){e(this).css(o,r(this,t)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?s["outer"+n].call(this,t):this.each(function(){e(this).css(o,r(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var n,r,i=e(this[0]);i.length&&i[0]!==document;){if(n=i.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(i.css("zIndex"),10),!isNaN(r)&&0!==r))return r;i=i.parent()}return 0}}),e.ui.plugin={add:function(t,n,r){var i,o=e.ui[t].prototype;for(i in r)o.plugins[i]=o.plugins[i]||[],o.plugins[i].push([n,r[i]])},call:function(e,t,n,r){var i,o=e.plugins[t];if(o&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(i=0;i<o.length;i++)e.options[o[i][0]]&&o[i][1].apply(e.element,n)}}}(r)},{jquery:111}],107:[function(e,t,n){var r=e("jquery");e("./core"),e("./mouse"),e("./widget"),function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,
revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var n=this.options;return this._blurActiveElement(t),!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blockFrames(n.iframeFix===!0?"iframe":n.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var n=this.document[0];if(this.handleElement.is(t.target))try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()&&e(n.activeElement).blur()}catch(r){}},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper),i=r?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r&&i[0]===this.element[0]&&this._setPositionRelative(),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options,o=this.document[0];return this.relativeContainer=null,i.containment?"window"===i.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===i.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):i.containment.constructor===Array?void(this.containment=i.containment):("parent"===i.containment&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0],void(r&&(t=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,i,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),u=e.pageX,c=e.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(r=this.relativeContainer.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(u=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(u=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),s.grid&&(i=s.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,c=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-s.grid[1]:i+s.grid[1]:i,o=s.grid[0]?this.originalPageX+Math.round((u-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,u=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o),"y"===s.axis&&(u=this.originalPageX),"x"===s.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:u-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),r.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,r){var i=e.extend({},n,{item:r.element});r.sortables=[],e(r.options.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(r.sortables.push(n),n.refreshPositions(),n._trigger("activate",t,i))})},stop:function(t,n,r){var i=e.extend({},n,{item:r.element});r.cancelHelperRemoval=!1,e.each(r.sortables,function(){var e=this;e.isOver?(e.isOver=0,r.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,i))})},drag:function(t,n,r){e.each(r.sortables,function(){var i=!1,o=this;o.positionAbs=r.positionAbs,o.helperProportions=r.helperProportions,o.offset.click=r.offset.click,o._intersectsWith(o.containerCache)&&(i=!0,e.each(r.sortables,function(){return this.positionAbs=r.positionAbs,this.helperProportions=r.helperProportions,this.offset.click=r.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(i=!1),i})),i?(o.isOver||(o.isOver=1,r._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=r.offset.click.top,o.offset.click.left=r.offset.click.left,o.offset.parent.left-=r.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=r.offset.parent.top-o.offset.parent.top,r._trigger("toSortable",t),r.dropped=o.element,e.each(r.sortables,function(){this.refreshPositions()}),r.currentItem=r.element,o.fromOutside=r),o.currentItem&&(o._mouseDrag(t),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(r._parent),r._refreshOffsets(t),n.position=r._generatePosition(t,!0),r._trigger("fromSortable",t),r.dropped=!1,e.each(r.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,r){var i=e("body"),o=r.options;i.css("cursor")&&(o._cursor=i.css("cursor")),i.css("cursor",o.cursor)},stop:function(t,n,r){var i=r.options;i._cursor&&e("body").css("cursor",i._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,r){var i=e(n.helper),o=r.options;i.css("opacity")&&(o._opacity=i.css("opacity")),i.css("opacity",o.opacity)},stop:function(t,n,r){var i=r.options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(t,n,r){var i=r.options,o=!1,s=r.scrollParentNotHidden[0],a=r.document[0];s!==a&&"HTML"!==s.tagName?(i.axis&&"x"===i.axis||(r.overflowOffset.top+s.offsetHeight-t.pageY<i.scrollSensitivity?s.scrollTop=o=s.scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(s.scrollTop=o=s.scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(r.overflowOffset.left+s.offsetWidth-t.pageX<i.scrollSensitivity?s.scrollLeft=o=s.scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(s.scrollLeft=o=s.scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(a).scrollTop()<i.scrollSensitivity?o=e(a).scrollTop(e(a).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(a).scrollTop())<i.scrollSensitivity&&(o=e(a).scrollTop(e(a).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(a).scrollLeft()<i.scrollSensitivity?o=e(a).scrollLeft(e(a).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(a).scrollLeft())<i.scrollSensitivity&&(o=e(a).scrollLeft(e(a).scrollLeft()+i.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,r){var i=r.options;r.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!==r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,r){var i,o,s,a,u,c,f,l,h,p,d=r.options,g=d.snapTolerance,y=n.offset.left,m=y+r.helperProportions.width,v=n.offset.top,b=v+r.helperProportions.height;for(h=r.snapElements.length-1;h>=0;h--)u=r.snapElements[h].left-r.margins.left,c=u+r.snapElements[h].width,f=r.snapElements[h].top-r.margins.top,l=f+r.snapElements[h].height,m<u-g||y>c+g||b<f-g||v>l+g||!e.contains(r.snapElements[h].item.ownerDocument,r.snapElements[h].item)?(r.snapElements[h].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[h].item})),r.snapElements[h].snapping=!1):("inner"!==d.snapMode&&(i=Math.abs(f-b)<=g,o=Math.abs(l-v)<=g,s=Math.abs(u-m)<=g,a=Math.abs(c-y)<=g,i&&(n.position.top=r._convertPositionTo("relative",{top:f-r.helperProportions.height,left:0}).top),o&&(n.position.top=r._convertPositionTo("relative",{top:l,left:0}).top),s&&(n.position.left=r._convertPositionTo("relative",{top:0,left:u-r.helperProportions.width}).left),a&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c}).left)),p=i||o||s||a,"outer"!==d.snapMode&&(i=Math.abs(f-v)<=g,o=Math.abs(l-b)<=g,s=Math.abs(u-y)<=g,a=Math.abs(c-m)<=g,i&&(n.position.top=r._convertPositionTo("relative",{top:f,left:0}).top),o&&(n.position.top=r._convertPositionTo("relative",{top:l-r.helperProportions.height,left:0}).top),s&&(n.position.left=r._convertPositionTo("relative",{top:0,left:u}).left),a&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left)),!r.snapElements[h].snapping&&(i||o||s||a||p)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[h].item})),r.snapElements[h].snapping=i||o||s||a||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,r){var i,o=r.options,s=e.makeArray(e(o.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});s.length&&(i=parseInt(e(s[0]).css("zIndex"),10)||0,e(s).each(function(t){e(this).css("zIndex",i+t)}),this.css("zIndex",i+s.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,r){var i=e(n.helper),o=r.options;i.css("zIndex")&&(o._zIndex=i.css("zIndex")),i.css("zIndex",o.zIndex)},stop:function(t,n,r){var i=r.options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}}),e.ui.draggable}(r)},{"./core":106,"./mouse":108,"./widget":110,jquery:111}],108:[function(e,t,n){var r=e("jquery");e("./widget"),function(e){var t=!1;return e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var r=this,i=1===n.which,o=!("string"!=typeof this.options.cancel||!n.target.nodeName)&&e(n.target).closest(this.options.cancel).length;return!(i&&!o&&this._mouseCapture(n))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(n){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(r)},{"./widget":110,jquery:111}],109:[function(e,t,n){var r=e("jquery");e("./core"),e("./mouse"),e("./widget"),function(e){return e.widget("ui.resizable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0||(t[r]=1,i=t[r]>0,t[r]=0,i)},_create:function(){var t,n,r,i,o,s=this,a=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},n=0;n<t.length;n++)r=e.trim(t[n]),o="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+o+"'></div>"),i.css({zIndex:a.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i);this._renderAxis=function(t){var n,r,i,o;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String?this.handles[n]=this.element.children(this.handles[n]).first().show():(this.handles[n].jquery||this.handles[n].nodeType)&&(this.handles[n]=e(this.handles[n]),this._on(this.handles[n],{mousedown:s._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(r=e(this.handles[n],this.element),o=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[n])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){s.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=i&&i[1]?i[1]:"se")}),a.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(e(this).removeClass("ui-resizable-autohide"),s._handles.show())}).mouseleave(function(){a.disabled||s.resizing||(e(this).addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles)r=e(this.handles[n])[0],(r===t.target||e.contains(r,t.target))&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(t){var n,r,i,o=this.options,s=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),r=this._num(this.helper.css("top")),o.containment&&(n+=e(o.containment).scrollLeft()||0,r+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:r},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalPosition={left:n,top:r},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,i=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===i?this.axis+"-resize":i),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r,i=this.originalMousePosition,o=this.axis,s=t.pageX-i.left||0,a=t.pageY-i.top||0,u=this._change[o];return this._updatePrevProperties(),!!u&&(n=u.apply(this,[t,s,a]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),r=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(r)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1)},_mouseStop:function(t){this.resizing=!1;var n,r,i,o,s,a,u,c=this.options,f=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&this._hasScroll(n[0],"left")?0:f.sizeDiff.height,o=r?0:f.sizeDiff.width,s={width:f.helper.width()-o,height:f.helper.height()-i},a=parseInt(f.element.css("left"),10)+(f.position.left-f.originalPosition.left)||null,u=parseInt(f.element.css("top"),10)+(f.position.top-f.originalPosition.top)||null,c.animate||this.element.css(e.extend(s,{top:u,left:a})),f.helper.height(f.size.height),f.helper.width(f.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,n,r,i,o,s=this.options;o={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:1/0,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,r=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,i=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),r>o.minHeight&&(o.minHeight=r),n<o.maxWidth&&(o.maxWidth=n),i<o.maxHeight&&(o.maxHeight=i)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,r=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===r&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===r&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,r=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,i=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,s=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,u=this.position.top+this.size.height,c=/sw|nw|w/.test(n),f=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),s&&(e.height=t.minHeight),r&&(e.width=t.maxWidth),i&&(e.height=t.maxHeight),o&&c&&(e.left=a-t.minWidth),r&&c&&(e.left=a-t.maxWidth),s&&f&&(e.top=u-t.minHeight),i&&f&&(e.top=u-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,n=[],r=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],i=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)n[t]=parseInt(r[t],10)||0,n[t]+=parseInt(i[t],10)||0;return{height:n[0]+n[2],width:n[1]+n[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,n=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:n.height()-this.outerDimensions.height||0,width:n.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",
zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).resizable("instance"),r=n.options,i=n._proportionallyResizeElements,o=i.length&&/textarea/i.test(i[0].nodeName),s=o&&n._hasScroll(i[0],"left")?0:n.sizeDiff.height,a=o?0:n.sizeDiff.width,u={width:n.size.width-a,height:n.size.height-s},c=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,f=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(u,f&&c?{top:f,left:c}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,n,r,i,o,s,a,u=e(this).resizable("instance"),c=u.options,f=u.element,l=c.containment,h=l instanceof e?l.get(0):/parent/.test(l)?f.parent().get(0):l;h&&(u.containerElement=e(h),/document/.test(l)||l===document?(u.containerOffset={left:0,top:0},u.containerPosition={left:0,top:0},u.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(h),n=[],e(["Top","Right","Left","Bottom"]).each(function(e,r){n[e]=u._num(t.css("padding"+r))}),u.containerOffset=t.offset(),u.containerPosition=t.position(),u.containerSize={height:t.innerHeight()-n[3],width:t.innerWidth()-n[1]},r=u.containerOffset,i=u.containerSize.height,o=u.containerSize.width,s=u._hasScroll(h,"left")?h.scrollWidth:o,a=u._hasScroll(h)?h.scrollHeight:i,u.parentData={element:h,left:r.left,top:r.top,width:s,height:a}))},resize:function(t){var n,r,i,o,s=e(this).resizable("instance"),a=s.options,u=s.containerOffset,c=s.position,f=s._aspectRatio||t.shiftKey,l={top:0,left:0},h=s.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(l=u),c.left<(s._helper?u.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-u.left:s.position.left-l.left),f&&(s.size.height=s.size.width/s.aspectRatio,p=!1),s.position.left=a.helper?u.left:0),c.top<(s._helper?u.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-u.top:s.position.top),f&&(s.size.width=s.size.height*s.aspectRatio,p=!1),s.position.top=s._helper?u.top:0),i=s.containerElement.get(0)===s.element.parent().get(0),o=/relative|absolute/.test(s.containerElement.css("position")),i&&o?(s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top):(s.offset.left=s.element.offset().left,s.offset.top=s.element.offset().top),n=Math.abs(s.sizeDiff.width+(s._helper?s.offset.left-l.left:s.offset.left-u.left)),r=Math.abs(s.sizeDiff.height+(s._helper?s.offset.top-l.top:s.offset.top-u.top)),n+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-n,f&&(s.size.height=s.size.width/s.aspectRatio,p=!1)),r+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-r,f&&(s.size.width=s.size.height*s.aspectRatio,p=!1)),p||(s.position.left=s.prevPosition.left,s.position.top=s.prevPosition.top,s.size.width=s.prevSize.width,s.size.height=s.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),n=t.options,r=t.containerOffset,i=t.containerPosition,o=t.containerElement,s=e(t.helper),a=s.offset(),u=s.outerWidth()-t.sizeDiff.width,c=s.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(o.css("position"))&&e(this).css({left:a.left-i.left-r.left,width:u,height:c}),t._helper&&!n.animate&&/static/.test(o.css("position"))&&e(this).css({left:a.left-i.left-r.left,width:u,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),n=t.options;e(n.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})},resize:function(t,n){var r=e(this).resizable("instance"),i=r.options,o=r.originalSize,s=r.originalPosition,a={height:r.size.height-o.height||0,width:r.size.width-o.width||0,top:r.position.top-s.top||0,left:r.position.left-s.left||0};e(i.alsoResize).each(function(){var t=e(this),r=e(this).data("ui-resizable-alsoresize"),i={},o=t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(r[t]||0)+(a[t]||0);n&&n>=0&&(i[t]=n||null)}),t.css(i)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,n=e(this).resizable("instance"),r=n.options,i=n.size,o=n.originalSize,s=n.originalPosition,a=n.axis,u="number"==typeof r.grid?[r.grid,r.grid]:r.grid,c=u[0]||1,f=u[1]||1,l=Math.round((i.width-o.width)/c)*c,h=Math.round((i.height-o.height)/f)*f,p=o.width+l,d=o.height+h,g=r.maxWidth&&r.maxWidth<p,y=r.maxHeight&&r.maxHeight<d,m=r.minWidth&&r.minWidth>p,v=r.minHeight&&r.minHeight>d;r.grid=u,m&&(p+=c),v&&(d+=f),g&&(p-=c),y&&(d-=f),/^(se|s|e)$/.test(a)?(n.size.width=p,n.size.height=d):/^(ne)$/.test(a)?(n.size.width=p,n.size.height=d,n.position.top=s.top-h):/^(sw)$/.test(a)?(n.size.width=p,n.size.height=d,n.position.left=s.left-l):((d-f<=0||p-c<=0)&&(t=n._getPaddingPlusBorderDimensions(this)),d-f>0?(n.size.height=d,n.position.top=s.top-h):(d=f-t.height,n.size.height=d,n.position.top=s.top+o.height-d),p-c>0?(n.size.width=p,n.position.left=s.left-l):(p=c-t.width,n.size.width=p,n.position.left=s.left+o.width-p))}}),e.ui.resizable}(r)},{"./core":106,"./mouse":108,"./widget":110,jquery:111}],110:[function(e,t,n){var r=e("jquery");!function(e){var t=0,n=Array.prototype.slice;return e.cleanData=function(t){return function(n){var r,i,o;for(o=0;null!=(i=n[o]);o++)try{r=e._data(i,"events"),r&&r.remove&&e(i).triggerHandler("remove")}catch(s){}t(n)}}(e.cleanData),e.widget=function(t,n,r){var i,o,s,a,u={},c=t.split(".")[0];return t=t.split(".")[1],i=c+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[c]=e[c]||{},o=e[c][t],s=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),a=new n,a.options=e.widget.extend({},a.options),e.each(r,function(t,r){return e.isFunction(r)?void(u[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=i,t=r.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(u[t]=r)}),s.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||t:t},u,{constructor:s,namespace:c,widgetName:t,widgetFullName:i}),o?(e.each(o._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,s,n._proto)}),delete o._childConstructors):n._childConstructors.push(s),e.widget.bridge(t,s),s},e.widget.extend=function(t){for(var r,i,o=n.call(arguments,1),s=0,a=o.length;s<a;s++)for(r in o[s])i=o[s][r],o[s].hasOwnProperty(r)&&void 0!==i&&(e.isPlainObject(i)?t[r]=e.isPlainObject(t[r])?e.widget.extend({},t[r],i):e.widget.extend({},i):t[r]=i);return t},e.widget.bridge=function(t,r){var i=r.prototype.widgetFullName||t;e.fn[t]=function(o){var s="string"==typeof o,a=n.call(arguments,1),u=this;return s?this.each(function(){var n,r=e.data(this,i);return"instance"===o?(u=r,!1):r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,a),n!==r&&void 0!==n?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):(a.length&&(o=e.widget.extend.apply(null,[o].concat(a))),this.each(function(){var t=e.data(this,i);t?(t.option(o||{}),t._init&&t._init()):e.data(this,i,new r(o,this))})),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(n,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var r,i,o,s=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(s={},r=t.split("."),t=r.shift(),r.length){for(i=s[t]=e.widget.extend({},this.options[t]),o=0;o<r.length-1;o++)i[r[o]]=i[r[o]]||{},i=i[r[o]];if(t=r.pop(),1===arguments.length)return void 0===i[t]?null:i[t];i[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];s[t]=n}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,n,r){var i,o=this;"boolean"!=typeof t&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,s){function a(){if(t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof s?o[s]:s).apply(o,arguments)}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var u=r.match(/^([\w:-]*)\s*(.*)$/),c=u[1]+o.eventNamespace,f=u[2];f?i.delegate(f,c,a):n.bind(c,a)})},_off:function(t,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(n).undelegate(n),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,o,s=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(i in o)i in n||(n[i]=o[i]);return this.element.trigger(n,r),!(e.isFunction(s)&&s.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,o){"string"==typeof i&&(i={effect:i});var s,a=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),s=!e.isEmptyObject(i),i.complete=o,i.delay&&r.delay(i.delay),s&&e.effects&&e.effects.effect[a]?r[t](i):a!==t&&r[a]?r[a](i.duration,i.easing,o):r.queue(function(n){e(this)[t](),o&&o.call(r[0]),n()})}}),e.widget}(r)},{jquery:111}],111:[function(e,t,n){!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function n(e,t){t=t||te;var n=t.createElement("script");n.text=e,t.head.appendChild(n).parentNode.removeChild(n)}function r(e){var t=!!e&&"length"in e&&e.length,n=de.type(e);return"function"!==n&&!de.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e,t,n){return de.isFunction(t)?de.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?de.grep(e,function(e){return e===t!==n}):"string"!=typeof t?de.grep(e,function(e){return se.call(t,e)>-1!==n}):ke.test(t)?de.filter(t,e,n):(t=de.filter(t,e),de.grep(e,function(e){return se.call(t,e)>-1!==n&&1===e.nodeType}))}function o(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function s(e){var t={};return de.each(e.match(Te)||[],function(e,n){t[n]=!0}),t}function a(e){return e}function u(e){throw e}function c(e,t,n){var r;try{e&&de.isFunction(r=e.promise)?r.call(e).done(t).fail(n):e&&de.isFunction(r=e.then)?r.call(e,t,n):t.call(void 0,e)}catch(e){n.call(void 0,e)}}function f(){te.removeEventListener("DOMContentLoaded",f),e.removeEventListener("load",f),de.ready()}function l(){this.expando=de.expando+l.uid++}function h(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Le.test(e)?JSON.parse(e):e)}function p(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(Fe,"-$&").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n=h(n)}catch(i){}Ne.set(e,t,n)}else n=void 0;return n}function d(e,t,n,r){var i,o=1,s=20,a=r?function(){return r.cur()}:function(){return de.css(e,t,"")},u=a(),c=n&&n[3]||(de.cssNumber[t]?"":"px"),f=(de.cssNumber[t]||"px"!==c&&+u)&&je.exec(de.css(e,t));if(f&&f[3]!==c){c=c||f[3],n=n||[],f=+u||1;do o=o||".5",f/=o,de.style(e,t,f+c);while(o!==(o=a()/u)&&1!==o&&--s)}return n&&(f=+f||+u||0,i=n[1]?f+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=f,r.end=i)),i}function g(e){var t,n=e.ownerDocument,r=e.nodeName,i=qe[r];return i?i:(t=n.body.appendChild(n.createElement(r)),i=de.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),qe[r]=i,i)}function y(e,t){for(var n,r,i=[],o=0,s=e.length;o<s;o++)r=e[o],r.style&&(n=r.style.display,t?("none"===n&&(i[o]=De.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&Ke(r)&&(i[o]=g(r))):"none"!==n&&(i[o]="none",De.set(r,"display",n)));for(o=0;o<s;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}function m(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&de.nodeName(e,t)?de.merge([e],n):n}function v(e,t){for(var n=0,r=e.length;n<r;n++)De.set(e[n],"globalEval",!t||De.get(t[n],"globalEval"))}function b(e,t,n,r,i){for(var o,s,a,u,c,f,l=t.createDocumentFragment(),h=[],p=0,d=e.length;p<d;p++)if(o=e[p],o||0===o)if("object"===de.type(o))de.merge(h,o.nodeType?[o]:o);else if(Xe.test(o)){for(s=s||l.appendChild(t.createElement("div")),a=(We.exec(o)||["",""])[1].toLowerCase(),u=Ye[a]||Ye._default,s.innerHTML=u[1]+de.htmlPrefilter(o)+u[2],f=u[0];f--;)s=s.lastChild;de.merge(h,s.childNodes),s=l.firstChild,s.textContent=""}else h.push(t.createTextNode(o));for(l.textContent="",p=0;o=h[p++];)if(r&&de.inArray(o,r)>-1)i&&i.push(o);else if(c=de.contains(o.ownerDocument,o),s=m(l.appendChild(o),"script"),c&&v(s),n)for(f=0;o=s[f++];)Ge.test(o.type||"")&&n.push(o);return l}function w(){return!0}function E(){return!1}function _(){try{return te.activeElement}catch(e){}}function S(e,t,n,r,i,o){var s,a;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(a in t)S(e,a,n,r,t[a],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),i===!1)i=E;else if(!i)return e;return 1===o&&(s=i,i=function(e){return de().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=de.guid++)),e.each(function(){de.event.add(this,t,i,r,n)})}function k(e,t){return de.nodeName(e,"table")&&de.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e:e}function C(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function x(e){var t=rt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function I(e,t){var n,r,i,o,s,a,u,c;if(1===t.nodeType){if(De.hasData(e)&&(o=De.access(e),s=De.set(t,o),c=o.events)){delete s.handle,s.events={};for(i in c)for(n=0,r=c[i].length;n<r;n++)de.event.add(t,i,c[i][n])}Ne.hasData(e)&&(a=Ne.access(e),u=de.extend({},a),Ne.set(t,u))}}function A(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ve.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function P(e,t,r,i){t=ie.apply([],t);var o,s,a,u,c,f,l=0,h=e.length,p=h-1,d=t[0],g=de.isFunction(d);if(g||h>1&&"string"==typeof d&&!he.checkClone&&nt.test(d))return e.each(function(n){var o=e.eq(n);g&&(t[0]=d.call(this,n,o.html())),P(o,t,r,i)});if(h&&(o=b(t,e[0].ownerDocument,!1,e,i),s=o.firstChild,1===o.childNodes.length&&(o=s),s||i)){for(a=de.map(m(o,"script"),C),u=a.length;l<h;l++)c=o,l!==p&&(c=de.clone(c,!0,!0),u&&de.merge(a,m(c,"script"))),r.call(e[l],c,l);if(u)for(f=a[a.length-1].ownerDocument,de.map(a,x),l=0;l<u;l++)c=a[l],Ge.test(c.type||"")&&!De.access(c,"globalEval")&&de.contains(f,c)&&(c.src?de._evalUrl&&de._evalUrl(c.src):n(c.textContent.replace(it,""),f))}return e}function T(e,t,n){for(var r,i=t?de.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||de.cleanData(m(r)),r.parentNode&&(n&&de.contains(r.ownerDocument,r)&&v(m(r,"script")),r.parentNode.removeChild(r));return e}function M(e,t,n){var r,i,o,s,a=e.style;return n=n||at(e),n&&(s=n.getPropertyValue(t)||n[t],""!==s||de.contains(e.ownerDocument,e)||(s=de.style(e,t)),!he.pixelMarginRight()&&st.test(s)&&ot.test(t)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function R(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function O(e){if(e in ht)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=lt.length;n--;)if(e=lt[n]+t,e in ht)return e}function B(e,t,n){var r=je.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function D(e,t,n,r,i){var o,s=0;for(o=n===(r?"border":"content")?4:"width"===t?1:0;o<4;o+=2)"margin"===n&&(s+=de.css(e,n+ze[o],!0,i)),r?("content"===n&&(s-=de.css(e,"padding"+ze[o],!0,i)),"margin"!==n&&(s-=de.css(e,"border"+ze[o]+"Width",!0,i))):(s+=de.css(e,"padding"+ze[o],!0,i),"padding"!==n&&(s+=de.css(e,"border"+ze[o]+"Width",!0,i)));return s}function N(e,t,n){var r,i=!0,o=at(e),s="border-box"===de.css(e,"boxSizing",!1,o);if(e.getClientRects().length&&(r=e.getBoundingClientRect()[t]),r<=0||null==r){if(r=M(e,t,o),(r<0||null==r)&&(r=e.style[t]),st.test(r))return r;i=s&&(he.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+D(e,t,n||(s?"border":"content"),i,o)+"px"}function L(e,t,n,r,i){return new L.prototype.init(e,t,n,r,i)}function F(){dt&&(e.requestAnimationFrame(F),de.fx.tick())}function U(){return e.setTimeout(function(){pt=void 0}),pt=de.now()}function j(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)n=ze[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function z(e,t,n){for(var r,i=(q.tweeners[t]||[]).concat(q.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function K(e,t,n){var r,i,o,s,a,u,c,f,l="width"in t||"height"in t,h=this,p={},d=e.style,g=e.nodeType&&Ke(e),m=De.get(e,"fxshow");n.queue||(s=de._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,de.queue(e,"fx").length||s.empty.fire()})}));for(r in t)if(i=t[r],gt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}p[r]=m&&m[r]||de.style(e,r)}if(u=!de.isEmptyObject(t),u||!de.isEmptyObject(p)){l&&1===e.nodeType&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],c=m&&m.display,null==c&&(c=De.get(e,"display")),f=de.css(e,"display"),"none"===f&&(c?f=c:(y([e],!0),c=e.style.display||c,f=de.css(e,"display"),y([e]))),("inline"===f||"inline-block"===f&&null!=c)&&"none"===de.css(e,"float")&&(u||(h.done(function(){d.display=c}),null==c&&(f=d.display,c="none"===f?"":f)),d.display="inline-block")),n.overflow&&(d.overflow="hidden",h.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),u=!1;for(r in p)u||(m?"hidden"in m&&(g=m.hidden):m=De.access(e,"fxshow",{display:c}),o&&(m.hidden=!g),g&&y([e],!0),h.done(function(){g||y([e]),De.remove(e,"fxshow");for(r in p)de.style(e,r,p[r])})),u=z(g?m[r]:0,r,h),r in m||(m[r]=u.start,g&&(u.end=u.start,u.start=0))}}function H(e,t){var n,r,i,o,s;for(n in e)if(r=de.camelCase(n),i=t[r],o=e[n],de.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=de.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function q(e,t,n){var r,i,o=0,s=q.prefilters.length,a=de.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=pt||U(),n=Math.max(0,c.startTime+c.duration-t),r=n/c.duration||0,o=1-r,s=0,u=c.tweens.length;s<u;s++)c.tweens[s].run(o);return a.notifyWith(e,[c,o,n]),o<1&&u?n:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:de.extend({},t),opts:de.extend(!0,{specialEasing:{},easing:de.easing._default},n),originalProperties:t,originalOptions:n,startTime:pt||U(),duration:n.duration,tweens:[],createTween:function(t,n){var r=de.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(r),r},stop:function(t){var n=0,r=t?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),f=c.props;for(H(f,c.opts.specialEasing);o<s;o++)if(r=q.prefilters[o].call(c,e,f,c.opts))return de.isFunction(r.stop)&&(de._queueHooks(c.elem,c.opts.queue).stop=de.proxy(r.stop,r)),r;return de.map(f,z,c),de.isFunction(c.opts.start)&&c.opts.start.call(e,c),de.fx.timer(de.extend(u,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function V(e){var t=e.match(Te)||[];return t.join(" ")}function W(e){return e.getAttribute&&e.getAttribute("class")||""}function G(e,t,n,r){var i;if(de.isArray(t))de.each(t,function(t,i){n||xt.test(e)?r(e,i):G(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==de.type(t))r(e,t);else for(i in t)G(e+"["+i+"]",t[i],n,r)}function Y(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(Te)||[];if(de.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function X(e,t,n,r){function i(a){var u;return o[a]=!0,de.each(e[a]||[],function(e,a){var c=a(t,n,r);return"string"!=typeof c||s||o[c]?s?!(u=c):void 0:(t.dataTypes.unshift(c),i(c),!1)}),u}var o={},s=e===Ft;return i(t.dataTypes[0])||!o["*"]&&i("*")}function $(e,t){var n,r,i=de.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&de.extend(!0,e,r),e}function J(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}if(o)return o!==u[0]&&u.unshift(o),n[o]}function Q(e,t,n,r){var i,o,s,a,u,c={},f=e.dataTypes.slice();if(f[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=f.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=f.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=c[u+" "+o]||c["* "+o],!s)for(i in c)if(a=i.split(" "),a[1]===o&&(s=c[u+" "+a[0]]||c["* "+a[0]])){s===!0?s=c[i]:c[i]!==!0&&(o=a[0],f.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(l){return{state:"parsererror",error:s?l:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}function Z(e){return de.isWindow(e)?e:9===e.nodeType&&e.defaultView}var ee=[],te=e.document,ne=Object.getPrototypeOf,re=ee.slice,ie=ee.concat,oe=ee.push,se=ee.indexOf,ae={},ue=ae.toString,ce=ae.hasOwnProperty,fe=ce.toString,le=fe.call(Object),he={},pe="3.1.1",de=function(e,t){return new de.fn.init(e,t)},ge=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ye=/^-ms-/,me=/-([a-z])/g,ve=function(e,t){return t.toUpperCase()};de.fn=de.prototype={jquery:pe,constructor:de,length:0,toArray:function(){return re.call(this)},get:function(e){return null==e?re.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=de.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return de.each(this,e)},map:function(e){return this.pushStack(de.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(re.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:oe,sort:ee.sort,splice:ee.splice},de.extend=de.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||de.isFunction(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(c&&r&&(de.isPlainObject(r)||(i=de.isArray(r)))?(i?(i=!1,o=n&&de.isArray(n)?n:[]):o=n&&de.isPlainObject(n)?n:{},s[t]=de.extend(c,o,r)):void 0!==r&&(s[t]=r));return s},de.extend({expando:"jQuery"+(pe+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===de.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=de.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==ue.call(e))&&(!(t=ne(e))||(n=ce.call(t,"constructor")&&t.constructor,"function"==typeof n&&fe.call(n)===le))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?ae[ue.call(e)]||"object":typeof e},globalEval:function(e){n(e)},camelCase:function(e){return e.replace(ye,"ms-").replace(me,ve)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,i=0;if(r(e))for(n=e.length;i<n&&t.call(e[i],i,e[i])!==!1;i++);else for(i in e)if(t.call(e[i],i,e[i])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ge,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(r(Object(e))?de.merge(n,"string"==typeof e?[e]:e):oe.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:se.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,s=e.length,a=!n;o<s;o++)r=!t(e[o],o),r!==a&&i.push(e[o]);return i},map:function(e,t,n){var i,o,s=0,a=[];if(r(e))for(i=e.length;s<i;s++)o=t(e[s],s,n),null!=o&&a.push(o);else for(s in e)o=t(e[s],s,n),null!=o&&a.push(o);return ie.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),de.isFunction(e))return r=re.call(arguments,2),i=function(){return e.apply(t||this,r.concat(re.call(arguments)))},i.guid=e.guid=e.guid||de.guid++,i},now:Date.now,support:he}),"function"==typeof Symbol&&(de.fn[Symbol.iterator]=ee[Symbol.iterator]),de.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){ae["[object "+t+"]"]=t.toLowerCase()});var be=function(e){function t(e,t,n,r){var i,o,s,a,u,c,f,h=t&&t.ownerDocument,d=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==d&&9!==d&&11!==d)return n;if(!r&&((t?t.ownerDocument||t:z)!==O&&R(t),t=t||O,D)){if(11!==d&&(u=me.exec(e)))if(i=u[1]){if(9===d){if(!(s=t.getElementById(i)))return n;if(s.id===i)return n.push(s),n}else if(h&&(s=h.getElementById(i))&&U(t,s)&&s.id===i)return n.push(s),n}else{if(u[2])return Q.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&_.getElementsByClassName&&t.getElementsByClassName)return Q.apply(n,t.getElementsByClassName(i)),n}if(_.qsa&&!W[e+" "]&&(!N||!N.test(e))){if(1!==d)h=t,f=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(Ee,_e):t.setAttribute("id",a=j),c=x(e),o=c.length;o--;)c[o]="#"+a+" "+p(c[o]);f=c.join(","),h=ve.test(e)&&l(t.parentNode)||t}if(f)try{return Q.apply(n,h.querySelectorAll(f)),n}catch(g){}finally{a===j&&t.removeAttribute("id")}}}return A(e.replace(ae,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>S.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[j]=!0,e}function i(e){var t=O.createElement("fieldset");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=n.length;r--;)S.attrHandle[n[r]]=t}function s(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function u(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ke(t)===e:t.disabled===e:"label"in t&&t.disabled===e;
}}function f(e){return r(function(t){return t=+t,r(function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}function l(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function h(){}function p(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,i=t.next,o=i||r,s=n&&"parentNode"===o,a=H++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||s)return e(t,n,i);return!1}:function(t,n,u){var c,f,l,h=[K,a];if(u){for(;t=t[r];)if((1===t.nodeType||s)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||s)if(l=t[j]||(t[j]={}),f=l[t.uniqueID]||(l[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=f[o])&&c[0]===K&&c[1]===a)return h[2]=c[2];if(f[o]=h,h[2]=e(t,n,u))return!0}return!1}}function g(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function y(e,n,r){for(var i=0,o=n.length;i<o;i++)t(e,n[i],r);return r}function m(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,c=null!=t;a<u;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),c&&t.push(a)));return s}function v(e,t,n,i,o,s){return i&&!i[j]&&(i=v(i)),o&&!o[j]&&(o=v(o,s)),r(function(r,s,a,u){var c,f,l,h=[],p=[],d=s.length,g=r||y(t||"*",a.nodeType?[a]:a,[]),v=!e||!r&&t?g:m(g,h,e,a,u),b=n?o||(r?e:d||i)?[]:s:v;if(n&&n(v,b,a,u),i)for(c=m(b,p),i(c,[],a,u),f=c.length;f--;)(l=c[f])&&(b[p[f]]=!(v[p[f]]=l));if(r){if(o||e){if(o){for(c=[],f=b.length;f--;)(l=b[f])&&c.push(v[f]=l);o(null,b=[],c,u)}for(f=b.length;f--;)(l=b[f])&&(c=o?ee(r,l):h[f])>-1&&(r[c]=!(s[c]=l))}}else b=m(b===s?b.splice(d,b.length):b),o?o(null,s,b,u):Q.apply(s,b)})}function b(e){for(var t,n,r,i=e.length,o=S.relative[e[0].type],s=o||S.relative[" "],a=o?1:0,u=d(function(e){return e===t},s,!0),c=d(function(e){return ee(t,e)>-1},s,!0),f=[function(e,n,r){var i=!o&&(r||n!==P)||((t=n).nodeType?u(e,n,r):c(e,n,r));return t=null,i}];a<i;a++)if(n=S.relative[e[a].type])f=[d(g(f),n)];else{if(n=S.filter[e[a].type].apply(null,e[a].matches),n[j]){for(r=++a;r<i&&!S.relative[e[r].type];r++);return v(a>1&&g(f),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ae,"$1"),n,a<r&&b(e.slice(a,r)),r<i&&b(e=e.slice(r)),r<i&&p(e))}f.push(n)}return g(f)}function w(e,n){var i=n.length>0,o=e.length>0,s=function(r,s,a,u,c){var f,l,h,p=0,d="0",g=r&&[],y=[],v=P,b=r||o&&S.find.TAG("*",c),w=K+=null==v?1:Math.random()||.1,E=b.length;for(c&&(P=s===O||s||c);d!==E&&null!=(f=b[d]);d++){if(o&&f){for(l=0,s||f.ownerDocument===O||(R(f),a=!D);h=e[l++];)if(h(f,s||O,a)){u.push(f);break}c&&(K=w)}i&&((f=!h&&f)&&p--,r&&g.push(f))}if(p+=d,i&&d!==p){for(l=0;h=n[l++];)h(g,y,s,a);if(r){if(p>0)for(;d--;)g[d]||y[d]||(y[d]=$.call(u));y=m(y)}Q.apply(u,y),c&&!r&&y.length>0&&p+n.length>1&&t.uniqueSort(u)}return c&&(K=w,P=v),g};return i?r(s):s}var E,_,S,k,C,x,I,A,P,T,M,R,O,B,D,N,L,F,U,j="sizzle"+1*new Date,z=e.document,K=0,H=0,q=n(),V=n(),W=n(),G=function(e,t){return e===t&&(M=!0),0},Y={}.hasOwnProperty,X=[],$=X.pop,J=X.push,Q=X.push,Z=X.slice,ee=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ie="\\["+ne+"*("+re+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ne+"*\\]",oe=":("+re+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ie+")*)|.*)\\)|)",se=new RegExp(ne+"+","g"),ae=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ue=new RegExp("^"+ne+"*,"+ne+"*"),ce=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),fe=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),le=new RegExp(oe),he=new RegExp("^"+re+"$"),pe={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re+"|[*])"),ATTR:new RegExp("^"+ie),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},de=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ye=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=/[+~]/,be=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),we=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},Ee=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,_e=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Se=function(){R()},ke=d(function(e){return e.disabled===!0&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{Q.apply(X=Z.call(z.childNodes),z.childNodes),X[z.childNodes.length].nodeType}catch(Ce){Q={apply:X.length?function(e,t){J.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}_=t.support={},C=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},R=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:z;return r!==O&&9===r.nodeType&&r.documentElement?(O=r,B=O.documentElement,D=!C(O),z!==O&&(n=O.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Se,!1):n.attachEvent&&n.attachEvent("onunload",Se)),_.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=i(function(e){return e.appendChild(O.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=ye.test(O.getElementsByClassName),_.getById=i(function(e){return B.appendChild(e).id=j,!O.getElementsByName||!O.getElementsByName(j).length}),_.getById?(S.filter.ID=function(e){var t=e.replace(be,we);return function(e){return e.getAttribute("id")===t}},S.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&D){var n=t.getElementById(e);return n?[n]:[]}}):(S.filter.ID=function(e){var t=e.replace(be,we);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},S.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&D){var n,r,i,o=t.getElementById(e);if(o){if(n=o.getAttributeNode("id"),n&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if(n=o.getAttributeNode("id"),n&&n.value===e)return[o]}return[]}}),S.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},S.find.CLASS=_.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&D)return t.getElementsByClassName(e)},L=[],N=[],(_.qsa=ye.test(O.querySelectorAll))&&(i(function(e){B.appendChild(e).innerHTML="<a id='"+j+"'></a><select id='"+j+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+j+"-]").length||N.push("~="),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+j+"+*").length||N.push(".#.+[+~]")}),i(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=O.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+ne+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&N.push(":enabled",":disabled"),B.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(_.matchesSelector=ye.test(F=B.matches||B.webkitMatchesSelector||B.mozMatchesSelector||B.oMatchesSelector||B.msMatchesSelector))&&i(function(e){_.disconnectedMatch=F.call(e,"*"),F.call(e,"[s!='']:x"),L.push("!=",oe)}),N=N.length&&new RegExp(N.join("|")),L=L.length&&new RegExp(L.join("|")),t=ye.test(B.compareDocumentPosition),U=t||ye.test(B.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},G=t?function(e,t){if(e===t)return M=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!_.sortDetached&&t.compareDocumentPosition(e)===n?e===O||e.ownerDocument===z&&U(z,e)?-1:t===O||t.ownerDocument===z&&U(z,t)?1:T?ee(T,e)-ee(T,t):0:4&n?-1:1)}:function(e,t){if(e===t)return M=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],u=[t];if(!i||!o)return e===O?-1:t===O?1:i?-1:o?1:T?ee(T,e)-ee(T,t):0;if(i===o)return s(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;a[r]===u[r];)r++;return r?s(a[r],u[r]):a[r]===z?-1:u[r]===z?1:0},O):O},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==O&&R(e),n=n.replace(fe,"='$1']"),_.matchesSelector&&D&&!W[n+" "]&&(!L||!L.test(n))&&(!N||!N.test(n)))try{var r=F.call(e,n);if(r||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return t(n,O,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==O&&R(e),U(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==O&&R(e);var n=S.attrHandle[t.toLowerCase()],r=n&&Y.call(S.attrHandle,t.toLowerCase())?n(e,t,!D):void 0;return void 0!==r?r:_.attributes||!D?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.escape=function(e){return(e+"").replace(Ee,_e)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,i=0;if(M=!_.detectDuplicates,T=!_.sortStable&&e.slice(0),e.sort(G),M){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return T=null,e},k=t.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=k(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=k(t);return n},S=t.selectors={cacheLength:50,createPseudo:r,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,we),e[3]=(e[3]||e[4]||e[5]||"").replace(be,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&le.test(n)&&(t=x(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(be,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=q[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&q(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(i){var o=t.attr(i,e);return null==o?"!="===n:!n||(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o.replace(se," ")+" ").indexOf(r)>-1:"|="===n&&(o===r||o.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var c,f,l,h,p,d,g=o!==s?"nextSibling":"previousSibling",y=t.parentNode,m=a&&t.nodeName.toLowerCase(),v=!u&&!a,b=!1;if(y){if(o){for(;g;){for(h=t;h=h[g];)if(a?h.nodeName.toLowerCase()===m:1===h.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?y.firstChild:y.lastChild],s&&v){for(h=y,l=h[j]||(h[j]={}),f=l[h.uniqueID]||(l[h.uniqueID]={}),c=f[e]||[],p=c[0]===K&&c[1],b=p&&c[2],h=p&&y.childNodes[p];h=++p&&h&&h[g]||(b=p=0)||d.pop();)if(1===h.nodeType&&++b&&h===t){f[e]=[K,p,b];break}}else if(v&&(h=t,l=h[j]||(h[j]={}),f=l[h.uniqueID]||(l[h.uniqueID]={}),c=f[e]||[],p=c[0]===K&&c[1],b=p),b===!1)for(;(h=++p&&h&&h[g]||(b=p=0)||d.pop())&&((a?h.nodeName.toLowerCase()!==m:1!==h.nodeType)||!++b||(v&&(l=h[j]||(h[j]={}),f=l[h.uniqueID]||(l[h.uniqueID]={}),f[e]=[K,b]),h!==t)););return b-=i,b===r||b%r===0&&b/r>=0}}},PSEUDO:function(e,n){var i,o=S.pseudos[e]||S.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[j]?o(n):o.length>1?(i=[e,e,"",n],S.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,i=o(e,n),s=i.length;s--;)r=ee(e,i[s]),e[r]=!(t[r]=i[s])}):function(e){return o(e,0,i)}):o}},pseudos:{not:r(function(e){var t=[],n=[],i=I(e.replace(ae,"$1"));return i[j]?r(function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(be,we),function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:r(function(e){return he.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(be,we).toLowerCase(),function(t){var n;do if(n=D?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===B},focus:function(e){return e===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:c(!1),disabled:c(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!S.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return de.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:f(function(){return[0]}),last:f(function(e,t){return[t-1]}),eq:f(function(e,t,n){return[n<0?n+t:n]}),even:f(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:f(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:f(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:f(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},S.pseudos.nth=S.pseudos.eq;for(E in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[E]=a(E);for(E in{submit:!0,reset:!0})S.pseudos[E]=u(E);return h.prototype=S.filters=S.pseudos,S.setFilters=new h,x=t.tokenize=function(e,n){var r,i,o,s,a,u,c,f=V[e+" "];if(f)return n?0:f.slice(0);for(a=e,u=[],c=S.preFilter;a;){r&&!(i=ue.exec(a))||(i&&(a=a.slice(i[0].length)||a),u.push(o=[])),r=!1,(i=ce.exec(a))&&(r=i.shift(),o.push({value:r,type:i[0].replace(ae," ")}),a=a.slice(r.length));for(s in S.filter)!(i=pe[s].exec(a))||c[s]&&!(i=c[s](i))||(r=i.shift(),o.push({value:r,type:s,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?t.error(e):V(e,u).slice(0)},I=t.compile=function(e,t){var n,r=[],i=[],o=W[e+" "];if(!o){for(t||(t=x(e)),n=t.length;n--;)o=b(t[n]),o[j]?r.push(o):i.push(o);o=W(e,w(i,r)),o.selector=e}return o},A=t.select=function(e,t,n,r){var i,o,s,a,u,c="function"==typeof e&&e,f=!r&&x(e=c.selector||e);if(n=n||[],1===f.length){if(o=f[0]=f[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&D&&S.relative[o[1].type]){if(t=(S.find.ID(s.matches[0].replace(be,we),t)||[])[0],!t)return n;c&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=pe.needsContext.test(e)?0:o.length;i--&&(s=o[i],!S.relative[a=s.type]);)if((u=S.find[a])&&(r=u(s.matches[0].replace(be,we),ve.test(o[0].type)&&l(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&p(o),!e)return Q.apply(n,r),n;break}}return(c||I(e,f))(r,t,!D,n,!t||ve.test(e)&&l(t.parentNode)||t),n},_.sortStable=j.split("").sort(G).join("")===j,_.detectDuplicates=!!M,R(),_.sortDetached=i(function(e){return 1&e.compareDocumentPosition(O.createElement("fieldset"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);de.find=be,de.expr=be.selectors,de.expr[":"]=de.expr.pseudos,de.uniqueSort=de.unique=be.uniqueSort,de.text=be.getText,de.isXMLDoc=be.isXML,de.contains=be.contains,de.escapeSelector=be.escape;var we=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&de(e).is(n))break;r.push(e)}return r},Ee=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},_e=de.expr.match.needsContext,Se=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,ke=/^.[^:#\[\.,]*$/;de.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?de.find.matchesSelector(r,e)?[r]:[]:de.find.matches(e,de.grep(t,function(e){return 1===e.nodeType}))},de.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(de(e).filter(function(){for(t=0;t<r;t++)if(de.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)de.find(e,i[t],n);return r>1?de.uniqueSort(n):n},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&_e.test(e)?de(e):e||[],!1).length}});var Ce,xe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Ie=de.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||Ce,"string"==typeof e){if(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:xe.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof de?t[0]:t,de.merge(this,de.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:te,!0)),Se.test(r[1])&&de.isPlainObject(t))for(r in t)de.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=te.getElementById(r[2]),i&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):de.isFunction(e)?void 0!==n.ready?n.ready(e):e(de):de.makeArray(e,this)};Ie.prototype=de.fn,Ce=de(te);var Ae=/^(?:parents|prev(?:Until|All))/,Pe={children:!0,contents:!0,next:!0,prev:!0};de.fn.extend({has:function(e){var t=de(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(de.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],s="string"!=typeof e&&de(e);if(!_e.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&de.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?de.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?se.call(de(e),this[0]):se.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(de.uniqueSort(de.merge(this.get(),de(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),de.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return we(e,"parentNode")},parentsUntil:function(e,t,n){return we(e,"parentNode",n)},next:function(e){return o(e,"nextSibling")},prev:function(e){return o(e,"previousSibling")},nextAll:function(e){return we(e,"nextSibling")},prevAll:function(e){return we(e,"previousSibling")},nextUntil:function(e,t,n){return we(e,"nextSibling",n)},prevUntil:function(e,t,n){return we(e,"previousSibling",n)},siblings:function(e){return Ee((e.parentNode||{}).firstChild,e)},children:function(e){return Ee(e.firstChild)},contents:function(e){return e.contentDocument||de.merge([],e.childNodes)}},function(e,t){de.fn[e]=function(n,r){var i=de.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=de.filter(r,i)),this.length>1&&(Pe[e]||de.uniqueSort(i),Ae.test(e)&&i.reverse()),this.pushStack(i)}});var Te=/[^\x20\t\r\n\f]+/g;de.Callbacks=function(e){e="string"==typeof e?s(e):de.extend({},e);var t,n,r,i,o=[],a=[],u=-1,c=function(){for(i=e.once,r=t=!0;a.length;u=-1)for(n=a.shift();++u<o.length;)o[u].apply(n[0],n[1])===!1&&e.stopOnFalse&&(u=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},f={add:function(){return o&&(n&&!t&&(u=o.length-1,a.push(n)),function r(t){de.each(t,function(t,n){de.isFunction(n)?e.unique&&f.has(n)||o.push(n):n&&n.length&&"string"!==de.type(n)&&r(n)})}(arguments),n&&!t&&c()),this},remove:function(){return de.each(arguments,function(e,t){for(var n;(n=de.inArray(t,o,n))>-1;)o.splice(n,1),n<=u&&u--}),this},has:function(e){return e?de.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=n||[],n=[e,n.slice?n.slice():n],a.push(n),t||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!r}};return f},de.extend({Deferred:function(t){var n=[["notify","progress",de.Callbacks("memory"),de.Callbacks("memory"),2],["resolve","done",de.Callbacks("once memory"),de.Callbacks("once memory"),0,"resolved"],["reject","fail",de.Callbacks("once memory"),de.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},"catch":function(e){return i.then(null,e)},pipe:function(){var e=arguments;return de.Deferred(function(t){de.each(n,function(n,r){var i=de.isFunction(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&de.isFunction(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(t,r,i){function o(t,n,r,i){return function(){var c=this,f=arguments,l=function(){var e,l;if(!(t<s)){if(e=r.apply(c,f),e===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,de.isFunction(l)?i?l.call(e,o(s,n,a,i),o(s,n,u,i)):(s++,l.call(e,o(s,n,a,i),o(s,n,u,i),o(s,n,a,n.notifyWith))):(r!==a&&(c=void 0,f=[e]),(i||n.resolveWith)(c,f))}},h=i?l:function(){try{l()}catch(e){de.Deferred.exceptionHook&&de.Deferred.exceptionHook(e,h.stackTrace),t+1>=s&&(r!==u&&(c=void 0,f=[e]),n.rejectWith(c,f))}};t?h():(de.Deferred.getStackHook&&(h.stackTrace=de.Deferred.getStackHook()),e.setTimeout(h))}}var s=0;return de.Deferred(function(e){n[0][3].add(o(0,e,de.isFunction(i)?i:a,e.notifyWith)),n[1][3].add(o(0,e,de.isFunction(t)?t:a)),n[2][3].add(o(0,e,de.isFunction(r)?r:u))}).promise()},promise:function(e){return null!=e?de.extend(e,i):i}},o={};return de.each(n,function(e,t){var s=t[2],a=t[5];i[t[1]]=s.add,a&&s.add(function(){r=a},n[3-e][2].disable,n[0][2].lock),s.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=s.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=re.call(arguments),o=de.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?re.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(c(e,o.done(s(n)).resolve,o.reject),"pending"===o.state()||de.isFunction(i[n]&&i[n].then)))return o.then();for(;n--;)c(i[n],s(n),o.reject);return o.promise()}});var Me=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;de.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&Me.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},de.readyException=function(t){e.setTimeout(function(){throw t})};var Re=de.Deferred();de.fn.ready=function(e){return Re.then(e)["catch"](function(e){de.readyException(e)}),this},de.extend({isReady:!1,readyWait:1,holdReady:function(e){e?de.readyWait++:de.ready(!0)},ready:function(e){(e===!0?--de.readyWait:de.isReady)||(de.isReady=!0,e!==!0&&--de.readyWait>0||Re.resolveWith(te,[de]))}}),de.ready.then=Re.then,"complete"===te.readyState||"loading"!==te.readyState&&!te.documentElement.doScroll?e.setTimeout(de.ready):(te.addEventListener("DOMContentLoaded",f),e.addEventListener("load",f));var Oe=function(e,t,n,r,i,o,s){var a=0,u=e.length,c=null==n;if("object"===de.type(n)){i=!0;for(a in n)Oe(e,t,a,n[a],!0,o,s)}else if(void 0!==r&&(i=!0,de.isFunction(r)||(s=!0),c&&(s?(t.call(e,r),t=null):(c=t,t=function(e,t,n){return c.call(de(e),n)})),t))for(;a<u;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:c?t.call(e):u?t(e[0],n):o},Be=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};l.uid=1,l.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Be(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[de.camelCase(t)]=n;else for(r in t)i[de.camelCase(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][de.camelCase(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){de.isArray(t)?t=t.map(de.camelCase):(t=de.camelCase(t),t=t in r?[t]:t.match(Te)||[]),n=t.length;for(;n--;)delete r[t[n]]}(void 0===t||de.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!de.isEmptyObject(t)}};var De=new l,Ne=new l,Le=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Fe=/[A-Z]/g;de.extend({hasData:function(e){return Ne.hasData(e)||De.hasData(e)},data:function(e,t,n){return Ne.access(e,t,n)},removeData:function(e,t){Ne.remove(e,t)},_data:function(e,t,n){return De.access(e,t,n)},_removeData:function(e,t){De.remove(e,t)}}),de.fn.extend({data:function(e,t){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(i=Ne.get(o),1===o.nodeType&&!De.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(r=s[n].name,0===r.indexOf("data-")&&(r=de.camelCase(r.slice(5)),p(o,r,i[r])));De.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Ne.set(this,e)}):Oe(this,function(t){var n;if(o&&void 0===t){if(n=Ne.get(o,e),void 0!==n)return n;if(n=p(o,e),void 0!==n)return n}else this.each(function(){Ne.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Ne.remove(this,e)})}}),de.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=De.get(e,t),n&&(!r||de.isArray(n)?r=De.access(e,t,de.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=de.queue(e,t),r=n.length,i=n.shift(),o=de._queueHooks(e,t),s=function(){de.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return De.get(e,n)||De.access(e,n,{empty:de.Callbacks("once memory").add(function(){De.remove(e,[t+"queue",n])})})}}),de.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?de.queue(this[0],e):void 0===t?this:this.each(function(){var n=de.queue(this,e,t);de._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&de.dequeue(this,e)})},dequeue:function(e){return this.each(function(){de.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=de.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)n=De.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var Ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,je=new RegExp("^(?:([+-])=|)("+Ue+")([a-z%]*)$","i"),ze=["Top","Right","Bottom","Left"],Ke=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&de.contains(e.ownerDocument,e)&&"none"===de.css(e,"display")},He=function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i},qe={};de.fn.extend({show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ke(this)?de(this).show():de(this).hide()})}});var Ve=/^(?:checkbox|radio)$/i,We=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ge=/^$|\/(?:java|ecma)script/i,Ye={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ye.optgroup=Ye.option,Ye.tbody=Ye.tfoot=Ye.colgroup=Ye.caption=Ye.thead,Ye.th=Ye.td;var Xe=/<|&#?\w+;/;!function(){var e=te.createDocumentFragment(),t=e.appendChild(te.createElement("div")),n=te.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),he.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",he.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var $e=te.documentElement,Je=/^key/,Qe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ze=/^([^.]*)(?:\.(.+)|)/;de.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,c,f,l,h,p,d,g,y=De.get(e);if(y)for(n.handler&&(o=n,n=o.handler,i=o.selector),i&&de.find.matchesSelector($e,i),n.guid||(n.guid=de.guid++),(u=y.events)||(u=y.events={}),(s=y.handle)||(s=y.handle=function(t){return"undefined"!=typeof de&&de.event.triggered!==t.type?de.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Te)||[""],c=t.length;c--;)a=Ze.exec(t[c])||[],p=g=a[1],d=(a[2]||"").split(".").sort(),p&&(l=de.event.special[p]||{},p=(i?l.delegateType:l.bindType)||p,l=de.event.special[p]||{},f=de.extend({type:p,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&de.expr.match.needsContext.test(i),namespace:d.join(".")},o),(h=u[p])||(h=u[p]=[],h.delegateCount=0,l.setup&&l.setup.call(e,r,d,s)!==!1||e.addEventListener&&e.addEventListener(p,s)),l.add&&(l.add.call(e,f),f.handler.guid||(f.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,f):h.push(f),de.event.global[p]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,c,f,l,h,p,d,g,y=De.hasData(e)&&De.get(e);if(y&&(u=y.events)){for(t=(t||"").match(Te)||[""],c=t.length;c--;)if(a=Ze.exec(t[c])||[],p=g=a[1],d=(a[2]||"").split(".").sort(),p){for(l=de.event.special[p]||{},p=(r?l.delegateType:l.bindType)||p,h=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=h.length;o--;)f=h[o],!i&&g!==f.origType||n&&n.guid!==f.guid||a&&!a.test(f.namespace)||r&&r!==f.selector&&("**"!==r||!f.selector)||(h.splice(o,1),
f.selector&&h.delegateCount--,l.remove&&l.remove.call(e,f));s&&!h.length&&(l.teardown&&l.teardown.call(e,d,y.handle)!==!1||de.removeEvent(e,p,y.handle),delete u[p])}else for(p in u)de.event.remove(e,p+t[c],n,r,!0);de.isEmptyObject(u)&&De.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,s,a=de.event.fix(e),u=new Array(arguments.length),c=(De.get(this,"events")||{})[a.type]||[],f=de.event.special[a.type]||{};for(u[0]=a,t=1;t<arguments.length;t++)u[t]=arguments[t];if(a.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,a)!==!1){for(s=de.event.handlers.call(this,a,c),t=0;(i=s[t++])&&!a.isPropagationStopped();)for(a.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,r=((de.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u),void 0!==r&&(a.result=r)===!1&&(a.preventDefault(),a.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,a),a.result}},handlers:function(e,t){var n,r,i,o,s,a=[],u=t.delegateCount,c=e.target;if(u&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||c.disabled!==!0)){for(o=[],s={},n=0;n<u;n++)r=t[n],i=r.selector+" ",void 0===s[i]&&(s[i]=r.needsContext?de(i,this).index(c)>-1:de.find(i,this,null,[c]).length),s[i]&&o.push(r);o.length&&a.push({elem:c,handlers:o})}return c=this,u<t.length&&a.push({elem:c,handlers:t.slice(u)}),a},addProp:function(e,t){Object.defineProperty(de.Event.prototype,e,{enumerable:!0,configurable:!0,get:de.isFunction(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[de.expando]?e:new de.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==_()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===_()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&de.nodeName(this,"input"))return this.click(),!1},_default:function(e){return de.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},de.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},de.Event=function(e,t){return this instanceof de.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?w:E,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&de.extend(this,t),this.timeStamp=e&&e.timeStamp||de.now(),void(this[de.expando]=!0)):new de.Event(e,t)},de.Event.prototype={constructor:de.Event,isDefaultPrevented:E,isPropagationStopped:E,isImmediatePropagationStopped:E,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=w,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=w,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=w,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},de.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Je.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Qe.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},de.event.addProp),de.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){de.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||de.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),de.fn.extend({on:function(e,t,n,r){return S(this,e,t,n,r)},one:function(e,t,n,r){return S(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,de(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return t!==!1&&"function"!=typeof t||(n=t,t=void 0),n===!1&&(n=E),this.each(function(){de.event.remove(this,e,n,t)})}});var et=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,tt=/<script|<style|<link/i,nt=/checked\s*(?:[^=]|=\s*.checked.)/i,rt=/^true\/(.*)/,it=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;de.extend({htmlPrefilter:function(e){return e.replace(et,"<$1></$2>")},clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=de.contains(e.ownerDocument,e);if(!(he.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||de.isXMLDoc(e)))for(s=m(a),o=m(e),r=0,i=o.length;r<i;r++)A(o[r],s[r]);if(t)if(n)for(o=o||m(e),s=s||m(a),r=0,i=o.length;r<i;r++)I(o[r],s[r]);else I(e,a);return s=m(a,"script"),s.length>0&&v(s,!u&&m(e,"script")),a},cleanData:function(e){for(var t,n,r,i=de.event.special,o=0;void 0!==(n=e[o]);o++)if(Be(n)){if(t=n[De.expando]){if(t.events)for(r in t.events)i[r]?de.event.remove(n,r):de.removeEvent(n,r,t.handle);n[De.expando]=void 0}n[Ne.expando]&&(n[Ne.expando]=void 0)}}}),de.fn.extend({detach:function(e){return T(this,e,!0)},remove:function(e){return T(this,e)},text:function(e){return Oe(this,function(e){return void 0===e?de.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return P(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=k(this,e);t.appendChild(e)}})},prepend:function(){return P(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=k(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return P(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return P(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(de.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return de.clone(this,e,t)})},html:function(e){return Oe(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!tt.test(e)&&!Ye[(We.exec(e)||["",""])[1].toLowerCase()]){e=de.htmlPrefilter(e);try{for(;n<r;n++)t=this[n]||{},1===t.nodeType&&(de.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return P(this,arguments,function(t){var n=this.parentNode;de.inArray(this,e)<0&&(de.cleanData(m(this)),n&&n.replaceChild(t,this))},e)}}),de.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){de.fn[e]=function(e){for(var n,r=[],i=de(e),o=i.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),de(i[s])[t](n),oe.apply(r,n.get());return this.pushStack(r)}});var ot=/^margin/,st=new RegExp("^("+Ue+")(?!px)[a-z%]+$","i"),at=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)};!function(){function t(){if(a){a.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",$e.appendChild(s);var t=e.getComputedStyle(a);n="1%"!==t.top,o="2px"===t.marginLeft,r="4px"===t.width,a.style.marginRight="50%",i="4px"===t.marginRight,$e.removeChild(s),a=null}}var n,r,i,o,s=te.createElement("div"),a=te.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",he.clearCloneStyle="content-box"===a.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(a),de.extend(he,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return t(),r},pixelMarginRight:function(){return t(),i},reliableMarginLeft:function(){return t(),o}}))}();var ut=/^(none|table(?!-c[ea]).+)/,ct={position:"absolute",visibility:"hidden",display:"block"},ft={letterSpacing:"0",fontWeight:"400"},lt=["Webkit","Moz","ms"],ht=te.createElement("div").style;de.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=M(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=de.camelCase(t),u=e.style;return t=de.cssProps[a]||(de.cssProps[a]=O(a)||a),s=de.cssHooks[t]||de.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t]:(o=typeof n,"string"===o&&(i=je.exec(n))&&i[1]&&(n=d(e,t,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(de.cssNumber[a]?"":"px")),he.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(u[t]=n)),void 0)}},css:function(e,t,n,r){var i,o,s,a=de.camelCase(t);return t=de.cssProps[a]||(de.cssProps[a]=O(a)||a),s=de.cssHooks[t]||de.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=M(e,t,r)),"normal"===i&&t in ft&&(i=ft[t]),""===n||n?(o=parseFloat(i),n===!0||isFinite(o)?o||0:i):i}}),de.each(["height","width"],function(e,t){de.cssHooks[t]={get:function(e,n,r){if(n)return!ut.test(de.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?N(e,t,r):He(e,ct,function(){return N(e,t,r)})},set:function(e,n,r){var i,o=r&&at(e),s=r&&D(e,t,r,"border-box"===de.css(e,"boxSizing",!1,o),o);return s&&(i=je.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=de.css(e,t)),B(e,n,s)}}}),de.cssHooks.marginLeft=R(he.reliableMarginLeft,function(e,t){if(t)return(parseFloat(M(e,"marginLeft"))||e.getBoundingClientRect().left-He(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),de.each({margin:"",padding:"",border:"Width"},function(e,t){de.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+ze[r]+t]=o[r]||o[r-2]||o[0];return i}},ot.test(e)||(de.cssHooks[e+t].set=B)}),de.fn.extend({css:function(e,t){return Oe(this,function(e,t,n){var r,i,o={},s=0;if(de.isArray(t)){for(r=at(e),i=t.length;s<i;s++)o[t[s]]=de.css(e,t[s],!1,r);return o}return void 0!==n?de.style(e,t,n):de.css(e,t)},e,t,arguments.length>1)}}),de.Tween=L,L.prototype={constructor:L,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||de.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(de.cssNumber[n]?"":"px")},cur:function(){var e=L.propHooks[this.prop];return e&&e.get?e.get(this):L.propHooks._default.get(this)},run:function(e){var t,n=L.propHooks[this.prop];return this.options.duration?this.pos=t=de.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=de.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){de.fx.step[e.prop]?de.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[de.cssProps[e.prop]]&&!de.cssHooks[e.prop]?e.elem[e.prop]=e.now:de.style(e.elem,e.prop,e.now+e.unit)}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},de.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},de.fx=L.prototype.init,de.fx.step={};var pt,dt,gt=/^(?:toggle|show|hide)$/,yt=/queueHooks$/;de.Animation=de.extend(q,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return d(n.elem,e,je.exec(t),n),n}]},tweener:function(e,t){de.isFunction(e)?(t=e,e=["*"]):e=e.match(Te);for(var n,r=0,i=e.length;r<i;r++)n=e[r],q.tweeners[n]=q.tweeners[n]||[],q.tweeners[n].unshift(t)},prefilters:[K],prefilter:function(e,t){t?q.prefilters.unshift(e):q.prefilters.push(e)}}),de.speed=function(e,t,n){var r=e&&"object"==typeof e?de.extend({},e):{complete:n||!n&&t||de.isFunction(e)&&e,duration:e,easing:n&&t||t&&!de.isFunction(t)&&t};return de.fx.off||te.hidden?r.duration=0:"number"!=typeof r.duration&&(r.duration in de.fx.speeds?r.duration=de.fx.speeds[r.duration]:r.duration=de.fx.speeds._default),null!=r.queue&&r.queue!==!0||(r.queue="fx"),r.old=r.complete,r.complete=function(){de.isFunction(r.old)&&r.old.call(this),r.queue&&de.dequeue(this,r.queue)},r},de.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Ke).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=de.isEmptyObject(e),o=de.speed(t,n,r),s=function(){var t=q(this,de.extend({},e),o);(i||De.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=de.timers,s=De.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&yt.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||de.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=De.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=de.timers,s=r?r.length:0;for(n.finish=!0,de.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),de.each(["toggle","show","hide"],function(e,t){var n=de.fn[t];de.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(j(t,!0),e,r,i)}}),de.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){de.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),de.timers=[],de.fx.tick=function(){var e,t=0,n=de.timers;for(pt=de.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||de.fx.stop(),pt=void 0},de.fx.timer=function(e){de.timers.push(e),e()?de.fx.start():de.timers.pop()},de.fx.interval=13,de.fx.start=function(){dt||(dt=e.requestAnimationFrame?e.requestAnimationFrame(F):e.setInterval(de.fx.tick,de.fx.interval))},de.fx.stop=function(){e.cancelAnimationFrame?e.cancelAnimationFrame(dt):e.clearInterval(dt),dt=null},de.fx.speeds={slow:600,fast:200,_default:400},de.fn.delay=function(t,n){return t=de.fx?de.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=te.createElement("input"),t=te.createElement("select"),n=t.appendChild(te.createElement("option"));e.type="checkbox",he.checkOn=""!==e.value,he.optSelected=n.selected,e=te.createElement("input"),e.value="t",e.type="radio",he.radioValue="t"===e.value}();var mt,vt=de.expr.attrHandle;de.fn.extend({attr:function(e,t){return Oe(this,de.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){de.removeAttr(this,e)})}}),de.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?de.prop(e,t,n):(1===o&&de.isXMLDoc(e)||(i=de.attrHooks[t.toLowerCase()]||(de.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void de.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:(r=de.find.attr(e,t),null==r?void 0:r))},attrHooks:{type:{set:function(e,t){if(!he.radioValue&&"radio"===t&&de.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(Te);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),mt={set:function(e,t,n){return t===!1?de.removeAttr(e,n):e.setAttribute(n,n),n}},de.each(de.expr.match.bool.source.match(/\w+/g),function(e,t){var n=vt[t]||de.find.attr;vt[t]=function(e,t,r){var i,o,s=t.toLowerCase();return r||(o=vt[s],vt[s]=i,i=null!=n(e,t,r)?s:null,vt[s]=o),i}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;de.fn.extend({prop:function(e,t){return Oe(this,de.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[de.propFix[e]||e]})}}),de.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&de.isXMLDoc(e)||(t=de.propFix[t]||t,i=de.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=de.find.attr(e,"tabindex");return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),he.optSelected||(de.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),de.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){de.propFix[this.toLowerCase()]=this}),de.fn.extend({addClass:function(e){var t,n,r,i,o,s,a,u=0;if(de.isFunction(e))return this.each(function(t){de(this).addClass(e.call(this,t,W(this)))});if("string"==typeof e&&e)for(t=e.match(Te)||[];n=this[u++];)if(i=W(n),r=1===n.nodeType&&" "+V(i)+" "){for(s=0;o=t[s++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");a=V(r),i!==a&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,r,i,o,s,a,u=0;if(de.isFunction(e))return this.each(function(t){de(this).removeClass(e.call(this,t,W(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(Te)||[];n=this[u++];)if(i=W(n),r=1===n.nodeType&&" "+V(i)+" "){for(s=0;o=t[s++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");a=V(r),i!==a&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):de.isFunction(e)?this.each(function(n){de(this).toggleClass(e.call(this,n,W(this),t),t)}):this.each(function(){var t,r,i,o;if("string"===n)for(r=0,i=de(this),o=e.match(Te)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==n||(t=W(this),t&&De.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":De.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+V(W(n))+" ").indexOf(t)>-1)return!0;return!1}});var Et=/\r/g;de.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=de.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,de(this).val()):e,null==i?i="":"number"==typeof i?i+="":de.isArray(i)&&(i=de.map(i,function(e){return null==e?"":e+""})),t=de.valHooks[this.type]||de.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return t=de.valHooks[i.type]||de.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(Et,""):null==n?"":n)}}}),de.extend({valHooks:{option:{get:function(e){var t=de.find.attr(e,"value");return null!=t?t:V(de.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],u=s?o+1:i.length;for(r=o<0?u:s?o:0;r<u;r++)if(n=i[r],(n.selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!de.nodeName(n.parentNode,"optgroup"))){if(t=de(n).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,o=de.makeArray(t),s=i.length;s--;)r=i[s],(r.selected=de.inArray(de.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),de.each(["radio","checkbox"],function(){de.valHooks[this]={set:function(e,t){if(de.isArray(t))return e.checked=de.inArray(de(e).val(),t)>-1}},he.checkOn||(de.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var _t=/^(?:focusinfocus|focusoutblur)$/;de.extend(de.event,{trigger:function(t,n,r,i){var o,s,a,u,c,f,l,h=[r||te],p=ce.call(t,"type")?t.type:t,d=ce.call(t,"namespace")?t.namespace.split("."):[];if(s=a=r=r||te,3!==r.nodeType&&8!==r.nodeType&&!_t.test(p+de.event.triggered)&&(p.indexOf(".")>-1&&(d=p.split("."),p=d.shift(),d.sort()),c=p.indexOf(":")<0&&"on"+p,t=t[de.expando]?t:new de.Event(p,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=d.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:de.makeArray(n,[t]),l=de.event.special[p]||{},i||!l.trigger||l.trigger.apply(r,n)!==!1)){if(!i&&!l.noBubble&&!de.isWindow(r)){for(u=l.delegateType||p,_t.test(u+p)||(s=s.parentNode);s;s=s.parentNode)h.push(s),a=s;a===(r.ownerDocument||te)&&h.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=h[o++])&&!t.isPropagationStopped();)t.type=o>1?u:l.bindType||p,f=(De.get(s,"events")||{})[t.type]&&De.get(s,"handle"),f&&f.apply(s,n),f=c&&s[c],f&&f.apply&&Be(s)&&(t.result=f.apply(s,n),t.result===!1&&t.preventDefault());return t.type=p,i||t.isDefaultPrevented()||l._default&&l._default.apply(h.pop(),n)!==!1||!Be(r)||c&&de.isFunction(r[p])&&!de.isWindow(r)&&(a=r[c],a&&(r[c]=null),de.event.triggered=p,r[p](),de.event.triggered=void 0,a&&(r[c]=a)),t.result}},simulate:function(e,t,n){var r=de.extend(new de.Event,n,{type:e,isSimulated:!0});de.event.trigger(r,null,t)}}),de.fn.extend({trigger:function(e,t){return this.each(function(){de.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return de.event.trigger(e,t,n,!0)}}),de.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){de.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),de.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),he.focusin="onfocusin"in e,he.focusin||de.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){de.event.simulate(t,e.target,de.event.fix(e))};de.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=De.access(r,t);i||r.addEventListener(e,n,!0),De.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=De.access(r,t)-1;i?De.access(r,t,i):(r.removeEventListener(e,n,!0),De.remove(r,t))}}});var St=e.location,kt=de.now(),Ct=/\?/;de.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(r){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||de.error("Invalid XML: "+t),n};var xt=/\[\]$/,It=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Pt=/^(?:input|select|textarea|keygen)/i;de.param=function(e,t){var n,r=[],i=function(e,t){var n=de.isFunction(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(de.isArray(e)||e.jquery&&!de.isPlainObject(e))de.each(e,function(){i(this.name,this.value)});else for(n in e)G(n,e[n],t,i);return r.join("&")},de.fn.extend({serialize:function(){return de.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=de.prop(this,"elements");return e?de.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!de(this).is(":disabled")&&Pt.test(this.nodeName)&&!At.test(e)&&(this.checked||!Ve.test(e))}).map(function(e,t){var n=de(this).val();return null==n?null:de.isArray(n)?de.map(n,function(e){return{name:t.name,value:e.replace(It,"\r\n")}}):{name:t.name,value:n.replace(It,"\r\n")}}).get()}});var Tt=/%20/g,Mt=/#.*$/,Rt=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Bt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Dt=/^(?:GET|HEAD)$/,Nt=/^\/\//,Lt={},Ft={},Ut="*/".concat("*"),jt=te.createElement("a");jt.href=St.href,de.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:St.href,type:"GET",isLocal:Bt.test(St.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":de.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?$($(e,de.ajaxSettings),t):$(de.ajaxSettings,e)},ajaxPrefilter:Y(Lt),ajaxTransport:Y(Ft),ajax:function(t,n){function r(t,n,r,a){var c,h,p,w,E,_=n;f||(f=!0,u&&e.clearTimeout(u),i=void 0,s=a||"",S.readyState=t>0?4:0,c=t>=200&&t<300||304===t,r&&(w=J(d,S,r)),w=Q(d,w,S,c),c?(d.ifModified&&(E=S.getResponseHeader("Last-Modified"),E&&(de.lastModified[o]=E),E=S.getResponseHeader("etag"),E&&(de.etag[o]=E)),204===t||"HEAD"===d.type?_="nocontent":304===t?_="notmodified":(_=w.state,h=w.data,p=w.error,c=!p)):(p=_,!t&&_||(_="error",t<0&&(t=0))),S.status=t,S.statusText=(n||_)+"",c?m.resolveWith(g,[h,_,S]):m.rejectWith(g,[S,_,p]),S.statusCode(b),b=void 0,l&&y.trigger(c?"ajaxSuccess":"ajaxError",[S,d,c?h:p]),v.fireWith(g,[S,_]),l&&(y.trigger("ajaxComplete",[S,d]),--de.active||de.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,s,a,u,c,f,l,h,p,d=de.ajaxSetup({},n),g=d.context||d,y=d.context&&(g.nodeType||g.jquery)?de(g):de.event,m=de.Deferred(),v=de.Callbacks("once memory"),b=d.statusCode||{},w={},E={},_="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(f){if(!a)for(a={};t=Ot.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return f?s:null},setRequestHeader:function(e,t){return null==f&&(e=E[e.toLowerCase()]=E[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==f&&(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(f)S.always(e[S.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||_;return i&&i.abort(t),r(0,t),this}};if(m.promise(S),d.url=((t||d.url||St.href)+"").replace(Nt,St.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(Te)||[""],null==d.crossDomain){c=te.createElement("a");try{c.href=d.url,c.href=c.href,d.crossDomain=jt.protocol+"//"+jt.host!=c.protocol+"//"+c.host}catch(k){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=de.param(d.data,d.traditional)),X(Lt,d,n,S),f)return S;l=de.event&&d.global,l&&0===de.active++&&de.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Dt.test(d.type),o=d.url.replace(Mt,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Tt,"+")):(p=d.url.slice(o.length),d.data&&(o+=(Ct.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(o=o.replace(Rt,"$1"),p=(Ct.test(o)?"&":"?")+"_="+kt++ +p),d.url=o+p),d.ifModified&&(de.lastModified[o]&&S.setRequestHeader("If-Modified-Since",de.lastModified[o]),de.etag[o]&&S.setRequestHeader("If-None-Match",de.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",d.contentType),S.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ut+"; q=0.01":""):d.accepts["*"]);for(h in d.headers)S.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(d.beforeSend.call(g,S,d)===!1||f))return S.abort();if(_="abort",v.add(d.complete),S.done(d.success),S.fail(d.error),i=X(Ft,d,n,S)){if(S.readyState=1,l&&y.trigger("ajaxSend",[S,d]),f)return S;d.async&&d.timeout>0&&(u=e.setTimeout(function(){S.abort("timeout")},d.timeout));try{f=!1,i.send(w,r)}catch(k){if(f)throw k;r(-1,k)}}else r(-1,"No Transport");return S},getJSON:function(e,t,n){return de.get(e,t,n,"json")},getScript:function(e,t){return de.get(e,void 0,t,"script")}}),de.each(["get","post"],function(e,t){de[t]=function(e,n,r,i){return de.isFunction(n)&&(i=i||r,r=n,n=void 0),de.ajax(de.extend({url:e,type:t,dataType:i,data:n,success:r},de.isPlainObject(e)&&e))}}),de._evalUrl=function(e){return de.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},de.fn.extend({wrapAll:function(e){var t;return this[0]&&(de.isFunction(e)&&(e=e.call(this[0])),t=de(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return de.isFunction(e)?this.each(function(t){de(this).wrapInner(e.call(this,t))}):this.each(function(){var t=de(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=de.isFunction(e);return this.each(function(n){de(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){de(this).replaceWith(this.childNodes)}),this}}),de.expr.pseudos.hidden=function(e){return!de.expr.pseudos.visible(e)},de.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},de.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(t){}};var zt={0:200,1223:204},Kt=de.ajaxSettings.xhr();he.cors=!!Kt&&"withCredentials"in Kt,he.ajax=Kt=!!Kt,de.ajaxTransport(function(t){var n,r;if(he.cors||Kt&&!t.crossDomain)return{send:function(i,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)a.setRequestHeader(s,i[s]);n=function(e){return function(){n&&(n=r=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(zt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),r=a.onerror=n("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(u){if(n)throw u}},abort:function(){n&&n()}}}),de.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),de.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return de.globalEval(e),e}}}),de.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),de.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=de("<script>").prop({
charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),te.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Ht=[],qt=/(=)\?(?=&|$)|\?\?/;de.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ht.pop()||de.expando+"_"+kt++;return this[e]=!0,e}}),de.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(qt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&qt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=de.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(qt,"$1"+i):t.jsonp!==!1&&(t.url+=(Ct.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||de.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){void 0===o?de(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Ht.push(i)),s&&de.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),he.createHTMLDocument=function(){var e=te.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),de.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var r,i,o;return t||(he.createHTMLDocument?(t=te.implementation.createHTMLDocument(""),r=t.createElement("base"),r.href=te.location.href,t.head.appendChild(r)):t=te),i=Se.exec(e),o=!n&&[],i?[t.createElement(i[1])]:(i=b([e],t,o),o&&o.length&&de(o).remove(),de.merge([],i.childNodes))},de.fn.load=function(e,t,n){var r,i,o,s=this,a=e.indexOf(" ");return a>-1&&(r=V(e.slice(a)),e=e.slice(0,a)),de.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&de.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?de("<div>").append(de.parseHTML(e)).find(r):e)}).always(n&&function(e,t){s.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},de.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){de.fn[t]=function(e){return this.on(t,e)}}),de.expr.pseudos.animated=function(e){return de.grep(de.timers,function(t){return e===t.elem}).length},de.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,c,f=de.css(e,"position"),l=de(e),h={};"static"===f&&(e.style.position="relative"),a=l.offset(),o=de.css(e,"top"),u=de.css(e,"left"),c=("absolute"===f||"fixed"===f)&&(o+u).indexOf("auto")>-1,c?(r=l.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),de.isFunction(t)&&(t=t.call(e,n,de.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+i),"using"in t?t.using.call(e,h):l.css(h)}},de.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){de.offset.setOffset(this,e,t)});var t,n,r,i,o=this[0];if(o)return o.getClientRects().length?(r=o.getBoundingClientRect(),r.width||r.height?(i=o.ownerDocument,n=Z(i),t=i.documentElement,{top:r.top+n.pageYOffset-t.clientTop,left:r.left+n.pageXOffset-t.clientLeft}):r):{top:0,left:0}},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===de.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),de.nodeName(e[0],"html")||(r=e.offset()),r={top:r.top+de.css(e[0],"borderTopWidth",!0),left:r.left+de.css(e[0],"borderLeftWidth",!0)}),{top:t.top-r.top-de.css(n,"marginTop",!0),left:t.left-r.left-de.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===de.css(e,"position");)e=e.offsetParent;return e||$e})}}),de.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;de.fn[e]=function(r){return Oe(this,function(e,r,i){var o=Z(e);return void 0===i?o?o[t]:e[r]:void(o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i)},e,r,arguments.length)}}),de.each(["top","left"],function(e,t){de.cssHooks[t]=R(he.pixelPosition,function(e,n){if(n)return n=M(e,t),st.test(n)?de(e).position()[t]+"px":n})}),de.each({Height:"height",Width:"width"},function(e,t){de.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){de.fn[r]=function(i,o){var s=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||o===!0?"margin":"border");return Oe(this,function(t,n,i){var o;return de.isWindow(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?de.css(t,n,a):de.style(t,n,i,a)},t,s?i:void 0,s)}})}),de.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),de.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return de});var Vt=e.jQuery,Wt=e.$;return de.noConflict=function(t){return e.$===de&&(e.$=Wt),t&&e.jQuery===de&&(e.jQuery=Vt),de},t||(e.jQuery=e.$=de),de})},{}],112:[function(e,t,n){t.exports=e("./lib/linkify-html")["default"]},{"./lib/linkify-html":113}],113:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=h["default"].tokenize(e),i=[],o=[];for(n=new y(n),t=0;t<r.length;t++){var c=r[t];if(c.type!==m)if(c.type===b){var l=s(c.chars,n);i.push.apply(i,l)}else i.push(c);else{i.push(c);var p=c.tagName.toUpperCase(),d="A"===p||g.contains(n.ignoreTags,p);if(!d)continue;var E=i.length;a(p,r,++t,i),t+=i.length-E-1}}for(t=0;t<i.length;t++){var _=i[t];switch(_.type){case m:var S="<"+_.tagName;if(_.attributes.length>0){var k=f(_.attributes);S+=" "+k.join(" ")}S+=">",o.push(S);break;case v:o.push("</"+_.tagName+">");break;case b:o.push(u(_.chars));break;case w:o.push("<!--"+u(_.chars)+"-->")}}return o.join("")}function s(e,t){for(var n=d.tokenize(e),r=[],i=0;i<n.length;i++){var o=n[i];if("nl"===o.type&&t.nl2br)r.push({type:m,tagName:"br",attributes:[],selfClosing:!0});else if(o.isLink&&t.check(o)){var s=t.resolve(o),a=(s.href,s.formatted),u=s.formattedHref,c=s.tagName,f=s.className,l=s.target,h=s.attributes,p=[["href",u]];f&&p.push(["class",f]),l&&p.push(["target",l]);for(var g in h)p.push([g,h[g]]);r.push({type:m,tagName:c,attributes:p,selfClosing:!1}),r.push({type:b,chars:a}),r.push({type:v,tagName:c})}else r.push({type:b,chars:o.toString()})}return r}function a(e,t,n,r){for(var i=1;n<t.length&&i>0;){var o=t[n];o.type===m&&o.tagName.toUpperCase()===e?i++:o.type===v&&o.tagName.toUpperCase()===e&&i--,r.push(o),n++}return r}function u(e){return e}function c(e){return e.replace(/"/g,"&quot;")}function f(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=r[0],o=r[1];t.push(i+'="'+c(o)+'"')}return t}n.__esModule=!0,n["default"]=o;var l=e("./simple-html-tokenizer"),h=i(l),p=e("./linkify"),d=r(p),g=d.options,y=g.Options,m="StartTag",v="EndTag",b="Chars",w="Comment"},{"./linkify":114,"./simple-html-tokenizer":123}],114:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}n.__esModule=!0,n.tokenize=n.test=n.scanner=n.parser=n.options=n.inherits=n.find=void 0;var i=e("./linkify/utils/class"),o=e("./linkify/utils/options"),s=r(o),a=e("./linkify/core/scanner"),u=r(a),c=e("./linkify/core/parser"),f=r(c);Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var l=function(e){return f.run(u.run(e))},h=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=l(e),r=[],i=0;i<n.length;i++){var o=n[i];!o.isLink||t&&o.type!==t||r.push(o.toObject())}return r},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=l(e);return 1===n.length&&n[0].isLink&&(!t||n[0].type===t)};n.find=h,n.inherits=i.inherits,n.options=s,n.parser=f,n.scanner=u,n.test=p,n.tokenize=l},{"./linkify/core/parser":115,"./linkify/core/scanner":116,"./linkify/utils/class":121,"./linkify/utils/options":122}],115:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}n.__esModule=!0,n.start=n.run=n.TOKENS=n.State=void 0;var i=e("./state"),o=e("./tokens/text"),s=(r(o),e("./tokens/multi")),a=r(s),u=function(e){return new i.TokenState(e)},c=u(),f=u(),l=u(),h=u(),p=u(),d=u(),g=u(),y=u(s.URL),m=u(),v=u(s.URL),b=u(s.URL),w=u(),E=u(),_=u(),S=u(),k=u(),C=u(s.URL),x=u(s.URL),I=u(s.URL),A=u(s.URL),P=u(),T=u(),M=u(),R=u(),O=u(),B=u(),D=u(s.EMAIL),N=u(),L=u(s.EMAIL),F=u(s.MAILTOEMAIL),U=u(),j=u(),z=u(),K=u(),H=u(s.NL);c.on(o.NL,H).on(o.PROTOCOL,f).on(o.MAILTO,l).on(o.SLASH,h),f.on(o.SLASH,h),h.on(o.SLASH,p),c.on(o.TLD,d).on(o.DOMAIN,d).on(o.LOCALHOST,y).on(o.NUM,d),p.on(o.TLD,b).on(o.DOMAIN,b).on(o.NUM,b).on(o.LOCALHOST,b),d.on(o.DOT,g),O.on(o.DOT,B),g.on(o.TLD,y).on(o.DOMAIN,d).on(o.NUM,d).on(o.LOCALHOST,d),B.on(o.TLD,D).on(o.DOMAIN,O).on(o.NUM,O).on(o.LOCALHOST,O),y.on(o.DOT,g),D.on(o.DOT,B),y.on(o.COLON,m).on(o.SLASH,b),m.on(o.NUM,v),v.on(o.SLASH,b),D.on(o.COLON,N),N.on(o.NUM,L);var q=[o.DOMAIN,o.AT,o.LOCALHOST,o.NUM,o.PLUS,o.POUND,o.PROTOCOL,o.SLASH,o.TLD,o.UNDERSCORE,o.SYM,o.AMPERSAND],V=[o.COLON,o.DOT,o.QUERY,o.PUNCTUATION,o.CLOSEBRACE,o.CLOSEBRACKET,o.CLOSEANGLEBRACKET,o.CLOSEPAREN,o.OPENBRACE,o.OPENBRACKET,o.OPENANGLEBRACKET,o.OPENPAREN];b.on(o.OPENBRACE,E).on(o.OPENBRACKET,_).on(o.OPENANGLEBRACKET,S).on(o.OPENPAREN,k),w.on(o.OPENBRACE,E).on(o.OPENBRACKET,_).on(o.OPENANGLEBRACKET,S).on(o.OPENPAREN,k),E.on(o.CLOSEBRACE,b),_.on(o.CLOSEBRACKET,b),S.on(o.CLOSEANGLEBRACKET,b),k.on(o.CLOSEPAREN,b),C.on(o.CLOSEBRACE,b),x.on(o.CLOSEBRACKET,b),I.on(o.CLOSEANGLEBRACKET,b),A.on(o.CLOSEPAREN,b),P.on(o.CLOSEBRACE,b),T.on(o.CLOSEBRACKET,b),M.on(o.CLOSEANGLEBRACKET,b),R.on(o.CLOSEPAREN,b),E.on(q,C),_.on(q,x),S.on(q,I),k.on(q,A),E.on(V,P),_.on(V,T),S.on(V,M),k.on(V,R),C.on(q,C),x.on(q,x),I.on(q,I),A.on(q,A),C.on(V,C),x.on(V,x),I.on(V,I),A.on(V,A),P.on(q,C),T.on(q,x),M.on(q,I),R.on(q,A),P.on(V,P),T.on(V,T),M.on(V,M),R.on(V,R),b.on(q,b),w.on(q,b),b.on(V,w),w.on(V,w),l.on(o.TLD,F).on(o.DOMAIN,F).on(o.NUM,F).on(o.LOCALHOST,F),F.on(q,F).on(V,U),U.on(q,F).on(V,U);var W=[o.DOMAIN,o.NUM,o.PLUS,o.POUND,o.QUERY,o.UNDERSCORE,o.SYM,o.AMPERSAND,o.TLD];d.on(W,j).on(o.AT,z),y.on(W,j).on(o.AT,z),g.on(W,j),j.on(W,j).on(o.AT,z).on(o.DOT,K),K.on(W,j),z.on(o.TLD,O).on(o.DOMAIN,O).on(o.LOCALHOST,D);var G=function(e){for(var t=e.length,n=0,r=[],i=[];n<t;){for(var o=c,a=null,u=null,f=0,l=null,h=-1;n<t&&!(a=o.next(e[n]));)i.push(e[n++]);for(;n<t&&(u=a||o.next(e[n]));)a=null,o=u,o.accepts()?(h=0,l=o):h>=0&&h++,n++,f++;if(h<0)for(var p=n-f;p<n;p++)i.push(e[p]);else{i.length>0&&(r.push(new s.TEXT(i)),i=[]),n-=h,f-=h;var d=l.emit();r.push(new d(e.slice(n-f,n)))}}return i.length>0&&r.push(new s.TEXT(i)),r};n.State=i.TokenState,n.TOKENS=a,n.run=G,n.start=c},{"./state":117,"./tokens/multi":119,"./tokens/text":120}],116:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}n.__esModule=!0,n.start=n.run=n.TOKENS=n.State=void 0;var i=e("./state"),o=e("./tokens/text"),s=r(o),a="aaa|aarp|abb|abbott|abogado|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|af|afl|ag|agency|ai|aig|airforce|airtel|al|alibaba|alipay|allfinanz|alsace|am|amica|amsterdam|an|analytics|android|ao|apartments|app|apple|aq|aquarelle|ar|aramco|archi|army|arpa|arte|as|asia|associates|at|attorney|au|auction|audi|audio|author|auto|autos|avianca|aw|ax|axa|az|azure|ba|baidu|band|bank|bar|barcelona|barclaycard|barclays|bargains|bauhaus|bayern|bb|bbc|bbva|bcg|bcn|bd|be|beats|beer|bentley|berlin|best|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bom|bond|boo|book|boots|bosch|bostik|bot|boutique|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|camera|camp|cancerresearch|canon|capetown|capital|car|caravan|cards|care|career|careers|cars|cartier|casa|cash|casino|cat|catering|cba|cbn|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chloe|christmas|chrome|church|ci|cipriani|circle|cisco|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|date|dating|datsun|day|dclk|de|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|diamonds|diet|digital|direct|directory|discount|dj|dk|dm|dnp|do|docs|dog|doha|domains|download|drive|dubai|durban|dvag|dz|earth|eat|ec|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epson|equipment|er|erni|es|esq|estate|et|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|fage|fail|fairwinds|faith|family|fan|fans|farm|fashion|fast|feedback|ferrero|fi|film|final|finance|financial|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|florist|flowers|flsmidth|fly|fm|fo|foo|football|ford|forex|forsale|forum|foundation|fox|fr|fresenius|frl|frogans|frontier|fund|furniture|futbol|fyi|ga|gal|gallery|gallup|game|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|gold|goldpoint|golf|goo|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|group|gs|gt|gu|gucci|guge|guide|guitars|guru|gw|gy|hamburg|hangout|haus|hdfcbank|health|healthcare|help|helsinki|here|hermes|hiphop|hitachi|hiv|hk|hm|hn|hockey|holdings|holiday|homedepot|homes|honda|horse|host|hosting|hoteles|hotmail|house|how|hr|hsbc|ht|hu|hyundai|ibm|icbc|ice|icu|id|ie|ifm|iinet|il|im|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|international|investments|io|ipiranga|iq|ir|irish|is|iselect|ist|istanbul|it|itau|iwc|jaguar|java|jcb|je|jetzt|jewelry|jlc|jll|jm|jmp|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kitchen|kiwi|km|kn|koeln|komatsu|kp|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|lamborghini|lamer|lancaster|land|landrover|lanxess|lasalle|lat|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|legal|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|limited|limo|lincoln|linde|link|live|living|lixil|lk|loan|loans|local|locus|lol|london|lotte|lotto|love|lr|ls|lt|ltd|ltda|lu|lupin|luxe|luxury|lv|ly|ma|madrid|maif|maison|makeup|man|management|mango|market|marketing|markets|marriott|mba|mc|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|mg|mh|miami|microsoft|mil|mini|mk|ml|mm|mma|mn|mo|mobi|mobily|moda|moe|moi|mom|monash|money|montblanc|mormon|mortgage|moscow|motorcycles|mov|movie|movistar|mp|mq|mr|ms|mt|mtn|mtpc|mtr|mu|museum|mutuelle|mv|mw|mx|my|mz|na|nadex|nagoya|name|natura|navy|nc|ne|nec|net|netbank|network|neustar|new|news|nexus|nf|ng|ngo|nhk|ni|nico|nikon|ninja|nissan|nl|no|nokia|norton|nowruz|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|office|okinawa|om|omega|one|ong|onl|online|ooo|oracle|orange|org|organic|origins|osaka|otsuka|ovh|pa|page|pamperedchef|panerai|paris|pars|partners|parts|party|passagens|pe|pet|pf|pg|ph|pharmacy|philips|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pohl|poker|porn|post|pr|praxi|press|pro|prod|productions|prof|promo|properties|property|protection|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|racing|re|read|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|ricoh|rio|rip|ro|rocher|rocks|rodeo|room|rs|rsvp|ru|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|saxo|sb|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scor|scot|sd|se|seat|security|seek|select|sener|services|seven|sew|sex|sexy|sfr|sg|sh|sharp|shell|shia|shiksha|shoes|show|shriram|si|singles|site|sj|sk|ski|skin|sky|skype|sl|sm|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|st|stada|star|starhub|statefarm|statoil|stc|stcgroup|stockholm|storage|store|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|taobao|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|team|tech|technology|tel|telecity|telefonica|temasek|tennis|tf|tg|th|thd|theater|theatre|tickets|tienda|tiffany|tips|tires|tirol|tj|tk|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tp|tr|trade|trading|training|travel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubs|ug|uk|unicom|university|uno|uol|us|uy|uz|va|vacations|vana|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|viking|villas|vin|vip|virgin|vision|vista|vistaprint|viva|vlaanderen|vn|vodka|volkswagen|vote|voting|voto|voyage|vu|vuelos|wales|walter|wang|wanggou|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|wme|wolterskluwer|work|works|world|ws|wtc|wtf|xbox|xerox|xin|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|youtube|yt|za|zara|zero|zip|zm|zone|zuerich|zw".split("|"),u="0123456789".split(""),c="0123456789abcdefghijklmnopqrstuvwxyz".split(""),f=[" ","\f","\r","\t","\x0B","","",""],l=[],h=function(e){return new i.CharacterState(e)},p=h(),d=h(o.NUM),g=h(o.DOMAIN),y=h(),m=h(o.WS);p.on("@",h(o.AT)).on(".",h(o.DOT)).on("+",h(o.PLUS)).on("#",h(o.POUND)).on("?",h(o.QUERY)).on("/",h(o.SLASH)).on("_",h(o.UNDERSCORE)).on(":",h(o.COLON)).on("{",h(o.OPENBRACE)).on("[",h(o.OPENBRACKET)).on("<",h(o.OPENANGLEBRACKET)).on("(",h(o.OPENPAREN)).on("}",h(o.CLOSEBRACE)).on("]",h(o.CLOSEBRACKET)).on(">",h(o.CLOSEANGLEBRACKET)).on(")",h(o.CLOSEPAREN)).on("&",h(o.AMPERSAND)).on([",",";","!",'"',"'"],h(o.PUNCTUATION)),p.on("\n",h(o.NL)).on(f,m),m.on(f,m);for(var v=0;v<a.length;v++){var b=(0,i.stateify)(a[v],p,o.TLD,o.DOMAIN);l.push.apply(l,b)}var w=(0,i.stateify)("file",p,o.DOMAIN,o.DOMAIN),E=(0,i.stateify)("ftp",p,o.DOMAIN,o.DOMAIN),_=(0,i.stateify)("http",p,o.DOMAIN,o.DOMAIN),S=(0,i.stateify)("mailto",p,o.DOMAIN,o.DOMAIN);l.push.apply(l,w),l.push.apply(l,E),l.push.apply(l,_);var k=w.pop(),C=E.pop(),x=_.pop(),I=S.pop(),A=h(o.DOMAIN),P=h(o.PROTOCOL),T=h(o.MAILTO);C.on("s",A).on(":",P),x.on("s",A).on(":",P),l.push(A),k.on(":",P),A.on(":",P),I.on(":",T);var M=(0,i.stateify)("localhost",p,o.LOCALHOST,o.DOMAIN);l.push.apply(l,M),p.on(u,d),d.on("-",y).on(u,d).on(c,g),g.on("-",y).on(c,g);for(var R=0;R<l.length;R++)l[R].on("-",y).on(c,g);y.on("-",y).on(u,g).on(c,g),p.defaultTransition=h(o.SYM);var O=function(e){for(var t=e.replace(/[A-Z]/g,function(e){return e.toLowerCase()}),n=e.length,r=[],i=0;i<n;){for(var o=p,s=null,a=null,u=0,c=null,f=-1;i<n&&(a=o.next(t[i]));)s=null,o=a,o.accepts()?(f=0,c=o):f>=0&&f++,u++,i++;if(!(f<0)){i-=f,u-=f;var l=c.emit();r.push(new l(e.substr(i-u,u)))}}return r},B=p;n.State=i.CharacterState,n.TOKENS=s,n.run=O,n.start=B},{"./state":117,"./tokens/text":120}],117:[function(e,t,n){"use strict";function r(){return function(e){this.j=[],this.T=e||null}}function i(e,t,n,r){for(var i=0,o=e.length,s=t,u=[],c=void 0;i<o&&(c=s.next(e[i]));)s=c,i++;if(i>=o)return[];for(;i<o-1;)c=new a(r),u.push(c),s.on(e[i],c),s=c,i++;return c=new a(n),u.push(c),s.on(e[o-1],c),u}n.__esModule=!0,n.stateify=n.TokenState=n.CharacterState=void 0;var o=e("../utils/class"),s=r();s.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)this.j.push([e[n],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var n=this.j[t],r=n[0],i=n[1];if(this.test(e,r))return i}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var a=(0,o.inherits)(s,r(),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),u=(0,o.inherits)(s,r(),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.next(new e(""));return n===this.defaultTransition?(n=new this.constructor(t),this.on(e,n)):t&&(n.T=t),n},test:function(e,t){return e instanceof t}});n.CharacterState=a,n.TokenState=u,n.stateify=i},{"../utils/class":121}],118:[function(e,t,n){"use strict";function r(){return function(e){e&&(this.v=e)}}n.__esModule=!0,n.createTokenClass=r},{}],119:[function(e,t,n){"use strict";function r(e){return e instanceof s.DOMAIN||e instanceof s.TLD}n.__esModule=!0,n.URL=n.TEXT=n.NL=n.EMAIL=n.MAILTOEMAIL=n.Base=void 0;var i=e("./create-token-class"),o=e("../../utils/class"),s=e("./text"),a=(0,i.createTokenClass)();a.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var u=(0,o.inherits)(a,(0,i.createTokenClass)(),{type:"email",isLink:!0}),c=(0,o.inherits)(a,(0,i.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){this.v;return"mailto:"+this.toString()}}),f=(0,o.inherits)(a,(0,i.createTokenClass)(),{type:"text"}),l=(0,o.inherits)(a,(0,i.createTokenClass)(),{type:"nl"}),h=(0,o.inherits)(a,(0,i.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,n=!1,i=this.v,o=[],a=0;i[a]instanceof s.PROTOCOL;)t=!0,o.push(i[a].toString().toLowerCase()),a++;for(;i[a]instanceof s.SLASH;)n=!0,o.push(i[a].toString()),a++;for(;r(i[a]);)o.push(i[a].toString().toLowerCase()),a++;for(;a<i.length;a++)o.push(i[a].toString());return o=o.join(""),t||n||(o=e+"://"+o),o},hasProtocol:function(){return this.v[0]instanceof s.PROTOCOL}});n.Base=a,n.MAILTOEMAIL=u,n.EMAIL=c,n.NL=l,n.TEXT=f,n.URL=h},{"../../utils/class":121,"./create-token-class":118,"./text":120}],120:[function(e,t,n){"use strict";function r(e){var t=e?{v:e}:{};return(0,o.inherits)(s,(0,i.createTokenClass)(),t)}n.__esModule=!0,n.AMPERSAND=n.CLOSEPAREN=n.CLOSEANGLEBRACKET=n.CLOSEBRACKET=n.CLOSEBRACE=n.OPENPAREN=n.OPENANGLEBRACKET=n.OPENBRACKET=n.OPENBRACE=n.WS=n.TLD=n.SYM=n.UNDERSCORE=n.SLASH=n.MAILTO=n.PROTOCOL=n.QUERY=n.POUND=n.PLUS=n.NUM=n.NL=n.LOCALHOST=n.PUNCTUATION=n.DOT=n.COLON=n.AT=n.DOMAIN=n.Base=void 0;var i=e("./create-token-class"),o=e("../../utils/class"),s=(0,i.createTokenClass)();s.prototype={toString:function(){return this.v+""}};var a=r(),u=r("@"),c=r(":"),f=r("."),l=r(),h=r(),p=r("\n"),d=r(),g=r("+"),y=r("#"),m=r(),v=r("mailto:"),b=r("?"),w=r("/"),E=r("_"),_=r(),S=r(),k=r(),C=r("{"),x=r("["),I=r("<"),A=r("("),P=r("}"),T=r("]"),M=r(">"),R=r(")"),O=r("&");n.Base=s,n.DOMAIN=a,n.AT=u,n.COLON=c,n.DOT=f,n.PUNCTUATION=l,n.LOCALHOST=h,n.NL=p,n.NUM=d,n.PLUS=g,n.POUND=y,n.QUERY=b,n.PROTOCOL=m,n.MAILTO=v,n.SLASH=w,n.UNDERSCORE=E,n.SYM=_,n.TLD=S,n.WS=k,n.OPENBRACE=C,n.OPENBRACKET=x,n.OPENANGLEBRACKET=I,n.OPENPAREN=A,n.CLOSEBRACE=P,n.CLOSEBRACKET=T,n.CLOSEANGLEBRACKET=M,n.CLOSEPAREN=R,n.AMPERSAND=O},{"../../utils/class":121,"./create-token-class":118}],121:[function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.create(e.prototype);for(var i in n)r[i]=n[i];return r.constructor=t,t.prototype=r,t}n.__esModule=!0,n.inherits=r},{}],122:[function(e,t,n){"use strict";function r(e){e=e||{},this.defaultProtocol=e.defaultProtocol||u.defaultProtocol,this.events=e.events||u.events,this.format=e.format||u.format,this.formatHref=e.formatHref||u.formatHref,this.nl2br=e.nl2br||u.nl2br,this.tagName=e.tagName||u.tagName,this.target=e.target||u.target,this.validate=e.validate||u.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||u.attributes,this.className=e.className||e.linkClass||u.className;for(var t=e.ignoreTags||u.ignoreTags,n=0;n<t.length;n++)this.ignoreTags.push(t[n].toUpperCase())}function i(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function o(e){return e}function s(e,t){return"url"===t?"_blank":null}n.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u={defaultProtocol:"http",events:null,format:o,formatHref:o,nl2br:!1,tagName:"a",target:s,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};n.defaults=u,n.Options=r,n.contains=i,r.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,t,n){var r=this[e];if(!r)return r;switch("undefined"==typeof r?"undefined":a(r)){case"function":return r(t,n.type);case"object":var i=r[n.type]||u[e];return"function"==typeof i?i(t,n.type):i}return r},getObject:function(e,t,n){var r=this[e];return"function"==typeof r?r(t,n.type):r}}},{}],123:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var i=e("./simple-html-tokenizer/html5-named-char-refs"),o=r(i),s=e("./simple-html-tokenizer/entity-parser"),a=r(s),u=e("./simple-html-tokenizer/evented-tokenizer"),c=r(u),f=e("./simple-html-tokenizer/tokenizer"),l=r(f),h=e("./simple-html-tokenizer/tokenize"),p=r(h),d={HTML5NamedCharRefs:o["default"],EntityParser:a["default"],EventedTokenizer:c["default"],Tokenizer:l["default"],tokenize:p["default"]};n["default"]=d},{"./simple-html-tokenizer/entity-parser":124,"./simple-html-tokenizer/evented-tokenizer":125,"./simple-html-tokenizer/html5-named-char-refs":126,"./simple-html-tokenizer/tokenize":127,"./simple-html-tokenizer/tokenizer":128}],124:[function(e,t,n){"use strict";function r(e){this.named=e}n.__esModule=!0;var i=/^#[xX]([A-Fa-f0-9]+)$/,o=/^#([0-9]+)$/,s=/^([A-Za-z0-9]+)$/;r.prototype.parse=function(e){if(e){var t=e.match(i);return t?"&#x"+t[1]+";":(t=e.match(o))?"&#"+t[1]+";":(t=e.match(s),t?this.named[t[1]]||"&"+t[1]+";":void 0)}},n["default"]=r},{}],125:[function(e,t,n){"use strict";function r(e,t){this.delegate=e,this.entityParser=t,this.state=null,this.input=null,this.index=-1,this.line=-1,this.column=-1,this.tagLine=-1,this.tagColumn=-1,this.reset()}n.__esModule=!0;var i=e("./utils");r.prototype={reset:function(){this.state="beforeData",this.input="",this.index=0,this.line=1,this.column=0,this.tagLine=-1,this.tagColumn=-1,this.delegate.reset()},tokenize:function(e){this.reset(),this.tokenizePart(e),this.tokenizeEOF()},tokenizePart:function(e){for(this.input+=(0,i.preprocessInput)(e);this.index<this.input.length;)this.states[this.state].call(this)},tokenizeEOF:function(){this.flushData()},flushData:function(){"data"===this.state&&(this.delegate.finishData(),this.state="beforeData")},peek:function(){return this.input.charAt(this.index)},consume:function(){var e=this.peek();return this.index++,"\n"===e?(this.line++,this.column=0):this.column++,e},consumeCharRef:function(){var e=this.input.indexOf(";",this.index);if(e!==-1){var t=this.input.slice(this.index,e),n=this.entityParser.parse(t);if(n){for(var r=t.length;r;)this.consume(),r--;return this.consume(),n}}},markTagStart:function(){this.tagLine=this.line,this.tagColumn=this.column,this.delegate.tagOpen&&this.delegate.tagOpen()},states:{beforeData:function(){var e=this.peek();"<"===e?(this.state="tagOpen",this.markTagStart(),this.consume()):(this.state="data",this.delegate.beginData())},data:function(){var e=this.peek();"<"===e?(this.delegate.finishData(),this.state="tagOpen",this.markTagStart(),this.consume()):"&"===e?(this.consume(),this.delegate.appendToData(this.consumeCharRef()||"&")):(this.consume(),this.delegate.appendToData(e))},tagOpen:function(){var e=this.consume();"!"===e?this.state="markupDeclaration":"/"===e?this.state="endTagOpen":(0,i.isAlpha)(e)&&(this.state="tagName",this.delegate.beginStartTag(),this.delegate.appendToTagName(e.toLowerCase()))},markupDeclaration:function(){var e=this.consume();"-"===e&&"-"===this.input.charAt(this.index)&&(this.consume(),this.state="commentStart",this.delegate.beginComment())},commentStart:function(){var e=this.consume();"-"===e?this.state="commentStartDash":">"===e?(this.delegate.finishComment(),this.state="beforeData"):(this.delegate.appendToCommentData(e),this.state="comment")},commentStartDash:function(){var e=this.consume();"-"===e?this.state="commentEnd":">"===e?(this.delegate.finishComment(),this.state="beforeData"):(this.delegate.appendToCommentData("-"),this.state="comment")},comment:function(){var e=this.consume();"-"===e?this.state="commentEndDash":this.delegate.appendToCommentData(e)},commentEndDash:function(){var e=this.consume();"-"===e?this.state="commentEnd":(this.delegate.appendToCommentData("-"+e),this.state="comment")},commentEnd:function(){var e=this.consume();">"===e?(this.delegate.finishComment(),this.state="beforeData"):(this.delegate.appendToCommentData("--"+e),this.state="comment")},tagName:function(){var e=this.consume();(0,i.isSpace)(e)?this.state="beforeAttributeName":"/"===e?this.state="selfClosingStartTag":">"===e?(this.delegate.finishTag(),this.state="beforeData"):this.delegate.appendToTagName(e)},beforeAttributeName:function(){var e=this.peek();return(0,i.isSpace)(e)?void this.consume():void("/"===e?(this.state="selfClosingStartTag",this.consume()):">"===e?(this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.state="attributeName",this.delegate.beginAttribute(),this.consume(),this.delegate.appendToAttributeName(e)))},attributeName:function(){var e=this.peek();(0,i.isSpace)(e)?(this.state="afterAttributeName",this.consume()):"/"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.state="selfClosingStartTag"):"="===e?(this.state="beforeAttributeValue",this.consume()):">"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.consume(),this.delegate.appendToAttributeName(e))},afterAttributeName:function(){var e=this.peek();return(0,i.isSpace)(e)?void this.consume():void("/"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.state="selfClosingStartTag"):"="===e?(this.consume(),this.state="beforeAttributeValue"):">"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.state="attributeName",this.delegate.beginAttribute(),this.delegate.appendToAttributeName(e)))},beforeAttributeValue:function(){var e=this.peek();
(0,i.isSpace)(e)?this.consume():'"'===e?(this.state="attributeValueDoubleQuoted",this.delegate.beginAttributeValue(!0),this.consume()):"'"===e?(this.state="attributeValueSingleQuoted",this.delegate.beginAttributeValue(!0),this.consume()):">"===e?(this.delegate.beginAttributeValue(!1),this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.state="attributeValueUnquoted",this.delegate.beginAttributeValue(!1),this.consume(),this.delegate.appendToAttributeValue(e))},attributeValueDoubleQuoted:function(){var e=this.consume();'"'===e?(this.delegate.finishAttributeValue(),this.state="afterAttributeValueQuoted"):"&"===e?this.delegate.appendToAttributeValue(this.consumeCharRef('"')||"&"):this.delegate.appendToAttributeValue(e)},attributeValueSingleQuoted:function(){var e=this.consume();"'"===e?(this.delegate.finishAttributeValue(),this.state="afterAttributeValueQuoted"):"&"===e?this.delegate.appendToAttributeValue(this.consumeCharRef("'")||"&"):this.delegate.appendToAttributeValue(e)},attributeValueUnquoted:function(){var e=this.peek();(0,i.isSpace)(e)?(this.delegate.finishAttributeValue(),this.consume(),this.state="beforeAttributeName"):"&"===e?(this.consume(),this.delegate.appendToAttributeValue(this.consumeCharRef(">")||"&")):">"===e?(this.delegate.finishAttributeValue(),this.consume(),this.delegate.finishTag(),this.state="beforeData"):(this.consume(),this.delegate.appendToAttributeValue(e))},afterAttributeValueQuoted:function(){var e=this.peek();(0,i.isSpace)(e)?(this.consume(),this.state="beforeAttributeName"):"/"===e?(this.consume(),this.state="selfClosingStartTag"):">"===e?(this.consume(),this.delegate.finishTag(),this.state="beforeData"):this.state="beforeAttributeName"},selfClosingStartTag:function(){var e=this.peek();">"===e?(this.consume(),this.delegate.markTagAsSelfClosing(),this.delegate.finishTag(),this.state="beforeData"):this.state="beforeAttributeName"},endTagOpen:function(){var e=this.consume();(0,i.isAlpha)(e)&&(this.state="tagName",this.delegate.beginEndTag(),this.delegate.appendToTagName(e.toLowerCase()))}}},n["default"]=r},{"./utils":129}],126:[function(e,t,n){"use strict";n.__esModule=!0;var r={nbsp:""};n["default"]=r},{}],127:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=new s["default"](new u["default"](f["default"]),t);return n.tokenize(e)}n.__esModule=!0,n["default"]=i;var o=e("./tokenizer"),s=r(o),a=e("./entity-parser"),u=r(a),c=e("./html5-named-char-refs"),f=r(c)},{"./entity-parser":124,"./html5-named-char-refs":126,"./tokenizer":128}],128:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){this.token=null,this.startLine=1,this.startColumn=0,this.options=t||{},this.tokenizer=new s["default"](this,e)}n.__esModule=!0;var o=e("./evented-tokenizer"),s=r(o);i.prototype={tokenize:function(e){return this.tokens=[],this.tokenizer.tokenize(e),this.tokens},tokenizePart:function(e){return this.tokens=[],this.tokenizer.tokenizePart(e),this.tokens},tokenizeEOF:function(){return this.tokens=[],this.tokenizer.tokenizeEOF(),this.tokens[0]},reset:function(){this.token=null,this.startLine=1,this.startColumn=0},addLocInfo:function(){this.options.loc&&(this.token.loc={start:{line:this.startLine,column:this.startColumn},end:{line:this.tokenizer.line,column:this.tokenizer.column}}),this.startLine=this.tokenizer.line,this.startColumn=this.tokenizer.column},beginData:function(){this.token={type:"Chars",chars:""},this.tokens.push(this.token)},appendToData:function(e){this.token.chars+=e},finishData:function(){this.addLocInfo()},beginComment:function(){this.token={type:"Comment",chars:""},this.tokens.push(this.token)},appendToCommentData:function(e){this.token.chars+=e},finishComment:function(){this.addLocInfo()},beginStartTag:function(){this.token={type:"StartTag",tagName:"",attributes:[],selfClosing:!1},this.tokens.push(this.token)},beginEndTag:function(){this.token={type:"EndTag",tagName:""},this.tokens.push(this.token)},finishTag:function(){this.addLocInfo()},markTagAsSelfClosing:function(){this.token.selfClosing=!0},appendToTagName:function(e){this.token.tagName+=e},beginAttribute:function(){this._currentAttribute=["","",null],this.token.attributes.push(this._currentAttribute)},appendToAttributeName:function(e){this._currentAttribute[0]+=e},beginAttributeValue:function(e){this._currentAttribute[2]=e},appendToAttributeValue:function(e){this._currentAttribute[1]=this._currentAttribute[1]||"",this._currentAttribute[1]+=e},finishAttributeValue:function(){}},n["default"]=i},{"./evented-tokenizer":125}],129:[function(e,t,n){"use strict";function r(e){return s.test(e)}function i(e){return a.test(e)}function o(e){return e.replace(u,"\n")}n.__esModule=!0,n.isSpace=r,n.isAlpha=i,n.preprocessInput=o;var s=/[\t\n\f ]/,a=/[A-Za-z]/,u=/\r\n?/g},{}],130:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.localforage=e()}}(function(){return function t(n,r,i){function o(a,u){if(!r[a]){if(!n[a]){var c="function"==typeof e&&e;if(!u&&c)return c(a,!0);if(s)return s(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[a]={exports:{}};n[a][0].call(l.exports,function(e){var t=n[a][1][e];return o(t?t:e)},l,l.exports,t,n,r,i)}return r[a].exports}for(var s="function"==typeof e&&e,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){"use strict";function r(){}function i(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,e!==r&&u(this,e)}function o(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function s(e,t,n){d(function(){var r;try{r=t(n)}catch(i){return g.reject(e,i)}r===e?g.reject(e,new TypeError("Cannot resolve promise with itself")):g.resolve(e,r)})}function a(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function u(e,t){function n(t){o||(o=!0,g.reject(e,t))}function r(t){o||(o=!0,g.resolve(e,t))}function i(){t(r,n)}var o=!1,s=c(i);"error"===s.status&&n(s.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}function f(e){return e instanceof this?e:g.resolve(new this(r),e)}function l(e){var t=new this(r);return g.reject(t,e)}function h(e){function t(e,t){function r(e){s[t]=e,++a!==i||o||(o=!0,g.resolve(c,s))}n.resolve(e).then(r,function(e){o||(o=!0,g.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var s=new Array(i),a=0,u=-1,c=new this(r);++u<i;)t(e[u],u);return c}function p(e){function t(e){n.resolve(e).then(function(e){o||(o=!0,g.resolve(a,e))},function(e){o||(o=!0,g.reject(a,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var s=-1,a=new this(r);++s<i;)t(e[s]);return a}var d=e(2),g={},y=["REJECTED"],m=["FULFILLED"],v=["PENDING"];t.exports=n=i,i.prototype["catch"]=function(e){return this.then(null,e)},i.prototype.then=function(e,t){if("function"!=typeof e&&this.state===m||"function"!=typeof t&&this.state===y)return this;var n=new this.constructor(r);if(this.state!==v){var i=this.state===m?e:t;s(n,i,this.outcome)}else this.queue.push(new o(n,e,t));return n},o.prototype.callFulfilled=function(e){g.resolve(this.promise,e)},o.prototype.otherCallFulfilled=function(e){s(this.promise,this.onFulfilled,e)},o.prototype.callRejected=function(e){g.reject(this.promise,e)},o.prototype.otherCallRejected=function(e){s(this.promise,this.onRejected,e)},g.resolve=function(e,t){var n=c(a,t);if("error"===n.status)return g.reject(e,n.value);var r=n.value;if(r)u(e,r);else{e.state=m,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},g.reject=function(e,t){e.state=y,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},n.resolve=f,n.reject=l,n.all=h,n.race=p},{2:2}],2:[function(e,t,n){(function(e){"use strict";function n(){f=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}f=!1}function r(e){1!==l.push(e)||f||i()}var i,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var s=0,a=new o(n),u=e.document.createTextNode("");a.observe(u,{characterData:!0}),i=function(){u.data=s=++s%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,i=function(){c.port2.postMessage(0)}}var f,l=[];t.exports=r}).call(this,"undefined"!=typeof r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(1))}).call(this,"undefined"!=typeof r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}function o(){try{return!!oe&&(!("undefined"!=typeof openDatabase&&"undefined"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))&&(oe&&"function"==typeof oe.open&&"undefined"!=typeof IDBKeyRange))}catch(e){return!1}}function s(){return"function"==typeof openDatabase}function a(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}function u(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(n){if("TypeError"!==n.name)throw n;for(var r="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,i=new r,o=0;o<e.length;o+=1)i.append(e[o]);return i.getBlob(t.type)}}function c(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function f(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e["catch"](n)}function l(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function h(e){return new ue(function(t){var n=u([""]);e.objectStore(ce).put(n,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})["catch"](function(){return!1})}function p(e){return"boolean"==typeof se?ue.resolve(se):h(e).then(function(e){return se=e})}function d(e){var t=ae[e.name],n={};n.promise=new ue(function(e){n.resolve=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function g(e){var t=ae[e.name],n=t.deferredOperations.pop();n&&n.resolve()}function y(e,t){return new ue(function(n,r){if(e.db){if(!t)return n(e.db);d(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=oe.open.apply(oe,i);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(ce)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(){r(o.error)},o.onsuccess=function(){n(o.result),g(e)}})}function m(e){return y(e,!1)}function v(e){return y(e,!0)}function b(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function w(e){return new ue(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function E(e){var t=l(atob(e.data));return u([t],{type:e.type})}function _(e){return e&&e.__local_forage_encoded_blob}function S(e){var t=this,n=t._initReady().then(function(){var e=ae[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return f(n,e,e),n}function k(e){function t(){return ue.resolve()}var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];ae||(ae={});var o=ae[r.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},ae[r.name]=o),o.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=S);for(var s=[],a=0;a<o.forages.length;a++){var u=o.forages[a];u!==n&&s.push(u._initReady()["catch"](t))}var c=o.forages.slice(0);return ue.all(s).then(function(){return r.db=o.db,m(r)}).then(function(e){return r.db=e,b(r,n._defaultConfig.version)?v(r):e}).then(function(e){r.db=o.db=e,n._dbInfo=r;for(var t=0;t<c.length;t++){var i=c[t];i!==n&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}})}function C(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),s=o.get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),_(e)&&(e=E(e)),t(e)},s.onerror=function(){r(s.error)}})["catch"](r)});return c(r,t),r}function x(e,t){var n=this,r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),s=o.openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;_(r)&&(r=E(r));var i=e(r,n.key,a++);void 0!==i?t(i):n["continue"]()}else t()},s.onerror=function(){r(s.error)}})["catch"](r)});return c(r,t),r}function I(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new ue(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===fe.call(t)?p(o.db).then(function(e){return e?t:w(t)}):t}).then(function(t){var r=o.db.transaction(o.storeName,"readwrite"),s=r.objectStore(o.storeName);null===t&&(t=void 0),r.oncomplete=function(){void 0===t&&(t=null),n(t)},r.onabort=r.onerror=function(){var e=a.error?a.error:a.transaction.error;i(e)};var a=s.put(t,e)})["catch"](i)});return c(i,n),i}function A(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readwrite"),s=o.objectStore(i.storeName),a=s["delete"](e);o.oncomplete=function(){t()},o.onerror=function(){r(a.error)},o.onabort=function(){var e=a.error?a.error:a.transaction.error;r(e)}})["catch"](r)});return c(r,t),r}function P(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),o=i.objectStore(r.storeName),s=o.clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=s.error?s.error:s.transaction.error;n(e)}})["catch"](n)});return c(n,e),n}function T(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),o=i.count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}})["catch"](n)});return c(n,e),n}function M(e,t){var n=this,r=new ue(function(t,r){return e<0?void t(null):void n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),s=!1,a=o.openCursor();a.onsuccess=function(){var n=a.result;return n?void(0===e?t(n.key):s?t(n.key):(s=!0,n.advance(e))):void t(null)},a.onerror=function(){r(a.error)}})["catch"](r)});return c(r,t),r}function R(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),o=i.openCursor(),s=[];o.onsuccess=function(){var t=o.result;return t?(s.push(t.key),void t["continue"]()):void e(s)},o.onerror=function(){n(o.error)}})["catch"](n)});return c(n,e),n}function O(e){var t,n,r,i,o,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),f=new Uint8Array(c);for(t=0;t<a;t+=4)n=he.indexOf(e[t]),r=he.indexOf(e[t+1]),i=he.indexOf(e[t+2]),o=he.indexOf(e[t+3]),f[u++]=n<<2|r>>4,f[u++]=(15&r)<<4|i>>2,f[u++]=(3&i)<<6|63&o;return c}function B(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=he[n[t]>>2],r+=he[(3&n[t])<<4|n[t+1]>>4],r+=he[(15&n[t+1])<<2|n[t+2]>>6],r+=he[63&n[t+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function D(e,t){var n="";if(e&&(n=Pe.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===Pe.call(e.buffer))){var r,i=ge;e instanceof ArrayBuffer?(r=e,i+=me):(r=e.buffer,"[object Int8Array]"===n?i+=be:"[object Uint8Array]"===n?i+=we:"[object Uint8ClampedArray]"===n?i+=Ee:"[object Int16Array]"===n?i+=_e:"[object Uint16Array]"===n?i+=ke:"[object Int32Array]"===n?i+=Se:"[object Uint32Array]"===n?i+=Ce:"[object Float32Array]"===n?i+=xe:"[object Float64Array]"===n?i+=Ie:t(new Error("Failed to get type for BinaryArray"))),t(i+B(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=pe+e.type+"~"+B(this.result);t(ge+ve+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function N(e){if(e.substring(0,ye)!==ge)return JSON.parse(e);var t,n=e.substring(Ae),r=e.substring(ye,Ae);if(r===ve&&de.test(n)){var i=n.match(de);t=i[1],n=n.substring(i[0].length)}var o=O(n);switch(r){case me:return o;case ve:return u([o],{type:t});case be:return new Int8Array(o);case we:return new Uint8Array(o);case Ee:return new Uint8ClampedArray(o);case _e:return new Int16Array(o);case ke:return new Uint16Array(o);case Se:return new Int32Array(o);case Ce:return new Uint32Array(o);case xe:return new Float32Array(o);case Ie:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}function L(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new ue(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(i){return r(i)}n.db.transaction(function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=n,e()},function(e,t){r(t)})})});return n.serializer=Te,i}function F(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})})["catch"](r)});return c(r,t),r}function U(e,t){var n=this,r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var u=o.item(a),c=u.value;if(c&&(c=i.serializer.deserialize(c)),c=e(c,u.key,a+1),void 0!==c)return void t(c)}t()},function(e,t){r(t)})})})["catch"](r)});return c(r,t),r}function j(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new ue(function(n,i){r.ready().then(function(){void 0===t&&(t=null);var o=t,s=r._dbInfo;s.serializer.serialize(t,function(t,r){r?i(r):s.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){n(o)},function(e,t){i(t)})},function(e){e.code===e.QUOTA_ERR&&i(e)})})})["catch"](i)});return c(i,n),i}function z(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})})["catch"](r)});return c(r,t),r}function K(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})})["catch"](n)});return c(n,e),n}function H(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})})["catch"](n)});return c(n,e),n}function q(e,t){var n=this,r=new ue(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})})["catch"](r)});return c(r,t),r}function V(e){var t=this,n=new ue(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})})["catch"](n)});return c(n,e),n}function W(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=n.name+"/",n.storeName!==t._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),t._dbInfo=n,n.serializer=Te,ue.resolve()}function G(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return c(n,e),n}function Y(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return c(r,t),r}function X(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var u=localStorage.key(a);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=t.serializer.deserialize(c)),c=e(c,u.substring(i),s++),void 0!==c)return c}}});return c(r,t),r}function $(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(i){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return c(r,t),r}function J(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++)0===localStorage.key(i).indexOf(e.keyPrefix)&&r.push(localStorage.key(i).substring(e.keyPrefix.length));return r});return c(n,e),n}function Q(e){var t=this,n=t.keys().then(function(e){return e.length});return c(n,e),n}function Z(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return c(r,t),r}function ee(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new ue(function(i,o){var s=r._dbInfo;s.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+e,t),i(n)}catch(a){"QuotaExceededError"!==a.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==a.name||o(a),o(a)}})})});return c(i,n),i}function te(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function ne(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ue(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function re(e){for(var t in Be)if(Be.hasOwnProperty(t)&&Be[t]===e)return!0;return!1}var ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe=i();"undefined"==typeof Promise&&"undefined"!=typeof e&&e(3);var se,ae,ue=Promise,ce="local-forage-detect-blob-support",fe=Object.prototype.toString,le={_driver:"asyncStorage",_initStorage:k,iterate:x,getItem:C,setItem:I,removeItem:A,clear:P,length:T,key:M,keys:R},he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pe="~~local_forage_type~",de=/^~~local_forage_type~([^~]+)~/,ge="__lfsc__:",ye=ge.length,me="arbf",ve="blob",be="si08",we="ui08",Ee="uic8",_e="si16",Se="si32",ke="ur16",Ce="ui32",xe="fl32",Ie="fl64",Ae=ye+me.length,Pe=Object.prototype.toString,Te={serialize:D,deserialize:N,stringToBuffer:O,bufferToString:B},Me={_driver:"webSQLStorage",_initStorage:L,iterate:U,getItem:F,setItem:j,removeItem:z,clear:K,length:H,key:q,keys:V},Re={_driver:"localStorageWrapper",_initStorage:W,iterate:X,getItem:Y,setItem:ee,removeItem:Z,clear:G,length:Q,key:$,keys:J},Oe={},Be={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},De=[Be.INDEXEDDB,Be.WEBSQL,Be.LOCALSTORAGE],Ne=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],Le={description:"",driver:De.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Fe={};Fe[Be.INDEXEDDB]=o(),Fe[Be.WEBSQL]=s(),Fe[Be.LOCALSTORAGE]=a();var Ue=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},je=function(){function e(t){r(this,e),this.INDEXEDDB=Be.INDEXEDDB,this.LOCALSTORAGE=Be.LOCALSTORAGE,this.WEBSQL=Be.WEBSQL,this._defaultConfig=ne({},Le),this._config=ne({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(e){if("object"===("undefined"==typeof e?"undefined":ie(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)"storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new ue(function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),o=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(i);if(re(e._driver))return void n(o);for(var s=Ne.concat("_initStorage"),a=0;a<s.length;a++){var u=s[a];if(!u||!e[u]||"function"!=typeof e[u])return void n(i)}var c=ue.resolve(!0);"_support"in e&&(c=e._support&&"function"==typeof e._support?e._support():ue.resolve(!!e._support)),c.then(function(n){Fe[r]=n,Oe[r]=e,t()},n)}catch(f){n(f)}});return f(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=this,i=ue.resolve().then(function(){if(!re(e)){if(Oe[e])return Oe[e];throw new Error("Driver not found.")}switch(e){case r.INDEXEDDB:return le;case r.LOCALSTORAGE:return Re;case r.WEBSQL:return Me}});return f(i,t,n),i},e.prototype.getSerializer=function(e){var t=ue.resolve(Te);return f(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return f(n,e,e),n},e.prototype.setDriver=function(e,t,n){function r(){o._config.driver=o.driver()}function i(e){return function(){function t(){for(;n<e.length;){var i=e[n];return n++,o._dbInfo=null,o._ready=null,o.getDriver(i).then(function(e){return o._extend(e),r(),o._ready=o._initStorage(o._config),o._ready})["catch"](t)}r();var s=new Error("No available storage method found.");return o._driverSet=ue.reject(s),o._driverSet}var n=0;return t()}}var o=this;Ue(e)||(e=[e]);var s=this._getSupportedDrivers(e),a=null!==this._driverSet?this._driverSet["catch"](function(){return ue.resolve()}):ue.resolve();return this._driverSet=a.then(function(){var e=s[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then(function(e){o._driver=e._driver,r(),o._wrapLibraryMethodsWithReady(),o._initDriver=i(s)})})["catch"](function(){r();var e=new Error("No available storage method found.");return o._driverSet=ue.reject(e),o._driverSet}),f(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Fe[e]},e.prototype._extend=function(e){ne(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<Ne.length;e++)te(this,Ne[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),ze=new je;t.exports=ze},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],131:[function(e,t,n){(function(e){function n(e,t){return null==e?void 0:e[t]}function r(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function i(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function o(){this.__data__=ye?ye(null):{}}function s(e){return this.has(e)&&delete this.__data__[e]}function a(e){var t=this.__data__;if(ye){var n=t[e];return n===H?void 0:n}return fe.call(t,e)?t[e]:void 0}function u(e){var t=this.__data__;return ye?void 0!==t[e]:fe.call(t,e)}function c(e,t){var n=this.__data__;return n[e]=ye&&void 0===t?H:t,this}function f(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function l(){this.__data__=[]}function h(e){var t=this.__data__,n=_(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():de.call(t,n,1),!0}function p(e){var t=this.__data__,n=_(t,e);return n<0?void 0:t[n][1]}function d(e){return _(this.__data__,e)>-1}function g(e,t){var n=this.__data__,r=_(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}function y(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function m(){this.__data__={hash:new i,map:new(ge||f),string:new i}}function v(e){return I(this,e)["delete"](e)}function b(e){return I(this,e).get(e)}function w(e){return I(this,e).has(e)}function E(e,t){return I(this,e).set(e,t),this}function _(e,t){for(var n=e.length;n--;)if(D(e[n][0],t))return n;return-1}function S(e,t){t=P(t,e)?[t]:x(t);for(var n=0,r=t.length;null!=e&&n<r;)e=e[R(t[n++])];return n&&n==r?e:void 0}function k(e){if(!L(e)||M(e))return!1;var t=N(e)||r(e)?he:ee;return t.test(O(e))}function C(e){if("string"==typeof e)return e;if(U(e))return ve?ve.call(e):"";var t=e+"";return"0"==t&&1/e==-q?"-0":t}function x(e){return we(e)?e:be(e)}function I(e,t){var n=e.__data__;return T(t)?n["string"==typeof t?"string":"hash"]:n.map}function A(e,t){var r=n(e,t);return k(r)?r:void 0}function P(e,t){if(we(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!U(e))||(X.test(e)||!Y.test(e)||null!=t&&e in Object(t))}function T(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e;
}function M(e){return!!ue&&ue in e}function R(e){if("string"==typeof e||U(e))return e;var t=e+"";return"0"==t&&1/e==-q?"-0":t}function O(e){if(null!=e){try{return ce.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function B(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(K);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new(B.Cache||y),n}function D(e,t){return e===t||e!==e&&t!==t}function N(e){var t=L(e)?le.call(e):"";return t==V||t==W}function L(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function F(e){return!!e&&"object"==typeof e}function U(e){return"symbol"==typeof e||F(e)&&le.call(e)==G}function j(e){return null==e?"":C(e)}function z(e,t,n){var r=null==e?void 0:S(e,t);return void 0===r?n:r}var K="Expected a function",H="__lodash_hash_undefined__",q=1/0,V="[object Function]",W="[object GeneratorFunction]",G="[object Symbol]",Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,$=/^\./,J=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q=/[\\^$.*+?()[\]{}|]/g,Z=/\\(\\)?/g,ee=/^\[object .+?Constructor\]$/,te="object"==typeof e&&e&&e.Object===Object&&e,ne="object"==typeof self&&self&&self.Object===Object&&self,re=te||ne||Function("return this")(),ie=Array.prototype,oe=Function.prototype,se=Object.prototype,ae=re["__core-js_shared__"],ue=function(){var e=/[^.]+$/.exec(ae&&ae.keys&&ae.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ce=oe.toString,fe=se.hasOwnProperty,le=se.toString,he=RegExp("^"+ce.call(fe).replace(Q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pe=re.Symbol,de=ie.splice,ge=A(re,"Map"),ye=A(Object,"create"),me=pe?pe.prototype:void 0,ve=me?me.toString:void 0;i.prototype.clear=o,i.prototype["delete"]=s,i.prototype.get=a,i.prototype.has=u,i.prototype.set=c,f.prototype.clear=l,f.prototype["delete"]=h,f.prototype.get=p,f.prototype.has=d,f.prototype.set=g,y.prototype.clear=m,y.prototype["delete"]=v,y.prototype.get=b,y.prototype.has=w,y.prototype.set=E;var be=B(function(e){e=j(e);var t=[];return $.test(e)&&t.push(""),e.replace(J,function(e,n,r,i){t.push(r?i.replace(Z,"$1"):n||e)}),t});B.Cache=y;var we=Array.isArray;t.exports=z}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],132:[function(e,t,n){(function(e){function n(e,t){return null==e?void 0:e[t]}function r(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function i(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function o(){this.__data__=we?we(null):{}}function s(e){return this.has(e)&&delete this.__data__[e]}function a(e){var t=this.__data__;if(we){var n=t[e];return n===V?void 0:n}return de.call(t,e)?t[e]:void 0}function u(e){var t=this.__data__;return we?void 0!==t[e]:de.call(t,e)}function c(e,t){var n=this.__data__;return n[e]=we&&void 0===t?V:t,this}function f(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function l(){this.__data__=[]}function h(e){var t=this.__data__,n=S(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():ve.call(t,n,1),!0}function p(e){var t=this.__data__,n=S(t,e);return n<0?void 0:t[n][1]}function d(e){return S(this.__data__,e)>-1}function g(e,t){var n=this.__data__,r=S(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}function y(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function m(){this.__data__={hash:new i,map:new(be||f),string:new i}}function v(e){return A(this,e)["delete"](e)}function b(e){return A(this,e).get(e)}function w(e){return A(this,e).has(e)}function E(e,t){return A(this,e).set(e,t),this}function _(e,t,n){var r=e[t];de.call(e,t)&&L(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function S(e,t){for(var n=e.length;n--;)if(L(e[n][0],t))return n;return-1}function k(e){if(!U(e)||O(e))return!1;var t=F(e)||r(e)?ye:re;return t.test(D(e))}function C(e,t,n,r){if(!U(e))return e;t=M(t,e)?[t]:I(t);for(var i=-1,o=t.length,s=o-1,a=e;null!=a&&++i<o;){var u=B(t[i]),c=n;if(i!=s){var f=a[u];c=r?r(f,u,a):void 0,void 0===c&&(c=U(f)?f:T(t[i+1])?[]:{})}_(a,u,c),a=a[u]}return e}function x(e){if("string"==typeof e)return e;if(z(e))return _e?_e.call(e):"";var t=e+"";return"0"==t&&1/e==-W?"-0":t}function I(e){return ke(e)?e:Se(e)}function A(e,t){var n=e.__data__;return R(t)?n["string"==typeof t?"string":"hash"]:n.map}function P(e,t){var r=n(e,t);return k(r)?r:void 0}function T(e,t){return t=null==t?G:t,!!t&&("number"==typeof e||ie.test(e))&&e>-1&&e%1==0&&e<t}function M(e,t){if(ke(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!z(e))||(Q.test(e)||!J.test(e)||null!=t&&e in Object(t))}function R(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function O(e){return!!he&&he in e}function B(e){if("string"==typeof e||z(e))return e;var t=e+"";return"0"==t&&1/e==-W?"-0":t}function D(e){if(null!=e){try{return pe.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function N(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(q);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new(N.Cache||y),n}function L(e,t){return e===t||e!==e&&t!==t}function F(e){var t=U(e)?ge.call(e):"";return t==Y||t==X}function U(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function j(e){return!!e&&"object"==typeof e}function z(e){return"symbol"==typeof e||j(e)&&ge.call(e)==$}function K(e){return null==e?"":x(e)}function H(e,t,n){return null==e?e:C(e,t,n)}var q="Expected a function",V="__lodash_hash_undefined__",W=1/0,G=9007199254740991,Y="[object Function]",X="[object GeneratorFunction]",$="[object Symbol]",J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,Z=/^\./,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=/\\(\\)?/g,re=/^\[object .+?Constructor\]$/,ie=/^(?:0|[1-9]\d*)$/,oe="object"==typeof e&&e&&e.Object===Object&&e,se="object"==typeof self&&self&&self.Object===Object&&self,ae=oe||se||Function("return this")(),ue=Array.prototype,ce=Function.prototype,fe=Object.prototype,le=ae["__core-js_shared__"],he=function(){var e=/[^.]+$/.exec(le&&le.keys&&le.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),pe=ce.toString,de=fe.hasOwnProperty,ge=fe.toString,ye=RegExp("^"+pe.call(de).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),me=ae.Symbol,ve=ue.splice,be=P(ae,"Map"),we=P(Object,"create"),Ee=me?me.prototype:void 0,_e=Ee?Ee.toString:void 0;i.prototype.clear=o,i.prototype["delete"]=s,i.prototype.get=a,i.prototype.has=u,i.prototype.set=c,f.prototype.clear=l,f.prototype["delete"]=h,f.prototype.get=p,f.prototype.has=d,f.prototype.set=g,y.prototype.clear=m,y.prototype["delete"]=v,y.prototype.get=b,y.prototype.has=w,y.prototype.set=E;var Se=N(function(e){e=K(e);var t=[];return Z.test(e)&&t.push(""),e.replace(ee,function(e,n,r,i){t.push(r?i.replace(ne,"$1"):n||e)}),t});N.Cache=y;var ke=Array.isArray;t.exports=H}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],133:[function(e,t,n){!function(n,r){"function"==typeof define&&define.amd?define([],r):"function"==typeof e&&"object"==typeof t&&t&&t.exports?t.exports=r():(n.dcodeIO=n.dcodeIO||{}).Long=r()}(this,function(){"use strict";function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}e.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=function(e){return(e&&e.__isLong__)===!0};var t={},n={};e.fromInt=function(r,i){var o,s;return i?(r>>>=0,0<=r&&r<256&&(s=n[r])?s:(o=new e(r,(0|r)<0?-1:0,(!0)),0<=r&&r<256&&(n[r]=o),o)):(r=0|r,-128<=r&&r<128&&(s=t[r])?s:(o=new e(r,r<0?-1:0,(!1)),-128<=r&&r<128&&(t[r]=o),o))},e.fromNumber=function(t,n){return n=!!n,isNaN(t)||!isFinite(t)?e.ZERO:!n&&t<=-s?e.MIN_VALUE:!n&&t+1>=s?e.MAX_VALUE:n&&t>=o?e.MAX_UNSIGNED_VALUE:t<0?e.fromNumber(-t,n).negate():new e(t%i|0,t/i|0,n)},e.fromBits=function(t,n,r){return new e(t,n,r)},e.fromString=function(t,n,r){if(0===t.length)throw Error("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return e.ZERO;if("number"==typeof n&&(r=n,n=!1),r=r||10,r<2||36<r)throw Error("radix out of range: "+r);var i;if((i=t.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+t);if(0===i)return e.fromString(t.substring(1),n,r).negate();for(var o=e.fromNumber(Math.pow(r,8)),s=e.ZERO,a=0;a<t.length;a+=8){var u=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+u),r);if(u<8){var f=e.fromNumber(Math.pow(r,u));s=s.multiply(f).add(e.fromNumber(c))}else s=s.multiply(o),s=s.add(e.fromNumber(c))}return s.unsigned=n,s},e.fromValue=function(t){return t instanceof e?t:"number"==typeof t?e.fromNumber(t):"string"==typeof t?e.fromString(t):new e(t.low,t.high,t.unsigned)};var r=1<<24,i=4294967296,o=0x10000000000000000,s=o/2,a=e.fromInt(r);return e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*i+(this.low>>>0):this.high*i+(this.low>>>0)},e.prototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix out of range: "+t);if(this.isZero())return"0";var n;if(this.isNegative()){if(this.equals(e.MIN_VALUE)){var r=e.fromNumber(t),i=this.divide(r);return n=i.multiply(r).subtract(this),i.toString(t)+n.toInt().toString(t)}return"-"+this.negate().toString(t)}var o=e.fromNumber(Math.pow(t,6),this.unsigned);n=this;for(var s="";;){var a=n.divide(o),u=n.subtract(a.multiply(o)).toInt()>>>0,c=u.toString(t);if(n=a,n.isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(e.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,n=31;n>0&&0==(t&1<<n);n--);return 0!=this.high?n+33:n+1},e.prototype.isZero=function(){return 0===this.high&&0===this.low},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isOdd=function(){return 1===(1&this.low)},e.prototype.isEven=function(){return 0===(1&this.low)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},e.eq=e.prototype.equals,e.prototype.notEquals=function(e){return!this.equals(e)},e.neq=e.prototype.notEquals,e.prototype.lessThan=function(e){return this.compare(e)<0},e.prototype.lt=e.prototype.lessThan,e.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},e.prototype.lte=e.prototype.lessThanOrEqual,e.prototype.greaterThan=function(e){return this.compare(e)>0},e.prototype.gt=e.prototype.greaterThan,e.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},e.prototype.gte=e.prototype.greaterThanOrEqual,e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.equals(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.subtract(t).isNegative()?-1:1},e.prototype.negate=function(){return!this.unsigned&&this.equals(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=e.prototype.negate,e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=t.high>>>16,a=65535&t.high,u=t.low>>>16,c=65535&t.low,f=0,l=0,h=0,p=0;return p+=o+c,h+=p>>>16,p&=65535,h+=i+u,l+=h>>>16,h&=65535,l+=r+a,f+=l>>>16,l&=65535,f+=n+s,f&=65535,e.fromBits(h<<16|p,f<<16|l,this.unsigned)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.negate())},e.prototype.sub=e.prototype.subtract,e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())return e.ZERO;if(this.equals(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.equals(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(a)&&t.lessThan(a))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=t.high>>>16,u=65535&t.high,c=t.low>>>16,f=65535&t.low,l=0,h=0,p=0,d=0;return d+=o*f,p+=d>>>16,d&=65535,p+=i*f,h+=p>>>16,p&=65535,p+=o*c,h+=p>>>16,p&=65535,h+=r*f,l+=h>>>16,h&=65535,h+=i*c,l+=h>>>16,h&=65535,h+=o*u,l+=h>>>16,h&=65535,l+=n*f+r*c+i*u+o*s,l&=65535,e.fromBits(p<<16|d,l<<16|h,this.unsigned)},e.prototype.mul=e.prototype.multiply,e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var n,r,i;if(this.equals(e.MIN_VALUE)){if(t.equals(e.ONE)||t.equals(e.NEG_ONE))return e.MIN_VALUE;if(t.equals(e.MIN_VALUE))return e.ONE;var o=this.shiftRight(1);return n=o.divide(t).shiftLeft(1),n.equals(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(r=this.subtract(t.multiply(n)),i=n.add(r.divide(t)))}if(t.equals(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.negate().divide(t.negate()):this.negate().divide(t).negate();if(t.isNegative())return this.divide(t.negate()).negate();for(i=e.ZERO,r=this;r.greaterThanOrEqual(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:Math.pow(2,s-48),u=e.fromNumber(n),c=u.multiply(t);c.isNegative()||c.greaterThan(r);)n-=a,u=e.fromNumber(n,this.unsigned),c=u.multiply(t);u.isZero()&&(u=e.ONE),i=i.add(u),r=r.subtract(c)}return i},e.prototype.div=e.prototype.divide,e.prototype.modulo=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.subtract(this.divide(t).multiply(t))},e.prototype.mod=e.prototype.modulo,e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=e.prototype.shiftLeft,e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=e.prototype.shiftRight,e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),t&=63,0===t)return this;var n=this.high;if(t<32){var r=this.low;return e.fromBits(r>>>t|n<<32-t,n>>>t,this.unsigned)}return 32===t?e.fromBits(n,0,this.unsigned):e.fromBits(n>>>t-32,0,this.unsigned)},e.prototype.shru=e.prototype.shiftRightUnsigned,e.prototype.toSigned=function(){return this.unsigned?new e(this.low,this.high,(!1)):this},e.prototype.toUnsigned=function(){return this.unsigned?this:new e(this.low,this.high,(!0))},e})},{}],134:[function(e,t,n){function r(e,t){if(!e)throw new Error(t||"Assertion failed")}t.exports=r,r.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},{}],135:[function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function i(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(o){return!1}}var o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;t.exports=i()?Object.assign:function(e,t){for(var n,i,u=r(e),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var f in n)s.call(n,f)&&(u[f]=n[f]);if(o){i=o(n);for(var l=0;l<i.length;l++)a.call(n,i[l])&&(u[i[l]]=n[i[l]])}}return u}},{}],136:[function(e,t,n){function r(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}var i=e("wrappy");t.exports=i(r),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0})})},{wrappy:396}],137:[function(e,t,n){t.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],138:[function(e,t,n){var r=e("asn1.js"),i=r.define("RSAPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("modulus")["int"](),this.key("publicExponent")["int"](),this.key("privateExponent")["int"](),this.key("prime1")["int"](),this.key("prime2")["int"](),this.key("exponent1")["int"](),this.key("exponent2")["int"](),this.key("coefficient")["int"]())});n.RSAPrivateKey=i;var o=r.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus")["int"](),this.key("publicExponent")["int"]())});n.RSAPublicKey=o;var s=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())});n.PublicKey=s;var a=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p")["int"](),this.key("q")["int"](),this.key("g")["int"]()).optional())}),u=r.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version")["int"](),this.key("algorithm").use(a),this.key("subjectPrivateKey").octstr())});n.PrivateKey=u;var c=r.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters")["int"]())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});n.EncryptedPrivateKey=c;var f=r.define("DSAPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("p")["int"](),this.key("q")["int"](),this.key("g")["int"](),this.key("pub_key")["int"](),this.key("priv_key")["int"]())});n.DSAPrivateKey=f,n.DSAparam=r.define("DSAparam",function(){this["int"]()});var l=r.define("ECPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(h),this.key("publicKey").optional().explicit(1).bitstr())});n.ECPrivateKey=l;var h=r.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});n.signature=r.define("signature",function(){this.seq().obj(this.key("r")["int"](),this.key("s")["int"]())})},{"asn1.js":1}],139:[function(e,t,n){(function(Buffer){var n=/Proc-Type: 4,ENCRYPTED\r?\nDEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\r?\n\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n/m,r=/^-----BEGIN (.*) KEY-----\r?\n/m,i=/^-----BEGIN (.*) KEY-----\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n-----END \1 KEY-----$/m,o=e("evp_bytestokey"),s=e("browserify-aes");t.exports=function(e,t){var a,u=e.toString(),c=u.match(n);if(c){var f="aes"+c[1],l=new Buffer(c[2],"hex"),h=new Buffer(c[3].replace(/\r?\n/g,""),"base64"),p=o(t,l.slice(0,8),parseInt(c[1],10)).key,d=[],g=s.createDecipheriv(f,p,l);d.push(g.update(h)),d.push(g["final"]()),a=Buffer.concat(d)}else{var y=u.match(i);a=new Buffer(y[2].replace(/\r?\n/g,""),"base64")}var m=u.match(r)[1]+" KEY";return{tag:m,data:a}}}).call(this,e("buffer").Buffer)},{"browserify-aes":30,buffer:590,evp_bytestokey:74}],140:[function(e,t,n){(function(Buffer){function n(e){var t;"object"!=typeof e||Buffer.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=new Buffer(e));var n,o,a=s(e,t),u=a.tag,c=a.data;switch(u){case"PUBLIC KEY":switch(o=i.PublicKey.decode(c,"der"),n=o.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(o.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return o.subjectPrivateKey=o.subjectPublicKey,{type:"ec",data:o};case"1.2.840.10040.4.1":return o.algorithm.params.pub_key=i.DSAparam.decode(o.subjectPublicKey.data,"der"),{type:"dsa",data:o.algorithm.params};default:throw new Error("unknown key id "+n)}throw new Error("unknown key type "+u);case"ENCRYPTED PRIVATE KEY":c=i.EncryptedPrivateKey.decode(c,"der"),c=r(c,t);case"PRIVATE KEY":switch(o=i.PrivateKey.decode(c,"der"),n=o.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(o.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:o.algorithm.curve,privateKey:i.ECPrivateKey.decode(o.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return o.algorithm.params.priv_key=i.DSAparam.decode(o.subjectPrivateKey,"der"),{type:"dsa",params:o.algorithm.params};default:throw new Error("unknown key id "+n)}throw new Error("unknown key type "+u);case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(c,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(c,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(c,"der")};case"EC PRIVATE KEY":return c=i.ECPrivateKey.decode(c,"der"),{curve:c.parameters.value,privateKey:c.privateKey};default:throw new Error("unknown key type "+u)}}function r(e,t){var n=e.algorithm.decrypt.kde.kdeparams.salt,r=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),i=o[e.algorithm.decrypt.cipher.algo.join(".")],s=e.algorithm.decrypt.cipher.iv,c=e.subjectPrivateKey,f=parseInt(i.split("-")[1],10)/8,l=u.pbkdf2Sync(t,n,r,f),h=a.createDecipheriv(i,l,s),p=[];return p.push(h.update(c)),p.push(h["final"]()),Buffer.concat(p)}var i=e("./asn1"),o=e("./aesid.json"),s=e("./fixProc"),a=e("browserify-aes"),u=e("pbkdf2");t.exports=n,n.signature=i.signature}).call(this,e("buffer").Buffer)},{"./aesid.json":137,"./asn1":138,"./fixProc":139,"browserify-aes":30,buffer:590,pbkdf2:142}],141:[function(e,t,n){var r=e("trim"),i=e("for-each"),o=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return i(r(e).split("\n"),function(e){var n=e.indexOf(":"),i=r(e.slice(0,n)).toLowerCase(),s=r(e.slice(n+1));"undefined"==typeof t[i]?t[i]=s:o(t[i])?t[i].push(s):t[i]=[t[i],s]}),t}},{"for-each":75,trim:388}],142:[function(e,t,n){(function(t,Buffer){var r=e("create-hmac"),i=e("./precondition");n.pbkdf2=function(e,t,r,o,s,a){if("function"==typeof s&&(a=s,s=void 0),i(r,o),"function"!=typeof a)throw new Error("No callback provided to pbkdf2");setTimeout(function(){a(null,n.pbkdf2Sync(e,t,r,o,s))})};var o;if(t.browser)o="utf-8";else{var s=parseInt(t.version.split(".")[0].slice(1),10);o=s>=6?"utf-8":"binary"}n.pbkdf2Sync=function(e,t,n,s,a){Buffer.isBuffer(e)||(e=new Buffer(e,o)),Buffer.isBuffer(t)||(t=new Buffer(t,o)),i(n,s),a=a||"sha1";var u,c=1,f=new Buffer(s),l=new Buffer(t.length+4);t.copy(l,0,0,t.length);for(var h,p,d=1;d<=c;d++){l.writeUInt32BE(d,t.length);var g=r(a,e).update(l).digest();u||(u=g.length,p=new Buffer(u),c=Math.ceil(s/u),h=s-(c-1)*u),g.copy(p,0,0,u);for(var y=1;y<n;y++){g=r(a,e).update(g).digest();for(var m=0;m<u;m++)p[m]^=g[m]}var v=(d-1)*u,b=d===c?h:u;p.copy(f,v,0,b)}return f}}).call(this,e("_process"),e("buffer").Buffer)},{"./precondition":143,_process:592,buffer:590,"create-hmac":54}],143:[function(e,t,n){var r=Math.pow(2,30)-1;t.exports=function(e,t){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof t)throw new TypeError("Key length not a number");if(t<0||t>r||t!==t)throw new TypeError("Bad key length")}},{}],144:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-crypto"),i=e("simplito-utils"),o=e("privmx-exception"),s=e("../exception/PrivFsException"),a=e("../core/StorageProviderInterface"),u=e("bs58"),c=r.service,f=o.IllegalArgumentException,l=function(){function e(){}return e.download=function(e,t,r,o){if(!(e instanceof a))throw new f("storage",e);if(!i.isBuffer(o))throw new f("aesKey",o);var l=n.defer(),h=[],p=[],d=0;return r.forEach(function(i,a){var f,g=n(null).then(function(){return e.blockGet(i,t,!0)}).fail(function(e){return n.reject(new s("CANNOT_READ_BLOCK",{index:a,length:r.length,bid:i},null,e))}).then(function(e){return f=e,c.sha256(f)}).then(function(e){if(!e.equals(new Buffer(u.decode(i))))throw new s("CORRUPTED_BLOCK",{index:a,length:r.length,bid:i,hash:e});return c.generateIv(o,a)}).then(function(e){return c.privmxDecrypt(f,o,e)}).then(function(e){d+=1,h[a]=e,l.notify({count:d,total:r.length,percent:Math.min(100,Math.floor(100*d/r.length))})});p.push(g)}),n.all(p).then(function(){return Buffer.concat(h)}).then(l.resolve).fail(l.reject),l.promise},e}();t.exports=l}).call(this,e("buffer").Buffer)},{"../core/StorageProviderInterface":164,"../exception/PrivFsException":167,bs58:43,buffer:590,"privmx-crypto":248,"privmx-exception":266,q:327,"simplito-utils":373}],145:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-crypto"),i=e("simplito-promise"),o=e("simplito-lazybuffer"),s=e("simplito-utils"),a=e("privmx-exception"),u=e("../exception/PrivFsException"),c=e("../core/StorageProviderInterface"),f=e("bs58"),l=e("./BlockDownloader"),h=r.service,p=i.PromiseUtils,d=a.IllegalArgumentException,g=o.LazyBuffer,y=o.SimpleLazyBuffer,m=function(){function e(){}return e.stream=function(e,t,r,i){if(!(e instanceof c))throw new d("storage",e);if(!(r instanceof g))throw new d("buffer",r);if(!s.isBuffer(i))throw new d("aesKey",i);var o=h.privmxOptAesWithDettachedIv(),a=h.privmxGetBlockSize(o,e.config.maxBlockLength);if(a<0)throw new Error("Server max block length is too small for chosen algorithm");var l=n.defer(),y=[],m=r.getSize(),v=0==m?0:Math.floor(m/a)+1;return p.nTimes(v,function(s){var c,p,d=s*a,g=d+a>m?m:d+a;return n(null).then(function(){return r.slice(d,g)}).then(function(e){return c=e,h.generateIv(i,s)}).then(function(e){return h.privmxEncrypt(o,c,i,e)}).then(function(e){return p=e,h.sha256(p)}).then(function(r){var i=f.encode(r);return n(null).then(function(){return e.blockCreate(t,i,p)}).fail(function(e){return n.reject(new u("CANNOT_SEND_BLOCK",{index:s,length:v,bid:i},null,e))}).then(function(e){y.push(i),l.notify({count:s,total:v,percent:Math.min(100,Math.floor(100*s/v))})})})}).thenResolve(y).then(l.resolve).fail(l.reject),l.promise},e.addBlocksToSessionByInfo=function(t,n,r){return e.addBlocksToSession(t,n,r.storage,r.source,r.data.blocks,r.data.key)},e.addBlocksToSession=function(t,r,i,o,s,a){return n(null).then(function(){return t.getDestination()==i.getDestination()?t.blockAddToSession(r,o,s).thenResolve(s):p.oneByOne(s,function(e,a){var c;return n(null).then(function(){return i.blockGet(a,o,!0)}).fail(function(t){return n.reject(new u("CANNOT_READ_BLOCK",{index:e,length:s.length,bid:a},null,t))}).then(function(n){if(c=n,c.length>t.config.maxBlockLength)throw{msg:"ivalid-block-length",index:parseInt(e)};return h.sha256(c)}).then(function(i){if(!i.equals(new Buffer(f.decode(a))))throw new u("CORRUPTED_BLOCK",{index:e,length:s.length,bid:a,hash:i});return n(null).then(function(){return t.blockCreate(r,a,c)}).fail(function(t){return n.reject(new u("CANNOT_SEND_BLOCK",{index:e,length:s.length,bid:a},null,t))})})}).then(function(){return s}).fail(function(u){return"object"!=typeof u||null==u||"ivalid-block-length"!=u.msg||null==u.index?n.reject(u):n(null).then(function(){return l.download(i,o,s.slice(u.index),a)}).then(function(n){return e.stream(t,r,new y(n,""),a)}).then(function(e){return s.slice(0,u.index).concat(e)})})})},e}();t.exports=m}).call(this,e("buffer").Buffer)},{"../core/StorageProviderInterface":164,"../exception/PrivFsException":167,"./BlockDownloader":144,bs58:43,buffer:590,"privmx-crypto":248,"privmx-exception":266,q:327,"simplito-lazybuffer":352,"simplito-promise":370,"simplito-utils":373}],146:[function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.storage=e,this.source=t,this.data=n}return e}();t.exports=r},{}],147:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./BlockDownloader");n.BlockDownloader=r;var i=e("./BlocksInfo");n.BlocksInfo=i;var o=e("./BlockStreamer");n.BlockStreamer=o},{"./BlockDownloader":144,"./BlockStreamer":145,"./BlocksInfo":146}],148:[function(e,t,n){"use strict";var r=function(){function e(){}return e.getOrCreate=function(e){return null==e?{list:[]}:e},e.getValue=function(e){var t=e;return null!=t.value&&null!=t.acls?t.value:e},e.indexOf=function(t,n){for(var r=0;r<n.list.length;r++){var i=e.getValue(n.list[r]);if(i==t)return r}return-1},e.addToList=function(t,n){var r=e.indexOf(e.getValue(t),n);r==-1?n.list.push(t):n.list[r]=t},e}();t.exports=r},{}],149:[function(e,t,n){"use strict";var r=e("../gateway/RpcGateway"),i=e("privmx-crypto"),o=e("../identity/Identity"),s=e("../message/Message"),a=e("../message/MessageSink"),u=e("../message/MessageManager"),c=e("../message/MessageReceiver"),f=e("./PrivFsRpcManager"),l=e("./StorageProviderManager"),h=i.service,p=function(){function e(e){if(!(e instanceof r))throw new Error("Invalid gateway");this.gateway=e,this.storageProviderManager=new l(e,(!1))}return e.prototype.withIdentity=function(){var e=this;return h.eccGenerateKey("raw").then(function(t){return new o("anonymous#"+e.gateway.getHost(),t)})},e.prototype.postMessage=function(e,t,n,r,i,o){var f=this;return this.withIdentity().then(function(l){var h=a.fromSerialized(e),p=new c(h,l),d=new u(f.storageProviderManager,l),g=new s;return g.setSender(l),g.title=t,g.text=n,g.addReceiver(p),Array.isArray(r)&&r.length>0&&r.forEach(function(e){g.addAttachment(e)}),d.messagePost(g,o||[d.tagService.getUnecryptedTag("type:form")],i?{extra:i}:null)}).then(function(e){if(e[0].success)return e[0];throw e[0]})},e.create=function(t){return f.getHttpGatewayByHost(t).then(function(t){return new e(t)})},e}();t.exports=p},{"../gateway/RpcGateway":198,"../identity/Identity":201,"../message/Message":205,"../message/MessageManager":208,"../message/MessageReceiver":209,"../message/MessageSink":210,"./PrivFsRpcManager":156,"./StorageProviderManager":165,"privmx-crypto":248}],150:[function(e,t,n){"use strict";var r=function(){function e(){}return e.is=function(t,n){var r=e.codes[n];return null!=t&&null!=t.data&&null!=t.data.error&&null!=r&&r.code==t.data.error.code;
},e.isError=function(e){return null!=e&&null!=e.data&&null!=e.data.error&&null!=e.data.error.code},e.isConnectionError=function(e){return"string"==typeof e&&0==e.indexOf("Connection Broken")},e.isOrCouse=function(t,n){return null!=t&&(e.is(t,n)||e.isOrCouse(t.couse,n))},e.isEx=function(t,n){var r=e.codes[n];return e.is(t,n)||null!=r&&t==="Connection Broken (processMessage - got ALERT: "+r.message+")"},e.codes={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},INTERNAL_ERROR:{code:-32603,message:"Internal error"},NOT_YET_INSTALLED:{code:-32604,message:"Not yet installed"},ONLY_POST_METHOD_ALLOWED:{code:-32605,message:"Only post method allowed"},UNKNOWN_ERROR:{code:1,message:"Unkown error"},INVALID_USERNAME:{code:2,message:"Invalid username"},INVALID_SALT:{code:3,message:"Invalid salt"},INVALID_VERIFIER:{code:4,message:"Invalid verifier"},INVALID_MASTER_SEED:{code:5,message:"Invalid master seed"},INVALID_IDENTITY_KEY:{code:6,message:"Invalid identity key"},USER_ALREADY_EXISTS:{code:7,message:"User already exists"},INVALID_SIGNATURE:{code:8,message:"Invalid signature"},USER_DOESNT_EXIST:{code:9,message:"User doesn't exist"},INVALID_USER_ENTRY:{code:11,message:"Invalid user entry"},UNKNOWN_SESSION:{code:12,message:"Unknown session"},INVALID_SESSION_STATE:{code:13,message:"Invalid session state"},INVALID_A:{code:14,message:"Invalid A"},DIFFERENT_M1:{code:15,message:"Different M1"},INVALID_PIN:{code:16,message:"Invalid PIN"},OPEN_REGISTRATION_DISABLED:{code:17,message:"Open registration disabled"},MAX_PIN_ATTEMPTS_EXCEEDED:{code:18,message:"Max PIN attempts exceeded"},USER_ALREADY_ACTIVATED:{code:19,message:"User already activated"},INVITATION_DISABLED:{code:20,message:"Invitation disabled"},INVALID_TOKEN:{code:21,message:"Invalid token"},MAX_SIZE_OF_BLOCK_BULK_EXCEEDED:{code:22,message:"Max size of block bulk exceeded"},INVALID_BID:{code:23,message:"Invalid bid"},INVALID_DATA:{code:24,message:"Invalid data"},BLOCK_DOESNT_EXIST:{code:25,message:"Block doesn't exist"},MAX_SIZE_OF_DESCRIPTOR_BULK_EXCEEDED:{code:26,message:"Max size of descriptor bulk exceeded"},INVALID_DESCRIPTOR_SIGNATURE_PAIR:{code:27,message:"Invalid pair descriptor:signature"},INVALID_DID:{code:28,message:"Invalid did"},DESCRIPTOR_DOESNT_EXIST:{code:29,message:"Descriptor doesn't exist"},INVALID_DPUB58:{code:30,message:"Invalid dpub58"},INVALID_JSON_PARAMETERS:{code:31,message:"Invalid json parameters"},DPUB58_DOESNT_MATCH_TO_DID:{code:32,message:"Dpub58 doesn't match to did"},PUBLIC_KEY_CANNOT_BE_CHANGED:{code:33,message:"Public key cannot be changed"},OLD_SIGNATURE_DOESNT_MATCH:{code:34,message:"Old signature doesn't match"},INVALID_OWNER:{code:35,message:"Invalid owner"},INVALID_OWNER_SIGNATURE:{code:36,message:"Invalid owner signature"},INVALID_SID:{code:37,message:"Invalid sid"},INVALID_CREATE_SIGNATURE:{code:38,message:"Invalid create signature"},SINK_DOESNT_EXISTS:{code:39,message:"Sink doesn't exist"},INVALID_TIMESTAMP:{code:40,message:"Invalid timestamp"},INVALID_NONCE:{code:41,message:"Invalid nonce"},INVALID_MID:{code:42,message:"Invalid mid"},MESSAGE_DOESNT_EXISTS:{code:43,message:"Message doesn't exists"},MAX_SIZE_OF_MESSAGE_BULK_EXCEEDED:{code:44,message:"Max size of message bulk exceeded"},INVALID_HASHMAIL:{code:45,message:"Invalid hashmail"},INVALID_USER_PRESENCE:{code:46,message:"Invalid user presence"},INVALID_SINK_ACL:{code:47,message:"Invalid sink acl"},ACCESS_DENIED:{code:48,message:"Access denied"},INVALID_STATE:{code:49,message:"Invalid state"},SINK_ALREADY_EXISTS:{code:50,message:"Sink already exists"},INVALID_MOD_SEQ:{code:51,message:"Invalid mod seq"},DESCRIPTOR_ALREADY_EXISTS:{code:52,message:"Descriptor already exists"},INVALID_LOGIN_DATA:{code:53,message:"Invalid login data"},INVALID_HOST:{code:54,message:"Invalid host"},INVALID_DESCRIPTOR_LOCK:{code:55,message:"Invliad descriptor lock"},DESCRIPTOR_LOCKED:{code:56,message:"Descriptor locked"},INVALID_EMAIL:{code:57,message:"Invalid email"},INVALID_LANGUAGE:{code:58,message:"Invalid language"},INVALID_DESCRIPTION:{code:59,message:"Invalid description"},MAX_USERS_COUNT_EXCEEDED:{code:60,message:"Max users count exceeded"},LOGIN_BLOCKED:{code:61,message:"Login blocked"},INVALID_SMTP_CONFIG:{code:62,message:"Invalid SMTP config"},CANNOT_SAVE_CONFIG:{code:63,message:"Cannot save config"},LOGIN_REJECTED:{code:64,message:"Login rejected"},HOST_BLACKLISTED:{code:65,message:"Host blacklisted"},INVALID_BLOCK_SOURCE:{code:66,message:"Invalid block source"},INVALID_TRANSFER_SESSION:{code:67,message:"Invalid transfer session"},MAX_COUNT_OF_BLOCKS_EXCEEDED:{code:68,message:"Max count of blocks exceeded"},SECURE_FORM_VALIDATION_FAILED:{code:69,message:"Secure form validation callback returned false"},FORBIDDEN_USERNAME:{code:70,message:"Forbidden username"},INVALID_DOCUMENT_ID:{code:71,message:"Invalid document id"},DOCUMENT_DOESNT_EXISTS:{code:72,message:"Document doesn't exists"},INVLIAD_PKI_DOCUMENT:{code:73,message:"Invalid pki document"}},e}();t.exports=r},{}],151:[function(e,t,n){"use strict";var r=function(){function e(){this.maxSize=10485760,this.cache={},this.info=[],this.size=0}return e.prototype.set=function(e,t){this.get(e)||(this.cache[e]=t,this.info.push({create:(new Date).getTime(),access:(new Date).getTime(),bid:e}),this.size+=t.length,this.clear())},e.prototype.get=function(e){if(this.cache[e]){for(var t=0;t<this.info.length;t++)if(this.info[t].bid==e){this.info[t].access=(new Date).getTime();break}return this.cache[e]}return null},e.prototype.clear=function(){this.size>this.maxSize&&(this.removeOldest(),this.clear())},e.prototype.removeOldest=function(){if(0!=this.info.length){this.info.sort(function(e,t){return e.access-t.access});var e=this.info[0].bid;this.info.splice(0,1),this.size-=this.cache[e].length,delete this.cache[e]}},e}();t.exports=r},{}],152:[function(e,t,n){"use strict";var r=e("q"),i=e("../fs/descriptor/ref/DescriptorRefWrite"),o=e("../fs/file/FileSystem"),s=e("../fs/descriptor/Manager"),a=e("../message/MessageManager"),u=e("privmx-crypto"),c=e("./StorageProviderManager"),f=u.service,l=function(){function e(e,t,n,r){this.gateway=e,this.identity=t,this.rootExtKey=n,this.storageProviderManager=new c(this.gateway,r),this.descriptorManager=new s(this.storageProviderManager,this.identity),this.messageManager=new a(this.storageProviderManager,this.identity)}return e.prototype.getConfig=function(){var e=this;return r(null).then(function(){return e.storageProviderManager.getProvider(e.identity.host)}).then(function(e){return e.config})},e.prototype.init=function(){var e=this;return r(null).then(function(){return e.messageManager.init()})},e.prototype.getFileSystem=function(e){return new o(this.descriptorManager,e)},e.prototype.getFileSystemByIndex=function(e){var t=this;return r(null).then(function(){return t.deriveRootRef(e)}).then(function(e){return t.getFileSystem(e)})},e.prototype.getFileSystemByIndexAndInit=function(e){var t,n=this;return r(null).then(function(){return n.getFileSystemByIndex(e)}).then(function(e){return t=e,t.init()}).then(function(){return t})},e.prototype.getMessageManager=function(){return this.messageManager},e.prototype.deriveRootRef=function(e){var t=this;return r(null).then(function(){return t.deriveKey(e)}).then(function(e){return new i(e,t.identity.host)})},e.prototype.deriveKey=function(e){return f.deriveHardened(this.rootExtKey,e)},e}();t.exports=l},{"../fs/descriptor/Manager":175,"../fs/descriptor/ref/DescriptorRefWrite":183,"../fs/file/FileSystem":185,"../message/MessageManager":208,"./StorageProviderManager":165,"privmx-crypto":248,q:327}],153:[function(e,t,n){"use strict";var r;!function(e){e[e.SENT=0]="SENT",e[e.NOT_WANTED=1]="NOT_WANTED",e[e.INVALID_CONFIG=2]="INVALID_CONFIG",e[e.ERROR=3]="ERROR"}(r||(r={})),t.exports=r},{}],154:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("randombytes"),i=e("privmx-crypto"),o=e("simplito-logger"),s=i.service,a=(o.get("privfs-client.core.PasswordMixer"),function(){function e(){}return e.serializeData=function(e){return JSON.stringify({algorithm:e.algorithm,hash:e.hash,length:e.length,rounds:e.rounds,salt:e.salt.toString("base64"),version:e.version})},e.deserializeData=function(e){var t=JSON.parse(e);return t.salt=new Buffer(t.salt,"base64"),t},e.generatePbkdf2=function(t){var n={algorithm:"PBKDF2",hash:"SHA512",length:16,rounds:4e3+Math.floor(1e3*Math.random()),salt:r(16),version:1};return e.perform(t,n).then(function(e){return{mixed:e,data:n}})},e.mix=function(t,n){return e.perform(t,n).then(function(e){return e})},e.perform=function(e,t){return n(null).then(function(){if("PBKDF2"==t.algorithm){if("SHA512"!=t.hash)throw new Error("Not supported hash algorithm '"+t.hash+"'");if(1!=t.version)throw new Error("Not supported version '"+t.version+"'");if(16!=t.salt.length||16!=t.length)throw new Error("Invalid parameters");return s.pbkdf2(new Buffer(e,"utf8"),t.salt,t.rounds,t.length,t.hash.toLowerCase())}throw new Error("Not supported algorithm '"+t.algorithm+"'")})},e}());t.exports=a}).call(this,e("buffer").Buffer)},{buffer:590,"privmx-crypto":248,q:327,randombytes:329,"simplito-logger":357}],155:[function(e,t,n){"use strict";var r=e("../gateway/RpcGateway"),i=e("simplito-utils"),o=e("privmx-exception"),s=e("q"),a=e("privmx-crypto"),u=a.service,c=o.IllegalArgumentException,f=function(){function e(e,t,n){if(!(e instanceof r))throw new c("rpcGateway",e);if(!(t instanceof p))throw new c("privFsSrp",t);if(!i.isPositiveInteger(n))throw new c("identityIndex",n);Object.defineProperty(this,"rpcGateway",{value:e,enumerable:!0}),Object.defineProperty(this,"privFsSrp",{value:t,enumerable:!0}),Object.defineProperty(this,"identityIndex",{value:n,enumerable:!0})}return e.prototype.login=function(t,n){var r,i,o=this;return s(null).then(function(){return"string"==typeof t?u.bip39FromMnemonic(t):u.bip39FromEntropy(t)}).then(function(e){return r=e,o.rpcGateway.rpc.keyHandshake(r.extKey.getPrivateKey(),o.rpcGateway.properties)}).then(function(){var t=n===!1?null:o.privFsSrp.createDefaultPki();return i=new l(o.rpcGateway,o.privFsSrp,t),i.getRecoveryData(e.getEncryptorFromBip39(r))}).then(function(e){return h.loginLastStep(i,e,o.identityIndex)})},e.getEncryptorFromBip39=function(e){return u.getObjectEncryptor(e.extKey.getChainCode())},e}();t.exports=f;var l=e("./PrivFsSrpSecure"),h=e("./PrivFsSrpEx"),p=e("./PrivFsSrp");t.exports=f},{"../gateway/RpcGateway":198,"./PrivFsSrp":158,"./PrivFsSrpEx":159,"./PrivFsSrpSecure":161,"privmx-crypto":248,"privmx-exception":266,q:327,"simplito-utils":373}],156:[function(e,t,n){"use strict";var r=e("./PrivFsRpcManagerClass");t.exports=new r},{"./PrivFsRpcManagerClass":157}],157:[function(e,t,n){"use strict";var r=e("q"),i=e("simplito-logger"),o=e("simplito-net"),s=e("privmx-service-discovery"),a=e("privmx-rpc"),u=e("../gateway/RpcGateway"),c=e("./PrivFsSrp"),f=e("./PrivFsSrpEx"),l=e("./PrivFsKeyLogin"),h=o.JsonRpcRequest,p=s.DiscoveryMode,d=s.JsonMode,g=s.PrivMXServiceDiscovery,y=a.PrivmxRpc,m=i.get("privfs-client.core.PrivFsRpcManager"),v=function(){function e(){this.serviceDiscovery=new g,this.urlMap={}}return e.prototype.setGatewayProperties=function(t){e.GATEWAY_PROPERTIES=t},e.prototype.setAgent=function(t){e.AGENT=t},e.prototype.getHttpSrpExByHost=function(e,t,n){var i=this;return void 0===n&&(n="v2.0"),r(null).then(function(){return i.getHttpSrpByHost(t,n)}).then(function(t){return new f(t,e)})},e.prototype.getHttpSrpByHost=function(e,t){var n=this;return r(null).then(function(){return n.getHttpGatewayByHost(e,t)}).then(function(e){return new c(e)})},e.prototype.getApiBaseEndpoint=function(e){return e.apiBaseEndpoint?this.sanitizeUrl(e.apiBaseEndpoint):e.defaultEndpoint?this.sanitizeUrl(e.defaultEndpoint)+"api/":null},e.prototype.discoverHostConfiguration=function(t){var n=this;return r(null).then(function(){return n.serviceDiscovery.discover(t,e.SERVICE_DISCOVERY_JSON_MODE,e.SERVICE_DISCOVERY_DISCOVERY_ONLY)})},e.prototype.getHttpGatewayByHost=function(t,n){var i=this;"undefined"==typeof n&&(n=e.DEFAULT_VERSION);var o;return r(null).then(function(){var o=t+":"+n;return o in i.urlMap?i.urlMap[o]:r(null).then(function(){return i.discoverHostConfiguration(t)}).then(function(n){var o=i.getApiBaseEndpoint(n);if(!o)throw new Error("Invalid config for host "+t);var s=[];0==o.indexOf("//")?i.serviceDiscovery.resolveSchemeless(e.SERVICE_DISCOVERY_JSON_MODE,o,s):s.push(o);var a=0,u=function(){if(a==s.length)return r.reject("Cannot connect to endpoint");var e=s[a];return h.promise({url:e+"?_="+(new Date).getTime(),method:"versions",params:{},withCredentials:!0}).then(function(t){return{apiBaseEndpoint:e,versions:t}}).fail(function(t){return m.debug("Cannot fetch versions from '"+e+"', trying next one...",t),a++,u()})};return u()}).then(function(e){if(e.versions.indexOf(n)==-1)throw new Error("Unsupported API versions");var t=e.apiBaseEndpoint+n+"/";return i.urlMap[o]=t,t})}).then(function(n){return o=new y({url:n,destination:t,agent:e.AGENT}),o.connect()}).then(function(){return new u(o,e.GATEWAY_PROPERTIES)})},e.prototype.sanitizeUrl=function(e){var t=e.trim();return/\/$/.test(t)?t:t+"/"},e.prototype.getKeyLoginByHost=function(e,t,n){var i=this;return r(null).then(function(){return i.getHttpSrpByHost(t,n)}).then(function(t){return new l(t.rpcGateway,t,e)})},e.DEFAULT_VERSION="v2.0",e.SERVICE_DISCOVERY_JSON_MODE=d.HTTP_AND_HTTPS,e.SERVICE_DISCOVERY_DISCOVERY_ONLY=p.JSON_ONLY,e.GATEWAY_PROPERTIES={},e.AGENT=null,e}();t.exports=v},{"../gateway/RpcGateway":198,"./PrivFsKeyLogin":155,"./PrivFsSrp":158,"./PrivFsSrpEx":159,"privmx-rpc":316,"privmx-service-discovery":324,q:327,"simplito-logger":357,"simplito-net":360}],158:[function(e,t,n){(function(Buffer){"use strict";var n=e("../gateway/RpcGateway"),r=e("privmx-exception"),i=e("privmx-crypto"),o=e("simplito-logger"),s=e("q"),a=e("privmx-rpc"),u=e("privmx-pki"),c=r.IllegalArgumentException,f=i.service,l=a.PrivmxRpc,h=(o.get("privfs-client.core.PrivFsSrp"),function(){function e(e){if(!(e instanceof n))throw new c("rpcGateway",e);Object.defineProperty(this,"rpcGateway",{value:e,enumerable:!0})}return e.prototype.register=function(t,n,r,i,o,s,a,u,c,l){var h,p,d=this,g=this.createKeystore(t,n,o);return u="undefined"==typeof u||null==u?"":u,c="undefined"==typeof c||null==c?"":c,i.dataVersion=e.DATA_VERSION,this.initUser(t,r,i).then(function(e){h=e;var n="createUser"+t+u+c+h.srpSalt.toString("hex")+h.srpVerifier.toString("hex")+o.getPublicKey().toBase58DER();return f.signToCompactSignatureWithHash(o,new Buffer(n,"utf8"))}).then(function(e){return p=e,d.getKeystoreInsertionSignature(g)}).then(function(r){return d.rpcGateway.registerUser(t,n,h.srpSalt,h.srpVerifier,h.loginData,s,u,c,h.privDataEnc,g.getPublicView(),r,p,a,e.DATA_VERSION,l)}).then(function(){return h})},e.prototype.basicLogin=function(e,t,r,i,o){var a,u=this,c=this.rpcGateway;return s(null).then(function(){if(i===!0)return c=new n(new l(u.rpcGateway.rpc.config),u.rpcGateway.properties),c.rpc.connect()}).then(function(){return c.rpc.login(e+"#"+t,r,c.properties)}).then(function(e){var t=o===!1?null:u.createDefaultPki(c);return a=new p(c,u,t),u.createPrivDataEncryptor(e.mixed)}).then(function(e){return{srpSecure:a,encryptor:e}})},e.prototype.login=function(e,t,n,r,i){var o,a=this;return s(null).then(function(){return a.basicLogin(e,t,n,r,i)}).then(function(e){return o=e,o.srpSecure.getPrivData(o.encryptor)}).then(function(e){return{srpSecure:o.srpSecure,privData:e}})},e.prototype.initUser=function(e,t,n){var r=this,i={username:e,password:t,privData:n,srpSalt:null,srpVerifier:null,loginData:null,privDataEncryptor:null,privDataEnc:null};return this.rpcGateway.prepareRegisterData(e,t).then(function(e){return i.srpSalt=e.s,i.srpVerifier=e.v,i.loginData=e.loginData,r.createPrivDataEncryptor(e.mixed)}).then(function(e){return i.privDataEncryptor=e,e.encrypt(n)}).then(function(e){i.privDataEnc=e}).thenResolve(i)},e.prototype.createPrivDataEncryptor=function(e){return f.sha256(e).then(function(e){return f.getObjectEncryptor(e)})},e.prototype.getServerKeystoreWithoutCosigners=function(){var e=this;return s(null).then(function(){var t=e.createDefaultPki();return t.getServerKeyStore()}).then(function(e){return e.keystore})},e.prototype.createDefaultPki=function(e){return e=e||this.rpcGateway,new u.PrivmxPKI(e,e.getHost())},e.prototype.createKeystore=function(e,t,n){return u.Helper.createEccKeystore(e,n.key)},e.prototype.getKeystoreInsertionSignature=function(e){var t=this;return s(null).then(function(){var n=t.createDefaultPki();return n.unpackParams({prefix:"user:",data:e})}).then(function(e){return e.kis})},e.prototype.registerInPKI=function(e,t,n){var r=this,i=this.createKeystore(e,t,n);return s(null).then(function(){return r.getKeystoreInsertionSignature(i)}).then(function(e){return r.rpcGateway.request("registerInPKI",{keystore:i.getPublicView().serialize().toString("base64"),kis:e.serialize().toString("base64")})}).thenResolve(i)},e.DATA_VERSION="1.0",e}());t.exports=h;var p=e("./PrivFsSrpSecure");t.exports=h}).call(this,e("buffer").Buffer)},{"../gateway/RpcGateway":198,"./PrivFsSrpSecure":161,buffer:590,"privmx-crypto":248,"privmx-exception":266,"privmx-pki":306,"privmx-rpc":316,q:327,"simplito-logger":357}],159:[function(e,t,n){(function(Buffer){"use strict";var n=e("simplito-utils"),r=e("privmx-exception"),i=e("../exception/PrivFsException"),o=e("../identity/Identity"),s=e("./PrivFsSrp"),a=e("privmx-crypto"),u=e("q"),c=r.IllegalArgumentException,f=a.service,l=function(){function e(e,t){if(!(e instanceof s))throw new c("privFsSrp",e);if(!n.isPositiveInteger(t))throw new c("identityIndex",t);Object.defineProperty(this,"privFsSrp",{value:e,enumerable:!0}),Object.defineProperty(this,"identityIndex",{value:t,enumerable:!0})}return e.prototype.register=function(e,t,n,r,i,o,s,a){var c,l,h,p,d=this;return u(null).then(function(){return c=f.randomBytes(64),f.eccExtFromSeed(c)}).then(function(e){return l=e,f.deriveHardened(l,d.identityIndex)}).then(function(u){return h=u.getPrivateKey(),p={masterSeed:c.toString("base64")},d.privFsSrp.register(e,t,n,p,h,r,i,o,s,a)}).then(function(e){return{uData:e,masterSeed:c,masterExtKey:l,identityKey:h,privData:p}})},e.prototype.login=function(t,n,r,i,o){var s=this;return u(null).then(function(){return s.privFsSrp.login(t,n,r,i,o)}).then(function(t){return e.loginLastStep(t.srpSecure,t.privData,s.identityIndex)})},e.loginLastStep=function(t,n,r){return t.identityIndex=r,u(null).then(function(){return t.getMyData()}).then(function(i){if(null!=i.keystore)return e.processUserData(t,i,n,r);var o,s=i.raw.username,a=t.gateway.getHost();return u(null).then(function(){return e.getUserKeys(n,r)}).then(function(e){return o=e,t.privFsSrp.registerInPKI(s,a,o.identityKey)}).then(function(n){return i={raw:i.raw,presence:i.presence,keystore:n,userInfo:t.parseUserInfo(s,a,n)},e.getUserDataEx(t,i,o)})})},e.getUserKeys=function(e,t){var n;return u().then(function(){var t=new Buffer(e.masterSeed,"base64");return f.eccExtFromSeed(t)}).then(function(e){return n=e,f.deriveHardened(n,t)}).then(function(e){return{identityKey:e.getPrivateKey(),masterExtKey:n}})},e.getUserDataEx=function(e,t,n){var r=n.identityKey.getPublicKey().toBase58DER();if(r!=t.userInfo.user.pub58)throw new i("DIFFERENT_IDENTITY",{my:r,server:t.userInfo.user.pub58});return{myData:t,srpSecure:e,identity:o.fromUser(t.userInfo.user,n.identityKey),masterExtKey:n.masterExtKey}},e.processUserData=function(t,n,r,i){return u().then(function(){return e.getUserKeys(r,i)}).then(function(r){return e.getUserDataEx(t,n,r)})},e}();t.exports=l}).call(this,e("buffer").Buffer)},{"../exception/PrivFsException":167,"../identity/Identity":201,"./PrivFsSrp":158,buffer:590,"privmx-crypto":248,"privmx-exception":266,q:327,"simplito-utils":373}],160:[function(e,t,n){"use strict";var r=e("./PrivFsRpcManager");t.exports=r},{"./PrivFsRpcManager":156}],161:[function(e,t,n){(function(Buffer){"use strict";var n=e("../gateway/RpcGateway"),r=e("privmx-exception"),i=e("privmx-crypto"),o=e("simplito-promise"),s=e("randombytes"),a=e("../identity/User"),u=e("../message/MessageSink"),c=e("q"),f=e("privmx-pki"),l=r.IllegalArgumentException,h=i.service,p=o.PromiseUtils,d=function(){function e(e,t,r){if(!(e instanceof n))throw new l("gateway",e);if(!(t instanceof g))throw new l("privFsSrp",t);Object.defineProperty(this,"gateway",{value:e,enumerable:!0}),Object.defineProperty(this,"privFsSrp",{value:t,enumerable:!0}),this.privmxPKI=r}return e.prototype.request=function(e,t,n){return void 0===n&&(n={}),this.gateway.request(e,t,n)},e.prototype.getUserConfig=function(){return this.request("getUserConfig",{})},e.prototype.parseUserInfo=function(e,t,n){var r={keystore:n,user:a.fromKeyStore({user:e,host:t},n),profile:{name:null,description:null,image:n.getAttachment("image"),sinks:[]}},i=n.getAttachment("info");if(i){var o=JSON.parse(i.toString("utf8"));r.profile.name=o.name,r.user.name=o.name,r.profile.description=o.description,o.sinks&&(r.profile.sinks=o.sinks.map(function(e){return u.deserialize(e)}))}return r},e.prototype.getUserKeystoreName=function(e,t){return"user:"+e},e.prototype.getUserInfo=function(e,t,n,r){var i=this,o=r===!0;return c(null).then(function(){return i.privmxPKI.getKeyStore(i.getUserKeystoreName(e,t),{pkiOptions:{domain:t,noCache:!o},includeAttachments:n,cacheLoad:o,cacheSave:o,fetchSave:o})}).then(function(n){if(null==n.keystore)throw new Error("user-does-not-exists");return i.parseUserInfo(e,t,n.keystore)})},e.prototype.setUserInfo=function(e,t){var n=this.privFsSrp.createKeystore(e.user,e.host,e.priv),r={name:t.name,description:t.description,sinks:(t.sinks||[]).map(function(e){return e.serialize()})};return n.addAttachment("info",new Buffer(JSON.stringify(r),"utf8")),t.image&&n.addAttachment("image",t.image),this.privmxPKI.callMethodByPki("setUserInfo",{prefix:"user:",data:n},function(e){return{data:e.keystore,kis:e.kis}})},e.prototype.getKeyStoreFetch=function(e){return this.privmxPKI.getFetchExById(e)},e.prototype.getPrimaryKeyFromKeystoreAtTime=function(e,t){return new i.ecc.PublicKey(e.getPrimaryKey().keyPair.keyPair)},e.prototype.getMyData=function(){var e=this;return c(null).then(function(){return e.request("getMyData",{})}).then(function(t){var n,r=t.keystore?f.Helper.decodeKeystore(t.keystore):null;return null!=t.presence&&(n={presence:t.presence.presence,acl:{type:t.presence.acl.type}},null!=t.presence.acl.pubs&&(n.acl.pubs=f.Enumerable.$A(t.presence.acl.pubs).map(function(e){return i.ecc.PublicKey.fromBase58DER(e)}).toArray())),{raw:t,presence:n,keystore:r,userInfo:r?e.parseUserInfo(t.username,e.gateway.getHost(),r):null}})},e.prototype.setContactFormEnabled=function(e){return this.request("setContactFormEnabled",{enabled:e})},e.prototype.getPrivData=function(e){var t=this;return c(null).then(function(){return t.request("getPrivData",{})}).then(function(t){return e.decrypt(new Buffer(t,"base64"))})},e.prototype.getRecoveryData=function(e){var t=this;return c(null).then(function(){return t.request("getRecoveryData",{})}).then(function(t){return e.decrypt(new Buffer(t.data,"base64"))})},e.prototype.getRecoveryInfo=function(e,t){var n,r,i,o=this,s=this.gateway.getSession();return c(null).then(function(){return o.privFsSrp.basicLogin(s.I,s.host,e,!0)}).then(function(e){return n=e.encryptor,o.getPrivData(n)}).then(function(e){return t!==!0&&e.recovery?h.bip39FromEntropy(new Buffer(e.recovery,"base64")):c(null).then(function(){return h.bip39Generate(256)}).then(function(t){return i=t,e.recovery=i.entropy.toString("base64"),y.getEncryptorFromBip39(i).encrypt(e)}).then(function(t){return r=t,n.encrypt(e)}).then(function(e){return o.request("setRecoveryData",{privData:e.toString("base64"),recoveryData:{pub:i.extKey.getPublicKey().toBase58DER(),data:r.toString("base64")},dataVersion:g.DATA_VERSION})}).then(function(){return i})})},e.prototype.changePasswordByOldPassword=function(e,t,n){var r=this,i=this.gateway.getSession();return c(null).then(function(){return r.privFsSrp.basicLogin(i.I,i.host,e,!0)}).then(function(e){return r.getPrivData(e.encryptor)}).then(function(e){return r.changePassword(e,t,n)})},e.prototype.changePasswordByRecovery=function(e,t,n){var r=this;return c(null).then(function(){return"string"==typeof e?h.bip39FromMnemonic(e):h.bip39FromEntropy(e)}).then(function(e){return r.getRecoveryData(y.getEncryptorFromBip39(e))}).then(function(e){return r.changePassword(e,t,n)})},e.prototype.changePassword=function(e,t,n){var r=this,i=this.gateway.getSession();return c(null).then(function(){return r.privFsSrp.initUser(i.I,t,e)}).then(function(e){return r.request("setCredentials",{srpSalt:e.srpSalt.toString("hex"),srpVerifier:e.srpVerifier.toString("hex"),loginData:e.loginData,privData:e.privDataEnc.toString("base64"),dataVersion:g.DATA_VERSION,weakPassword:n!==!1})})},e.prototype.setUserPreferences=function(e,t,n){var r={language:e,notificationsEntry:t};return null!=n&&(r.contactFormSid=n),this.request("setUserPreferences",r)},e.prototype.invite=function(){return this.request("invite",{})},e.prototype.setUserPresence=function(e,t,n){var r,i,o,s,a=this;return c(null).then(function(){if(i={type:t.type},null!=t.pubs){i.pubs=[];for(var s in t.pubs)i.pubs.push(t.pubs[s].toBase58DER())}r=(new Date).getTime().toString(),o={status:e,timestamp:r};var a=new Buffer(JSON.stringify(o),"utf8");return h.signToCompactSignatureWithHash(n,a)}).then(function(e){return s=e.toString("base64"),a.request("setUserPresence",{presence:o,acl:i,signature:s})}).then(function(){return{entry:o,acl:t,signature:s}})},e.prototype.getUsersPresence=function(e,t){var n,r=this;return c(null).then(function(){var r=t.getPublicKey().toBase58DER(),i={};n={};for(var o in e){var a=e[o];n[a.hashmail]=a,a.host in i?i[a.host].usernames.push(a.user):i[a.host]={usernames:[a.user],pub58:r,nonce:s(32).toString("base64"),timestamp:(new Date).getTime().toString()}}return p.oneByOne(i,function(e,n){var r=new Buffer("userPresence"+n.usernames.join(",")+" "+n.nonce+" "+n.timestamp,"utf8");return c(null).then(function(){return h.signToCompactSignatureWithHash(t,r)}).then(function(e){n.signature=e.toString("base64")})}).thenResolve(i)}).then(function(e){return r.request("getUsersPresenceMulti",{hosts:e})}).then(function(e){var t={};return p.oneByOne(e,function(e,r){return p.oneByOne(r,function(r,i){if(null!=i){var o=new Buffer(JSON.stringify(i.entry),"utf8"),s=n[r+"#"+e];return c(null).then(function(){return h.verifyCompactSignatureWithHash(s.pub,o,new Buffer(i.signature,"base64"))}).then(function(e){if(!e)throw new Error("Invalid signature");t[s.hashmail]={user:s,presence:i.entry}})}})}).thenResolve(t)})},e.prototype.getInitData=function(){return this.request("getInitData",{})},e.prototype.getUser=function(e){return this.request("getUser",{username:e})},e.prototype.getUsers=function(){return this.request("getUsers",{})},e.prototype.getConfigEx=function(){return this.request("getConfigEx",{})},e.prototype.removeUser=function(e){return this.request("removeUser",{username:e})},e.prototype.addUser=function(e,t){return this.request("addUser",{username:e,pin:t})},e.prototype.addUserWithToken=function(e,t,n,r,i,o,s,a){return this.request("addUserWithToken",{creator:e,username:t,email:n,description:r,sendActivationLink:i,notificationEnabled:o,language:s,linkPattern:a})},e.prototype.changePin=function(e,t){return this.request("changePin",{username:e,pin:t})},e.prototype.changeEmail=function(e,t){return this.request("changeEmail",{username:e,email:t})},e.prototype.changeDescription=function(e,t){return this.request("changeDescription",{username:e,description:t})},e.prototype.changeUserData=function(e,t){return this.request("changeUserData",{username:e,data:t})},e.prototype.generateInvitations=function(e,t,n,r){return this.request("generateInvitations",{username:e,count:t,description:n,linkPattern:r})},e.prototype.getFullInitData=function(){return this.request("getFullInitData",{})},e.prototype.setInitData=function(e){return this.request("setInitData",{data:e})},e.prototype.getNotifierConfig=function(){return this.request("getNotifierConfig",{})},e.prototype.setNotifierConfig=function(e){return this.request("setNotifierConfig",{config:e})},e.prototype.getInvitationMailConfig=function(){return this.request("getInvitationMailConfig",{})},e.prototype.setInvitationMailConfig=function(e){return this.request("setInvitationMailConfig",{config:e})},e.parseLogins=function(e){return e.entries.forEach(function(e){e.date=new Date(parseInt(e.timestamp)),delete e.timestamp}),e},e.prototype.getLoginsPage=function(t,n){return this.request("getLoginsPage",{beg:t,end:n}).then(e.parseLogins)},e.prototype.getLastLogins=function(t){return this.request("getLastLogins",{count:t}).then(e.parseLogins)},e.prototype.register=function(e,t,n,r,i,o,s,a){var u,f,l,p,d=this;return c(null).then(function(){return u=h.randomBytes(64),h.eccExtFromSeed(u)}).then(function(e){return f=e,h.deriveHardened(f,d.identityIndex)}).then(function(c){return l=c.getPrivateKey(),p={masterSeed:u.toString("base64")},d.privFsSrp.register(e,t,n,p,l,r,i,o,s,a)}).then(function(e){return{uData:e,masterSeed:u,masterExtKey:f,identityKey:l,privData:p}})},e.prototype.parseCosigners=function(e){if(Array.isArray(e)&&0===e.length)return{};var t={};for(var n in e)t[n]={hashmail:e[n].hashmail,uuid:e[n].uuid,state:e[n].state,keystore:f.Helper.decodeKeystore(e[n].keystore),ip:e[n].ip,modification_timestamp:e[n].modification_timestamp,response_count:e[n].response_count,requests_count:e[n].requests_count};return t},e.prototype.setCosigner=function(e,t){var n=this;return c(null).then(function(){if(!t.state||!t.keystore||!t.uuid)throw new Error("Cosigner 'keystore', 'state' and 'uuid' are required");return n.request("setCosigner",{domain:e,data:{hashmail:t.hashmail,state:t.state,uuid:t.uuid,keystore:t.keystore instanceof f.KeyStore.KeyStore?t.keystore.serialize().toString("base64"):t.keystore}}).then(function(e){return n.parseCosigners(e)})})},e.prototype.removeCosigner=function(e,t){var n=this;return c(null).then(function(){return n.request("removeCosigner",{domain:e,uuid:t}).then(function(e){return n.parseCosigners(e)})})},e.prototype.getCosigners=function(){var e=this;return this.request("getCosigners",{}).then(function(t){return e.parseCosigners(t)})},e.prototype.getBlacklist=function(){return this.request("getBlacklist",{})},e.prototype.setBlacklistEntry=function(e,t){return this.request("setBlacklistEntry",{domain:e,mode:t})},e.prototype.suggestBlacklistEntry=function(e){return this.request("suggestBlacklistEntry",{domain:e})},e.prototype.deleteBlacklistEntry=function(e){return this.request("deleteBlacklistEntry",{domain:e})},e.prototype.getPkiAdminEntryName=function(){return"admin:"},e.prototype.getPkiDocument=function(e,t){return this.privmxPKI.getKeyStore(e,{pkiOptions:{noCache:!0},includeAttachments:t,cacheLoad:!1,cacheSave:!1,fetchSave:!1}).then(function(e){if(!(e.keystore instanceof f.KeyStore.DocumentsPacket))throw new Error("Expected DocumentsPacket class");return e.keystore})},e.prototype.getPublishedCosigners=function(){var t=this;return c(null).then(function(){return t.getPkiDocument(t.getPkiAdminEntryName(),[e.PKI_COSIGNERS_ENTRY_NAME])}).then(function(t){var n=t.getAttachment(e.PKI_COSIGNERS_ENTRY_NAME);if(null==n)return{};var r=JSON.parse(n.toString("utf8")),i={};for(var o in r)i[o]=f.Helper.decodeKeystore(r[o]);return i})},e.prototype.publishCosigners=function(t,n){var r=this;return c(null).then(function(){return r.getUsers()}).then(function(o){var s=f.Enumerable.$A(o).findAll(function(e){return e.isAdmin}).map(function(e){return i.ecc.PublicKey.fromBase58DER(e.cachedPkiEntry.primaryKey)}).toArray(),a=f.Enumerable.$A(s).map(function(e){return new f.KeyStore.EccKeyPair(e.key)}).toArray(),u=new f.KeyStore.EccKeyPair(t.key),c=new f.KeyStore.DocumentsPacket(u,a),l={};for(var h in n)l[h]=n[h].serialize().toString("base64");return c.addAttachment(e.PKI_COSIGNERS_ENTRY_NAME,new Buffer(JSON.stringify(l),"utf8")),
r.privmxPKI.callMethodByPki("setPkiDocument",{name:r.getPkiAdminEntryName(),data:c},function(e){return{name:e.name,data:e.keystore,kis:e.kis}})})},e.prototype.changeIsAdmin=function(e,t,n,r){var o,s=this;return c(null).then(function(){return s.getPkiDocument(s.getPkiAdminEntryName(),!0)}).then(function(e){return o=e,s.getUsers()}).then(function(a){var u=f.Enumerable.$A(a).findAll(function(e){return e.username!=t&&e.isAdmin}).map(function(e){return i.ecc.PublicKey.fromBase58DER(e.cachedPkiEntry.primaryKey)}).toArray();if(n){if(null==r)throw new Error("User identity key is required when adding to admin group");u.push(r)}return o.primaryKey=new f.KeyStore.EccKeyPair(e.key),o.keys=f.Enumerable.$A(u).map(function(e){return new f.KeyStore.EccKeyPair(e.key)}).toArray(),s.privmxPKI.callMethodByPki("changeIsAdmin",{name:s.getPkiAdminEntryName(),data:o},function(e){return{username:t,isAdmin:n,data:e.keystore,kis:e.kis}})})},e.prototype.sinkGetAllByUser=function(e){return this.request("sinkGetAllByUser",{username:e})},e.PKI_COSIGNERS_ENTRY_NAME="cosigners",e}();t.exports=d;var g=e("./PrivFsSrp"),y=e("./PrivFsKeyLogin");t.exports=d}).call(this,e("buffer").Buffer)},{"../gateway/RpcGateway":198,"../identity/User":202,"../message/MessageSink":210,"./PrivFsKeyLogin":155,"./PrivFsSrp":158,buffer:590,"privmx-crypto":248,"privmx-exception":266,"privmx-pki":306,q:327,randombytes:329,"simplito-promise":370}],162:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("q"),o=e("./StorageProviderInterface"),s=function(e){function t(t,n,r){var i=e.call(this)||this;return i.gateway=t,i.destination=n,i.config=r,i}return r(t,e),t.prototype.getDestination=function(){return this.destination},t.prototype.blockAddToSession=function(e,t,n){return this.gateway.proxyRequest(this.destination,"blockAddToSession",{transferIds:e,source:t,blocks:n})},t.prototype.blockCreate=function(e,t,n){return this.gateway.proxyRequest(this.destination,"blockCreate",{transferIds:e,bid:t,data:n})},t.prototype.blockGet=function(e,t,n){return this.gateway.proxyRequest(this.destination,"blockGet",{bid:e,source:t},{sendAlone:n})},t.prototype.multiMap=function(e,t,n){for(var r=[],o=0;o<e.length;){for(var s=o+t,a=[];o<s&&o<e.length;o++)a.push(e[o]);r.push(n(a))}return i.all(r).then(function(e){if(1==e.length)return e[0];for(var t={},n=0;n<e.length;n++){var r=e[n];for(var i in r)t[i]=r[i]}return t})},t.prototype.blockCheck=function(e){var t=this;return this.multiMap(e,this.config.maxBlockBulkSize,function(e){return t.blockCheckSingle(e)})},t.prototype.blockCheckSingle=function(e){return this.gateway.proxyRequest(this.destination,"blockCheck",{bids:e})},t.prototype.descriptorCheck=function(e){return this.gateway.proxyRequest(this.destination,"descriptorCheck",{dids:e})},t.prototype.descriptorDelete=function(e,t,n){return this.gateway.proxyRequest(this.destination,"descriptorDelete",{did:e,signature:t,lockId:n})},t.prototype.descriptorGet=function(e){return this.gateway.proxyRequest(this.destination,"descriptorGet",{dids:e})},t.prototype.descriptorUpdateInit=function(e,t){return this.gateway.proxyRequest(this.destination,"descriptorUpdateInit",{did:e,signature:t})},t.prototype.descriptorUpdate=function(e,t,n,r,i,o){return this.gateway.proxyRequest(this.destination,"descriptorUpdate",{did:e,data:t,transferId:n,signature:r,lockId:i,releaseLock:o})},t.prototype.descriptorCreateInit=function(){return this.gateway.request("descriptorCreateInit",{})},t.prototype.descriptorCreate=function(e,t,n){return this.gateway.request("descriptorCreate",{did:e,data:t,transferId:n})},t.prototype.descriptorLock=function(e,t,n,r,i,o){return this.gateway.proxyRequest(this.destination,"descriptorLock",{did:e,lockId:t,signature:n,lockerPub58:r,lockerSignature:i,force:o})},t.prototype.descriptorRelease=function(e,t,n){return this.gateway.proxyRequest(this.destination,"descriptorRelease",{did:e,lockId:t,signature:n})},t.prototype.messageDelete=function(e,t,n){return this.gateway.request("messageDelete",{sid:e,mids:t,expectedModSeq:n})},t.prototype.messageModify=function(e,t,n,r,i){return this.gateway.request("messageModify",{sid:e,mid:t,flags:n,tags:r,expectedModSeq:i})},t.prototype.messageModifyTags=function(e,t,n,r,i){return this.gateway.request("messageModifyTags",{sid:e,mids:t,toAdd:n,toRemove:r,expectedModSeq:i})},t.prototype.messageGet=function(e,t,n){var r=this;return this.multiMap(t,this.config.maxMessageBulkSize,function(t){return r.messageGetSingle(e,t,n)})},t.prototype.messageGetSingle=function(e,t,n){return this.gateway.request("messageGet",{sid:e,mids:t,mode:n})},t.prototype.messagePostInit=function(e,t,n){var r={sid:e,signature:t};return"string"==typeof n&&(r.extra=n),this.gateway.proxyRequest(this.destination,"messagePostInit",r)},t.prototype.messagePost=function(e,t,n,r){var i={data:e,tags:t,transferId:n};return"string"==typeof r&&(i.extra=r),this.gateway.proxyRequest(this.destination,"messagePost",i)},t.prototype.messageCreateAndDeleteInit=function(e,t,n){return this.gateway.request("messageCreateAndDeleteInit",{dSid:e,dMid:t,cSid:n})},t.prototype.messageCreateAndDelete=function(e,t,n,r,i,o,s){return this.gateway.request("messageCreateAndDelete",{data:e,flags:t,tags:n,transferId:r,sid:i,mid:o,expectedModSeq:s})},t.prototype.messageCreateInit=function(e){return this.gateway.request("messageCreateInit",{sid:e})},t.prototype.messageCreate=function(e,t,n,r){return this.gateway.request("messageCreate",{data:e,flags:t,tags:n,transferId:r})},t.prototype.sinkGetAllMy=function(){return this.gateway.request("sinkGetAllMy",{})},t.prototype.sinkCreate=function(e,t,n,r){return this.gateway.request("sinkCreate",{sid:e,acl:t,data:n,options:r})},t.prototype.sinkSave=function(e,t,n,r){return this.gateway.request("sinkSave",{sid:e,acl:t,data:n,options:r})},t.prototype.sinkDelete=function(e){return this.gateway.request("sinkDelete",{sid:e})},t.prototype.sinkSetLastSeenSeq=function(e,t){return this.gateway.request("sinkSetLastSeenSeq",{sid:e,lastSeenSeq:t})},t.prototype.sinkPoll=function(e,t){return this.gateway.request("sinkPoll",{sinks:e,updateLastSeen:t})},t.prototype.sinkClear=function(e,t){return this.gateway.request("sinkClear",{sid:e,currentModSeq:t})},t.prototype.sinkInfo=function(e,t){return this.gateway.request("sinkInfo",{sid:e,addMidList:t})},t.prototype.sinkQuery=function(e,t,n,r){return this.gateway.request("sinkQuery",{sid:e,query:t,limit:n,order:r})},t}(o);t.exports=s},{"./StorageProviderInterface":164,q:327}],163:[function(e,t,n){(function(Buffer){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=e("./RemoteStorageProvider"),i=e("./BlockCache"),o=e("q"),s=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.cache=new i,o}return n(t,e),t.prototype.blockGet=function(e,t,n){var r=this,i=this.cache.get(e);return null!=i?o(null).thenResolve(i):this.gateway.proxyRequest(this.destination,"blockGet",{bid:e,source:t},{sendAlone:n}).then(function(t){return r.cache.set(e,t),t})},t.prototype.descriptorGet=function(e){var t=this;return this.gateway.proxyRequest(this.destination,"descriptorGet",{dids:e,includeBlocks:1}).then(function(e){return Object.keys(e).forEach(function(n){var r=e[n];r.blocksData&&Object.keys(r.blocksData).forEach(function(e){var n=Buffer.from(r.blocksData[e].toArrayBuffer());t.cache.set(e,n)})}),e})},t}(r);t.exports=s}).call(this,e("buffer").Buffer)},{"./BlockCache":151,"./RemoteStorageProvider":162,buffer:590,q:327}],164:[function(e,t,n){"use strict";var r=e("privmx-exception"),i=r.UnsupportedOperationException,o=function(){function e(){}return e.prototype.getDestination=function(){return this.destination},e.prototype.blockAddToSession=function(e,t,n){throw new i},e.prototype.blockCreate=function(e,t,n){throw new i},e.prototype.blockGet=function(e,t,n){throw new i},e.prototype.blockCheck=function(e){throw new i},e.prototype.descriptorCheck=function(e){throw new i},e.prototype.descriptorDelete=function(e,t,n){throw new i},e.prototype.descriptorGet=function(e){throw new i},e.prototype.descriptorUpdateInit=function(e,t){throw new i},e.prototype.descriptorUpdate=function(e,t,n,r,o,s){throw new i},e.prototype.descriptorCreateInit=function(){throw new i},e.prototype.descriptorCreate=function(e,t,n){throw new i},e.prototype.descriptorLock=function(e,t,n,r,o,s){throw new i},e.prototype.descriptorRelease=function(e,t,n){throw new i},e.prototype.messageDelete=function(e,t,n){throw new i},e.prototype.messageModify=function(e,t,n,r,o){throw new i},e.prototype.messageModifyTags=function(e,t,n,r,o){throw new i},e.prototype.messageGet=function(e,t,n){throw new i},e.prototype.messagePostInit=function(e,t,n){throw new i},e.prototype.messagePost=function(e,t,n,r){throw new i},e.prototype.messageCreateAndDeleteInit=function(e,t,n){throw new i},e.prototype.messageCreateAndDelete=function(e,t,n,r,o,s,a){throw new i},e.prototype.messageCreateInit=function(e){throw new i},e.prototype.messageCreate=function(e,t,n,r){throw new i},e.prototype.sinkGetAllMy=function(){throw new i},e.prototype.sinkCreate=function(e,t,n,r){throw new i},e.prototype.sinkSave=function(e,t,n,r){throw new i},e.prototype.sinkDelete=function(e){throw new i},e.prototype.sinkSetLastSeenSeq=function(e,t){throw new i},e.prototype.sinkPoll=function(e,t){throw new i},e.prototype.sinkClear=function(e,t){throw new i},e.prototype.sinkInfo=function(e,t){throw new i},e.prototype.sinkQuery=function(e,t,n,r){throw new i},e}();t.exports=o},{"privmx-exception":266}],165:[function(e,t,n){"use strict";var r=e("../gateway/RpcGateway"),i=e("./RemoteStorageProvider"),o=e("./RemoteStorageProviderWithCache"),s=e("privmx-exception"),a=e("q"),u=s.IllegalArgumentException,c=function(){function e(e,t){if(!(e instanceof r))throw new u("gateway",e);Object.defineProperty(this,"gateway",{value:e,enumerable:!0}),Object.defineProperty(this,"map",{value:{},enumerable:!0}),this.withCache=t!==!1}return e.prototype.getProvider=function(e){var t=this;return a(null).then(function(){return e in t.map?t.map[e]:a(null).then(function(){return t.gateway.proxyRequest(e,"getConfig",{})}).then(function(n){var r;return r=t.withCache?new o(t.gateway,e,n):new i(t.gateway,e,n),t.map[e]=r,r})})},e}();t.exports=c},{"../gateway/RpcGateway":198,"./RemoteStorageProvider":162,"./RemoteStorageProviderWithCache":163,"privmx-exception":266,q:327}],166:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Acl");n.Acl=r;var i=e("./ApiErrorCodes");n.ApiErrorCodes=i;var o=e("./Client");n.Client=o;var s=e("./LinkSentStatus");n.LinkSentStatus=s;var a=e("./PasswordMixer");n.PasswordMixer=a;var u=e("./PrivFsKeyLogin");n.PrivFsKeyLogin=u;var c=e("./PrivFsSrp");n.PrivFsSrp=c;var f=e("./PrivFsSrpEx");n.PrivFsSrpEx=f;var l=e("./PrivFsSrpManager");n.PrivFsSrpManager=l;var h=e("./PrivFsSrpSecure");n.PrivFsSrpSecure=h;var p=e("./PrivFsRpcManager");n.PrivFsRpcManager=p;var d=e("./PrivFsRpcManagerClass");n.PrivFsRpcManagerClass=d;var g=e("./RemoteStorageProvider");n.RemoteStorageProvider=g;var y=e("./StorageProviderInterface");n.StorageProviderInterface=y;var m=e("./AnonymousPrivmxClient");n.AnonymousPrivmxClient=m},{"./Acl":148,"./AnonymousPrivmxClient":149,"./ApiErrorCodes":150,"./Client":152,"./LinkSentStatus":153,"./PasswordMixer":154,"./PrivFsKeyLogin":155,"./PrivFsRpcManager":156,"./PrivFsRpcManagerClass":157,"./PrivFsSrp":158,"./PrivFsSrpEx":159,"./PrivFsSrpManager":160,"./PrivFsSrpSecure":161,"./RemoteStorageProvider":162,"./StorageProviderInterface":164}],167:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("privmx-exception"),o=i.Exception,s=function(e){function t(n,r,i,o){var s=e.call(this,i||(n in t.codes?null:t.codes[n].message),r,o)||this;return s.errorName=n,s.errorObject=t.codes[n],s}return r(t,e),t.is=function(e,n){return e instanceof t&&e.errorName==n},t.codes={FILE_DOESNT_EXISTS:{code:4097,message:"File doesnt exists"},INVALID_VERIFER:{code:4098,message:"Invalid verifier"},FILE_ALREADY_EXISTS:{code:4099,message:"File already exists"},FILE_DOESNT_EXIST:{code:4100,message:"File doesn't exist"},CANNOT_OPEN_DIRECTORY:{code:4101,message:"Cannot open directory"},FILE_ISNT_DIRECTORY:{code:4102,message:"File isn't directory"},ACCESS_DENIED_TO_FILE:{code:4103,message:"Access denied to file"},NO_WRITE_RIGTHS:{code:4104,message:"No write rights"},NO_READ_RIGTHS:{code:4105,message:"No read rights"},INVALID_DESCRIPTOR_SIGNATURE:{code:4106,message:"Invalid descriptor signature"},CANNOT_ASSIGN_RESULT_TO_PATH_PART:{code:4107,message:"Cannot assign result to path part"},NAME_IN_USE:{code:4108,message:"Name in use"},DIFFERENT_IDENTITY:{code:4109,message:"Different identity"},CANNOT_READ_BLOCK:{code:4110,message:"Cannot read block"},CORRUPTED_BLOCK:{code:4111,message:"Corrupted block, hash is invalid"},CANNOT_SEND_BLOCK:{code:4112,message:"Cannot send block"},INVALID_RESPONSE:{code:4113,message:"Invalid response"},INVALID_USER_ENTRY_SIGNATURE:{code:4114,message:"Invalid user entry signature"}},t}(o);t.exports=s},{"privmx-exception":266}],168:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./PrivFsException");n.PrivFsException=r},{"./PrivFsException":167}],169:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./block");n.block=r;var i=e("./core");n.core=i;var o=e("./exception");n.exception=o;var s=e("./fs");n.fs=s;var a=e("./gateway");n.gateway=a;var u=e("./identity");n.identity=u;var c=e("./message");n.message=c;var f=e("./types");n.types=f;var l=e("privmx-crypto");n.crypto=l;var h=e("privmx-service-discovery");n.serviceDiscovery=h;var p=e("privmx-rpc");n.rpc=p;var d=e("simplito-lazybuffer");n.lazyBuffer=d;var g=e("bs58");n.bs58=g;var y=e("privmx-pki");n.pki=y;var Buffer=e("buffer");n.Buffer=Buffer},{"./block":147,"./core":166,"./exception":168,"./fs":197,"./gateway":199,"./identity":203,"./message":217,"./types":218,bs58:43,buffer:590,"privmx-crypto":248,"privmx-pki":306,"privmx-rpc":316,"privmx-service-discovery":324,"simplito-lazybuffer":352}],170:[function(e,t,n){"use strict";n.__esModule=!0;var r,i=e("../../core/StorageProviderInterface"),o=e("../../identity/Identity"),s=e("privmx-exception"),a=e("./Descriptor"),u=e("./Result"),c=e("q"),f=s.IllegalArgumentException;!function(e){e[e.NEW=0]="NEW",e[e.MODIFIED=1]="MODIFIED",e[e.NOT_MODIFIED=2]="NOT_MODIFIED"}(r=n.SubResultMode||(n.SubResultMode={}));var l;!function(e){e[e.NO_NEED=0]="NO_NEED",e[e.CHECK=1]="CHECK",e[e.GET=2]="GET"}(l=n.CacheRefreshMode||(n.CacheRefreshMode={}));var h=function(){function e(e,t,n,r,i){this.cache=e,this.descriptor=t,this.expires=n,this.defer=r,this.isNew=i}return e.createNew=function(t,n){return new e(t,new a(n,t.storage,t.identity),null,c.defer(),(!0))},e.createResolved=function(t,n,r){var i=new a(n,t.storage,t.identity);return i.setLastVersion(r),new e(t,i,(new Date).getTime()+t.expirationTime,null,(!1))},e.prototype.isResolving=function(){return null!=this.defer},e.prototype.isExpired=function(){return this.expires<(new Date).getTime()},e.prototype.switchToResolving=function(){this.expires=null,this.defer=c.defer()},e.prototype.attach=function(e){return this.defer.promise.then(function(t){if(t.mode==r.NEW)return u.createNew(e,t.descriptor);if(t.mode==r.MODIFIED)return u.createModified(e,t.descriptor);if(t.mode==r.NOT_MODIFIED)return u.createNotModified(e,t.descriptor);throw new Error("Unknown descriptor mode "+t.mode)})},e.prototype.resolveByDataEx=function(e){"NotModified"==e?this.resolve(r.NOT_MODIFIED):this.resolveByData(e)},e.prototype.resolveByData=function(e){var t=this;this.descriptor.deserializeAndSetLastVersion(e).then(function(){t.resolve(t.isNew?r.NEW:r.MODIFIED)}).fail(function(e){t.reject(e)})},e.prototype.resolve=function(e){this.isResolving()&&(this.expires=(new Date).getTime()+this.cache.expirationTime,this.defer.resolve({mode:e,descriptor:this.descriptor}),this.finishResolve())},e.prototype.reject=function(e){this.isResolving()&&(this.defer.reject(e),this.finishResolve())},e.prototype.finishResolve=function(){this.defer=null,this.isNew=!1},e}();n.CachedDescriptor=h;var p=function(){function e(e,t,n){if(!(e instanceof i))throw new f("storage",e);if(!(t instanceof o))throw new f("identity",t);Object.defineProperty(this,"storage",{value:e,enumerable:!0}),Object.defineProperty(this,"identity",{value:t,enumerable:!0}),this.expirationTime=n,this.cache={}}return e.prototype.getEntries=function(e){var t=this,n={mode:l.NO_NEED,dids:[],promises:[],map:{}};return e.forEach(function(e){var r=t.cache[e.did];r?r.isResolving()?n.promises.push(r.attach(e)):r.isExpired()?(r.switchToResolving(),n.mode=l.CHECK,n.promises.push(r.attach(e)),n.dids.push({did:e.did,signature:r.descriptor.lastVersion.raw.signature}),n.map[e.did]=r):n.promises.push(c(u.createNotModified(e,r.descriptor))):(t.cache[e.did]=r=h.createNew(t,e.did),n.mode=n.mode==l.NO_NEED?l.GET:n.mode,n.promises.push(r.attach(e)),n.dids.push({did:e.did,signature:""}),n.map[e.did]=r)}),n},e.prototype.createResolved=function(e,t){return this.cache[e]=h.createResolved(this,e,t),this.cache[e].descriptor},e.prototype.getDescriptor=function(e){var t=this.cache[e];return t?t.descriptor:null},e.prototype.has=function(e){return e in this.cache},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.clear=function(){this.cache={}},e}();n.Cache=p},{"../../core/StorageProviderInterface":164,"../../identity/Identity":201,"./Descriptor":171,"./Result":177,"privmx-exception":266,q:327}],171:[function(e,t,n){"use strict";var r=e("q"),i=e("privmx-exception"),o=e("privmx-crypto"),s=e("../../core/StorageProviderInterface"),a=e("../../identity/Identity"),u=e("./Version"),c=e("./Raw"),f=e("./Lock"),l=i.IllegalArgumentException,h=o.utils.Event,p=function(){function e(e,t,n){if("string"!=typeof e)throw new l("did",e);if(!(t instanceof s))throw new l("storage",t);if(!(n instanceof a))throw new l("identity",n);Object.defineProperty(this,"did",{value:e,enumerable:!0}),Object.defineProperty(this,"storage",{value:t,enumerable:!0}),Object.defineProperty(this,"identity",{value:n,enumerable:!0}),Object.defineProperty(this,"event",{value:new h,enumerable:!0})}return e.prototype.deserializeAndSetLastVersion=function(e){var t=this;return c.deserialize(e).then(function(e){return t.setLastVersion(new u(e))})},e.prototype.setLastVersion=function(e){if(!e.isValidDid(this.did))throw new l("Given version doesn't match to this descriptor",e);return this.lastVersion=e,this.event.trigger("new-version",this,this.lastVersion),this.lastVersion},e.prototype.lock=function(e,t){var n,i=this;return r(null).then(function(){return null!=i.lockObj?i.lockObj:f.create(i.did,e,i.identity)}).then(function(e){return n=e,i.storage.descriptorLock(i.did,n.id,n.lockSignature,n.identity.pub58,n.lockerSignature,!!t)}).then(function(e){n.serverDate=new Date(parseInt(e)),i.lockObj=n})},e.prototype.release=function(){var e=this;return r(null).then(function(){if(null!=e.lockObj)return r(null).then(function(){return e.storage.descriptorRelease(e.did,e.lockObj.id,e.lockObj.releaseSignature)}).then(function(){delete e.lockObj})})},e.prototype.refresh=function(){var e=this;return r(null).then(function(){return e.storage.descriptorCheck([{did:e.did,signature:e.lastVersion.raw.signature}])}).then(function(t){var n=t[e.did];return"NotModified"!=n&&e.deserializeAndSetLastVersion(n).thenResolve(!0)})},e}();t.exports=p},{"../../core/StorageProviderInterface":164,"../../identity/Identity":201,"./Lock":174,"./Raw":176,"./Version":179,"privmx-crypto":248,"privmx-exception":266,q:327}],172:[function(e,t,n){(function(Buffer){"use strict";var n=e("privmx-crypto"),r=n.service,i=function(){function e(e,t){this.key=e,this.meta=t}return e.prototype.serialize=function(){return{meta:this.meta,key:this.key.toString("base64")}},e.deserialize=function(t){return new e(new Buffer(t.key,"base64"),t.meta)},e.encode=function(e,t){return r.generateIv(e,0).then(function(n){var i=new Buffer(JSON.stringify(t),"utf8");return r.privmxEncrypt(r.privmxOptAesWithDettachedIv(),i,e,n)})},e.decode=function(e,t){return r.generateIv(e,0).then(function(n){return r.privmxDecrypt(t,e,n).then(function(e){return JSON.parse(e.toString("utf8"))})})},e.prototype.serializeAndEncode=function(t){return e.encode(t,this.serialize())},e.decodeAndDeserialize=function(t,n){return e.decode(t,n).then(e.deserialize)},e}();t.exports=i}).call(this,e("buffer").Buffer)},{buffer:590,"privmx-crypto":248}],173:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-exception"),i=e("./Descriptor"),o=e("./ref/DescriptorRef"),s=e("./Streamer"),a=e("../../exception/PrivFsException"),u=e("../../block/BlocksInfo"),c=e("simplito-lazybuffer"),f=r.IllegalArgumentException,l=function(){function e(e,t,n,r){if(!(e instanceof o))throw new f("ref",e);if(!(t instanceof i))throw new f("descriptor",t);if(e.did!=t.did)throw new f("Given ref doesn't match to descriptor",{ref:e,descriptor:t});if("undefined"!=typeof n){if("boolean"!=typeof n||n&&!e.hasReadRights())throw new f("canRead",n);Object.defineProperty(this,"canRead",{value:n,enumerable:!0})}else Object.defineProperty(this,"canRead",{value:e.hasReadRights(),enumerable:!0});if("undefined"!=typeof r){if("boolean"!=typeof r||r&&!e.hasWriteRights())throw new f("canWrite",r);Object.defineProperty(this,"canWrite",{value:r,enumerable:!0})}else Object.defineProperty(this,"canWrite",{value:e.hasWriteRights(),enumerable:!0});Object.defineProperty(this,"ref",{value:e,enumerable:!0}),Object.defineProperty(this,"descriptor",{value:t,enumerable:!0}),this.currentVersion=this.descriptor.lastVersion}return e.prototype.createWithRights=function(t,n){return new e(this.ref,this.descriptor,t,n)},e.prototype.checkReadRight=function(){var e=this;return n(null).then(function(){if(!e.canRead)throw new a("NO_READ_RIGTHS")})},e.prototype.checkWriteRight=function(){var e=this;return n(null).then(function(){if(!e.canWrite)throw new a("NO_WRITE_RIGTHS")})},e.prototype.getMeta=function(){var e=this;return n(null).then(function(){return e.checkReadRight()}).then(function(){return e.currentVersion.getExtra(e.ref.readKey)}).then(function(e){return e.meta})},e.prototype.readContent=function(){var e=this;return n(null).then(function(){return e.checkReadRight()}).then(function(){return e.currentVersion.getContent(e.descriptor.storage,e.ref.readKey)})},e.prototype.readBuffer=function(){var e=this;return n(null).then(function(){return e.readContent()}).then(function(e){return e.buffer})},e.prototype.readText=function(){var e=this;return n(null).then(function(){return e.readBuffer()}).then(function(e){return e.toString("utf8")})},e.prototype.readJson=function(){var e=this;return n(null).then(function(){return e.readText()}).then(function(e){return JSON.parse(e)})},e.prototype.writeBlocksInfo=function(e,t,r){var i=this;return n(null).then(function(){return i.checkWriteRight()}).then(function(){return s.updateBlocks(i,e,r)}).then(function(e){return t!==!1&&(i.currentVersion=e),e})},e.prototype.writeLazyBuffer=function(e,t,r){var i=this;return n(null).then(function(){return i.checkWriteRight()}).then(function(){return s.update(i,e,r)}).then(function(e){return t!==!1&&(i.currentVersion=e),e})},e.prototype.writeBuffer=function(e,t,n,r){return this.writeLazyBuffer(new c.SimpleLazyBuffer(e,t||"application/octet-stream"),n,r)},e.prototype.writeText=function(e,t,n,r){return this.writeBuffer(new Buffer(e,"utf8"),t||"text/plain",n,r)},e.prototype.writeJson=function(e,t,n,r){return this.writeText(JSON.stringify(e),t||"application/json",n,r)},e.prototype.updateMeta=function(e,t,r){var i=this;return n(null).then(function(){return i.checkWriteRight()}).then(function(){return s.updateMeta(i,e,r)}).then(function(e){return t!==!1&&(i.currentVersion=e),e})},e.prototype.lock=function(e){var t=this;return n(null).then(function(){return t.checkWriteRight()}).then(function(){return t.descriptor.lock(t.ref.priv,e)})},e.prototype.release=function(){var e=this;return n(null).then(function(){return e.checkWriteRight()}).then(function(){return e.descriptor.release()})},e.prototype.addOnChangeCallback=function(e){this.descriptor.event.add(e)},e.prototype.removeOnChangeCallback=function(e){this.descriptor.event.remove(e)},e.prototype.isModified=function(){return this.currentVersion!=this.descriptor.lastVersion},e.prototype.isModifiedRemote=function(){var e=this;return n(null).then(function(){return e.refresh()}).then(function(){return e.isModified()})},e.prototype.updateToLastVersion=function(){var e=this.currentVersion;return this.currentVersion=this.descriptor.lastVersion,e},e.prototype.refresh=function(){return this.descriptor.refresh()},e.prototype.refreshAndUpdateToLastVersion=function(){var e=this;return n(null).then(function(){return e.refresh()}).then(function(t){return e.updateToLastVersion(),t})},e.prototype.getBlocksInfo=function(){var e=this;return n(null).then(function(){return e.currentVersion.getBlocksInfoData(e.ref.readKey)}).then(function(t){return new u(e.descriptor.storage,e.getBlocksSource(),t)})},e.prototype.getBlocksSource=function(){return{type:"descriptor",did:this.ref.did}},e}();t.exports=l}).call(this,e("buffer").Buffer)},{"../../block/BlocksInfo":146,"../../exception/PrivFsException":167,"./Descriptor":171,"./Streamer":178,"./ref/DescriptorRef":181,buffer:590,"privmx-exception":266,q:327,"simplito-lazybuffer":352}],174:[function(e,t,n){(function(Buffer){"use strict";var n=e("privmx-exception"),r=e("../../identity/Identity"),i=e("privmx-crypto"),o=e("randombytes"),s=e("q"),a=n.IllegalArgumentException,u=i.service,c=function(){function e(){}return e.prototype.isActive=function(){return null!=this.serverDate},e.create=function(t,n,c){var f=new e;return s(null).then(function(){if("string"!=typeof t)throw new a("did",t);if(!(n instanceof i.ecc.PrivateKey))throw new a("priv",n);if(!(c instanceof r))throw new a("identity",c);f.id=o(16).toString("hex"),f.did=t,f.identity=c,f.lockData=new Buffer("lock"+f.did+f.id+f.identity.pub58,"utf8"),f.releaseData=new Buffer("release"+f.did+f.id,"utf8")}).then(function(){return u.signToCompactSignatureWithHash(n,f.lockData)}).then(function(e){f.lockSignature=e.toString("base64")}).then(function(){return u.signToCompactSignatureWithHash(c.priv,f.lockData)}).then(function(e){f.lockerSignature=e.toString("base64")}).then(function(){return u.signToCompactSignatureWithHash(n,f.releaseData)}).then(function(e){f.releaseSignature=e.toString("base64")}).thenResolve(f)},e}();t.exports=c}).call(this,e("buffer").Buffer)},{"../../identity/Identity":201,buffer:590,"privmx-crypto":248,"privmx-exception":266,q:327,randombytes:329}],175:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-exception"),i=e("privmx-crypto"),o=e("./Cache"),s=e("./ref/DescriptorRef"),a=e("./ref/DescriptorRefWrite"),u=e("./Streamer"),c=e("./Handle"),f=e("../../core/StorageProviderManager"),l=e("../../identity/Identity"),h=e("simplito-lazybuffer"),p=r.IllegalArgumentException,d=i.service,g=h.SimpleLazyBuffer,y=function(){function e(e,t){if(!(e instanceof f))throw new p("storageProviderManager",e);if(!(t instanceof l))throw new p("identity",t);Object.defineProperty(this,"storageProviderManager",{value:e,enumerable:!0}),Object.defineProperty(this,"identity",{value:t,enumerable:!0}),Object.defineProperty(this,"caches",{value:{},enumerable:!0}),this.cacheExpirationTime=100}return e.prototype.getHandle=function(e){return this.getDescriptor(e).then(function(e){return e.createHandle()})},e.prototype.getDescriptor=function(e){return this.getDescriptors([e]).then(function(e){return e[0]})},e.prototype.getDescriptors=function(e){var t=this;return n(null).then(function(){if(!(Array.isArray(e)&&0!=e.length&&e[0]instanceof s))throw new p("refs",e);return t.getCache(e[0].url)}).then(function(t){e.forEach(function(t,n){if(!(t instanceof s))throw new p("Invalid ref at index "+n,e);if(t.url!=e[0].url)throw new p("Cannot make bulk request with refs which have different urls",e)});var r=t.getEntries(e);return r.mode==o.CacheRefreshMode.GET?t.storage.descriptorGet(r.dids.map(function(e){return e.did})).then(function(e){for(var t in e)r.map[t].resolveByData(e[t])}).fail(function(e){r.dids.forEach(function(t){r.map[t.did].reject(e)})}):r.mode==o.CacheRefreshMode.CHECK&&t.storage.descriptorCheck(r.dids).then(function(e){for(var t in e)r.map[t].resolveByDataEx(e[t])}).fail(function(e){r.dids.forEach(function(t){r.map[t.did].reject(e)})}),n.all(r.promises)})},e.prototype.generateRef=function(e){var t=this;return n(null).then(function(){return t.getCache(e)}).then(function(e){return a.generate(e.storage.destination)})},e.prototype.createFromLazyBuffer=function(e,t,r){var i=this;return n(null).then(function(){return i.generateRef(e)}).then(function(e){return i.createFromLazyBufferUnderRef(e,t,r)})},e.prototype.createFromLazyBufferUnderRef=function(e,t,r){var i,o=this;return n(null).then(function(){return o.getCache(e.url)}).then(function(n){return i=n,u.create(e,i.storage,t,r,o.identity.user)}).then(function(t){return new c(e,i.createResolved(e.did,t))})},e.prototype.createFromBlocksUnderRef=function(e,t,r){var i,o=this;return n(null).then(function(){return o.getCache(e.url)}).then(function(n){return i=n,u.createFromBlocks(e,i.storage,t,r,o.identity.user)}).then(function(t){return new c(e,i.createResolved(e.did,t))})},e.prototype.createFromBlocks=function(e,t,r){var i=this;return n(null).then(function(){return i.generateRef(e)}).then(function(e){return i.createFromBlocksUnderRef(e,t,r)})},e.prototype.createFromBuffer=function(e,t,r,i){var o=this;return n(null).then(function(){return o.generateRef(e)}).then(function(e){return o.createFromBufferUnderRef(e,t,r,i)})},e.prototype.createFromBufferUnderRef=function(e,t,n,r){return this.createFromLazyBufferUnderRef(e,new g(t,n||"application/octet-stream"),r)},e.prototype.createFromText=function(e,t,r,i){var o=this;return n(null).then(function(){return o.generateRef(e)}).then(function(e){return o.createFromTextUnderRef(e,t,r,i)})},e.prototype.createFromTextUnderRef=function(e,t,n,r){return this.createFromBufferUnderRef(e,new Buffer(t,"utf8"),n||"text/plain",r)},e.prototype.createFromJson=function(e,t,r,i){var o=this;return n(null).then(function(){return o.generateRef(e)}).then(function(e){return o.createFromJsonUnderRef(e,t,r,i)})},e.prototype.createFromJsonUnderRef=function(e,t,n,r){return this.createFromTextUnderRef(e,JSON.stringify(t),n||"application/json",r)},e.prototype.removeByRef=function(e){var t,r=this;return n(null).then(function(){return r.getCache(e.url)}).then(function(n){t=n;var r=new Buffer("delete"+e.did,"utf8");return d.signToCompactSignatureWithHash(e.priv,r)}).then(function(n){var r=t.getDescriptor(e.did),i=null==r||null==r.lockObj?"":r.lockObj.id;return t.storage.descriptorDelete(e.did,n.toString("base64"),i)}).then(function(){t.remove(e.did)})},e.prototype.getCache=function(e){var t=this;return n(null).then(function(){return e in t.caches?t.caches[e]:n(null).then(function(){return t.storageProviderManager.getProvider(e||t.identity.host)}).then(function(n){return t.caches[e]=new o.Cache(n,t.identity,t.cacheExpirationTime)})})},e.prototype.setCacheExpirationTime=function(e){this.cacheExpirationTime=e;for(var t in this.caches)this.caches[t].expirationTime=e},e}();t.exports=y}).call(this,e("buffer").Buffer);
},{"../../core/StorageProviderManager":165,"../../identity/Identity":201,"./Cache":170,"./Handle":173,"./Streamer":178,"./ref/DescriptorRef":181,"./ref/DescriptorRefWrite":183,buffer:590,"privmx-crypto":248,"privmx-exception":266,q:327,"simplito-lazybuffer":352}],176:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("../../exception/PrivFsException"),i=e("privmx-crypto"),o=e("simplito-utils"),s=i.service,a=function(){function e(e,t,n,r,s,a){var u=this;Object.defineProperty(this,"blocks",{value:e,enumerable:!0}),Object.defineProperty(this,"extra",{value:t,enumerable:!0}),Object.defineProperty(this,"signature",{value:n,enumerable:!0}),Object.defineProperty(this,"dpub",{value:r,enumerable:!0}),o.defineLazyReadOnlyProperty(this,"did",function(){return i.serviceSync.eccPubToBase58Address(u.dpub)}),Object.defineProperty(this,"serverDate",{value:s,enumerable:!0}),Object.defineProperty(this,"owner",{value:a,enumerable:!0})}return e.verifySignature=function(e,t,n,i){return s.sha256(t).then(function(t){var o=new Buffer(n.join("")+t.toString("base64"),"utf8");return s.verifyCompactSignatureWithHash(e,o,i).then(function(e){if(!e)throw new r("INVALID_DESCRIPTOR_SIGNATURE")})})},e.createSignature=function(e,t,n){return s.sha256(t).then(function(t){var r=new Buffer(n.join("")+t.toString("base64"),"utf8");return s.signToCompactSignatureWithHash(e,r)})},e.deserialize=function(t){return n(null).then(function(){var n=i.ecc.PublicKey.fromBase58DER(t.dpub58),r=new Buffer(t.extra,"base64"),o=new Buffer(t.signature,"base64");return e.verifySignature(n,r,t.blocks,o).then(function(){return new e(t.blocks,r,t.signature,n,new Date(parseInt(t.serverDate)),t.owner)})})},e.serialize=function(t,n,r){return e.createSignature(t,n,r).then(function(e){return{blocks:r,extra:n.toString("base64"),signature:e.toString("base64"),dpub58:t.getPublicKey().toBase58DER()}})},e}();t.exports=a}).call(this,e("buffer").Buffer)},{"../../exception/PrivFsException":167,buffer:590,"privmx-crypto":248,q:327,"simplito-utils":373}],177:[function(e,t,n){"use strict";var r=e("./Handle"),i=function(){function e(e,t,n){this.ref=e,this.descriptor=t,this.mode=n}return e.createNew=function(t,n){return new e(t,n,e.NEW)},e.createModified=function(t,n){return new e(t,n,e.MODIFIED)},e.createNotModified=function(t,n){return new e(t,n,e.NOT_MODIFIED)},e.prototype.isNew=function(){return this.mode==e.NEW},e.prototype.isModified=function(){return this.mode==e.MODIFIED},e.prototype.isNotModified=function(){return this.mode==e.NOT_MODIFIED},e.prototype.createHandle=function(){return this.createHandleWithRef(this.ref)},e.prototype.createHandleWithRef=function(e){return new r(e,this.descriptor)},e.NEW="new",e.MODIFIED="modified",e.NOT_MODIFIED="not-modified",e}();t.exports=i},{"./Handle":173}],178:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("./Extra"),i=e("../../block/BlockStreamer"),o=e("./Raw"),s=e("./Version"),a=e("simplito-utils"),u=e("privmx-crypto"),c=e("randombytes"),f=u.service,l=function(){function e(){}return e.create=function(t,o,s,a,u){var f,l;return n(null).then(function(){return o.descriptorCreateInit()}).then(function(e){return l=e,f=new r(c(32),{size:s.getSize(),createDate:(new Date).getTime(),modifiedDate:(new Date).getTime(),mimeType:s.getMimetype()||"",originalName:s.getName()||"",type:a}),i.stream(o,[l],s,f.key)}).then(function(n){return e.createCore(t,o,f,l,n,u)})},e.createFromBlocks=function(t,o,s,a,u){var c,f;return n(null).then(function(){return o.descriptorCreateInit()}).then(function(e){return f=e,c=new r(s.data.key,{size:s.data.size,createDate:(new Date).getTime(),modifiedDate:(new Date).getTime(),mimeType:s.data.mimeType,originalName:s.data.name||"",type:a}),i.addBlocksToSessionByInfo(o,[f],s)}).then(function(n){return e.createCore(t,o,c,f,n,u)})},e.createCore=function(e,t,r,i,a,u){var c,f;return n(null).then(function(){return r.serializeAndEncode(e.readKey)}).then(function(t){return c=t,o.serialize(e.priv,c,a)}).then(function(n){return f=n,t.descriptorCreate(e.did,f,i)}).then(function(t){var n=new o(f.blocks,c,f.signature,e.pub,new Date(parseInt(t.serverDate)),u);return new s(n,r)})},e.initUpdate=function(e){var t,r;return n(null).then(function(){t=c(32).toString("base64"),r=(new Date).getTime().toString();var n=new Buffer("descriptorUpdate"+e.ref.did+e.descriptor.identity.hashmail+" "+t+" "+r,"utf8");return f.signToCompactSignatureWithHash(e.descriptor.identity.priv,n)}).then(function(n){return e.descriptor.storage.descriptorUpdateInit(e.ref.did,{hashmail:e.descriptor.identity.hashmail,pub:e.descriptor.identity.pub58,nonce:t,timestamp:r,signature:n.toString("base64")})})},e.update=function(t,o,s){var u,f,l;return s=!!s,n(null).then(function(){return f=t.currentVersion,e.initUpdate(t)}).then(function(e){return l=e,f.getExtra(t.ref.readKey)}).then(function(e){return u=new r(c(32),a.clone(e.meta)),u.meta.size=o.getSize(),u.meta.modifiedDate=(new Date).getTime(),u.meta.mimeType=o.getMimetype()||u.meta.mimeType,i.stream(t.descriptor.storage,[l],o,u.key)}).then(function(n){return e.updateCore(t,f,u,l,n,s)})},e.updateBlocks=function(t,o,s){var u,f,l;return s=!!s,n(null).then(function(){return f=t.currentVersion,e.initUpdate(t)}).then(function(e){return l=e,f.getExtra(t.ref.readKey)}).then(function(e){return u=new r(c(32),a.clone(e.meta)),u.meta.size=o.data.size,u.meta.modifiedDate=(new Date).getTime(),u.meta.mimeType=o.data.mimeType||u.meta.mimeType,i.addBlocksToSessionByInfo(t.descriptor.storage,[l],o)}).then(function(n){return e.updateCore(t,f,u,l,n,s)})},e.updateMeta=function(t,o,s){var u,c,f;return s=!!s,n(null).then(function(){return c=t.currentVersion,e.initUpdate(t)}).then(function(e){return f=e,c.getExtra(t.ref.readKey)}).then(function(e){return u=new r(e.key,a.clone(e.meta)),"function"==typeof o&&o(u.meta),i.addBlocksToSession(t.descriptor.storage,[f],t.descriptor.storage,t.getBlocksSource(),c.raw.blocks,u.key)}).then(function(n){return e.updateCore(t,c,u,f,n,s)})},e.updateCore=function(e,t,r,i,a,u){var c,f;return n(null).then(function(){return r.serializeAndEncode(e.ref.readKey)}).then(function(t){return c=t,o.serialize(e.ref.priv,c,a)}).then(function(n){f=n;var r=null==e.descriptor.lockObj?"":e.descriptor.lockObj.id;return e.descriptor.storage.descriptorUpdate(e.ref.did,f,i,t.raw.signature,r,u)}).then(function(n){u&&(e.descriptor.lockObj=null);var i=new o(f.blocks,c,f.signature,e.ref.pub,new Date(parseInt(n.serverDate)),t.raw.owner);return e.descriptor.setLastVersion(new s(i,r))})},e}();t.exports=l}).call(this,e("buffer").Buffer)},{"../../block/BlockStreamer":145,"./Extra":172,"./Raw":176,"./Version":179,buffer:590,"privmx-crypto":248,q:327,randombytes:329,"simplito-utils":373}],179:[function(e,t,n){"use strict";var r=e("q"),i=e("privmx-exception"),o=e("simplito-lazybuffer"),s=e("../../block/BlockDownloader"),a=e("./Raw"),u=e("./Extra"),c=i.IllegalArgumentException,f=o.Content,l=function(){function e(e,t){if(!(e instanceof a))throw new c("raw",e);if(Object.defineProperty(this,"raw",{value:e,enumerable:!0}),null!=t){if(!(t instanceof u))throw new c("extra",t);Object.defineProperty(this,"extra",{value:t,enumerable:!0})}}return e.prototype.isValidDid=function(e){return e==this.raw.did},e.prototype.getExtra=function(e){var t=this;return r(null).then(function(){return null!=t.extra?t.extra:null!=t.extraPromise?t.extraPromise:t.extraPromise=r(null).then(function(){return u.decodeAndDeserialize(e,t.raw.extra)}).then(function(e){return Object.defineProperty(t,"extra",{value:e,enumerable:!0}),e}).fin(function(){delete t.extraPromise})})},e.prototype.getContent=function(e,t){var n=this;return r(null).then(function(){return n.getExtra(t)}).then(function(t){if(null!=n.contentPromise)return n.contentPromise;var r={type:"descriptor",did:n.raw.did};return n.contentPromise=s.download(e,r,n.raw.blocks,t.key).then(function(e){return new f(e,t.meta.mimeType,t.meta.originalName)})}).fin(function(){delete n.contentPromise})},e.prototype.getBlocksInfoData=function(e){var t=this;return r(null).then(function(){return t.getExtra(e)}).then(function(e){return{blocks:t.raw.blocks,mimeType:e.meta.mimeType,size:e.meta.size,key:e.key,name:e.meta.originalName}})},e}();t.exports=l},{"../../block/BlockDownloader":144,"./Extra":172,"./Raw":176,"privmx-exception":266,q:327,"simplito-lazybuffer":352}],180:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./ref");n.ref=r;var i=e("./Cache");n.Cache=i;var o=e("./Descriptor");n.Descriptor=o;var s=e("./Extra");n.Extra=s;var a=e("./Handle");n.Handle=a;var u=e("./Lock");n.Lock=u;var c=e("./Manager");n.Manager=c;var f=e("./Raw");n.Raw=f;var l=e("./Result");n.Result=l;var h=e("./Streamer");n.Streamer=h;var p=e("./Version");n.Version=p},{"./Cache":170,"./Descriptor":171,"./Extra":172,"./Handle":173,"./Lock":174,"./Manager":175,"./Raw":176,"./Result":177,"./Streamer":178,"./Version":179,"./ref":184}],181:[function(e,t,n){"use strict";var r=e("privmx-exception"),i=e("simplito-utils"),o=r.IllegalArgumentException,s=function(){function e(e,t){var n=this;if("string"!=typeof e)throw new o("did",e);if("string"!=typeof t)throw new o("url",t);Object.defineProperty(this,"did",{value:e,enumerable:!0}),Object.defineProperty(this,"url",{value:t,enumerable:!0}),i.defineLazyReadOnlyProperty(this,"id",function(){return n.url+n.did})}return e.prototype.hasReadRights=function(){return!1},e.prototype.hasWriteRights=function(){return!1},e.prototype.hasNoRights=function(){return!this.hasReadRights()&&!this.hasWriteRights()},e.prototype.isReadOnly=function(){return this.hasReadRights()&&!this.hasWriteRights()},e.prototype.equals=function(t){return t instanceof e&&this.id==t.id},e}();t.exports=s},{"privmx-exception":266,"simplito-utils":373}],182:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("privmx-exception"),o=e("simplito-utils"),s=e("./DescriptorRef"),a=e("privmx-crypto"),u=i.IllegalArgumentException,c=function(e){function t(t,n){var r=e.call(this,a.serviceSync.eccPubToBase58Address(t.getPublicKey()),n)||this;if(!(t instanceof a.ecc.ExtKey))throw new u("eccExtKey",t);return Object.defineProperty(r,"ext",{value:t,enumerable:!0}),o.defineLazyReadOnlyProperty(r,"extPub58",function(){return r.ext.getPublicPartAsBase58()}),o.defineLazyReadOnlyProperty(r,"pub",function(){return r.ext.getPublicKey()}),o.defineLazyReadOnlyProperty(r,"pub58",function(){return r.pub.toBase58DER()}),o.defineLazyReadOnlyProperty(r,"readKey",function(){return r.ext.getChainCode()}),r}return r(t,e),t.fromExtKey=function(e,n){return new t(a.ecc.ExtKey.fromBase58(e),n)},t.prototype.hasReadRights=function(){return!0},t}(s);t.exports=c},{"./DescriptorRef":181,"privmx-crypto":248,"privmx-exception":266,"simplito-utils":373}],183:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("privmx-exception"),o=e("simplito-utils"),s=e("./DescriptorRefRead"),a=e("privmx-crypto"),u=i.IllegalArgumentException,c=function(e){function t(t,n){var r=e.call(this,t,n)||this;if(!(t instanceof a.ecc.ExtKey&&t.isPrivate()))throw new u("eccExtKey",t);return o.defineLazyReadOnlyProperty(r,"extPriv58",function(){return r.ext.getPrivatePartAsBase58()}),o.defineLazyReadOnlyProperty(r,"priv",function(){return r.ext.getPrivateKey()}),o.defineLazyReadOnlyProperty(r,"privWif",function(){return r.priv.toWIF()}),o.defineLazyReadOnlyProperty(r,"writeKey",function(){return r.priv.getPrivateEncKey()}),r}return r(t,e),t.prototype.createReadOnly=function(){return new s(this.ext,this.url)},t.fromExtKey=function(e,n){return new t(a.ecc.ExtKey.fromBase58(e),n)},t.generate=function(e){return new t(a.serviceSync.eccExtRandom(),e)},t.prototype.hasWriteRights=function(){return!0},t}(s);t.exports=c},{"./DescriptorRefRead":182,"privmx-crypto":248,"privmx-exception":266,"simplito-utils":373}],184:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./DescriptorRef");n.DescriptorRef=r;var i=e("./DescriptorRefRead");n.DescriptorRefRead=i;var o=e("./DescriptorRefWrite");n.DescriptorRefWrite=o},{"./DescriptorRef":181,"./DescriptorRefRead":182,"./DescriptorRefWrite":183}],185:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("../descriptor/Manager"),i=e("../descriptor/ref/DescriptorRefWrite"),o=e("privmx-exception"),s=e("../../core/ApiErrorCodes"),a=e("./entry/Directory"),u=e("./entry/Entry"),c=e("./path/Path"),f=e("./path/PathPart"),l=e("./path/PathWalker"),h=e("./../../exception/PrivFsException"),p=e("./Mode"),d=e("simplito-promise"),g=e("simplito-utils"),y=e("simplito-lazybuffer"),m=e("./KeyValueFile"),v=e("../../block/BlocksInfo"),b=o.IllegalArgumentException,w=d.PromiseUtils,E=y.SimpleLazyBuffer,_=y.LazyBuffer,S=function(){function e(e,t){if(!(e instanceof r))throw new b("manager",e);if(!(t instanceof i))throw new b("rootRef",t);this.cache_file_refs_enabled=!0,this.file_refs_cache={},Object.defineProperty(this,"manager",{value:e,enumerable:!0}),Object.defineProperty(this,"rootRef",{value:t,enumerable:!0})}return e.prototype.open=function(e,t,r){var i=this;return n(null).then(function(){return i.openEx(e,t,r)}).then(function(e){return e.handle})},e.prototype.openEx=function(e,t,r){var i=this,o=!0,s=!1,a=this.root;return t=t||p.READ_WRITE_CREATE,r&&(r instanceof _||r instanceof v)||(o=!1,r=new E(new Buffer("","utf8"),"text/plain")),this.cache_file_refs_enabled&&t.isReadOnly()&&this.file_refs_cache[e]?n(null).then(function(){return a.manager.getHandle(i.file_refs_cache[e])}).then(function(e){return{handle:e.createWithRights(t.isRead(),t.isWrite()),created:!1,createDataUsed:!1}}):n(null).then(function(){return l.go(a,e,i.cache_file_refs_enabled)}).then(function(i){if(i.isFullyResolved()){if(t.shouldFailWhenExist())throw new h("FILE_ALREADY_EXISTS",e);var o=i.getLast();if(!o.entry.isFile())throw new h("CANNOT_OPEN_DIRECTORY",e);var c=null==o.result?o.entry.ref:o.result.ref;if(c.hasNoRights()||t.isRead()&&!c.hasReadRights()||t.isWrite()&&!c.hasWriteRights())throw new h("ACCESS_DENIED_TO_FILE",e);return t.isReadOnly()&&c.hasWriteRights()&&(c=c.createReadOnly()),null==o.result?a.manager.getHandle(c):o.result.createHandleWithRef(c)}if(!t.shouldCreateWhenNotExist()||!i.isResolvedExceptLastElement())throw new h("FILE_DOESNT_EXISTS",e);return s=!0,n(null).then(function(){if(r instanceof _)return a.manager.createFromLazyBuffer(null,r,"file");if(r instanceof v)return a.manager.createFromBlocks(null,r,"file");throw new Error("Invalid create data")}).then(function(e){var t=new u(i.getLast().name,"file",e.ref);return i.getOneBeforeEnd().entry.addEntry(t).thenResolve(e)})}).then(function(n){return i.cache_file_refs_enabled&&t.isReadOnly()&&(i.file_refs_cache[e]=n.ref),{handle:n.createWithRights(t.isRead(),t.isWrite()),created:s,createDataUsed:s&&o}})},e.prototype.mkdir=function(e){var t=this.root;return n(null).then(function(){return l.go(t,e)}).then(function(r){if(r.isFullyResolved()){if(r.getLast().entry.isFile())throw new h("FILE_ISNT_DIRECTORY",e);return r.getLast().entry.ref}if(r.isResolvedExceptLastElement())return n(null).then(function(){return t.manager.createFromJson(null,[],null,"directory")}).then(function(e){var n=a.fromHandleWithEmptyEntries(r.getLast().name,e,t.manager);return r.getOneBeforeEnd().entry.addEntry(n).thenResolve(n.ref)});throw new h("FILE_DOESNT_EXISTS",e)})},e.prototype.mkdirs=function(e){var t=this.root;return n(null).then(function(){return l.go(t,e)}).then(function(r){var i=t;return w.oneByOne(r.parts,function(r,o){if(o.isResolved()){if(o.entry.isFile())throw new h("FILE_ISNT_DIRECTORY",e);return void(i=o.entry)}return n(null).then(function(){return t.manager.createFromJson(null,[],null,"directory")}).then(function(e){var t=a.fromHandleWithEmptyEntries(o.name,e,i.manager);return i.addEntry(t).then(function(){i=t})})})})},e.prototype.remove=function(e){var t,r=this,i=this.root;return n(null).then(function(){return l.go(i,e)}).then(function(n){if(!n.isFullyResolved()||n.parts.length<2)throw new h("FILE_DOESNT_EXISTS",e);return t=n.getLast(),n.getOneBeforeEnd().entry.removeEntry(t.name)}).then(function(){return i.manager.removeByRef(t.entry.ref)}).then(function(){r.cache_file_refs_enabled&&delete r.file_refs_cache[e]})},e.prototype.rename=function(e,t){var r=this.root;return n(null).then(function(){return l.go(r,e)}).then(function(n){if(!n.isFullyResolved()||n.parts.length<2)throw new h("FILE_DOESNT_EXISTS",e);return n.getOneBeforeEnd().entry.renameEntry(n.getLast().name,t)})},e.prototype.list=function(e){var t=this.root;return n(null).then(function(){return l.go(t,e)}).then(function(t){if(!t.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e);var n=t.getLast().entry;if(n.isFile())throw new h("FILE_ISNT_DIRECTORY",e);return n.getEntries()}).then(function(e){return e.toInfo()})},e.prototype.link=function(e,t){var r=this.root;return n(null).then(function(){return l.go(r,e)}).then(function(n){if(!n.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e);var r=n.getLast().entry;if(r.isFile())throw new h("FILE_ISNT_DIRECTORY",e);return r.addEntry(t)})},e.prototype.unlink=function(e){var t=this.root;return n(null).then(function(){return l.go(t,e)}).then(function(t){if(!t.isFullyResolved()||t.parts.length<2)throw new h("FILE_DOESNT_EXISTS",e);var n=t.getLast();return t.getOneBeforeEnd().entry.removeEntry(n.name)})},e.prototype.stat=function(e,t){var r=this;return n(null).then(function(){return l.go(r.root,e)}).then(function(i){if(!i.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e);var o=i.getLast(),s={meta:null,entry:o.entry.toInfo()};return t===!1?s:n(null).then(function(){return r.resolvePathPartToHandle(o)}).then(function(e){return e.getMeta()}).then(function(e){return s.meta=e,s})})},e.prototype.refresh=function(e){var t=this.root;return n(null).then(function(){return l.go(t,e)}).then(function(t){if(!t.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e)})},e.prototype.addDirectoryOnChangeCallback=function(e,t){var r=this.root;return n(null).then(function(){return l.go(r,e)}).then(function(n){if(!n.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e);return n.getLast().entry.addOnChangeCallback(t)})},e.prototype.removeDirectoryOnChangeCallback=function(e,t){var r=this.root;return n(null).then(function(){return l.go(r,e)}).then(function(n){if(!n.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e);return n.getLast().entry.removeOnChangeCallback(t)})},e.prototype.copyBetweenFileSystems=function(e,t,r){var i,o=this;return n(null).then(function(){return o.open(e,p.READ_ONLY)}).then(function(e){return e.getBlocksInfo()}).then(function(o){var s=g.endsWith(r,"/")?r:r+"/",a=new c(e).getLast().name,u=a.lastIndexOf("."),f=u==-1?"":a.substring(u),l=u==-1?a:a.substring(0,u),p=1;i=s+a;var d=function(){return n(null).then(function(){return t.createBlocksInfo(i,o)}).fail(function(e){return h.is(e,"FILE_ALREADY_EXISTS")?(i=s+l+"("+p+")"+f,p++,d()):n.reject(e)})};return d()}).then(function(){return i})},e.prototype.writeBlocksInfo=function(e,t,r){var i=this;return n(null).then(function(){return i.openEx(t,e,r)}).then(function(e){return e.createDataUsed?e.handle.ref:e.handle.writeBlocksInfo(r).thenResolve(e.handle.ref)})},e.prototype.writeLazyBuffer=function(e,t,r){var i=this;return n(null).then(function(){return i.openEx(t,e,r)}).then(function(e){return e.createDataUsed?e.handle.ref:e.handle.writeLazyBuffer(r).thenResolve(e.handle.ref)})},e.prototype.writeBuffer=function(e,t,n,r){return this.writeLazyBuffer(e,t,new E(n,r||"application/octet-stream"))},e.prototype.writeText=function(e,t,n,r){return this.writeBuffer(e,t,new Buffer(n,"utf8"),r||"text/plain")},e.prototype.writeJson=function(e,t,n,r){return this.writeText(e,t,JSON.stringify(n),r||"application/json")},e.prototype.saveBlocksInfo=function(e,t){return this.writeBlocksInfo(p.WRITE_CREATE,e,t)},e.prototype.saveLazyBuffer=function(e,t){return this.writeLazyBuffer(p.WRITE_CREATE,e,t)},e.prototype.saveBuffer=function(e,t,n){return this.writeBuffer(p.WRITE_CREATE,e,t,n)},e.prototype.saveText=function(e,t,n){return this.writeText(p.WRITE_CREATE,e,t,n)},e.prototype.saveJson=function(e,t,n){return this.writeJson(p.WRITE_CREATE,e,t,n)},e.prototype.createBlocksInfo=function(e,t){return this.writeBlocksInfo(p.WRITE_EXCL,e,t)},e.prototype.createLazyBuffer=function(e,t){return this.writeLazyBuffer(p.WRITE_EXCL,e,t)},e.prototype.createBuffer=function(e,t,n){return this.writeBuffer(p.WRITE_EXCL,e,t,n)},e.prototype.createText=function(e,t,n){return this.writeText(p.WRITE_EXCL,e,t,n)},e.prototype.createJson=function(e,t,n){return this.writeJson(p.WRITE_EXCL,e,t,n)},e.prototype.readContent=function(e){var t=this;return n(null).then(function(){return t.open(e,p.READ_ONLY)}).then(function(e){return e.readContent()}).then(function(t){return t.withName(new c(e).getLast().name)})},e.prototype.readBuffer=function(e){var t=this;return n(null).then(function(){return t.open(e,p.READ_ONLY)}).then(function(e){return e.readBuffer()})},e.prototype.readText=function(e){var t=this;return n(null).then(function(){return t.open(e,p.READ_ONLY)}).then(function(e){return e.readText()})},e.prototype.readJson=function(e){var t=this;return n(null).then(function(){return t.open(e,p.READ_ONLY)}).then(function(e){return e.readJson()})},e.prototype.optReadContent=function(e,t){var r=this;return n(null).then(function(){return r.readContent(e)}).fail(function(e){return h.is(e,"FILE_DOESNT_EXISTS")?t:n.reject(e)})},e.prototype.optReadBuffer=function(e,t){var r=this;return n(null).then(function(){return r.readBuffer(e)}).fail(function(e){return h.is(e,"FILE_DOESNT_EXISTS")?t:n.reject(e)})},e.prototype.optReadText=function(e,t){var r=this;return n(null).then(function(){return r.readText(e)}).fail(function(e){return h.is(e,"FILE_DOESNT_EXISTS")?t:n.reject(e)})},e.prototype.optReadJson=function(e,t){var r=this;return n(null).then(function(){return r.readJson(e)}).fail(function(e){return h.is(e,"FILE_DOESNT_EXISTS")?t:n.reject(e)})},e.prototype.updateMeta=function(e,t){var r=this;return n(null).then(function(){return l.go(r.root,e)}).then(function(t){if(!t.isFullyResolved())throw new h("FILE_DOESNT_EXISTS",e);return r.resolvePathPartToHandle(t.getLast())}).then(function(e){return e.updateMeta(t)})},e.prototype.getKeyValueFile=function(e,t,r){var i=this;return n(null).then(function(){var n="object"==typeof t&&null!=t?t:{},o=r||"application/json";return i.open(e,p.READ_WRITE_CREATE,new E(new Buffer(JSON.stringify(n),"utf8"),o))}).then(function(e){return m.create(e)})},e.prototype.init=function(){return this.ensureRoot()},e.prototype.ensureRoot=function(){var e=this;return n(null).then(function(){return n(null).then(function(){return e.manager.getHandle(e.rootRef)}).fail(function(t){return s.is(t,"DESCRIPTOR_DOESNT_EXIST")?e.manager.createFromJsonUnderRef(e.rootRef,[],null,"directory"):n.reject(t)})}).then(function(t){e.root=a.fromHandle("",t,e.manager)})},e.prototype.resolvePathPartToHandle=function(e){var t=this;return n(null).then(function(){if(!(e instanceof f&&e.isResolved()))throw new b("pathPart",e);return e.entry.isDirectory()?e.entry.getHandle():null!=e.result?e.result.createHandle():t.manager.getHandle(e.entry.ref)})},e}();t.exports=S}).call(this,e("buffer").Buffer)},{"../../block/BlocksInfo":146,"../../core/ApiErrorCodes":150,"../descriptor/Manager":175,"../descriptor/ref/DescriptorRefWrite":183,"./../../exception/PrivFsException":167,"./KeyValueFile":186,"./Mode":187,"./entry/Directory":188,"./entry/Entry":190,"./path/Path":193,"./path/PathPart":194,"./path/PathWalker":195,buffer:590,"privmx-exception":266,q:327,"simplito-lazybuffer":352,"simplito-promise":370,"simplito-utils":373}],186:[function(e,t,n){"use strict";var r=e("q"),i=e("simplito-utils"),o=e("simplito-promise"),s=o.PromiseQueue,a=function(){function e(e){this.handle=e,this.saveQueue=new s}return e.create=function(t){return new e(t).init()},e.prototype.init=function(){var e=this;return r(null).then(function(){return e.handle.readJson()}).then(function(t){return e.map=t,e})},e.prototype.save=function(e){var t=this;return r(null).then(function(){return t.handle.refreshAndUpdateToLastVersion()}).then(function(){return t.handle.writeJson(e)}).thenResolve(null)},e.prototype.hasKey=function(e){return e in this.map},e.prototype.hasValue=function(e){for(var t in this.map)if(this.map[t]==e)return!0;return!1},e.prototype.getValueByKey=function(e){return e in this.map?this.map[e]:null},e.prototype.getKeyByValue=function(e){for(var t in this.map)if(this.map[t]==e)return t;return null},e.prototype.set=function(e,t){var n,i=this;return this.saveQueue.add(function(){return r(null).then(function(){return n=i.setAtCopy(e,t),i.save(n)}).then(function(){i.map=n})})},e.prototype.setAtCopy=function(e,t){var n=i.simpleDeepClone(this.map);return n[e]=t,n},e.prototype.remove=function(e){var t,n=this;return this.saveQueue.add(function(){return r(null).then(function(){return t=n.removeAtCopy(e),n.save(t)}).then(function(){n.map=t})})},e.prototype.removeAtCopy=function(e){var t=i.simpleDeepClone(this.map);return delete t[e],t},e.prototype.isEmpty=function(){return 0===Object.keys(this.map).length},e.prototype.getAll=function(){return i.simpleDeepClone(this.map)},e.prototype.replaceData=function(e,t){if(t)return this.map=e,r(null);var n=this;return this.saveQueue.add(function(){return r(null).then(function(){return n.save(e)}).then(function(){n.map=e})})},e}();t.exports=a},{q:327,"simplito-promise":370,"simplito-utils":373}],187:[function(e,t,n){"use strict";var r=e("privmx-exception").IllegalArgumentException,i=function(){function e(e,t,n,i){if("boolean"!=typeof e)throw new r("read",e);if("boolean"!=typeof t)throw new r("write",t);if("boolean"!=typeof n)throw new r("createWhenNotExist",n);if("boolean"!=typeof i||0==n&&1==i)throw new r("failWhenExist",i);Object.defineProperty(this,"read",{value:e,enumerable:!0}),Object.defineProperty(this,"write",{value:t,enumerable:!0}),Object.defineProperty(this,"createWhenNotExist",{value:n,enumerable:!0}),Object.defineProperty(this,"failWhenExist",{value:i,enumerable:!0})}return e.prototype.isRead=function(){return this.read},e.prototype.isWrite=function(){return this.write},e.prototype.isReadOnly=function(){return this.read&&!this.write},e.prototype.isWriteOnly=function(){return!this.read&&this.write},e.prototype.isReadWrite=function(){return this.read&&this.write},e.prototype.shouldCreateWhenNotExist=function(){return this.createWhenNotExist},e.prototype.shouldFailWhenExist=function(){return this.failWhenExist},e.READ_ONLY=new e((!0),(!1),(!1),(!1)),e.WRITE_ONLY=new e((!1),(!0),(!1),(!1)),e.READ_WRITE=new e((!0),(!0),(!1),(!1)),e.WRITE_CREATE=new e((!1),(!0),(!0),(!1)),e.READ_WRITE_CREATE=new e((!0),(!0),(!0),(!1)),e.WRITE_EXCL=new e((!1),(!0),(!0),(!0)),e.READ_WRITE_EXCL=new e((!0),(!0),(!0),(!0)),e}();t.exports=i},{"privmx-exception":266}],188:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("q"),o=e("./Entry"),s=e("../../descriptor/Manager"),a=e("privmx-exception"),u=e("../../../core/ApiErrorCodes"),c=a.IllegalArgumentException,f=function(e){function t(t,n,r){var i=e.call(this,t,"directory",n)||this;if(!(r instanceof s))throw new c("manager",r);return Object.defineProperty(i,"manager",{value:r,enumerable:!0}),i}return r(t,e),t.fromHandle=function(e,n,r){var i=new t(e,n.ref,r);return Object.defineProperty(i,"handle",{value:n,enumerable:!0}),i},t.fromHandleWithEmptyEntries=function(e,n,r){var i=t.fromHandle(e,n,r);return i.entries=new l([]),i},t.prototype.addEntry=function(e){return!e.isDirectory()||e instanceof t||(e=new t(e.name,e.ref,this.manager)),this.tryModify(function(t){t.add(e)})},t.prototype.removeEntry=function(e){return this.tryModify(function(t){t.remove(e)})},t.prototype.renameEntry=function(e,t){return this.tryModify(function(n){n.rename(e,t)})},t.prototype.getByName=function(e){var t=this;return i(null).then(function(){return t.getEntries()}).then(function(t){return t.getByName(e)})},t.prototype.getByNameWithException=function(e){var t=this;return i(null).then(function(){return t.getEntries()}).then(function(t){return t.getByNameWithException(e)})},t.prototype.getHandle=function(){var e=this;return i(null).then(function(){return null!=e.handle?e.handle:null!=e.handlePromise?e.handlePromise:e.handlePromise=i(null).then(function(){return e.manager.getHandle(e.ref)}).then(function(t){return Object.defineProperty(e,"handle",{value:t,enumerable:!0}),t}).fin(function(){delete e.handlePromise})})},t.prototype.getEntries=function(){var e,t,n=this;return i(null).then(function(){if(null!=n.handle&&n.handle.isModified())t=n.handle.updateToLastVersion(),e=n.entries,n.entries=null;else if(n.entries)return n.entries;return i(null).then(function(){return n.getHandle()}).then(function(e){return e.readJson()}).then(function(e){return l.deserialize(n.manager,n.ref.writeKey,e)}).then(function(t){return null!=e&&t.upgrade(e),n.entries=t,t}).fail(function(r){return null!=e&&(n.entries=e,n.handle.currentVersion=t),i.reject(r)})})},t.prototype.tryModify=function(e){var t,n=this;return i(null).then(function(){return n.getEntries()}).then(function(n){return t=n.copy(),e(t)}).then(function(){return t.serialize(n.handle.ref.writeKey)}).then(function(e){return n.handle.writeJson(e)}).then(function(){n.entries=t}).fail(function(t){return u.is(t,"OLD_SIGNATURE_DOESNT_MATCH")?i(null).then(function(){return n.refresh()}).then(function(){return n.tryModify(e)}):i.reject(t)})},t.prototype.refresh=function(){var e=this;return i(null).then(function(){return e.getHandle()}).then(function(e){return e.refresh()})},t.prototype.addOnChangeCallback=function(e){var t=this;return i(null).then(function(){return t.getHandle()}).then(function(t){t.addOnChangeCallback(e)})},t.prototype.removeOnChangeCallback=function(e){var t=this;return i(null).then(function(){return t.getHandle()}).then(function(t){t.removeOnChangeCallback(e)})},t.prototype.toInfo=function(){return new o(this.name,this.type,this.ref)},t}(o);t.exports=f;var l=e("./Entries");t.exports=f},{"../../../core/ApiErrorCodes":150,"../../descriptor/Manager":175,"./Entries":189,"./Entry":190,"privmx-exception":266,q:327}],189:[function(e,t,n){"use strict";var r=e("q"),i=e("./Entry"),o=e("simplito-promise"),s=e("../../../exception/PrivFsException"),a=o.PromiseUtils,u=function(){function e(e){Object.defineProperty(this,"list",{value:e,enumerable:!0})}return e.prototype.serialize=function(e){return a.collect(this.list,function(t,n){return n.serialize(e)})},e.deserialize=function(t,n,o){return a.collect(o,function(e,o){return r(null).then(function(){return i.deserialize(o,n)}).then(function(e){return e.isDirectory()?new c(e.name,e.ref,t):e})}).then(function(t){return new e(t)})},e.prototype.getByRef=function(e){for(var t=0;t<this.list.length;t++){var n=this.list[t];if(n.ref.equals(e)&&n.ref.constructor==e.constructor)return n}return null},e.prototype.getByName=function(e){for(var t=0;t<this.list.length;t++){var n=this.list[t];if(n.name==e)return n}return null},e.prototype.getByNameWithException=function(e){var t=this.getByName(e);if(null==t)throw new s("FILE_DOESNT_EXIST",e);return t},e.prototype.hasName=function(e){return null!=this.getByName(e)},e.prototype.add=function(e){if(this.hasName(e.name))throw new s("FILE_ALREADY_EXISTS",e.name);
this.list.push(e)},e.prototype.remove=function(e){for(var t=0;t<this.list.length;t++){var n=this.list[t];if(n.name==e)return void this.list.splice(t,1)}throw new s("FILE_DOESNT_EXIST",e)},e.prototype.rename=function(e,t){if(this.hasName(t))throw new s("NAME_IN_USE",t);for(var n=0;n<this.list.length;n++){var r=this.list[n];if(r.name==e)return void(r.name=t)}throw new s("FILE_DOESNT_EXIST",e)},e.prototype.copy=function(){for(var t=[],n=0;n<this.list.length;n++)t.push(this.list[n]);return new e(t)},e.prototype.toInfo=function(){for(var e=[],t=0;t<this.list.length;t++)e.push(this.list[t].toInfo());return e},e.prototype.upgrade=function(e){for(var t=[],n=0;n<this.list.length;n++){var r=this.list[n],i=e.getByRef(r.ref);t.push(null==i?r:i)}this.list=t},e}();t.exports=u;var c=e("./Directory");t.exports=u},{"../../../exception/PrivFsException":167,"./Directory":188,"./Entry":190,q:327,"simplito-promise":370}],190:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-exception"),i=e("privmx-crypto"),o=e("../../descriptor/ref/DescriptorRefRead"),s=e("../../descriptor/ref/DescriptorRefWrite"),a=i.service,u=r.IllegalArgumentException,c=function(){function e(e,t,n){if("string"!=typeof e||e.indexOf("/")!=-1)throw new u("name",e);if("file"!=t&&"directory"!=t)throw new u("type",t);if(!(n instanceof o))throw new u("ref",n);Object.defineProperty(this,"name",{value:e,enumerable:!0,writable:!0}),Object.defineProperty(this,"type",{value:t,enumerable:!0}),Object.defineProperty(this,"ref",{value:n,enumerable:!0})}return e.prototype.isFile=function(){return"file"==this.type},e.prototype.isDirectory=function(){return"directory"==this.type},e.prototype.serialize=function(e){var t,r=this;return n(null).then(function(){return t={name:r.name,type:r.type,url:r.ref.url,xpub:r.ref.extPub58},r.ref.isReadOnly()?t:n(null).then(function(){return a.generateIv(e,0)}).then(function(t){var n=new Buffer(r.ref.extPriv58,"utf8");return a.privmxEncrypt(a.privmxOptAesWithDettachedIv(),n,e,t)}).then(function(e){t.xpriv=e.toString("base64")}).thenResolve(t)})},e.deserialize=function(t,r){return n(null).then(function(){return null==r||null==t.xpriv?o.fromExtKey(t.xpub,t.url):n(null).then(function(){return a.generateIv(r,0)}).then(function(e){return a.privmxDecrypt(new Buffer(t.xpriv,"base64"),r,e)}).then(function(e){return s.fromExtKey(e.toString("utf8"),t.url)})}).then(function(n){return new e(t.name,t.type,n)})},e.prototype.toInfo=function(){return this},e}();t.exports=c}).call(this,e("buffer").Buffer)},{"../../descriptor/ref/DescriptorRefRead":182,"../../descriptor/ref/DescriptorRefWrite":183,buffer:590,"privmx-crypto":248,"privmx-exception":266,q:327}],191:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Directory");n.Directory=r;var i=e("./Entries");n.Entries=i;var o=e("./Entry");n.Entry=o},{"./Directory":188,"./Entries":189,"./Entry":190}],192:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./entry");n.entry=r;var i=e("./path");n.path=i;var o=e("./FileSystem");n.FileSystem=o;var s=e("./KeyValueFile");n.KeyValueFile=s;var a=e("./Mode");n.Mode=a},{"./FileSystem":185,"./KeyValueFile":186,"./Mode":187,"./entry":191,"./path":196}],193:[function(e,t,n){"use strict";var r=e("privmx-exception"),i=e("simplito-utils"),o=e("./PathPart"),s=e("../../../exception/PrivFsException"),a=r.IllegalArgumentException,u=function(){function e(t){var n=e.parse(t);Object.defineProperty(this,"path",{value:t,enumerable:!0});for(var r=[],i=0;i<n.length;i++)r.push(new o(this,i,n[i]));Object.defineProperty(this,"parts",{value:r,enumerable:!0})}return e.parse=function(e){if("string"!=typeof e||!i.startsWith(e,"/"))throw new a("path",e);var t=e;i.endsWith(t,"/")&&(t=t.substring(0,t.length-1));for(var n=t.split("/"),r=0;r<n.length;r++)if(r>0&&0==n[r].length)throw new a("path",e);return n},e.prototype.getFirst=function(){return this.parts[0]},e.prototype.getLast=function(){return this.parts[this.parts.length-1]},e.prototype.getOneBeforeEnd=function(){return this.parts[this.parts.length-2]},e.prototype.assignResults=function(e){e:for(var t=0;t<e.length;t++){for(var n=e[t],r=0;r<this.parts.length;r++){var i=this.parts[r];if(i.did==n.ref.did){i.assignResult(n);continue e}}throw new s("CANNOT_ASSIGN_RESULT_TO_PATH_PART")}},e.prototype.isFullyResolved=function(){for(var e=0;e<this.parts.length;e++)if(!this.parts[e].isResolved())return!1;return!0},e.prototype.isResolvedExceptLastElement=function(){for(var e=0;e<this.parts.length-1;e++)if(!this.parts[e].isResolved())return!1;return!this.getLast().isResolved()},e}();t.exports=u},{"../../../exception/PrivFsException":167,"./PathPart":194,"privmx-exception":266,"simplito-utils":373}],194:[function(e,t,n){"use strict";var r=function(){function e(e,t,n){Object.defineProperty(this,"path",{value:e,enumerable:!0}),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"name",{value:n,enumerable:!0})}return e.prototype.isLast=function(){return this.index==this.path.parts.length-1},e.prototype.next=function(){return this.path.parts[this.index+1]},e.prototype.assignResult=function(e){this.result=e},e.prototype.isResultAssigned=function(e){return null!=this.result&&this.result.ref.did==e},e.prototype.assignDid=function(e){this.result=null,this.did=e},e.prototype.resolve=function(e){this.entry=e},e.prototype.isResolved=function(){return null!=this.entry},e}();t.exports=r},{}],195:[function(e,t,n){"use strict";var r=e("q"),i=e("./Path"),o=e("../../../exception/PrivFsException"),s=function(){function e(e,t){this.root=e,this.path=t,this.currentPart=this.path.getFirst(),this.currentEntry=e}return e.go=function(t,n,r){var o=new e(t,new i(n));return o.quick_path=r||!1,o.step()},e.prototype.refresh=function(e,t){var n=this;return r(null).then(function(){for(var r=[],i=e,o=t;null!=i&&null!=o&&!(i.ref.url!=e.ref.url||i.isDirectory()&&null==i.handle)&&(o.isResultAssigned(i.ref.did)||(r.push(i.ref),o.assignDid(i.ref.did)),null!=i.entries);)o=o.next(),i=null==o?null:i.entries.getByName(o.name);return 0==r.length?[]:(n.quick_path&&(r=r.slice(-1)),e.manager.getDescriptors(r))}).then(function(e){t.path.assignResults(e)})},e.prototype.step=function(){var e=this;return r(null).then(function(){return e.refresh(e.currentEntry,e.currentPart)}).then(function(){return e.currentPart.resolve(e.currentEntry),e.currentPart.isLast()?null:(e.currentPart=e.currentPart.next(),e.currentEntry.getByName(e.currentPart.name))}).then(function(t){if(null==t)return e.path;if(e.currentEntry=t,e.currentPart.isLast())return e.currentPart.resolve(e.currentEntry),e.path;if(e.currentEntry.isDirectory())return e.step();throw new o("FILE_ISNT_DIRECTORY",t.name)})},e}();t.exports=s},{"../../../exception/PrivFsException":167,"./Path":193,q:327}],196:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Path");n.Path=r;var i=e("./PathPart");n.PathPart=i;var o=e("./PathWalker");n.PathWalker=o},{"./Path":193,"./PathPart":194,"./PathWalker":195}],197:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./descriptor");n.descriptor=r;var i=e("./file");n.file=i},{"./descriptor":180,"./file":192}],198:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("../exception/PrivFsException"),i=e("simplito-utils"),o=e("privmx-crypto"),s=e("../core/PasswordMixer"),a=e("simplito-logger"),u=e("privmx-rpc"),c=o.service,f=u.PrivmxRpc,l=o.utils.Event,h=a.get("privfs-client.gateway.RpcGateway"),p=function(){function e(e,t){this.gateway=e,this.destination=t}return e.prototype.call=function(e,t){return this.destination?this.gateway.proxyRequest(this.destination,e,t):this.gateway.request(e,t)},e}(),d=function(){function e(e,t){this.rpc=e,this.properties=t,this.onFailBinded=this.onFail.bind(this),this.onConnectionLostEvent=new l}return e.prototype.request=function(e,t,n){return void 0===n&&(n={}),h.debug("request",e,t,n),this.rpc.call(e,t,n).fail(this.onFailBinded)},e.prototype.proxyRequest=function(e,t,n,r){return void 0===r&&(r={}),h.debug("proxyRequest",e,t,n,r),this.rpc.proxy(e,t,n,r).fail(this.onFailBinded)},e.prototype.isConnected=function(){return this.rpc.connected&&!this.rpc.connection.broken},e.prototype.onFail=function(e){return this.isConnected()||this.onConnectionLostEvent.trigger(),n.reject(e)},e.prototype.registerUser=function(e,t,n,r,i,o,s,a,u,c,f,l,h,p,d){if(c.hasAnyPrivate())throw new Error("Cannot send a keystore which contains a private key");return this.request("register",{username:e,host:t,srpSalt:n.toString("hex"),srpVerifier:r.toString("hex"),loginData:i,email:o,pin:s,token:a,privData:u.toString("base64"),keystore:c.serialize().toString("base64"),kis:f.serialize().toString("base64"),signature:l.toString("base64"),language:h,dataVersion:p,weakPassword:d!==!1})},e.prototype.info=function(){var e=this;return n(null).then(function(){return e.request("srpInfo",{})}).then(function(e){if(null==e||null==e.N||null==e.g)throw new r("INVALID_RESPONSE",e);return{N:new Buffer(i.padHex(e.N),"hex"),g:new Buffer(i.padHex(e.g),"hex")}})},e.prototype.prepareRegisterData=function(e,t){var r,i,o=this;return n(null).then(function(){return o.info()}).then(function(e){return r=e,s.generatePbkdf2(t)}).then(function(t){return i=t,c.srpRegister(r.N,r.g,e,i.mixed.toString("base64"))}).then(function(t){return{I:e,s:t.s,v:t.v,mixed:i.mixed,loginData:s.serializeData(i.data)}})},e.prototype.getHost=function(){return this.rpc.config.destination},e.prototype.getSession=function(){return this.rpc.getSrpData()},e.prototype.getClient=function(e){return n(new p(this,this.getHost()===e?null:e))},e.prototype.srpRelogin=function(e,t){var r,i=this;return n(null).then(function(){return r=new f(i.rpc.config),r.connect()}).then(function(){return r.login(e+"#"+i.rpc.config.destination,t,i.properties)}).then(function(){i.rpc=r})},e.prototype.keyRelogin=function(e){var t,r,i=this;return n(null).then(function(){return"string"==typeof e?c.bip39FromMnemonic(e):c.bip39FromEntropy(e)}).then(function(e){return r=e,t=new f(i.rpc.config),t.connect()}).then(function(){return t.keyHandshake(r.extKey.getPrivateKey(),i.properties)}).then(function(){i.rpc=t})},e}();t.exports=d}).call(this,e("buffer").Buffer)},{"../core/PasswordMixer":154,"../exception/PrivFsException":167,buffer:590,"privmx-crypto":248,"privmx-rpc":316,q:327,"simplito-logger":357,"simplito-utils":373}],199:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./RpcGateway");n.RpcGateway=r},{"./RpcGateway":198}],200:[function(e,t,n){"use strict";var r=function(){function e(e){if("string"==typeof e){var t=e.split("#");if(2!=t.length||0==t[0].length||0==t[0].length)throw new Error("Invalid parameter");Object.defineProperty(this,"hashmail",{value:e,enumerable:!0}),Object.defineProperty(this,"user",{value:t[0],enumerable:!0}),Object.defineProperty(this,"host",{value:t[1],enumerable:!0})}else{if("object"!=typeof e)throw new Error("Invalid parameter type");var n=e;if("string"!=typeof n.user||"string"!=typeof n.host||0==n.user.length||0==n.host.length||n.user.indexOf("#")!=-1||n.host.indexOf("#")!=-1)throw new Error("Invalid parameter");Object.defineProperty(this,"hashmail",{value:n.user+"#"+n.host,enumerable:!0}),Object.defineProperty(this,"user",{value:n.user,enumerable:!0}),Object.defineProperty(this,"host",{value:n.host,enumerable:!0})}}return e.prototype.toString=function(){return this.hashmail},e}();t.exports=r},{}],201:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("./User"),o=e("privmx-crypto"),s=function(e){function t(t,n,r,i){var s=e.call(this,t,n.getPublicKey(),r,i)||this;if(!(n instanceof o.ecc.PrivateKey))throw new Error("Invalid parameter");return Object.defineProperty(s,"priv",{value:n,enumerable:!0}),Object.defineProperty(s,"privWif",{value:n.toWIF(),enumerable:!0}),s}return r(t,e),t.fromSerialized=function(e,n,r){return new t(e,o.ecc.PrivateKey.fromWIF(n),r)},t.fromUser=function(e,n){return new t(e.hashmail,n,e.name,e.keystore)},t}(i);t.exports=s},{"./User":202,"privmx-crypto":248}],202:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("./Hashmail"),o=e("privmx-crypto"),s=function(e){function t(t,n,r,i){var s=e.call(this,t)||this;if(!(n instanceof o.ecc.PublicKey))throw new Error("Invalid parameter");return Object.defineProperty(s,"pub",{value:n,enumerable:!0}),Object.defineProperty(s,"pub58",{value:n.toBase58DER(),enumerable:!0}),Object.defineProperty(s,"name",{value:r,enumerable:!0,writable:!0}),Object.defineProperty(s,"keystore",{value:i,enumerable:!0,writable:!0}),s}return r(t,e),t.fromSerialized=function(e,n,r){return new t(e,o.ecc.PublicKey.fromBase58DER(n),r)},t.fromKeyStore=function(e,n,r){var i=n.getPrimaryKey().keyPair.keyPair;return new t(e,new o.ecc.PublicKey(i),r,n)},t.prototype.serialize=function(){return{hashmail:this.hashmail,pub58:this.pub58,name:this.name}},t.prototype.getDisplayName=function(e){return e||this.name||this.hashmail},t.prototype.toString=function(){return null==this.name?this.hashmail:this.name+"<"+this.hashmail+">"},t.prototype.getNameWithHashmail=function(){return null==this.name?this.hashmail:this.name+" ("+this.hashmail+")"},t}(i);t.exports=s},{"./Hashmail":200,"privmx-crypto":248}],203:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Hashmail");n.Hashmail=r;var i=e("./Identity");n.Identity=i;var o=e("./User");n.User=o},{"./Hashmail":200,"./Identity":201,"./User":202}],204:[function(e,t,n){"use strict";var r=e("./exports");t.exports=r},{"./exports":169}],205:[function(e,t,n){(function(Buffer){"use strict";var n=e("./MessageAttachmentSource"),r=e("../identity/Identity"),i=e("randombytes"),o=e("../identity/User"),s=e("./MessageReceiver"),a=e("privmx-crypto"),u=e("q"),c=a.service,f=function(){function e(){this.msgId=i(16).toString("hex"),this.receivers=[],this.createDate=new Date,this.attachments=[]}return e.prototype.setSender=function(e){if(!(e instanceof r))throw new Error("Invalid parameter");this.sender=e},e.prototype.addReceiver=function(e){if(!(e instanceof s))throw new Error("Invalid parameter");this.receivers.push(e)},e.prototype.setTitle=function(e){this.title=e},e.prototype.setText=function(e){this.text=e},e.prototype.setType=function(e){this.type=e},e.prototype.addAttachment=function(e){this.attachments.push(e instanceof n?e:new n(e))},e.prototype.checkReadyToSent=function(){for(var e=0;e<this.attachments.length;e++)if(!(this.attachments[e]instanceof n))throw new Error("Attachment must be instance of MessageAttachmentSource");if(null==this.sender)throw new Error("Sender cannot be empty");if(!(this.sender instanceof r))throw new Error("Sender must be instance of Identity");if(0==this.receivers.length)throw new Error("Message must contains at least one receiver");for(var e=0;e<this.receivers.length;e++)if(!(this.receivers[e]instanceof s))throw new Error("Receiver must be instance of MessageReceiver")},e.prototype.checkReadyToCreate=function(){for(var e=0;e<this.attachments.length;e++)if(!(this.attachments[e]instanceof n))throw new Error("Attachment must be instance of MessageAttachmentSource");if(null==this.sender)throw new Error("Sender cannot be empty");if(!(this.sender instanceof o))throw new Error("Sender must be instance of User");if(0==this.receivers.length)throw new Error("Message must contains at least one receiver");for(var e=0;e<this.receivers.length;e++)if(!(this.receivers[e]instanceof s))throw new Error("Receiver must be instance of MessageReceiver")},e.prototype.serialize=function(e,t,n){var r,i=this;return u(null).then(function(){var o=null==e;if(!o&&i.receivers.indexOf(e)==-1)throw new Error("Main receiver not at receiver list");var s=[];t.forEach(function(e){s.push(e.serialize())});var a=[];i.receivers.forEach(function(e){a.push({name:e.user.name,hashmail:e.user.hashmail,pub58:e.user.pub58,sinkPub58:e.sink.pub58,sent:(!o||e.sent!==!1)&&void 0})}),r={msgId:i.msgId,createDate:i.createDate.getTime(),text:i.text,title:i.title,inReplyTo:i.inReplyTo,forwarded:i.forwarded,attachments:s,sender:{name:i.sender.name,hashmail:i.sender.hashmail,pub58:i.sender.pub58},sid:o?void 0:e.sink.id,outerSignatory:n,receivers:a,type:i.type,contentType:i.contentType};var u=new Buffer(JSON.stringify(r),"utf8");return c.signToCompactSignatureWithHash(i.sender.priv,u).then(function(e){return{data:r,signature:e.toString("base64")}})})},e}();t.exports=f;var l=e("./SentMessage");f.deserialize=l.deserialize,f.deserializeFromSource=l.deserializeFromSource,f.deserializeWithoutCheckingSignature=l.deserializeWithoutCheckingSignature,f.deserializeFromSourceWithoutCheckingSignature=l.deserializeFromSourceWithoutCheckingSignature,t.exports=f}).call(this,e("buffer").Buffer)},{"../identity/Identity":201,"../identity/User":202,"./MessageAttachmentSource":207,"./MessageReceiver":209,"./SentMessage":213,buffer:590,"privmx-crypto":248,q:327,randombytes:329}],206:[function(e,t,n){(function(Buffer){"use strict";var n=e("../block/BlocksInfo"),r=function(){function e(){}return e.create=function(e){return new i(e)},e.prototype.serialize=function(){return{name:this.name,mimeType:this.mimeType,blocks:this.blocks,size:this.size,key:this.key.toString("base64")}},e.deserialize=function(t){var n=new e;return n.name=t.name,n.mimeType=t.mimeType,n.blocks=t.blocks,n.size=t.size,n.key=new Buffer(t.key,"base64"),n},e.prototype.getBids=function(){var e="";return this.blocks.forEach(function(t){e+=(""==e?"":",")+t}),e},e.prototype.checkBlocks=function(e){for(var t=0;t<this.blocks.length;t++)if(!(this.blocks[t]in e))return!1;return!0},e.prototype.getBlocksInfo=function(e,t,r){var i={type:"message",sid:t.id,mid:r.id};return new n(e,i,this)},e.getAllBlocks=function(e){var t=[];return e.forEach(function(e){e.blocks.forEach(function(e){t.push(e)})}),t},e}();t.exports=r;var i=e("./MessageAttachmentSource");t.exports=r}).call(this,e("buffer").Buffer)},{"../block/BlocksInfo":146,"./MessageAttachmentSource":207,buffer:590}],207:[function(e,t,n){"use strict";var r=e("simplito-lazybuffer"),i=e("../block/BlocksInfo"),o=function(){function e(e){if(e instanceof r.LazyBuffer){if(!e.getName())throw new Error("Invalid attachment name");this.name=e.getName(),this.mimeType=e.getMimetype()||"",this.size=e.getSize()}else{if(!(e instanceof i))throw new Error("Invalid attachment source");this.name=e.data.name,this.mimeType=e.data.mimeType,this.size=e.data.size}this.source=e}return e.prototype.getAttachment=function(e,t){var n=new s;return n.name=this.name,n.mimeType=this.mimeType,n.size=this.size,n.key=e,n.blocks=t,n},e}();t.exports=o;var s=e("./MessageAttachment");t.exports=o},{"../block/BlocksInfo":146,"./MessageAttachment":206,"simplito-lazybuffer":352}],208:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-crypto"),i=e("../block/BlockDownloader"),o=e("../block/BlockStreamer"),s=e("./MessageSinkCursor"),a=e("./MessageSinkPriv"),u=e("./Message"),c=e("./SentMessage"),f=e("./MessageAttachment"),l=e("./TagService"),h=e("simplito-logger"),p=e("simplito-lazybuffer"),d=e("../block/BlocksInfo"),g=e("randombytes"),y=e("simplito-promise"),m=r.service,v=y.PromiseUtils,b=h.get("privfs-client.message.MessageManager"),w=function(){function e(e,t){this.storageProviderManager=e,this.identity=t,this.tagService=new l}return e.prototype.init=function(){var e=this;return n(null).then(function(){return e.storageProviderManager.getProvider(e.identity.host)}).then(function(t){e.storage=t})},e.prototype.sinkGetAllMy=function(e){return this.storage.sinkGetAllMy().then(function(t){var n=[];return v.oneByOne(t,function(t,r){if(r.data)return e.decrypt(new Buffer(r.data,"base64")).then(function(e){var t=a.fromSerialized(e.wif,e.name,e.description,r.acl,e.extra,r.options);if(t.id!=r.id)throw new Error("Invalid sink private key");n.push(t)})}).thenResolve(n)})},e.prototype.sinkCreate=function(e,t,n,i,o,s){var u=this,c=new a(r.serviceSync.eccPrivRandom(),e,t,n,i,s),f={extra:c.extra,name:c.name,description:c.description,wif:c.privWif};return o.encrypt(f).then(function(e){return u.storage.sinkCreate(c.id,c.acl,e.toString("base64"),c.options).thenResolve(c)})},e.prototype.sinkSave=function(e,t){var n=this,r={extra:e.extra,name:e.name,description:e.description,wif:e.privWif};return t.encrypt(r).then(function(t){return n.storage.sinkSave(e.id,e.acl,t.toString("base64"),e.options)})},e.prototype.sinkDelete=function(e){return this.storage.sinkDelete(e.id)},e.prototype.sinkSetLastSeenSeq=function(e,t){return this.storage.sinkSetLastSeenSeq(e,t)},e.prototype.sinkPoll=function(e,t,r){var i=this,o=[];for(var s in e){var a=e[s];o.push({sid:a.sink.id,seq:a.seq,modSeq:a.modSeq})}return this.storage.sinkPoll(o,r).then(function(r){return v.oneByOne(r.sinks,function(r,o){for(var s=null,a=0;a<e.length;a++)if(e[a].sink.id==r){s=e[a];break}if(null==s)throw new Error("Cannot find cursor");t&&(s.seq=o.seq,s.modSeq=o.modSeq);var u=s.sink.priv.getPrivateEncKey();return n(null).then(function(){return v.oneByOne(o.meta,function(e,t){return""!=t.data?m.privmxDecrypt(m.privmxOptSignedCipher(),new Buffer(t.data,"base64"),u).then(function(e){t.data=JSON.parse(e.toString("utf8"))}).fail(function(e){t.error=e}):void(t.data=null)})}).then(function(){return v.oneByOne(o.msg,function(e,t){return i.decodeMessageAsync(s.sink,t).then(function(t){o.msg[parseInt(e)]=t}).fail(function(n){o.msg[parseInt(e)]={data:t,error:n}})})})}).thenResolve(r)})},e.prototype.sinkClear=function(e,t){return this.storage.sinkClear(e.sink.id,e.modSeq).then(function(n){return t&&(e.seq=n.seq,e.modSeq=n.modSeq),n})},e.prototype.sinkInfo=function(e,t){return this.storage.sinkInfo(e,!!t)},e.prototype.encodeSinkQuery=function(e){var t=this;return n(null).then(function(){if("string"==typeof e)return t.tagService.createTag(t.identity.pub,e);if("OR"==e.operand||"AND"==e.operand){var r;return n(null).then(function(){return t.encodeSinkQuery(e.left)}).then(function(n){return r=n,t.encodeSinkQuery(e.right)}).then(function(t){return{operand:e.operand,right:t,left:r}})}return"NOT"==e.operand?n(null).then(function(){return t.encodeSinkQuery(e.value)}).then(function(t){return{operand:e.operand,value:t}}):e})},e.prototype.sinkQuery=function(e,t,r,i){var o=this;return n(null).then(function(){return o.encodeSinkQuery(t)}).then(function(t){return o.storage.sinkQuery(e,t,r,i)})},e.prototype.sendAttachment=function(e,t){var r,i=this;return n(null).then(function(){if(t.source instanceof p.LazyBuffer)return r=g(32),o.stream(i.storage,e,t.source,r);if(t.source instanceof d)return r=t.source.data.key,o.addBlocksToSessionByInfo(i.storage,e,t.source);throw new Error("Invalid attachment source")}).then(function(e){return t.getAttachment(r,e)})},e.prototype.sendAttachments=function(e,t){var r=this,i=[];return t.forEach(function(t){i.push(r.sendAttachment(e,t))}),n.all(i)},e.prototype.prepareMessageDataToSend=function(e,t,r){var i,o,s,a,u,c;return n(null).then(function(){return i=e.sender.priv,o=e.sender.pub58,s=e.sender.hashmail,e.serialize(r,t,o)}).then(function(e){a={data:e.data,signature:e.signature};var t=new Buffer(JSON.stringify(a),"utf8");return m.eciesEncrypt(i,r.sink.pub,t)}).then(function(e){return u=e,m.sha256(u)}).then(function(e){c=f.getAllBlocks(t);var n=c.join("")+e.toString("base64")+r.sink.id+o;return m.signToCompactSignatureWithHash(i,new Buffer(n,"utf8"))}).then(function(e){var t={sid:r.sink.id,senderPub58:o,senderHashmail:s,blocks:c,extra:u.toString("base64"),signature:e.toString("base64")},n={data:a.data,signature:a.signature};return{data:t,source:n}})},e.prototype.prepareMessageDataToCreate=function(e,t,r){var i,o,s=this;return n(null).then(function(){var t=e.receivers.length>1;return i=e.sender.pub58,o=t?null:e.receivers[0],e.serialize(o,r,i)}).then(function(n){var a={data:n.data,signature:n.signature,pub:i,serverDate:e.serverDate?e.serverDate.getTime():null,sink:null==o?null:o.sink.id};return s.prepareMessageData(a,t,r)})},e.prototype.prepareMessageDataToCopy=function(e,t,r){var i=this;return n(null).then(function(){var n={data:e.source.data,signature:e.source.signature,pub:e.outerSignatory,serverDate:e.serverDate.getTime(),sink:null==e.mainReceiver?null:e.mainReceiver.sink.id};return i.prepareMessageData(n,t,r)})},e.prototype.prepareMessageData=function(e,t,r){var i,o;return n(null).then(function(){var n=new Buffer(JSON.stringify(e),"utf8");return m.privmxEncrypt(m.privmxOptAesWithAttachedIv(),n,t.priv.getPrivateEncKey())}).then(function(e){return o=e,m.sha256(o)}).then(function(e){i=f.getAllBlocks(r);var n=i.join("")+e.toString("base64")+t.id+t.id;return m.signToCompactSignatureWithHash(t.priv,new Buffer(n,"utf8"))}).then(function(n){var r={sid:t.id,senderPub58:t.id,blocks:i,extra:o.toString("base64"),signature:n.toString("base64")},s={data:e.data,signature:e.signature,serverDate:e.serverDate};return{data:r,source:s}})},e.prototype.messagePostSingle=function(e,t,r,i,o){var s,a,c=this;return n(null).then(function(){return c.tagService.createTags(i.receiver.user.pub,t)}).then(function(t){return a=t,c.prepareMessageDataToSend(e,r,i.receiver)}).then(function(e){return s=e,c.storage.messagePost(s.data,a,i.transferId,o)}).then(function(e){var t=new Date(parseInt(e.serverDate));s.source.serverId=e.serverId,s.source.serverDate=t.getTime(),i.success=!0,i.source=s.source,i.message=u.deserializeFromSourceWithoutCheckingSignature(s.source)}).fail(function(e){i.success=!1,i.couse=e})},e.prototype.messagePostToReceivers=function(t,r,i,o){var s=this;return n(null).then(function(){if(!(t instanceof u))throw new Error("Invalid message");t.checkReadyToSent();var a={};return i.forEach(function(e){var t=e.user.host;t in a||(a[t]={host:t,receivers:[],transfers:[],transferIds:[],messageManager:null}),a[t].receivers.push({receiver:e})}),null!=o&&o.transfers&&o.transfers.forEach(function(e){var t=e.host;t in a||(a[t]={host:t,receivers:[],transfers:[],transferIds:[],messageManager:null}),a[t].transfers.push(e),a[t].transferIds.push(e.id)}),v.settle(a,function(i,a){return n(null).then(function(){return s.storageProviderManager.getProvider(a.host)}).then(function(r){return a.messageManager=new e(s.storageProviderManager,s.identity),a.messageManager.storage=r,v.settle(a.receivers,function(e,r){if(0==t.attachments.length)return r.transferId="",void a.transferIds.push("");var i,s;return n(null).then(function(){i=g(32).toString("base64"),s=(new Date).getTime().toString();var e=new Buffer("messagePost"+r.receiver.sink.id+t.sender.hashmail+" "+i+" "+s,"utf8");return m.signToCompactSignatureWithHash(t.sender.priv,e)}).then(function(e){return a.messageManager.storage.messagePostInit(r.receiver.sink.id,{hashmail:t.sender.hashmail,pub:t.sender.pub58,nonce:i,timestamp:s,signature:e.toString("base64")},o?o.extra:null)}).then(function(e){r.transferId=e,a.transferIds.push(e)}).fail(function(e){r.success=!1,r.couse=e})})}).then(function(){return 0==a.transferIds.length?[]:a.messageManager.sendAttachments(a.transferIds,t.attachments)}).then(function(e){return a.transfers.forEach(function(t){t.success=!0,t.attachments=e}),v.settle(a.receivers,function(n,i){if(i.success!==!1)return a.messageManager.messagePostSingle(t,r,e,i,0==t.attachments.length&&o?o.extra:null)})}).fail(function(e){a.receivers.forEach(function(t){null==t.success&&(t.success=!1,t.couse=e)}),a.transfers.forEach(function(t){null==t.success&&(t.success=!1,t.couse=e)})})}).then(function(){var e=[];for(var t in a)a[t].receivers.forEach(function(t){e.push(t)});return e})})},e.prototype.messagePostToReceiversAndSaveInOutbox=function(e,t,r,i){if(null==i||null==i.outbox)return this.messagePostToReceivers(e,t,r,i);var o,s,a=this;return n(null).then(function(){return 0==e.attachments.length?"":a.messageCreateInit(i.outbox.sink)}).then(function(n){return o={id:n,host:a.storage.getDestination()},null==i.transfers&&(i.transfers=[]),i.transfers.push(o),a.messagePostToReceivers(e,t,r,i)}).then(function(t){s={results:t,errors:0};var r;return t.forEach(function(e){s.errors+=e.success?0:1,r=null==r&&e.success?e:r}),s.nooneGetMsg=s.errors==t.length,s.nooneGetMsg?s:o.success?n(null).then(function(){return e.serverDate=new Date(r.source.serverDate),a.updateReceiversSentStatus(e,s.results),a.messageCreateCore(e,i.outbox.flags,i.outbox.tags,i.outbox.sink,o.attachments,o.id)}).then(function(e){return s.outboxMessage=e,s}).fail(function(e){return s.outboxError=e,s}):(s.outboxError=o.couse,s)})},e.prototype.messagePost=function(e,t,n){return this.messagePostToReceiversAndSaveInOutbox(e,t,e.receivers,n)},e.prototype.messageResend=function(e,t,n,r){return this.messagePostToReceiversAndSaveInOutbox(e,t,n,r)},e.prototype.updateReceiversSentStatus=function(e,t){for(var n=0;n<t.length;n++)for(var r=t[n],i=0;i<e.receivers.length;i++){var o=e.receivers[i];r.receiver==o&&(o.sent=r.success)}},e.prototype.convertMessageToRaw=function(e,t){return e.createMessage(this.storage,t)},e.prototype.messageCreate=function(e,t,r,i){var o,s=this;return n(null).then(function(){if(!(e instanceof u&&i instanceof a))throw new Error("Invalid parameter");return e.checkReadyToCreate(),s.storage.messageCreateInit(i.id)}).then(function(t){return o=t,s.sendAttachments([o],e.attachments)}).then(function(n){return s.messageCreateCore(e,t,r,i,n,o)})},e.prototype.messageCreateInit=function(e){var t=this;return n(null).then(function(){if(!(e instanceof a))throw new Error("Invalid parameter");return t.storage.messageCreateInit(e.id)})},e.prototype.messageCreateCore=function(e,t,r,i,o,s){var c,f,l,h=this;return n(null).then(function(){if(!(e instanceof u&&i instanceof a))throw new Error("Invalid parameter");return e.checkReadyToCreate(),h.tagService.createTags(h.identity.pub,r)}).then(function(e){return l=e,h.encryptFlags(t,i)}).then(function(t){return f=t,h.prepareMessageDataToCreate(e,i,o)}).then(function(e){return c=e,h.storage.messageCreate(c.data,f,l,s)}).then(function(e){var t=new Date(parseInt(e.serverDate));return c.source.serverId=e.serverId,c.source.serverDate=t.getTime(),u.deserializeFromSourceWithoutCheckingSignature(c.source)})},e.prototype.messageMove=function(e,t,r,i,o,u){var f,l,h,p,d,g=this,y=i.modSeq+1;return n(null).then(function(){if(!(e instanceof c&&i instanceof s&&o instanceof a))throw new Error("Invalid parameter");return 0==e.attachments.length?"":g.storage.messageCreateAndDeleteInit(i.sink.id,e.id,o.id)}).then(function(t){return p=t,g.sendAttachments([p],e.getAttachmentSources(g.storage,i.sink))}).then(function(e){return d=e,g.tagService.createTags(g.identity.pub,r)}).then(function(e){return l=e,g.encryptFlags(t,o)}).then(function(t){return h=t,g.prepareMessageDataToCopy(e,o,d)}).then(function(t){return f=t,g.storage.messageCreateAndDelete(f.data,h,l,p,i.sink.id,e.serverId,y)}).then(function(t){u&&(i.modSeq=y);var n=new Date(parseInt(t.serverDate));return f.source.serverId=t.serverId,f.source.serverDate=n.getTime(),{message:e,source:f.source}})},e.prototype.messageDelete=function(e,t,r){var i=Array.isArray(t)?t:[t],o=this,s=e.modSeq+i.length;return n(null).then(function(){return o.storage.messageDelete(e.sink.id,i,s)}).then(function(){r&&(e.modSeq=s)})},e.prototype.messageModify=function(e,t,r,i,o){var s,a=this,u=e.modSeq+1;return n(null).then(function(){return a.tagService.createTags(a.identity.pub,i)}).then(function(t){return s=t,a.encryptFlags(r,e.sink)}).then(function(n){return a.storage.messageModify(e.sink.id,t,n,s,u)}).then(function(){o&&(e.modSeq=u)})},e.prototype.messageModifyTags=function(e,t,r,i,o){var s,a=this,u=e.modSeq+t.length;return n(null).then(function(){return a.tagService.createTags(a.identity.pub,r)}).then(function(e){return s=e,a.tagService.createTags(a.identity.pub,i);
}).then(function(n){return a.storage.messageModifyTags(e.sink.id,t,s,n,u)}).then(function(){o&&(e.modSeq=u)})},e.prototype.encryptFlags=function(e,t){return n(null).then(function(){if(null==e)return"";var n=new Buffer(JSON.stringify(e),"utf8");return m.privmxEncrypt(m.privmxOptAesWithSignature(),n,t.priv.getPrivateEncKey()).then(function(e){return e.toString("base64")})})},e.prototype.messageGet=function(e,t,r,i){var o=this;if(!(e instanceof a))throw new Error("Invalid parameter");var s=Array.isArray(t),u=s?t:[t];if(0==u.length)throw new Error("Empty mids list");var c=e.priv.getPrivateEncKey();return this.storage.messageGet(e.id,u,r||"DATA_AND_META").then(function(t){return n(null).then(function(){return v.oneByOne(t,function(e,t){if(null!=t.meta)return""!=t.meta.data?m.privmxDecrypt(m.privmxOptSignedCipher(),new Buffer(t.meta.data,"base64"),c).then(function(e){t.meta.data=JSON.parse(e.toString("utf8"))}).fail(function(e){t.metaError=e}):void(t.meta.data=null)})}).then(function(){return v.oneByOne(t,function(t,n){if(null!=n.data)return o.decodeMessageAsync(e,n.data).then(function(e){n.data=e}).fail(function(e){n.dataError=e})})}).then(function(){if(!s)return t[u[0]];if(i)return t;var e=[];for(var n in u)e.push(t[u[n]]);return e})})},e.prototype.decodeMessageAsync=function(e,t){var i,o,s,a=!1;return n(null).then(function(){return s=t.originalSid?t.originalSid:e.id,i=r.ecc.PublicKey.fromBase58DER(t.senderPub58),o=new Buffer(t.extra,"base64"),m.sha256(o)}).then(function(e){var n=t.blocks.join("")+e.toString("base64")+s+t.senderPub58;return m.verifyCompactSignatureWithHash(i,new Buffer(n,"utf8"),new Buffer(t.signature,"base64"))}).then(function(n){if(!n)throw new Error("Ivalid sink entry signature");if(e.id!=s){var r=e.registry?e.registry.map[s]:null;if(null==r)throw new Error("Cannot decrypt proxied message - no key");if("ecies"==r.type)return m.eciesDecrypt(r.priv,i,o);if("aesKey"==r.type)return m.privmxDecrypt(o,r.key);throw new Error("Unsupported sink register entry type "+r.type)}return a=t.senderPub58==e.id,a?m.privmxDecrypt(o,e.priv.getPrivateEncKey()):m.eciesDecrypt(e.priv,i,o)}).then(function(e){var n=JSON.parse(e.toString("utf8"));if(n.data.sid!=(a?n.sink:s))throw new Error("Sink id differ from id in message");if(n.data.outerSignatory!=(a?n.pub:t.senderPub58))throw new Error("Sink entry signatory differ from signatory in message");var r=a?new Date(n.serverDate):new Date(parseInt(t.serverDate));return u.deserialize(n.data,n.signature,t.serverId,r)}).fail(function(r){return"Error: Invalid checksum"===r?(b.error("Message decode error",r,e,t),null):n.reject(r)})},e.prototype.download=function(e,t,r,o){var s=this.storage;return n(null).then(function(){if(!(r instanceof f))throw new Error("Invalid attachment");return null!=r.cachedContent?r.cachedContent:null!=r.contentPromise?r.contentPromise:r.contentPromise=n(null).then(function(){var n={type:"message",sid:e.id,mid:t.id};return i.download(s,n,r.blocks,r.key)}).then(function(e){var t=new p.Content(e,r.mimeType,r.name);return o&&(r.cachedContent=t),t}).fin(function(){delete r.contentPromise})})},e}();t.exports=w}).call(this,e("buffer").Buffer)},{"../block/BlockDownloader":144,"../block/BlockStreamer":145,"../block/BlocksInfo":146,"./Message":205,"./MessageAttachment":206,"./MessageSinkCursor":211,"./MessageSinkPriv":212,"./SentMessage":213,"./TagService":214,buffer:590,"privmx-crypto":248,q:327,randombytes:329,"simplito-lazybuffer":352,"simplito-logger":357,"simplito-promise":370}],209:[function(e,t,n){"use strict";var r=e("../identity/User"),i=e("./MessageSink"),o=e("privmx-exception"),s=o.IllegalArgumentException,a=function(){function e(e,t){if(!(e instanceof i))throw new s("sink",e);if(!(t instanceof r))throw new s("user",t);Object.defineProperty(this,"sink",{value:e,enumerable:!0}),Object.defineProperty(this,"user",{value:t,enumerable:!0})}return e.fromSerialized=function(t,n,o,s){return new e(i.fromSerialized(t),r.fromSerialized(n,o,s))},e.prototype.toString=function(){var e=this.user.hashmail+":"+this.sink.id;return null==this.user.name?e:this.user.name+"<"+e+">"},e}();t.exports=a},{"../identity/User":202,"./MessageSink":210,"privmx-exception":266}],210:[function(e,t,n){"use strict";var r=e("privmx-crypto"),i=function(){function e(e,t,n){if(!(e instanceof r.ecc.PublicKey))throw new Error("Invalid parameter");Object.defineProperty(this,"pub",{value:e,enumerable:!0}),Object.defineProperty(this,"pub58",{value:e.toBase58DER(),enumerable:!0}),Object.defineProperty(this,"id",{value:this.pub58,enumerable:!0}),Object.defineProperty(this,"name",{value:t,enumerable:!0,writable:!0}),Object.defineProperty(this,"description",{value:n,enumerable:!0,writable:!0})}return e.fromSerialized=function(t,n,i){return new e(r.ecc.PublicKey.fromBase58DER(t),n,i)},e.deserialize=function(t){return e.fromSerialized(t.id,t.name,t.description)},e.prototype.serialize=function(){return{id:this.id,name:this.name,description:this.description}},e.prototype.toString=function(){return this.id},e.prototype.equals=function(t){return t instanceof e&&this.id===t.id},e}();t.exports=i},{"privmx-crypto":248}],211:[function(e,t,n){"use strict";var r=e("./MessageSinkPriv"),i=function(){function e(e,t,n){if(!(e instanceof r))throw new Error("Invalid parameter");Object.defineProperty(this,"sink",{value:e,enumerable:!0}),Object.defineProperty(this,"seq",{value:t,enumerable:!0,writable:!0}),Object.defineProperty(this,"modSeq",{value:n,enumerable:!0,writable:!0})}return e}();t.exports=i},{"./MessageSinkPriv":212}],212:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("privmx-crypto"),o=e("./MessageSink"),s=e("../core/Acl"),a=function(e){function t(t,n,r,o,s,a){var u=e.call(this,t.getPublicKey(),n,r)||this;if(!(t instanceof i.ecc.PrivateKey)||"public"!=o&&"private"!=o&&"shared"!=o&&"anonymous"!=o)throw new Error("Invalid parameter");return Object.defineProperty(u,"priv",{value:t,enumerable:!0}),Object.defineProperty(u,"privWif",{value:t.toWIF(),enumerable:!0}),Object.defineProperty(u,"acl",{value:o,enumerable:!0,writable:!0}),Object.defineProperty(u,"extra",{value:s||{},enumerable:!0,writable:!0}),u.options={removable:null==a||null==a.removable||a.removable,verify:null==a||null==a.verify?null:a.verify,proxyFrom:null==a||null==a.proxyFrom?void 0:a.proxyFrom,proxyTo:null==a||null==a.proxyTo?void 0:a.proxyTo,lowUsers:null==a||null==a.lowUsers?void 0:a.lowUsers},u}return r(t,e),t.fromSerialized=function(e,n,r,o,s,a){return new t(i.ecc.PrivateKey.fromWIF(e),n,r,o,s,a)},t.prototype.equals=function(e){return e instanceof t&&this.id===e.id},t.prototype.hasInProxyTo=function(e){return null!=this.options.proxyTo&&s.indexOf(s.getValue(e),this.options.proxyTo)!=-1},t.prototype.hasInProxyFrom=function(e){return null!=this.options.proxyFrom&&s.indexOf(s.getValue(e),this.options.proxyFrom)!=-1},t.prototype.addToProxyTo=function(e){this.options.proxyTo=s.getOrCreate(this.options.proxyTo),s.addToList(e,this.options.proxyTo)},t.prototype.addToProxyFrom=function(e){this.options.proxyFrom=s.getOrCreate(this.options.proxyFrom),s.addToList(e,this.options.proxyFrom)},t}(o);t.exports=a},{"../core/Acl":148,"./MessageSink":210,"privmx-crypto":248}],213:[function(e,t,n){(function(Buffer){"use strict";var n=e("./MessageAttachment"),r=e("./MessageAttachmentSource"),i=e("../identity/User"),o=e("./MessageReceiver"),s=e("q"),a=e("privmx-crypto"),u=a.service,c=function(){function e(){}return e.prototype.hasNotSent=function(){for(var e=0;e<this.receivers.length;e++)if(this.receivers[e].sent===!1)return!0;return!1},e.prototype.createMessage=function(e,t){var n=new f;n.msgId=this.msgId,n.createDate=this.createDate,n.text=this.text,n.title=this.title,n.inReplyTo=this.inReplyTo,n.forwarded=this.forwarded,n.sender=this.sender,n.receivers=this.receivers.concat([]);for(var r=0;r<this.attachments.length;r++)n.addAttachment(this.attachments[r].getBlocksInfo(e,t,this));return n.type=this.type,n.contentType=this.contentType,n},e.prototype.getAttachmentSources=function(e,t){for(var n=[],i=0;i<this.attachments.length;i++)n.push(new r(this.attachments[i].getBlocksInfo(e,t,this)));return n},e.deserializeWithoutCheckingSignature=function(t,n,r,i){return e.deserializeFromSourceWithoutCheckingSignature({data:t,signature:n,serverId:r,serverDate:i.getTime()})},e.deserializeFromSourceWithoutCheckingSignature=function(t){var r=new e;return r.msgId=t.data.msgId,t.data.createDate&&(r.createDate=new Date(t.data.createDate)),r.text=t.data.text,r.title=t.data.title,r.inReplyTo=t.data.inReplyTo,r.forwarded=t.data.forwarded,r.sender=i.fromSerialized(t.data.sender.hashmail,t.data.sender.pub58,t.data.sender.name),r.receivers=[],t.data.receivers.forEach(function(e){var n=o.fromSerialized(e.sinkPub58,e.hashmail,e.pub58,e.name);n.sent=e.sent,e.sinkPub58==t.data.sid&&(r.mainReceiver=n),r.receivers.push(n)}),r.attachments=[],t.data.attachments&&t.data.attachments.forEach(function(e){r.attachments.push(n.deserialize(e))}),r.outerSignatory=t.data.outerSignatory,r.serverId=t.serverId,r.serverDate=new Date(t.serverDate),r.source=t,r.type=t.data.type,r.contentType=t.data.contentType,r},e.deserialize=function(t,n,r,i){return e.deserializeFromSource({data:t,signature:n,serverId:r,serverDate:i.getTime()})},e.deserializeFromSource=function(t){var n;return s(null).then(function(){n=e.deserializeFromSourceWithoutCheckingSignature(t);var r=new Buffer(JSON.stringify(t.data),"utf8");return u.verifyCompactSignatureWithHash(n.sender.pub,r,new Buffer(t.signature,"base64"))}).then(function(e){if(!e)throw new Error("Ivalid signature");return n})},e}();Object.defineProperty(c.prototype,"id",{enumerable:!0,get:function(){return this.serverId}}),t.exports=c;var f=e("./Message");t.exports=c}).call(this,e("buffer").Buffer)},{"../identity/User":202,"./Message":205,"./MessageAttachment":206,"./MessageAttachmentSource":207,"./MessageReceiver":209,buffer:590,"privmx-crypto":248,q:327}],214:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=e("privmx-crypto"),i=e("simplito-promise"),o=r.service,s=i.PromiseUtils,a=function(){function e(){}return e.prototype.getUnecryptedTag=function(t){return e.UNENCRYPTED_PREFIX+t},e.prototype.createTag=function(e,t){var r=this;return n(null).then(function(){return r.getKeyFromPub(e)}).then(function(e){return r.createTagByKey(e,t)})},e.prototype.getKeyFromPub=function(e){return o.sha256(e.toDER())},e.prototype.createTagByKey=function(t,r){return n(null).then(function(){return 0==r.indexOf(e.UNENCRYPTED_PREFIX)?o.sha1(new Buffer(r,"utf8")):o.hmacSha1(t,new Buffer(r,"utf8"))}).then(function(e){return e.toString("base64")})},e.prototype.createTags=function(e,t){var r=this;return n(null).then(function(){return r.getKeyFromPub(e)}).then(function(e){return s.collect(t,function(t,n){return r.createTagByKey(e,n)})})},e.UNENCRYPTED_PREFIX="__$$",e}();t.exports=a}).call(this,e("buffer").Buffer)},{buffer:590,"privmx-crypto":248,q:327,"simplito-promise":370}],215:[function(e,t,n){"use strict";var r=e("q"),i=e("randombytes"),o=function(){function e(e){this.storage=e}return e.create=function(t,n){return r(null).then(function(){return t.getKeyValueFile(n)}).then(function(t){return new e(t)})},e.prototype.getTag=function(e){var t=this;return r(null).then(function(){if(t.storage.hasKey(e))return t.storage.getValueByKey(e);var n=i(32).toString("hex");return t.storage.set(e,n).thenResolve(n)})},e}();t.exports=o},{q:327,randombytes:329}],216:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("q"),o=e("privmx-pki"),s=o.CosignersProvider.CosignersProvider,a=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.storage=t,i}return r(t,e),t.create=function(e,n,r){return i(null).then(function(){return e.getKeyValueFile(n)}).then(function(e){var n=e.getAll(),i=n;n&&"cosigners"in n&&(i=n.cosigners);var s={};for(var a in i||{})s[a]=o.Helper.decodeKeystore(i[a]);return new t(e,s,r)})},t.prototype.setData=function(e){var t=this,n={};for(var r in e)n[r]=e[r].serialize().toString("base64");return this.storage.replaceData(n).then(function(){t.cosigners=e})},t}(s);t.exports=a},{"privmx-pki":306,q:327}],217:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Message");n.Message=r;var i=e("./MessageAttachment");n.MessageAttachment=i;var o=e("./MessageAttachmentSource");n.MessageAttachmentSource=o;var s=e("./MessageManager");n.MessageManager=s;var a=e("./MessageReceiver");n.MessageReceiver=a;var u=e("./MessageSink");n.MessageSink=u;var c=e("./MessageSinkCursor");n.MessageSinkCursor=c;var f=e("./MessageSinkPriv");n.MessageSinkPriv=f;var l=e("./SentMessage");n.SentMessage=l;var h=e("./TagService");n.TagService=h;var p=e("./TagStorage");n.TagStorage=p;var d=e("./TrustedServers");n.TrustedServers=d},{"./Message":205,"./MessageAttachment":206,"./MessageAttachmentSource":207,"./MessageManager":208,"./MessageReceiver":209,"./MessageSink":210,"./MessageSinkCursor":211,"./MessageSinkPriv":212,"./SentMessage":213,"./TagService":214,"./TagStorage":215,"./TrustedServers":216}],218:[function(e,t,n){"use strict";n.__esModule=!0;var r;!function(e){var t;!function(e){e[e.ALLOW_ALL=0]="ALLOW_ALL",e[e.DENY_ALL=1]="DENY_ALL",e[e.WHITE_LIST=2]="WHITE_LIST",e[e.BLACK_LIST=3]="BLACK_LIST"}(t=e.AclType||(e.AclType={}))}(r=n.core||(n.core={}));var i;!function(e){}(i=n.descriptor||(n.descriptor={}))},{}],219:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var e=function(){function e(){}return e.bufferToArray=function(e,t){if("function"==typeof e.toArrayBuffer)return e.toArrayBuffer();for(var n=e,r=new ArrayBuffer(n.length),i=new Uint8Array(r),o=0;o<n.length;++o)i[o]=n[o];return r},e.arrayToBuffer=function(e){return Buffer.from(e).slice(0)},e.isBuffer=function(e){return Buffer.isBuffer(e)||e instanceof Uint8Array},e.createBlob=function(t,n){return new Blob([e.bufferToArray(t)],{type:n})},e}();n.BrowserBuffer=e}).call(this,e("buffer").Buffer)},{buffer:590}],220:[function(e,t,n){"use strict";n.__esModule=!0;var r;!function(e){e[e.AES_256_CBC_PKCS7_NO_IV=1]="AES_256_CBC_PKCS7_NO_IV",e[e.AES_256_CBC_PKCS7_WITH_IV=2]="AES_256_CBC_PKCS7_WITH_IV",e[e.XTEA_ECB_PKCS7=3]="XTEA_ECB_PKCS7",e[e.AES_256_CBC_PKCS7_WITH_IV_AND_HMAC_SHA256=4]="AES_256_CBC_PKCS7_WITH_IV_AND_HMAC_SHA256"}(r=n.CipherType||(n.CipherType={}))},{}],221:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("../crypto/R"),r=e("bip39"),i=e("../ecc"),o=e("./CipherType"),s=e("../srp"),BN=e("bn.js"),a=function(){function e(){}return e.hmacSha1=function(e,n,r){return t.R(function(){return e.hmac("sha1",n,r)})},e.hmacSha256=function(e,n,r){return t.R(function(){return e.hmac("sha256",n,r)})},e.hmacSha512=function(e,n,r){return t.R(function(){return e.hmac("sha512",n,r)})},e.sha1=function(e,n){return t.R(function(){return e.hash("sha1",n)})},e.sha256=function(e,n){return t.R(function(){return e.hash("sha256",n)})},e.sha512=function(e,n){return t.R(function(){return e.hash("sha512",n)})},e.ripemd160=function(e,n){return t.R(function(){return e.hash("rmd160",n)})},e.hash160=function(e,n){return t.R(function(){return e.sha256(n)}).then(function(t){return e.ripemd160(t)})},e.kdf=function(e,n,r,i,o){var s;return t.R(function(){o||(o={}),"string"==typeof o&&(o={label:o});var a=o.counters!==!1,u=o.feedback!==!1,c=new Buffer(""),f=function(e){return"string"==typeof e?new Buffer(e):e instanceof Buffer?e:new Buffer("")};if(o.seed instanceof Buffer)c=o.seed;else{var l=f(o.label),h=f(o.context);c=new Buffer(l.length+h.length+5),l.copy(c),c.writeUInt8(0,l.length),h.copy(c,l.length+1),c.writeUInt32BE(r,l.length+h.length+1)}var p=f(o.iv);s=new Buffer("");var d=1,g=function(){if(!(s.length>=r)){var o=new Buffer("");if(u&&(o=p),a){var f=new Buffer(4);f.writeUInt32BE(d++,0),o=Buffer.concat([o,f])}return o=Buffer.concat([o,c]),t.R(function(){return e.hmac(n,i,o)}).then(function(e){return p=e,s=Buffer.concat([s,p]),g()})}};return g()}).then(function(){return s.slice(0,r)})},e.getKEM=function(e,n,r,i,o){return t.R(function(){return i||0===i||(i=32),o||0===o||(o=32),e.kdf(n,i+o,r,"key expansion")}).then(function(e){return{kE:e.slice(0,i),kM:e.slice(i)}})},e.aes256CbcHmac256Encrypt=function(e,n,r,i,o){var s,a;return t.R(function(){return o||0===o||(o=16),e.getKEM("sha256",r)}).then(function(t){return s=t,null==i?e.hmacSha256(r,n):i}).then(function(t){t=t.slice(0,16);var r=new Buffer(16);return r.fill(0),n=Buffer.concat([r,n]),e.aes256CbcPkcs7Encrypt(n,s.kE,t)}).then(function(t){return a=t,e.hmacSha256(s.kM,a)}).then(function(e){return e=e.slice(0,o),Buffer.concat([a,e])})},e.aes256CbcHmac256Decrypt=function(e,n,r,i){var o,s;return t.R(function(){return i||0===i||(i=16),e.getKEM("sha256",r)}).then(function(t){return o=t,s=n.slice(n.length-i),n=n.slice(0,n.length-i),e.hmacSha256(o.kM,n)}).then(function(t){if(t=t.slice(0,i),!s.equals(t))throw new Error("Wrong message security tag");var r=n.slice(0,16);return n=n.slice(16),e.aes256CbcPkcs7Decrypt(n,o.kE,r)})},e.prf_tls12=function(e,n,r,i){var o;return t.R(function(){var s=r;o=Buffer.alloc(0);var a=function(){if(!(o.length>=i))return t.R(function(){return e.hmacSha256(n,s)}).then(function(t){return s=t,e.hmacSha256(n,Buffer.concat([s,r]))}).then(function(e){return o=Buffer.concat([o,e]),a()})};return a()}).then(function(){return o.slice(0,i)})},e.hkdfSha256=function(e,n,r,i,o){var s;return t.R(function(){return i=i||Buffer.alloc(0),Buffer.isBuffer(n)||(n=Buffer.from(n)),Buffer.isBuffer(r)||(r=Buffer.from(r)),Buffer.isBuffer(i)||(i=Buffer.from(i)),s=Buffer.alloc(o),e.hmacSha256(n,r)}).then(function(n){var r=0,a=Buffer.alloc(0),u=1,c=function(){if(!(r>=o))return t.R(function(){return e.hmacSha256(n,Buffer.concat([a,i,Buffer.from([u++])]))}).then(function(e){return r+=e.copy(s,r,0,Math.min(e.length,o-r)),c()})};return c()}).then(function(){return s})},e.generateIv=function(e,n,r){return t.R(function(){return e.hmacSha256(n,new Buffer("iv"+r,"utf8"))}).then(function(e){return e.slice(0,16)})},e.reductKey=function(e,n){return t.R(function(){return e.sha256(n)}).then(function(e){return e.slice(0,16)})},e.xteaEcbPkcs7Key32Encrypt=function(e,n,r){return t.R(function(){return e.reductKey(r)}).then(function(t){return e.xteaEcbPkcs7Encrypt(n,t)})},e.xteaEcbPkcs7Key32Decrypt=function(e,n,r){return t.R(function(){return e.reductKey(r)}).then(function(t){return e.xteaEcbPkcs7Decrypt(n,t)})},e.ctAes256CbcPkcs7NoIv=function(e,n,r,i){return t.R(function(){return e.aes256CbcPkcs7Encrypt(n,r,i)}).then(function(e){return Buffer.concat([new Buffer([o.CipherType.AES_256_CBC_PKCS7_NO_IV]),e])})},e.ctAes256CbcPkcs7WithIv=function(e,n,r,i){return t.R(function(){return e.aes256CbcPkcs7Encrypt(n,r,i)}).then(function(e){return Buffer.concat([new Buffer([o.CipherType.AES_256_CBC_PKCS7_WITH_IV]),i,e])})},e.ctAes256CbcPkcs7WithRandomIv=function(e,n,r){return t.R(function(){return e.ctAes256CbcPkcs7WithIv(n,r,e.randomBytes(16))})},e.ctXteaEcbPkcs7=function(e,n,r){return t.R(function(){return e.xteaEcbPkcs7Encrypt(n,r)}).then(function(e){return Buffer.concat([new Buffer([o.CipherType.XTEA_ECB_PKCS7]),e])})},e.ctXteaEcbPkcs7Key32=function(e,n,r){return t.R(function(){return e.xteaEcbPkcs7Key32Encrypt(n,r)}).then(function(e){return Buffer.concat([new Buffer([o.CipherType.XTEA_ECB_PKCS7]),e])})},e.ctAes256CbcPkcs7WithIvAndHmacSha256=function(e,n,r,i,s){return t.R(function(){return e.aes256CbcHmac256Encrypt(n,r,i,s)}).then(function(e){return Buffer.concat([new Buffer([o.CipherType.AES_256_CBC_PKCS7_WITH_IV_AND_HMAC_SHA256]),e])})},e.ctDecrypt=function(e,n,r,i,s,a){return t.R(function(){if(32!==r.length)throw new Error("Decrypt invalid key length, required: 32, have: "+r.length+" "+r.toString("hex"));var t=n.readUInt8(0);if(t==o.CipherType.AES_256_CBC_PKCS7_NO_IV){if(null==i)throw new Error("Missing IV");return e.aes256CbcPkcs7Decrypt(n.slice(1),r,i)}if(t==o.CipherType.AES_256_CBC_PKCS7_WITH_IV)return e.aes256CbcPkcs7Decrypt(n.slice(17),r,n.slice(1,17));if(t==o.CipherType.XTEA_ECB_PKCS7)return a?e.xteaEcbPkcs7Decrypt(n.slice(1),a):e.xteaEcbPkcs7Key32Decrypt(n.slice(1),r);if(t==o.CipherType.AES_256_CBC_PKCS7_WITH_IV_AND_HMAC_SHA256)return e.aes256CbcHmac256Decrypt(n.slice(1),r,s);throw new Error("Unknown decryption type "+t)})},e.eccExtFromSeed=function(e,n){return t.R(function(){return i.ExtKey.fromSeed(e,n)})},e.eccExtRandom=function(e){return t.R(function(){return i.ExtKey.generateRandom(e)})},e.eccPrivRandom=function(e){return t.R(function(){return i.PrivateKey.generateRandom(e)})},e.eccPubToBase58Address=function(e,n,r){return t.R(function(){return n.toBase58Address(e,r)})},e.signToCompactSignature=function(e,n){return t.R(function(){return e.signToCompactSignature(n)})},e.signToCompactSignatureWithHash=function(e,n,r){return t.R(function(){return e.sha256(r)}).then(function(t){return e.signToCompactSignature(n,t)})},e.getSharedKey=function(e,n,r){return t.R(function(){return n.getSharedKey(e,r)})},e.verifyCompactSignature=function(e,n,r){return t.R(function(){return e.verifyCompactSignature(n,r)})},e.verifyCompactSignatureWithHash=function(e,n,r,i){return t.R(function(){return e.sha256(r)}).then(function(t){return e.verifyCompactSignature(n,t,i)})},e.eciesEncrypt=function(e,n,r,i){return t.R(function(){return n.eciesEncrypt(e,r,i)})},e.eciesDecrypt=function(e,n,r,i){return t.R(function(){return n.eciesDecrypt(e,r,i)})},e.deriveHardened=function(e,n,r){return t.R(function(){return n.deriveHardened(e,r)})},e.bip39FromEntropy=function(e,n,i){var o;return t.R(function(){return o=r.entropyToMnemonic(n),e.bip39GetExtKey(o,i)}).then(function(e){return{entropy:n,mnemonic:o,extKey:e}})},e.bip39FromMnemonic=function(e,n,i){var o;return t.R(function(){return o=r.mnemonicToEntropy(n),e.bip39GetExtKey(n,i)}).then(function(e){return{entropy:o,mnemonic:n,extKey:e}})},e.bip39GetExtKey=function(e,n,o){return t.R(function(){var t=r.mnemonicToSeed(n,o);return i.ExtKey.fromSeed(e,t)})},e.bip39Generate=function(e,n,r){return t.R(function(){return e.bip39FromEntropy(e.randomBytes(n/8),r)})},e.srpRegister=function(e,n,r,i,o){return t.R(function(){return e.srpRegisterS(n,r,i,o,e.randomBytes(16))})},e.srpRegisterS=function(e,n,r,i,o,a){return t.R(function(){var t=new s.SrpLogic(e,"sha256");return t.register(new BN(n),new BN(r),i,o,a)}).then(function(e){return{s:e.s,v:e.v.toArrayLike(Buffer)}})},e.srpLoginStep1=function(e,n,r,i,o,s,a,u){return t.R(function(){return e.srpLoginStep1A(n,r,i,o,s,a,u,e.randomBytes(64))})},e.srpLoginStep1A=function(e,n,r,i,o,a,u,c,f){return t.R(function(){var t=new s.SrpLogic(e,"sha256");return t.login_step1(new BN(n),new BN(r),i,new BN(o),u,c,new BN(f))}).then(function(e){return{A:e.A.toArrayLike(Buffer),K:e.K.toArrayLike(Buffer,"be",32),M1:e.M1.toArrayLike(Buffer),M2:e.M2.toArrayLike(Buffer)}})},e.srpLoginStep2=function(e,n){return t.R(function(){return s.SrpLogicBase.login_step2(new BN(e),new BN(n))})},e}();n.CryptoBase=a}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"../ecc":246,"../srp":261,"./CipherType":220,bip39:17,"bn.js":26,buffer:590}],222:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../crypto/R"),i=e("../browserbuffer/BrowserBuffer"),o=e("./CipherType"),s=function(){function e(){}return e.privmxOptAesWithDettachedIv=function(){return{algorithm:"AES-256-CBC"}},e.privmxOptAesWithAttachedIv=function(){return{algorithm:"AES-256-CBC",attachIv:!0}},e.privmxOptAesWithSignature=function(){return{algorithm:"AES-256-CBC",attachIv:!0,hmac:"SHA-256"}},e.privmxOptXtea=function(){return{algorithm:"XTEA-ECB"}},e.privmxOptSignedCipher=function(){return{signed:!0}},e.privmxGetBlockSize=function(e,t){var n=t-1;return e.attachIv&&(n-=16),e.hmac&&(n-="undefined"==typeof e.taglen?16:e.taglen),n-n%16-1},e.privmxHasSignature=function(e){var t=i.BrowserBuffer.isBuffer(e)?e.readUInt8(0):e;return t==o.CipherType.AES_256_CBC_PKCS7_WITH_IV_AND_HMAC_SHA256},e.privmxEncrypt=function(e,t,n,i,o){return r.R(function(){if(32!==i.length)throw new Error("Encrypt invalid key length, required: 32, have: "+i.length+" "+i.toString("hex"));var r=t.hmac||!1,s=t.attachIv===!0;switch(t.algorithm){case"AES-256-CBC":if(r){if("SHA-256"!==r||!s)throw new Error("Only hmac SHA-256 with iv is supported for AES-256-CBC");if(t.deterministic){if(o)throw new Error("Cannot pass IV to deterministic AES-256-CBC hmac SHA-256")}else o=o||e.randomBytes(16);return e.ctAes256CbcPkcs7WithIvAndHmacSha256(n,i,t.deterministic?null:o,t.taglen)}return o=o||e.randomBytes(16),s?e.ctAes256CbcPkcs7WithIv(n,i,o):e.ctAes256CbcPkcs7NoIv(n,i,o);case"XTEA-ECB":if(r||o||s)throw new Error("XTEA-ECB encryption doesn't support hmac and iv");return e.ctXteaEcbPkcs7Key32(n,i);default:throw new Error("Unsupported encryption algorithm "+t.algorithm)}})},e.privmxDecrypt=function(e,t,n,i,o,s){return r.R(function(){if(null!=n&&n.signed&&!t.privmxHasSignature(i)&&t.errorOnMissingSignature)throw new Error("Missing required signature");return e.ctDecrypt(i,o,s,null==n?null:n.taglen)})},e}();n.CryptoPrivmxBase=s;var a=function(){function e(e){this.crypto=e,this.errorOnMissingSignature=!0}return e.prototype.privmxSetErrorOnMissingSignature=function(e){this.errorOnMissingSignature=!!e},e.prototype.privmxOptAesWithDettachedIv=function(){return s.privmxOptAesWithDettachedIv()},e.prototype.privmxOptAesWithAttachedIv=function(){return s.privmxOptAesWithAttachedIv()},e.prototype.privmxOptAesWithSignature=function(){return s.privmxOptAesWithSignature()},e.prototype.privmxOptXtea=function(){return s.privmxOptXtea()},e.prototype.privmxOptSignedCipher=function(){return s.privmxOptSignedCipher()},e.prototype.privmxGetBlockSize=function(e,t){return s.privmxGetBlockSize(e,t)},e.prototype.privmxHasSignature=function(e){return s.privmxHasSignature(e)},e.prototype.privmxEncrypt=function(e,t,n,r){return s.privmxEncrypt(this.crypto,e,t,n,r).async()},e.prototype.privmxDecrypt=function(e,t,n,r){return i.BrowserBuffer.isBuffer(e)?s.privmxDecrypt(this.crypto,this,null,e,t,n).async():s.privmxDecrypt(this.crypto,this,e,t,n,r).async()},e}();n.CryptoPrivmx=a},{"../browserbuffer/BrowserBuffer":219,"../crypto/R":227,"./CipherType":220}],223:[function(e,t,n){(function(Buffer){"use strict";function t(e){return e}n.__esModule=!0;var r=e("../browserbuffer/BrowserBuffer"),i=e("q"),o=e("./CryptoBase"),s=e("privmx-exception"),a=s.IllegalArgumentException,u=function(){function e(){}return e.prototype.check=function(e){return i(null).then(e).then(function(){return!0}).fail(function(){return!1})},e.prototype.isSupported=function(){var e=this;return i(null).then(function(){var t="undefined"!=typeof window&&"undefined"!=typeof window.crypto&&"undefined"!=typeof window.crypto.subtle&&"undefined"!=typeof window.crypto.subtle.encrypt&&"undefined"!=typeof window.crypto.subtle.decrypt&&"undefined"!=typeof window.crypto.subtle.digest&&"undefined"!=typeof window.crypto.subtle.importKey;return!!t&&e.sha1_check()})},e.prototype.hmac=function(n,o,s){return i(null).then(function(){var i={name:"HMAC",hash:{name:e.HASH_ALGORITHM_MAP[n]}};return t(window.crypto.subtle.importKey("raw",r.BrowserBuffer.bufferToArray(o,!1),i,!1,["sign"]).then(function(e){return window.crypto.subtle.sign(i,e,r.BrowserBuffer.bufferToArray(s,!1))}).then(r.BrowserBuffer.arrayToBuffer))})},e.prototype.hmac_vary=function(e,t,n){return e},e.prototype.hmac_check=function(e){var t=this;return this.check(function(){return t.hmac(e,new Buffer(32),new Buffer(1024))})},e.prototype.hmacSha1=function(e,t){return o.CryptoBase.hmacSha1(this,e,t).async()},e.prototype.hmacSha1_check=function(){var e=this;return this.check(function(){return e.hmacSha1(new Buffer(32),new Buffer(1024))})},e.prototype.hmacSha256=function(e,t){return o.CryptoBase.hmacSha256(this,e,t).async()},e.prototype.hmacSha256_check=function(){var e=this;return this.check(function(){return e.hmacSha256(new Buffer(32),new Buffer(1024))})},e.prototype.hmacSha512=function(e,t){return o.CryptoBase.hmacSha512(this,e,t).async()},e.prototype.hmacSha512_check=function(){var e=this;return this.check(function(){return e.hmacSha512(new Buffer(32),new Buffer(1024))})},e.prototype.hash=function(n,o){return i(null).then(function(){if(n=e.HASH_ALGORITHM_MAP[n],!r.BrowserBuffer.isBuffer(o))throw new a("data",o);return t(window.crypto.subtle.digest({name:n},r.BrowserBuffer.bufferToArray(o,!1)).then(r.BrowserBuffer.arrayToBuffer))})},e.prototype.hash_vary=function(e,t){return e},e.prototype.hash_check=function(e){var t=this;return this.check(function(){return t.hash(e,new Buffer(1024))})},e.prototype.sha1=function(e){return o.CryptoBase.sha1(this,e).async()},e.prototype.sha1_check=function(){var e=this;return this.check(function(){return e.sha1(new Buffer(1024))})},e.prototype.sha256=function(e){return o.CryptoBase.sha256(this,e).async()},e.prototype.sha256_check=function(){var e=this;return this.check(function(){return e.sha256(new Buffer(1024))})},e.prototype.sha512=function(e){return o.CryptoBase.sha512(this,e).async()},e.prototype.sha512_check=function(){var e=this;return this.check(function(){return e.sha512(new Buffer(1024))})},e.prototype.aes256CbcPkcs7Encrypt=function(e,n,o){return i(null).then(function(){if(!r.BrowserBuffer.isBuffer(e)||0==e.length)throw new a("data",e);if(!r.BrowserBuffer.isBuffer(n)||32!=n.length)throw new a("key",n);if(!r.BrowserBuffer.isBuffer(o)||16!=o.length)throw new a("iv",o);return t(window.crypto.subtle.importKey("raw",r.BrowserBuffer.bufferToArray(n,!1),"AES-CBC",!0,["encrypt"]).then(function(t){return window.crypto.subtle.encrypt({name:"AES-CBC",iv:r.BrowserBuffer.bufferToArray(o,!1)},t,r.BrowserBuffer.bufferToArray(e,!1))}).then(r.BrowserBuffer.arrayToBuffer))})},e.prototype.aes256CbcPkcs7Encrypt_check=function(){var e=this;return this.check(function(){return e.aes256CbcPkcs7Encrypt(new Buffer(1024),new Buffer(32),new Buffer(16))})},e.prototype.aes256CbcPkcs7Decrypt=function(e,n,o){return i(null).then(function(){if(!r.BrowserBuffer.isBuffer(e)||0==e.length)throw new a("data",e);if(!r.BrowserBuffer.isBuffer(n)||32!=n.length)throw new a("key",n);if(!r.BrowserBuffer.isBuffer(o)||16!=o.length)throw new a("iv",o);return t(window.crypto.subtle.importKey("raw",r.BrowserBuffer.bufferToArray(n,!1),"AES-CBC",!0,["decrypt"]).then(function(t){return window.crypto.subtle.decrypt({name:"AES-CBC",iv:r.BrowserBuffer.bufferToArray(o,!1)},t,r.BrowserBuffer.bufferToArray(e,!1))}).then(r.BrowserBuffer.arrayToBuffer))})},e.prototype.aes256CbcPkcs7Decrypt_check=function(){return this.aes256CbcPkcs7Encrypt_check()},e.prototype.pbkdf2=function(n,o,s,a,u){return i(null).then(function(){return t(window.crypto.subtle.importKey("raw",r.BrowserBuffer.bufferToArray(n,!1),{name:"PBKDF2"},!1,["deriveBits"]).then(function(t){return window.crypto.subtle.deriveBits({name:"PBKDF2",salt:r.BrowserBuffer.bufferToArray(o),iterations:s,hash:{name:e.HASH_ALGORITHM_MAP[u]}},t,8*a)}).then(r.BrowserBuffer.arrayToBuffer))})},e.prototype.pbkdf2_vary=function(e,t,n,r,i){return i},e.prototype.pbkdf2_check=function(e){var t=this;return this.check(function(){return t.pbkdf2(new Buffer(32),new Buffer(16),1,1,e)})},e.prototype.kdf=function(e,t,n,r){return o.CryptoBase.kdf(this,e,t,n,r).async()},e.prototype.kdf_vary=function(e,t,n,r){return e},e.prototype.kdf_check=function(e){var t=this;return this.check(function(){return t.kdf(e,32,new Buffer(32),"a")})},e.prototype.getKEM=function(e,t,n,r){return o.CryptoBase.getKEM(this,e,t,n,r).async()},e.prototype.getKEM_vary=function(e,t,n,r){return e},e.prototype.getKEM_check=function(e){var t=this;return this.check(function(){return t.getKEM(e,new Buffer(32))})},
e.prototype.aes256CbcHmac256Encrypt=function(e,t,n,r){return o.CryptoBase.aes256CbcHmac256Encrypt(this,e,t,n,r).async()},e.prototype.aes256CbcHmac256Encrypt_check=function(){var e=this;return this.check(function(){return e.aes256CbcHmac256Encrypt(new Buffer(1024),new Buffer(32),new Buffer(16))})},e.prototype.aes256CbcHmac256Decrypt=function(e,t,n){return o.CryptoBase.aes256CbcHmac256Decrypt(this,e,t,n).async()},e.prototype.aes256CbcHmac256Decrypt_check=function(){return this.aes256CbcHmac256Encrypt_check()},e.prototype.prf_tls12=function(e,t,n){return o.CryptoBase.prf_tls12(this,e,t,n).async()},e.prototype.prf_tls12_check=function(){var e=this;return this.check(function(){return e.prf_tls12(new Buffer(32),new Buffer(32),32)})},e.prototype.hkdfSha256=function(e,n,o,s){return o=o||Buffer.alloc(0),i(null).then(function(){return t(window.crypto.subtle.importKey("raw",r.BrowserBuffer.bufferToArray(e,!1),{name:"HKDF"},!1,["deriveBits"]).then(function(e){return window.crypto.subtle.deriveBits({name:"HKDF",hash:{name:"SHA-256"},salt:r.BrowserBuffer.bufferToArray(n,!1),info:r.BrowserBuffer.bufferToArray(o,!1)},e,8*s)}).then(function(e){return Buffer.from(e)}))})},e.prototype.hkdfSha256_check=function(){var e=this;return this.check(function(){return e.hkdfSha256(new Buffer(32),new Buffer(16),new Buffer(16),32)})},e.prototype.generateIv=function(e,t){return o.CryptoBase.generateIv(this,e,t).async()},e.prototype.generateIv_check=function(){var e=this;return this.check(function(){return e.generateIv(new Buffer(32),0)})},e.prototype.reductKey=function(e){return o.CryptoBase.reductKey(this,e).async()},e.prototype.reductKey_check=function(){var e=this;return this.check(function(){return e.reductKey(new Buffer(32))})},e.prototype.ctAes256CbcPkcs7NoIv=function(e,t,n){return o.CryptoBase.ctAes256CbcPkcs7NoIv(this,e,t,n).async()},e.prototype.ctAes256CbcPkcs7NoIv_check=function(){var e=this;return this.check(function(){return e.ctAes256CbcPkcs7NoIv(new Buffer(1024),new Buffer(32),new Buffer(16))})},e.prototype.ctAes256CbcPkcs7WithIv=function(e,t,n){return o.CryptoBase.ctAes256CbcPkcs7WithIv(this,e,t,n).async()},e.prototype.ctAes256CbcPkcs7WithIv_check=function(){var e=this;return this.check(function(){return e.ctAes256CbcPkcs7WithIv(new Buffer(1024),new Buffer(32),new Buffer(16))})},e.prototype.ctAes256CbcPkcs7WithIvAndHmacSha256=function(e,t,n,r){return o.CryptoBase.ctAes256CbcPkcs7WithIvAndHmacSha256(this,e,t,n,r).async()},e.prototype.ctAes256CbcPkcs7WithIvAndHmacSha256_check=function(){var e=this;return this.check(function(){return e.ctAes256CbcPkcs7WithIvAndHmacSha256(new Buffer(1024),new Buffer(32),new Buffer(16))})},e.HASH_ALGORITHM_MAP={sha1:"SHA-1",sha256:"SHA-256",sha512:"SHA-512"},e}();n.CryptoSubtle=u}).call(this,e("buffer").Buffer)},{"../browserbuffer/BrowserBuffer":219,"./CryptoBase":221,buffer:590,"privmx-exception":266,q:327}],224:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("./Rng"),r=function(){function e(e){this.rng=e}return e.prototype.randomInt32=function(){return this.rng.int32()},e.prototype.randomDouble=function(){return this.rng["double"]()},e.prototype.randomBytes=function(e){return this.rng.bytes(e)},e.prototype.randomBits=function(e){return this.rng.bits(e)},e.prototype.randomBN=function(e){return this.rng.bn(e)},e}();n.RandomService=r;var i=function(){function e(e){this.rng=e}return e.prototype.randomBytes=function(e){if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var t=new Buffer(e);return window.crypto.getRandomValues(t),t}return this.rng.bytes(e)},e}();n.CryptoRandomBytesOrRng=i;var o=function(){function e(e){this.rng=e}return e.prototype.randomNumber=function(e){return this.rng.int32()%e},e}();n.RandomNumber=o;var s=function(){function e(e,t,n){this.entropyGenerator=e,this.intervalGenerator=t,this.callback=n}return e.bind=function(t,n,r){var i=new e(t,n,r);return i.init(),i},e.prototype.init=function(){var e=this,t=function(){var n=e.entropyGenerator.randomBytes(256);e.callback(n);var r=1e3+e.intervalGenerator.randomNumber(1e3);setTimeout(t,r)};t()},e}();n.IntervalEntropyGenerator=s;var a=function(){function e(e,t){this.intervalGenerator=e,this.callback=t,this.entropy=new Buffer(0),this.maxEntropy=65536,this.r=0}return e.bind=function(t,n){var r=new e(t,n);return r.init(),r},e.prototype.writeEntropy=function(e){this.entropy=Buffer.concat([this.entropy,e]),this.entropy.length<this.maxEntropy||(this.callback(this.entropy),this.entropy=new Buffer(0))},e.prototype.init=function(){var e=this,t=function(t){e.r++;var n="";for(var r in t)if("function"!=typeof t[r])try{n+=r+t[r]}catch(i){}e.writeEntropy(Buffer.from(n))};"undefined"!=typeof document&&(document.addEventListener("click",t),document.addEventListener("dblclick",t),document.addEventListener("mousemove",t),document.addEventListener("keyup",t),document.addEventListener("keydown",t),document.addEventListener("keypress",t),document.addEventListener("touchmove",t),document.addEventListener("touchstart",t),document.addEventListener("touchend",t));var n=function(){var t=new Buffer(8),r=(new Date).getTime();t.writeInt32LE(4294967295&e.r,0),t.writeInt32BE(4294967295&r,4),e.writeEntropy(t);var i=e.intervalGenerator.randomNumber(1e3);setTimeout(n,i)};n()},e}();n.EventsAndIntervalEntropyGenerator=a;var u=function(){function e(){var e=this;this.rng=new t.Rng,this.randomService=new r(this.rng),this.intervalGenerator=new o(this.rng),this.randomBytesGenerator=new i(this.rng),this.entropyGenerator=new a(this.intervalGenerator,function(t){e.rng.feed(t)})}return e.prototype.init=function(){this.entropyGenerator.init()},e.prototype.bindIntervalEntropyGenerator=function(e){return s.bind(this.randomBytesGenerator,this.intervalGenerator,e)},e.prototype.increaseCounter=function(){this.entropyGenerator.r++},e}();n.EntropyManager=u}).call(this,e("buffer").Buffer)},{"./Rng":228,buffer:590}],225:[function(e,t,n){"use strict";n.__esModule=!0},{}],226:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("../crypto/R"),r=function(){function e(){}return e.serializeData=function(e){return JSON.stringify({algorithm:e.algorithm,hash:e.hash,length:e.length,rounds:e.rounds,salt:e.salt.toString("base64"),version:e.version})},e.deserializeData=function(e){var t=JSON.parse(e);return t.salt=new Buffer(t.salt,"base64"),t},e.generatePbkdf2=function(n,r){var i;return t.R(function(){return i={algorithm:"PBKDF2",hash:"SHA512",length:16,rounds:4e3+Math.floor(1e3*Math.random()),salt:n.randomBytes(16),version:1},e.perform(n,r,i)}).then(function(e){return{mixed:e,data:i}})},e.perform=function(e,n,r){return t.R(function(){if("PBKDF2"==r.algorithm){if("SHA512"!=r.hash)throw new Error("Not supported hash algorithm '"+r.hash+"'");if(1!=r.version)throw new Error("Not supported version '"+r.version+"'");if(16!=r.salt.length||16!=r.length)throw new Error("Invalid parameters");return e.pbkdf2(n,r.salt,r.rounds,r.length,r.hash.toLowerCase())}throw new Error("Not supported algorithm '"+r.algorithm+"'")})},e}();n.PasswordMixerBase=r;var i=function(){function e(e){this.crypto=e}return e.prototype.serializeData=function(e){return r.serializeData(e)},e.prototype.deserializeData=function(e){return r.deserializeData(e)},e.prototype.generatePbkdf2=function(e){return r.generatePbkdf2(this.crypto,e).async()},e.prototype.perform=function(e,t){return r.perform(this.crypto,e,t).async()},e}();n.PasswordMixer=i}).call(this,e("buffer").Buffer)},{"../crypto/R":227,buffer:590}],227:[function(e,t,n){"use strict";function r(e){return s.createResult(null).then(e)}function i(e){return s.createResult(e)}n.__esModule=!0;var o=e("q"),s=function(){function e(){}return e.createPromise=function(t){var n=new e;return n.promiseMode=!0,n.promise=t,n.toResolve=[],n.toFail=[],n.promise.then(n.resolve.bind(n)).fail(n.reject.bind(n)),n},e.createResult=function(t){var n=new e;return n.success=!0,n.value=t,n},e.createError=function(t){var n=new e;return n.success=!1,n.error=t,n},e.prototype.sync=function(){if(this.promiseMode)throw new Error("Not supported sync mode");if(this.success)return this.value;throw this.error},e.prototype.async=function(){if(this.promiseMode&&!this.resolved){var e=o.defer();return this.toResolve.push(e),e.promise}return this.success?o(this.value):o.reject(this.error)},e.prototype.resolve=function(e){var t=this;this.resolved||(this.success=!0,this.value=e,this.resolved=!0,this.toResolve.forEach(function(e){e.resolve(t.value)}),delete this.promise,delete this.toResolve,delete this.toFail)},e.prototype.reject=function(e){var t=this;this.resolved||(this.success=!1,this.error=e,this.resolved=!0,this.toResolve.forEach(function(e){e.reject(t.error)}),this.toFail.forEach(function(e){try{e(t.error)}catch(n){console.log("Fail callback fails",t.error,n)}}),delete this.promise,delete this.toResolve,delete this.toFail)},e.prototype.then=function(t){if(this.promiseMode&&!this.resolved){var n=o.defer();return this.toResolve.push(n),e.createPromise(n.promise.then(t))}if(!this.success)return e.createError(this.error);try{var r=t(this.value);return r instanceof e&&!r.promiseMode?r.success?e.createResult(r.value):e.createError(r.error):null!=r&&"function"==typeof r.then?e.createPromise(r):e.createResult(r)}catch(i){return e.createError(i)}},e.prototype.fail=function(e){if(this.promiseMode&&!this.resolved)return void this.toFail.push(e);try{e(this.error)}catch(t){console.log("Fail callback fails",this.error,t)}},e}();n.ValueResult=s,n.R=r,n.RV=i},{q:327}],228:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("seedrandom"),BN=e("bn.js"),r=function(){function e(){this.rng=new t}return e.prototype.feed=function(e){this.rng=new t(e,{entropy:!0})},e.prototype.int32=function(){return this.rng.int32()},e.prototype["double"]=function(){return this.rng["double"]()},e.prototype.bytes=function(e){for(var t=new Buffer(e),n=0;e>=4;)t.writeInt32LE(this.int32(),n),n+=4,e-=4;for(;e>0;)t.writeUInt8(255&this.int32(),n),n+=1,e-=1;return t},e.prototype.bits=function(e){var t=(e+7)/8|0,n=this.bytes(t);return 7&e&&(n[0]>>=8-(7&e)),n},e.prototype.bn=function(e){var t=BN.isBN(e)?e:new BN(e),n=t.byteLength(),r=this.bytes(n),i=new BN(r);return i.words[i.length-1]%=t.words[t.length-1],i},e}();n.Rng=r}).call(this,e("buffer").Buffer)},{"bn.js":26,buffer:590,seedrandom:331}],229:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./webworker/Requester"),o=e("q"),s=e("./CryptoSubtle"),a=e("./sync"),u=e("./CryptoPrivmx"),c=e("./ServiceHelper"),f=e("../openssl/openssl-handler"),l=e("../ecc/ecc-crypto"),h=e("../rsa/rsa-subtle"),p=e("../rsa/rsa-crypto"),d=e("../rsa/rsa-browser"),g=e("../utils/ObjectEncryptor"),y=e("./PasswordMixer"),m=e("./Entropy"),v=new Function("try {return this===global;}catch(e){ return false;}"),b=function(){function e(){}return e.prototype.hmac=function(e,t,n){return this.execute("hmac",arguments)},e.prototype.hmacSha1=function(e,t){return this.execute("hmacSha1",arguments)},e.prototype.hmacSha256=function(e,t){return this.execute("hmacSha256",arguments)},e.prototype.hmacSha512=function(e,t){return this.execute("hmacSha512",arguments)},e.prototype.hash=function(e,t){return this.execute("hash",arguments)},e.prototype.sha1=function(e){return this.execute("sha1",arguments)},e.prototype.sha256=function(e){return this.execute("sha256",arguments)},e.prototype.sha512=function(e){return this.execute("sha512",arguments)},e.prototype.ripemd160=function(e){return this.execute("ripemd160",arguments)},e.prototype.hash160=function(e){return this.execute("hash160",arguments)},e.prototype.kdf=function(e,t,n,r){return this.execute("kdf",arguments)},e.prototype.getKEM=function(e,t,n,r){return this.execute("getKEM",arguments)},e.prototype.aes256CbcPkcs7Encrypt=function(e,t,n){return this.execute("aes256CbcPkcs7Encrypt",arguments)},e.prototype.aes256CbcPkcs7Decrypt=function(e,t,n){return this.execute("aes256CbcPkcs7Decrypt",arguments)},e.prototype.aes256CbcNoPadEncrypt=function(e,t,n){return this.execute("aes256CbcNoPadEncrypt",arguments)},e.prototype.aes256CbcNoPadDecrypt=function(e,t,n){return this.execute("aes256CbcNoPadDecrypt",arguments)},e.prototype.aes256EcbEncrypt=function(e,t){return this.execute("aes256EcbEncrypt",arguments)},e.prototype.aes256EcbDecrypt=function(e,t){return this.execute("aes256EcbDecrypt",arguments)},e.prototype.xteaEcbPkcs7Encrypt=function(e,t){return this.execute("xteaEcbPkcs7Encrypt",arguments)},e.prototype.xteaEcbPkcs7Decrypt=function(e,t){return this.execute("xteaEcbPkcs7Decrypt",arguments)},e.prototype.aes256CbcHmac256Encrypt=function(e,t,n,r){return this.execute("aes256CbcHmac256Encrypt",arguments)},e.prototype.aes256CbcHmac256Decrypt=function(e,t,n){return this.execute("aes256CbcHmac256Decrypt",arguments)},e.prototype.prf_tls12=function(e,t,n){return this.execute("prf_tls12",arguments)},e.prototype.hkdfSha256=function(e,t,n){return this.execute("hkdfSha256",arguments)},e.prototype.generateIv=function(e,t){return this.execute("generateIv",arguments)},e.prototype.reductKey=function(e){return this.execute("reductKey",arguments)},e.prototype.xteaEcbPkcs7Key32Encrypt=function(e,t){return this.execute("xteaEcbPkcs7Key32Encrypt",arguments)},e.prototype.xteaEcbPkcs7Key32Decrypt=function(e,t){return this.execute("xteaEcbPkcs7Key32Decrypt",arguments)},e.prototype.ctAes256CbcPkcs7NoIv=function(e,t,n){return this.execute("ctAes256CbcPkcs7NoIv",arguments)},e.prototype.ctAes256CbcPkcs7WithIv=function(e,t,n){return this.execute("ctAes256CbcPkcs7WithIv",arguments)},e.prototype.ctAes256CbcPkcs7WithRandomIv=function(e,t){return this.execute("ctAes256CbcPkcs7WithRandomIv",arguments)},e.prototype.ctXteaEcbPkcs7=function(e,t){return this.execute("ctXteaEcbPkcs7",arguments)},e.prototype.ctXteaEcbPkcs7Key32=function(e,t){return this.execute("ctXteaEcbPkcs7Key32",arguments)},e.prototype.ctAes256CbcPkcs7WithIvAndHmacSha256=function(e,t,n,r){return this.execute("ctAes256CbcPkcs7WithIvAndHmacSha256",arguments)},e.prototype.ctDecrypt=function(e,t,n,r,i){return this.execute("ctDecrypt",arguments)},e.prototype.pbkdf2=function(e,t,n,r,i){return this.execute("pbkdf2",arguments)},e.prototype.eccExtFromSeed=function(e){return this.execute("eccExtFromSeed",arguments)},e.prototype.eccExtRandom=function(){return this.execute("eccExtRandom",arguments)},e.prototype.eccPrivRandom=function(){return this.execute("eccPrivRandom",arguments)},e.prototype.eccPubToBase58Address=function(e,t){return this.execute("eccPubToBase58Address",arguments)},e.prototype.signToCompactSignature=function(e,t){return this.execute("signToCompactSignature",arguments)},e.prototype.signToCompactSignatureWithHash=function(e,t){return this.execute("signToCompactSignatureWithHash",arguments)},e.prototype.getSharedKey=function(e,t){return this.execute("getSharedKey",arguments)},e.prototype.eciesEncrypt=function(e,t,n){return this.execute("eciesEncrypt",arguments)},e.prototype.eciesDecrypt=function(e,t,n){return this.execute("eciesDecrypt",arguments)},e.prototype.eccEciesEncrypt=function(e,t,n){return this.execute("eccEciesEncrypt",arguments)},e.prototype.eccEciesDecrypt=function(e,t,n){return this.execute("eccEciesDecrypt",arguments)},e.prototype.verifyCompactSignature=function(e,t,n){return this.execute("verifyCompactSignature",arguments)},e.prototype.verifyCompactSignatureWithHash=function(e,t,n){return this.execute("verifyCompactSignatureWithHash",arguments)},e.prototype.deriveHardened=function(e,t){return this.execute("deriveHardened",arguments)},e.prototype.eccGenerateKey=function(e){return this.execute("eccGenerateKey",arguments)},e.prototype.ecdsaSign=function(e,t){return this.execute("ecdsaSign",arguments)},e.prototype.ecdsaVerify=function(e,t,n){return this.execute("ecdsaVerify",arguments)},e.prototype.bip39Generate=function(e,t){return this.execute("bip39Generate",arguments)},e.prototype.bip39FromEntropy=function(e,t){return this.execute("bip39FromEntropy",arguments)},e.prototype.bip39FromMnemonic=function(e,t){return this.execute("bip39FromMnemonic",arguments)},e.prototype.bip39GetExtKey=function(e,t){return this.execute("bip39GetExtKey",arguments)},e.prototype.srpRegister=function(e,t,n,r){return this.execute("srpRegister",arguments)},e.prototype.srpRegisterS=function(e,t,n,r,i){return this.execute("srpRegisterS",arguments)},e.prototype.srpLoginStep1=function(e,t,n,r,i,o,s){return this.execute("srpLoginStep1",arguments)},e.prototype.srpLoginStep1A=function(e,t,n,r,i,o,s,a){return this.execute("srpLoginStep1A",arguments)},e.prototype.srpLoginStep2=function(e,t){return this.execute("srpLoginStep2",arguments)},e.prototype.rsaGenerateKey=function(e){return this.execute("rsaGenerateKey",arguments)},e.prototype.rsaOaepEncrypt=function(e,t){return this.execute("rsaOaepEncrypt",arguments)},e.prototype.rsaOaepDecrypt=function(e,t){return this.execute("rsaOaepDecrypt",arguments)},e.prototype.rsaSign=function(e,t){return this.execute("rsaSign",arguments)},e.prototype.rsaVerify=function(e,t,n){return this.execute("rsaVerify",arguments)},e.prototype.encryptPrivateKey=function(e,t){return this.execute("encryptPrivateKey",arguments)},e.prototype.decryptPrivateKey=function(e,t){return this.execute("decryptPrivateKey",arguments)},e.prototype.extractPublicKey=function(e){return this.execute("extractPublicKey",arguments)},e.prototype.privmxEncrypt=function(e,t,n,r){return this.execute("privmxEncrypt",arguments)},e.prototype.privmxDecrypt=function(e,t,n,r){return this.execute("privmxDecrypt",arguments)},e.prototype.privmxGetBlockSize=function(e,t){return this.executeSync("privmxGetBlockSize",arguments)},e.prototype.privmxHasSignature=function(e){return this.executeSync("privmxHasSignature",arguments)},e.prototype.privmxSetErrorOnMissingSignature=function(e){return this.executeSync("privmxSetErrorOnMissingSignature",arguments)},e.prototype.privmxOptAesWithDettachedIv=function(){return this.executeSync("privmxOptAesWithDettachedIv",arguments)},e.prototype.privmxOptAesWithAttachedIv=function(){return this.executeSync("privmxOptAesWithAttachedIv",arguments)},e.prototype.privmxOptAesWithSignature=function(){return this.executeSync("privmxOptAesWithSignature",arguments)},e.prototype.privmxOptXtea=function(){return this.executeSync("privmxOptXtea",arguments)},e.prototype.privmxOptSignedCipher=function(){return this.executeSync("privmxOptSignedCipher",arguments)},e.prototype.randomInt32=function(){return this.executeSync("randomInt32",arguments)},e.prototype.randomDouble=function(){return this.executeSync("randomDouble",arguments)},e.prototype.randomBytes=function(e){return this.executeSync("randomBytes",arguments)},e.prototype.randomBits=function(e){return this.executeSync("randomBits",arguments)},e.prototype.randomBN=function(e){return this.executeSync("randomBN",arguments)},e}();n.Binder=b;var w=function(){function e(){this.cryptoSync=new a.CryptoSyncRandom}return e.prototype.execute=function(e,t){var n=this;return e in this.cryptoSync&&o(null).then(function(){return n.cryptoSync[e].apply(n.cryptoSync,t)})},e}();n.CryptoSyncAsPromiseExecute=w;var E=function(e){function t(){var t=e.call(this)||this;return t.handlers=[],t.initialized=!1,t.entropyManager=new m.EntropyManager,t}return r(t,e),t.prototype.init=function(e){var t=this;if(!this.initialized){if(this.entropyManager.init(),this.handlers.push(this.entropyManager.randomService),this.handlers.push(new c.ServiceHelper(this)),this.handlers.push(new f.OpenSSLHandler(this)),this.handlers.push(new u.CryptoPrivmx(this)),this.handlers.push(new s.CryptoSubtle),this.handlers.push(new h.RsaSubtle(this)),e){var n=new i.Requester(e);this.entropyManager.bindIntervalEntropyGenerator(function(e){n.execute("setEntropy",[e])}),this.handlers.push(n)}this.handlers.push(new c.ServiceHelper2(this)),this.handlers.push(new w),this.handlers.push(new l.EccCrypto(this)),v()?this.handlers.push(new p.RsaCrypto(this)):this.handlers.push(new d.RsaBrowser(this)),this.handlers.forEach(function(e){"function"==typeof e.init&&e.init(t)}),this.initialized=!0}},t.prototype.executeSync=function(e,t){this.entropyManager.increaseCounter();for(var n=0;n<this.handlers.length;++n){var r=this.handlers[n];if(r[e])return r[e].apply(r,t)}throw new Error("Unhandled method "+e)},t.prototype.execute=function(e,t){var n=this;this.entropyManager.increaseCounter(),this.init(),Array.isArray(t)||(t=Array.prototype.slice.call(t));for(var r=function(r){var s=i.handlers[r];if(s._state=s._state||{},s.isSupported){var a=s._state.isSupported;if(void 0===a&&(a=s.isSupported.apply(s),s._state.isSupported=a),a===!1)return"continue";if(a!==!0)return{value:a.then(function(r){return s._state.isSupported=r,n.execute(e,t)})}}if(!s[e]){if(!s.execute)return"continue";var u=s.execute(e,t);return u===!1?"continue":o.isPromiseAlike(u)?{value:u}:{value:o.resolve(u)}}if(!s[e+"_check"])return{value:s[e].apply(s,t)};var c=s[e+"_check"];"string"!=typeof c&&(c=e);var f=c,l="";s[c+"_vary"]&&(l=s[c+"_vary"].apply(s,t),f+=l);var h=s._state[f];return h===!1?"continue":h===!0?{value:s[e].apply(s,t)}:(void 0===h&&(h=s[c+"_check"].apply(s,[l]).then(function(e){s._state[f]=e}),s._state[f]=h),{value:h.then(function(){return n.execute(e,t)})})},i=this,s=0;s<this.handlers.length;++s){var a=r(s);if("object"==typeof a)return a.value}return o().then(function(){throw new Error("unhandled method "+e)})},t.prototype.getObjectEncryptor=function(e,t,n){return new g.ObjectEncryptor(this,e,t,n)},t.prototype.getPasswordMixer=function(){return new y.PasswordMixer(this)},t}(b);n.Service=E},{"../ecc/ecc-crypto":245,"../openssl/openssl-handler":252,"../rsa/rsa-browser":257,"../rsa/rsa-crypto":258,"../rsa/rsa-subtle":259,"../utils/ObjectEncryptor":264,"./CryptoPrivmx":222,"./CryptoSubtle":223,"./Entropy":224,"./PasswordMixer":226,"./ServiceHelper":230,"./sync":235,"./webworker/Requester":237,q:327}],230:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./CryptoBase"),i=function(){function e(e){this.service=e}return e.prototype.eccExtRandom=function(){return r.CryptoBase.eccExtRandom(this.service).async()},e.prototype.eccPrivRandom=function(){return r.CryptoBase.eccPrivRandom(this.service).async()},e.prototype.ctAes256CbcPkcs7WithRandomIv=function(e,t){return r.CryptoBase.ctAes256CbcPkcs7WithRandomIv(this.service,e,t).async()},e.prototype.bip39Generate=function(e,t){return r.CryptoBase.bip39Generate(this.service,e,t).async()},e.prototype.srpRegister=function(e,t,n,i){return r.CryptoBase.srpRegister(this.service,e,t,n,i).async()},e.prototype.srpLoginStep1=function(e,t,n,i,o,s,a){return r.CryptoBase.srpLoginStep1(this.service,e,t,n,i,o,s,a).async()},e.prototype.ctDecrypt=function(e,t,n,i,o){return r.CryptoBase.ctDecrypt(this.service,e,t,n,i,o).async()},e}();n.ServiceHelper=i;var o=function(){function e(e){this.service=e}return e.prototype.hash160=function(e){return r.CryptoBase.hash160(this.service,e).async()},e.prototype.eccExtFromSeed=function(e){return r.CryptoBase.eccExtFromSeed(this.service,e).async()},e.prototype.eccPubToBase58Address=function(e,t){return r.CryptoBase.eccPubToBase58Address(this.service,e,t).async()},e.prototype.signToCompactSignatureWithHash=function(e,t){return r.CryptoBase.signToCompactSignatureWithHash(this.service,e,t).async()},e.prototype.getSharedKey=function(e,t){return r.CryptoBase.getSharedKey(this.service,e,t).async()},e.prototype.verifyCompactSignatureWithHash=function(e,t,n){return r.CryptoBase.verifyCompactSignatureWithHash(this.service,e,t,n).async()},e.prototype.eciesEncrypt=function(e,t,n){return r.CryptoBase.eciesEncrypt(this.service,e,t,n).async()},e.prototype.eciesDecrypt=function(e,t,n){return r.CryptoBase.eciesDecrypt(this.service,e,t,n).async()},e.prototype.deriveHardened=function(e,t){return r.CryptoBase.deriveHardened(this.service,e,t).async()},e.prototype.bip39FromEntropy=function(e,t){return r.CryptoBase.bip39FromEntropy(this.service,e,t).async()},e.prototype.bip39FromMnemonic=function(e,t){return r.CryptoBase.bip39FromMnemonic(this.service,e,t).async()},e.prototype.bip39GetExtKey=function(e,t){return r.CryptoBase.bip39GetExtKey(this.service,e,t).async()},e.prototype.srpRegisterS=function(e,t,n,i,o){return r.CryptoBase.srpRegisterS(this.service,e,t,n,i,o).async()},e.prototype.srpLoginStep1A=function(e,t,n,i,o,s,a,u){return r.CryptoBase.srpLoginStep1A(this.service,e,t,n,i,o,s,a,u).async()},e}();n.ServiceHelper2=o},{"./CryptoBase":221}],231:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../CryptoBase"),i=function(){function e(){}return e.prototype.hmacSha1=function(e,t){return r.CryptoBase.hmacSha1(this,e,t).async()},e.prototype.hmacSha256=function(e,t){return r.CryptoBase.hmacSha256(this,e,t).async()},e.prototype.hmacSha512=function(e,t){return r.CryptoBase.hmacSha512(this,e,t).async()},e.prototype.sha1=function(e){return r.CryptoBase.sha1(this,e).async()},e.prototype.sha256=function(e){return r.CryptoBase.sha256(this,e).async()},e.prototype.sha512=function(e){return r.CryptoBase.sha512(this,e).async()},e.prototype.ripemd160=function(e){return r.CryptoBase.ripemd160(this,e).async()},e.prototype.hash160=function(e){return r.CryptoBase.hash160(this,e).async()},e.prototype.kdf=function(e,t,n,i){return r.CryptoBase.kdf(this,e,t,n,i).async()},e.prototype.getKEM=function(e,t,n,i){return r.CryptoBase.getKEM(this,e,t,n,i).async()},e.prototype.aes256CbcHmac256Encrypt=function(e,t,n,i){return r.CryptoBase.aes256CbcHmac256Encrypt(this,e,t,n,i).async()},e.prototype.aes256CbcHmac256Decrypt=function(e,t,n){return r.CryptoBase.aes256CbcHmac256Decrypt(this,e,t,n).async()},e.prototype.prf_tls12=function(e,t,n){return r.CryptoBase.prf_tls12(this,e,t,n).async()},e.prototype.hkdfSha256=function(e,t,n,i){return r.CryptoBase.hkdfSha256(this,e,t,n,i).async()},e.prototype.generateIv=function(e,t){return r.CryptoBase.generateIv(this,e,t).async()},e.prototype.reductKey=function(e){return r.CryptoBase.reductKey(this,e).async()},e.prototype.xteaEcbPkcs7Key32Encrypt=function(e,t){return r.CryptoBase.xteaEcbPkcs7Key32Encrypt(this,e,t).async()},e.prototype.xteaEcbPkcs7Key32Decrypt=function(e,t){return r.CryptoBase.xteaEcbPkcs7Key32Decrypt(this,e,t).async()},e.prototype.ctAes256CbcPkcs7NoIv=function(e,t,n){return r.CryptoBase.ctAes256CbcPkcs7NoIv(this,e,t,n).async()},e.prototype.ctAes256CbcPkcs7WithIv=function(e,t,n){return r.CryptoBase.ctAes256CbcPkcs7WithIv(this,e,t,n).async()},e.prototype.ctXteaEcbPkcs7=function(e,t){return r.CryptoBase.ctXteaEcbPkcs7(this,e,t).async()},e.prototype.ctXteaEcbPkcs7Key32=function(e,t){return r.CryptoBase.ctXteaEcbPkcs7Key32(this,e,t).async()},e.prototype.ctAes256CbcPkcs7WithIvAndHmacSha256=function(e,t,n,i){return r.CryptoBase.ctAes256CbcPkcs7WithIvAndHmacSha256(this,e,t,n,i).async()},e.prototype.ctDecrypt=function(e,t,n,i,o){return r.CryptoBase.ctDecrypt(this,e,t,n,i,o).async()},e.prototype.eccExtFromSeed=function(e){return r.CryptoBase.eccExtFromSeed(this,e).async()},e.prototype.eccPubToBase58Address=function(e,t){return r.CryptoBase.eccPubToBase58Address(this,e,t).async()},e.prototype.signToCompactSignature=function(e,t){return r.CryptoBase.signToCompactSignature(e,t).async()},e.prototype.signToCompactSignatureWithHash=function(e,t){return r.CryptoBase.signToCompactSignatureWithHash(this,e,t).async()},e.prototype.getSharedKey=function(e,t){return r.CryptoBase.getSharedKey(this,e,t).async()},e.prototype.verifyCompactSignature=function(e,t,n){return r.CryptoBase.verifyCompactSignature(e,t,n).async()},e.prototype.verifyCompactSignatureWithHash=function(e,t,n){return r.CryptoBase.verifyCompactSignatureWithHash(this,e,t,n).async()},e.prototype.eciesEncrypt=function(e,t,n){return r.CryptoBase.eciesEncrypt(this,e,t,n).async()},e.prototype.eciesDecrypt=function(e,t,n){return r.CryptoBase.eciesDecrypt(this,e,t,n).async()},e.prototype.deriveHardened=function(e,t){return r.CryptoBase.deriveHardened(this,e,t).async()},e.prototype.bip39FromEntropy=function(e,t){return r.CryptoBase.bip39FromEntropy(this,e,t).async()},e.prototype.bip39FromMnemonic=function(e,t){return r.CryptoBase.bip39FromMnemonic(this,e,t).async()},e.prototype.bip39GetExtKey=function(e,t){return r.CryptoBase.bip39GetExtKey(this,e,t).async()},e.prototype.srpRegisterS=function(e,t,n,i,o){return r.CryptoBase.srpRegisterS(this,e,t,n,i,o).async()},e.prototype.srpLoginStep1A=function(e,t,n,i,o,s,a,u){return r.CryptoBase.srpLoginStep1A(this,e,t,n,i,o,s,a,u).async()},e.prototype.srpLoginStep2=function(e,t){return r.CryptoBase.srpLoginStep2(e,t).async()},e.prototype.eccExtRandom=function(){return r.CryptoBase.eccExtRandom(this).async()},e.prototype.eccPrivRandom=function(){return r.CryptoBase.eccPrivRandom(this).async()},e.prototype.ctAes256CbcPkcs7WithRandomIv=function(e,t){return r.CryptoBase.ctAes256CbcPkcs7WithRandomIv(this,e,t).async()},e.prototype.bip39Generate=function(e,t){return r.CryptoBase.bip39Generate(this,e,t).async()},e.prototype.srpRegister=function(e,t,n,i){return r.CryptoBase.srpRegister(this,e,t,n,i).async()},e.prototype.srpLoginStep1=function(e,t,n,i,o,s,a){return r.CryptoBase.srpLoginStep1(this,e,t,n,i,o,s,a).async()},e}();n.CryptoAsyncAbstract=i},{"../CryptoBase":221}],232:[function(e,t,n){"use strict";var r=e("./CryptoAsync");t.exports=r},{"./CryptoAsync":231}],233:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./webworker");n.webworker=r;var i=e("./async");n.async=i;var o=e("./sync");n.sync=o;var s=e("./CipherType");n.CipherType=s.CipherType;var a=e("./CryptoBase");n.CryptoBase=a.CryptoBase;var u=e("./CryptoPrivmx");n.CryptoPrivmxBase=u.CryptoPrivmxBase,n.CryptoPrivmx=u.CryptoPrivmx;var c=e("./CryptoSubtle");n.CryptoSubtle=c.CryptoSubtle;var f=e("./Interfaces");n.Interfaces=f;var l=e("./PasswordMixer");n.PasswordMixer=l.PasswordMixer;var h=e("./R");n.R=h;var p=e("./Rng");n.Rng=p.Rng;var d=e("./Service");n.Service=d.Service;var g=e("./ServiceHelper");n.ServiceHelper=g.ServiceHelper,n.ServiceHelper2=g.ServiceHelper2},{"./CipherType":220,"./CryptoBase":221,"./CryptoPrivmx":222,"./CryptoSubtle":223,"./Interfaces":225,"./PasswordMixer":226,"./R":227,"./Rng":228,"./Service":229,"./ServiceHelper":230,"./async":232,"./sync":235,"./webworker":239}],234:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var r=e("crypto"),i=e("xtea"),o=e("../../browserbuffer/BrowserBuffer"),s=e("privmx-exception"),a=s.IllegalArgumentException,u=e("randombytes"),c=e("../CryptoBase"),f=function(){function e(){}return e.hmac=function(e,t,n){return r.createHmac(e,t).update(n).digest()},e.hash=function(e,t){return r.createHash(e).update(t).digest()},e.aes256CbcPkcs7Encrypt=function(e,t,n){if(!o.BrowserBuffer.isBuffer(e)||0==e.length)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||32!=t.length)throw new a("key",t);if(!o.BrowserBuffer.isBuffer(n)||16!=n.length)throw new a("iv",n);var i=r.createCipheriv("aes-256-cbc",t,n);return Buffer.concat([i.update(e),i["final"]()])},e.aes256CbcNoPadEncrypt=function(e,t,n){if(!o.BrowserBuffer.isBuffer(e)||0==e.length||e.length%16!=0)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||32!=t.length)throw new a("key",t);if(!o.BrowserBuffer.isBuffer(n)||16!=n.length)throw new a("iv",n);var i=r.createCipheriv("aes-256-cbc",t,n);return i.setAutoPadding(!1),Buffer.concat([i.update(e),i["final"]()])},e.aes256CbcPkcs7Decrypt=function(e,t,n){if(!o.BrowserBuffer.isBuffer(e)||0==e.length)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||32!=t.length)throw new a("key",t);if(!o.BrowserBuffer.isBuffer(n)||16!=n.length)throw new a("iv",n);var i=r.createDecipheriv("aes-256-cbc",t,n);
return Buffer.concat([i.update(e),i["final"]()])},e.aes256CbcNoPadDecrypt=function(e,t,n){if(!o.BrowserBuffer.isBuffer(e)||0==e.length||e.length%16!=0)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||32!=t.length)throw new a("key",t);if(!o.BrowserBuffer.isBuffer(n)||16!=n.length)throw new a("iv",n);var i=r.createDecipheriv("aes-256-cbc",t,n);return i.setAutoPadding(!1),Buffer.concat([i.update(e),i["final"]()])},e.xteaEcbPkcs7Encrypt=function(e,t){if(!o.BrowserBuffer.isBuffer(e)||0==e.length)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||16!=t.length)throw new a("key",t);return i.encrypt(e,t,"ecb")},e.xteaEcbPkcs7Decrypt=function(e,t){if(!o.BrowserBuffer.isBuffer(e)||0==e.length)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||16!=t.length)throw new a("key",t);return i.decrypt(e,t,"ecb")},e.aes256EcbEncrypt=function(e,t){if(!o.BrowserBuffer.isBuffer(e)||0==e.length||e.length%16!=0)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||32!=t.length&&16!=t.length)throw new a("key",t);var n=r.createCipheriv("aes-256-ecb",t,"");return n.setAutoPadding(!1),Buffer.concat([n.update(e),n["final"]()])},e.aes256EcbDecrypt=function(e,t){if(!o.BrowserBuffer.isBuffer(e)||0==e.length||e.length%16!=0)throw new a("data",e);if(!o.BrowserBuffer.isBuffer(t)||32!=t.length)throw new a("key",t);var n=r.createDecipheriv("aes-256-ecb",t,"");return n.setAutoPadding(!1),Buffer.concat([n.update(e),n["final"]()])},e.pbkdf2=function(e,t,n,i,o){return r.pbkdf2Sync(e,t,n,i,o)},e}();n.CryptoSyncBase=f;var l=function(){function e(){}return e.prototype.hmacSha1=function(e,t){return c.CryptoBase.hmacSha1(this,e,t).sync()},e.prototype.hmacSha256=function(e,t){return c.CryptoBase.hmacSha256(this,e,t).sync()},e.prototype.hmacSha512=function(e,t){return c.CryptoBase.hmacSha512(this,e,t).sync()},e.prototype.sha1=function(e){return c.CryptoBase.sha1(this,e).sync()},e.prototype.sha256=function(e){return c.CryptoBase.sha256(this,e).sync()},e.prototype.sha512=function(e){return c.CryptoBase.sha512(this,e).sync()},e.prototype.ripemd160=function(e){return c.CryptoBase.ripemd160(this,e).sync()},e.prototype.hash160=function(e){return c.CryptoBase.hash160(this,e).sync()},e.prototype.kdf=function(e,t,n,r){return c.CryptoBase.kdf(this,e,t,n,r).sync()},e.prototype.getKEM=function(e,t,n,r){return c.CryptoBase.getKEM(this,e,t,n,r).sync()},e.prototype.aes256CbcHmac256Encrypt=function(e,t,n,r){return c.CryptoBase.aes256CbcHmac256Encrypt(this,e,t,n,r).sync()},e.prototype.aes256CbcHmac256Decrypt=function(e,t,n){return c.CryptoBase.aes256CbcHmac256Decrypt(this,e,t,n).sync()},e.prototype.prf_tls12=function(e,t,n){return c.CryptoBase.prf_tls12(this,e,t,n).sync()},e.prototype.hkdfSha256=function(e,t,n,r){return c.CryptoBase.hkdfSha256(this,e,t,n,r).sync()},e.prototype.generateIv=function(e,t){return c.CryptoBase.generateIv(this,e,t).sync()},e.prototype.reductKey=function(e){return c.CryptoBase.reductKey(this,e).sync()},e.prototype.xteaEcbPkcs7Key32Encrypt=function(e,t){return c.CryptoBase.xteaEcbPkcs7Key32Encrypt(this,e,t).sync()},e.prototype.xteaEcbPkcs7Key32Decrypt=function(e,t){return c.CryptoBase.xteaEcbPkcs7Key32Decrypt(this,e,t).sync()},e.prototype.ctAes256CbcPkcs7NoIv=function(e,t,n){return c.CryptoBase.ctAes256CbcPkcs7NoIv(this,e,t,n).sync()},e.prototype.ctAes256CbcPkcs7WithIv=function(e,t,n){return c.CryptoBase.ctAes256CbcPkcs7WithIv(this,e,t,n).sync()},e.prototype.ctXteaEcbPkcs7=function(e,t){return c.CryptoBase.ctXteaEcbPkcs7(this,e,t).sync()},e.prototype.ctXteaEcbPkcs7Key32=function(e,t){return c.CryptoBase.ctXteaEcbPkcs7Key32(this,e,t).sync()},e.prototype.ctAes256CbcPkcs7WithIvAndHmacSha256=function(e,t,n,r){return c.CryptoBase.ctAes256CbcPkcs7WithIvAndHmacSha256(this,e,t,n,r).sync()},e.prototype.ctDecrypt=function(e,t,n,r,i){return c.CryptoBase.ctDecrypt(this,e,t,n,r,i).sync()},e.prototype.eccExtFromSeed=function(e){return c.CryptoBase.eccExtFromSeed(this,e).sync()},e.prototype.eccPubToBase58Address=function(e,t){return c.CryptoBase.eccPubToBase58Address(this,e,t).sync()},e.prototype.signToCompactSignature=function(e,t){return c.CryptoBase.signToCompactSignature(e,t).sync()},e.prototype.signToCompactSignatureWithHash=function(e,t){return c.CryptoBase.signToCompactSignatureWithHash(this,e,t).sync()},e.prototype.getSharedKey=function(e,t){return c.CryptoBase.getSharedKey(this,e,t).sync()},e.prototype.verifyCompactSignature=function(e,t,n){return c.CryptoBase.verifyCompactSignature(e,t,n).sync()},e.prototype.verifyCompactSignatureWithHash=function(e,t,n){return c.CryptoBase.verifyCompactSignatureWithHash(this,e,t,n).sync()},e.prototype.eciesEncrypt=function(e,t,n){return c.CryptoBase.eciesEncrypt(this,e,t,n).sync()},e.prototype.eciesDecrypt=function(e,t,n){return c.CryptoBase.eciesDecrypt(this,e,t,n).sync()},e.prototype.deriveHardened=function(e,t){return c.CryptoBase.deriveHardened(this,e,t).sync()},e.prototype.bip39FromEntropy=function(e,t){return c.CryptoBase.bip39FromEntropy(this,e,t).sync()},e.prototype.bip39FromMnemonic=function(e,t){return c.CryptoBase.bip39FromMnemonic(this,e,t).sync()},e.prototype.bip39GetExtKey=function(e,t){return c.CryptoBase.bip39GetExtKey(this,e,t).sync()},e.prototype.srpRegisterS=function(e,t,n,r,i){return c.CryptoBase.srpRegisterS(this,e,t,n,r,i).sync()},e.prototype.srpLoginStep1A=function(e,t,n,r,i,o,s,a){return c.CryptoBase.srpLoginStep1A(this,e,t,n,r,i,o,s,a).sync()},e.prototype.srpLoginStep2=function(e,t){return c.CryptoBase.srpLoginStep2(e,t).sync()},e}();n.CryptoSyncAbstract=l;var h=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.eccExtRandom=function(){return c.CryptoBase.eccExtRandom(this).sync()},n.prototype.eccPrivRandom=function(){return c.CryptoBase.eccPrivRandom(this).sync()},n.prototype.ctAes256CbcPkcs7WithRandomIv=function(e,t){return c.CryptoBase.ctAes256CbcPkcs7WithRandomIv(this,e,t).sync()},n.prototype.bip39Generate=function(e,t){return c.CryptoBase.bip39Generate(this,e,t).sync()},n.prototype.srpRegister=function(e,t,n,r){return c.CryptoBase.srpRegister(this,e,t,n,r).sync()},n.prototype.srpLoginStep1=function(e,t,n,r,i,o,s){return c.CryptoBase.srpLoginStep1(this,e,t,n,r,i,o,s).sync()},n}(l);n.CryptoSyncRandomAbstract=h;var p=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.hmac=function(e,t,n){return f.hmac(e,t,n)},n.prototype.hash=function(e,t){return f.hash(e,t)},n.prototype.aes256CbcPkcs7Encrypt=function(e,t,n){return f.aes256CbcPkcs7Encrypt(e,t,n)},n.prototype.aes256CbcNoPadEncrypt=function(e,t,n){return f.aes256CbcNoPadEncrypt(e,t,n)},n.prototype.aes256CbcPkcs7Decrypt=function(e,t,n){return f.aes256CbcPkcs7Decrypt(e,t,n)},n.prototype.aes256CbcNoPadDecrypt=function(e,t,n){return f.aes256CbcNoPadDecrypt(e,t,n)},n.prototype.xteaEcbPkcs7Encrypt=function(e,t){return f.xteaEcbPkcs7Encrypt(e,t)},n.prototype.xteaEcbPkcs7Decrypt=function(e,t){return f.xteaEcbPkcs7Decrypt(e,t)},n.prototype.aes256EcbEncrypt=function(e,t){return f.aes256EcbEncrypt(e,t)},n.prototype.aes256EcbDecrypt=function(e,t){return f.aes256EcbDecrypt(e,t)},n.prototype.pbkdf2=function(e,t,n,r,i){return f.pbkdf2(e,t,n,r,i)},n}(l);n.CryptoSync=p;var d=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.randomBytes=function(e){return u(e)},n.prototype.hmac=function(e,t,n){return f.hmac(e,t,n)},n.prototype.hash=function(e,t){return f.hash(e,t)},n.prototype.aes256CbcPkcs7Encrypt=function(e,t,n){return f.aes256CbcPkcs7Encrypt(e,t,n)},n.prototype.aes256CbcNoPadEncrypt=function(e,t,n){return f.aes256CbcNoPadEncrypt(e,t,n)},n.prototype.aes256CbcPkcs7Decrypt=function(e,t,n){return f.aes256CbcPkcs7Decrypt(e,t,n)},n.prototype.aes256CbcNoPadDecrypt=function(e,t,n){return f.aes256CbcNoPadDecrypt(e,t,n)},n.prototype.xteaEcbPkcs7Encrypt=function(e,t){return f.xteaEcbPkcs7Encrypt(e,t)},n.prototype.xteaEcbPkcs7Decrypt=function(e,t){return f.xteaEcbPkcs7Decrypt(e,t)},n.prototype.aes256EcbEncrypt=function(e,t){return f.aes256EcbEncrypt(e,t)},n.prototype.aes256EcbDecrypt=function(e,t){return f.aes256EcbDecrypt(e,t)},n.prototype.pbkdf2=function(e,t,n,r,i){return f.pbkdf2(e,t,n,r,i)},n}(h);n.CryptoSyncRandom=d}).call(this,e("buffer").Buffer)},{"../../browserbuffer/BrowserBuffer":219,"../CryptoBase":221,buffer:590,crypto:602,"privmx-exception":266,randombytes:329,xtea:399}],235:[function(e,t,n){"use strict";var r=e("./CryptoSync");t.exports=r},{"./CryptoSync":234}],236:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){}return e.getTransferable=function(e){if(e instanceof ArrayBuffer)return[e];var t=[];if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]instanceof ArrayBuffer&&t.push(e[n]);else if("object"==typeof e)for(var r in e)e[r]instanceof ArrayBuffer&&t.push(e[r]);return t},e}();n.Helper=r},{}],237:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Serializer"),i=e("./Helper"),o=e("../sync/CryptoSync"),s=e("q"),a=function(){function e(e){var t=this;this.tasks={},this.taskId=0;try{this.worker=new Worker(e),this.worker.onmessage=this.onMessage.bind(this),this.worker.onerror=function(){return t.isSupported=function(){return!1}}}catch(n){console.log("Requester error",n),this.isSupported=function(){return!1}}}return e.prototype.onMessage=function(e){var t=this.tasks[e.data.id];if(null==t)throw new Error("Invalid task id");delete this.tasks[e.data.id],"result"in e.data?t.resolve(e.data.result):t.reject(e.data.error)},e.prototype.execute=function(e,t){var n=this;return e in o.CryptoSync.prototype&&s(null).then(function(){var o=s.defer();n.taskId++,n.tasks[n.taskId]=o,t=r.Serializer.encode(t);var a={id:n.taskId,method:e,params:t};return n.worker.postMessage(a,i.Helper.getTransferable(t)),o.promise}).then(function(e){return r.Serializer.decode(e)})},e}();n.Requester=a},{"../sync/CryptoSync":234,"./Helper":236,"./Serializer":238,q:327}],238:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("../../browserbuffer/BrowserBuffer"),r=e("../../ecc"),i=function(){function e(){}return e.encode=function(e){var n=this;if("object"!=typeof e)return e;if(Array.isArray(e))return e.map(function(e){return n.encode(e)});if(e instanceof Buffer||e instanceof ArrayBuffer||e instanceof Uint8Array)return{_type:"buffer",_value:e instanceof ArrayBuffer?e:t.BrowserBuffer.bufferToArray(e,!1)};var i="";if(e instanceof r.PublicKey?i="eccpub":e instanceof r.PrivateKey?i="eccpriv":e instanceof r.ExtKey&&(i="eccext"),""!==i)return{_type:i,_value:t.BrowserBuffer.bufferToArray(e.serialize(),!1)};var o={};for(var s in e)o[s]=this.encode(e[s]);return o},e.decode=function(e){var n=this;if("object"!=typeof e)return e;if(Array.isArray(e))return e.map(function(e){return n.decode(e)});if(e._type&&e._value&&2===Object.keys(e).length){switch(e._type){case"buffer":return t.BrowserBuffer.arrayToBuffer(e._value);case"eccpub":return r.PublicKey.deserialize(t.BrowserBuffer.arrayToBuffer(e._value));case"eccpriv":return r.PrivateKey.deserialize(t.BrowserBuffer.arrayToBuffer(e._value));case"eccext":return r.ExtKey.deserialize(t.BrowserBuffer.arrayToBuffer(e._value))}throw new Error("Invalid type "+e._type)}var i={};for(var o in e)i[o]=this.decode(e[o]);return i},e}();n.Serializer=i}).call(this,e("buffer").Buffer)},{"../../browserbuffer/BrowserBuffer":219,"../../ecc":246,buffer:590}],239:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Serializer");n.Serializer=r.Serializer;var i=e("./Helper");n.Helper=i.Helper;var o=e("./Requester");n.Requester=o.Requester},{"./Helper":236,"./Requester":237,"./Serializer":238}],240:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("./PublicKey"),r=e("../crypto/R"),i=function(){function e(e,t,n){this.privateKey=e,this.publicKey=t,this.opts=n||{}}return e.prototype.getRbuf=function(){return null==this.rBuf&&(this.rBuf=this.privateKey.getPublicKey().toDER()),this.rBuf},e.prototype.getkEkM=function(e){return null==this.kEkM&&(this.kEkM=this.privateKey.getSharedKey(e,this.publicKey)),this.kEkM},e.prototype.getkE=function(e){return null==this.kE&&(this.kE=this.getkEkM(e).then(function(e){return e.slice(0,32)})),this.kE},e.prototype.getkM=function(e){return null==this.kM&&(this.kM=this.getkEkM(e).then(function(e){return e.slice(32,64)})),this.kM},e.prototype.encrypt=function(e,t,n){var i,o,s=this;return r.R(function(){return void 0===n?r.R(function(){return e.hmacSha256(s.privateKey.getPrivateEncKey(),t)}).then(function(e){return e.slice(0,16)}):n}).then(function(t){return i=t,s.getkE(e)}).then(function(n){return e.aes256CbcPkcs7Encrypt(t,n,i)}).then(function(t){return o=Buffer.concat([i,t]),s.getkM(e)}).then(function(t){return e.hmacSha256(t,o)}).then(function(e){s.opts.shortTag&&(e=e.slice(0,4));var t;return t=s.opts.noKey?Buffer.concat([o,e]):Buffer.concat([s.getRbuf(),o,e])})},e.prototype.decrypt=function(e,n){var i,o,s=this;return r.R(function(){var r=0,a=32;return s.opts.shortTag&&(a=4),s.opts.noKey||(r=33,s.publicKey=t.PublicKey.fromDER(n.slice(0,33))),i=n.slice(r,n.length-a),o=n.slice(n.length-a,n.length),s.getkM(e)}).then(function(t){return e.hmacSha256(t,i)}).then(function(t){s.opts.shortTag&&(t=t.slice(0,4));for(var n=!0,r=0;r<o.length;r++)n=n&&o[r]===t[r];if(!n)throw new Error("Invalid checksum");return s.getkE(e)}).then(function(t){return e.aes256CbcPkcs7Decrypt(i.slice(16),t,i.slice(0,16))})},e}();n.ECIES=i}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./PublicKey":244,buffer:590}],241:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("./HDNode"),BN=e("bn.js"),r=e("./PublicKey"),i=e("./PrivateKey"),o=e("../crypto/R"),s=function(){function e(e){this.key=e}return e.fromBase58=function(n){return new e(t.HDNode.fromBase58(n))},e.fromSeed=function(n,r){return o.R(function(){return t.HDNode.fromSeedBuffer(n,r)}).then(function(t){return new e(t)})},e.generateRandom=function(t){return e.generateFromBuffer(t.randomBytes(64))},e.generateFromBuffer=function(n){return new e(t.HDNode.fromRawBuffer(n))},e.prototype.isPrivate=function(){return!!this.key.privKey},e.prototype.getPrivatePartAsBase58=function(){return this.key.toBase58()},e.prototype.getPublicPartAsBase58=function(){return this.key.neutered().toBase58()},e.prototype.getPublicKey=function(){return new r.PublicKey(this.key.key)},e.prototype.getPrivateKey=function(){return new i.PrivateKey(this.key.key)},e.prototype.getChainCode=function(){return this.key.chainCode},e.prototype.deriveHardened=function(t,n){var r=this;return o.R(function(){return r.key.deriveHardened(t,n)}).then(function(t){return new e(t)})},e.deserialize=function(n){new BN(n.slice(0,32).toString("hex"),16);return new e(new t.HDNode(new BN(n.slice(0,32).toString("hex"),16),n.slice(32)))},e.prototype.serialize=function(){var e=new Buffer(this.key.key.getPrivate("hex"),"hex");return e.length<32&&(e=Buffer.concat([new Buffer(32-e.length).fill(0),e])),Buffer.concat([e,new Buffer(this.key.chainCode.toString("hex"),"hex")])},e}();n.ExtKey=s}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./HDNode":242,"./PrivateKey":243,"./PublicKey":244,"bn.js":26,buffer:590}],242:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("./networks"),r=e("typeforce"),i=e("assert"),BN=e("bn.js"),o=e("elliptic"),s=e("bs58check"),a=o.ec("secp256k1"),u=e("./PublicKey"),c=e("./PrivateKey"),f=e("../crypto/R"),l=function(){function e(e,n,o){if(o=o||t.networks.bitcoin,r("Buffer",n),i.equal(n.length,32,"Expected chainCode length of 32, got "+n.length),i(o.bip32,"Unknown BIP32 constants for network"),this.chainCode=n,this.depth=0,this.index=0,this.parentFingerprint=0,this.network=o,e instanceof BN)this.key=a.keyFromPrivate(e),this.privKey=this.key.getPrivate(),this.pubKey=this.key.getPublic();else if(e instanceof c.PrivateKey)this.key=e.key,this.privKey=this.key.getPrivate(),this.pubKey=this.key.getPublic();else{if(!(e instanceof u.PublicKey))throw new Error("not_impelemented");this.key=e.key,this.pubKey=this.key.getPublic()}}return e.findBIP32NetworkByVersion=function(e){for(var n in t.networksMap){var r=t.networksMap[n];if(e===r.bip32["private"]||e===r.bip32["public"])return r}i(!1,"Could not find network for "+e.toString(16))},e.fromSeedBuffer=function(t,n,o){return f.R(function(){return r("Buffer",n),i(n.length>=16,"Seed should be at least 128 bits"),i(n.length<=64,"Seed should be at most 512 bits"),t.hmacSha512(e.MASTER_SECRET,n)}).then(function(t){return e.fromRawBuffer(t)})},e.fromRawBuffer=function(t,n){r("Buffer",t),i(64==t.length,"Buffer has to be 512 bits");var o=t.slice(0,32),s=t.slice(32),a=c.PrivateKey.getSafeBn(o);return new e(a,s,n)},e.fromBase58=function(t,n){return e.fromBuffer(s.decode(t),n)},e.fromBuffer=function(t,n){i.strictEqual(t.length,e.LENGTH,"Invalid buffer length");var r=t.readUInt32BE(0);n?i(r===n.bip32["private"]||r===n.bip32["public"],"Network doesn't match"):n=e.findBIP32NetworkByVersion(r);var o=t.readUInt8(4),s=t.readUInt32BE(5);0===o&&i.strictEqual(s,0,"Invalid parent fingerprint");var c=t.readUInt32BE(9);i(o>0||0===c,"Invalid index");var f,l,h=t.slice(13,45);if(r===n.bip32["private"]){i.strictEqual(t.readUInt8(45),0,"Invalid private key"),f=t.slice(46,78);var p=new BN(f.toString("hex"),16);l=new e(p,h,n)}else{f=t.slice(45,78);var d=a.curve.decodePoint(f),g=a.keyPair({pub:d}),y=new u.PublicKey(g);l=new e(y,h,n)}return l.depth=o,l.index=c,l.parentFingerprint=s,l},e.prototype.neutered=function(){var t=new e(new u.PublicKey(this.key),this.chainCode,this.network);return t.depth=this.depth,t.index=this.index,t.parentFingerprint=this.parentFingerprint,t},e.prototype.toBase58=function(e){return s.encode(this.toBuffer(e))},e.prototype.toBuffer=function(t){void 0===t?t=!!this.privKey:console.warn("isPrivate flag is deprecated, please use the .neutered() method instead");var n=t?this.network.bip32["private"]:this.network.bip32["public"],r=new Buffer(e.LENGTH);if(r.writeUInt32BE(n,0),r.writeUInt8(this.depth,4),r.writeUInt32BE(this.parentFingerprint,5),r.writeUInt32BE(this.index,9),this.chainCode.copy(r,13),t){i(this.privKey,"Missing private key"),r.writeUInt8(0,45);var o=new Buffer(this.key.getPrivate("hex"),"hex");o.length<32&&(o=Buffer.concat([new Buffer(32-o.length).fill(0),o])),o.copy(r,46)}else{this.key.getPublic().encodeCompressed("hex");new Buffer(this.key.getPublic().encodeCompressed()).copy(r,45)}return r},e.prototype.getIdentifier=function(e){var t=this;return f.R(function(){return e.hash160(new Buffer(t.key.getPublic().encodeCompressed()))})},e.prototype.getFingerprint=function(e){return this.getIdentifier(e).then(function(e){return e.slice(0,4)})},e.prototype.derive=function(t,n){var r,o=this;return f.R(function(){var r=n>=e.HIGHEST_BIT,s=new Buffer(4);s.writeUInt32BE(n,0);var a;return r?(i(o.privKey,"Could not derive hardened child key"),a=Buffer.concat([new Buffer([0]),new Buffer(o.key.getPrivate("hex"),"hex"),s])):a=Buffer.concat([new Buffer(o.key.getPublic().encodeCompressed()),s]),t.hmacSha512(o.chainCode,a)}).then(function(i){var s=i.slice(0,32),u=i.slice(32),c=new BN(s.toString("hex"),16);if(c.cmp(a.curve.n)>=0)return o.derive(t,n+1);if(!o.privKey)throw new Error("derive from public key not implemented");var f=c.add(o.privKey).mod(a.curve.n);return f.isZero()?o.derive(t,n+1):(r=new e(f,u,o.network),r.depth=o.depth+1,r.index=n,o.getFingerprint(t).then(function(e){return r.parentFingerprint=e.readUInt32BE(0),r}))})},e.prototype.deriveHardened=function(t,n){return this.derive(t,n+e.HIGHEST_BIT)},e.prototype.toString=function(e){return this.toBase58(e)},e.MASTER_SECRET=new Buffer("Bitcoin seed"),e.HIGHEST_BIT=2147483648,e.LENGTH=78,e}();n.HDNode=l}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./PrivateKey":243,"./PublicKey":244,"./networks":247,assert:561,"bn.js":26,bs58check:44,buffer:590,elliptic:56,typeforce:391}],243:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("elliptic"),r=t.ec("secp256k1"),i=e("./PublicKey"),o=e("./networks"),s=e("bs58check"),a=e("assert"),BN=e("bn.js"),u=e("./ECIES"),c=e("../crypto/R"),f=function(){function e(e){this.key=e}return e.getSafeBn=function(e){if(32!=e.length)throw new Error("Expected 32-bytes length buffer");var t=new BN(e);return t=t.mod(r.curve.n.sub(new BN(2))),t.isZero()&&t.iaddn(1),t},e.generateRandom=function(t){return e.generateFromBuffer(t.randomBytes(32))},e.generateFromBuffer=function(t){return new e(r.keyFromPrivate(e.getSafeBn(t)))},e.fromWIF=function(t){var n=s.decode(t),i=!1;return n=n.slice(1),33===n.length&&(a.strictEqual(n[32],1,"Invalid compression flag"),n=n.slice(0,-1),i=!0),a.equal(n.length,32,"Invalid WIF payload length"),new e(r.keyFromPrivate(n))},e.prototype.toWIF=function(){var e=o.networks.bitcoin,t=34,n=new Buffer(t);n.writeUInt8(e.wif,0);var r=new Buffer(this.key.getPrivate("hex"),"hex");return r.length<32&&(r=Buffer.concat([new Buffer(32-r.length).fill(0),r])),r.copy(n,1),n.writeUInt8(1,33),s.encode(n)},e.prototype.signToCompactSignature=function(e){var t=this.key.sign(e),n=27,r=new Buffer(65);return r.writeUInt8(n,0),new Buffer(t.r.toArray("be",32)).copy(r,1),new Buffer(t.s.toArray("be",32)).copy(r,33),r},e.prototype.getPublicKey=function(){return new i.PublicKey(this.key)},e.prototype.getPrivateEncKey=function(){return this.serialize()},e.prototype.getSharedKey=function(e,t){var n=this;return c.R(function(){var r=n.key.derive(t.key.getPublic());return e.sha512(new Buffer(r.toArray("be",32)))})},e.prototype.eciesEncrypt=function(e,t,n){return new u.ECIES(this,t,{noKey:!0,shortTag:!0}).encrypt(e,n)},e.prototype.eciesDecrypt=function(e,t,n){return new u.ECIES(this,t,{noKey:!0,shortTag:!0}).decrypt(e,n)},e.deserialize=function(t){return new e(r.keyFromPrivate(t))},e.prototype.serialize=function(){var e=new Buffer(this.key.getPrivate("hex"),"hex");return e.length<32&&(e=Buffer.concat([new Buffer(32-e.length).fill(0),e])),e},e}();n.PrivateKey=f}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./ECIES":240,"./PublicKey":244,"./networks":247,assert:561,"bn.js":26,bs58check:44,buffer:590,elliptic:56}],244:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("elliptic"),r=e("bs58check"),i=t.ec("secp256k1"),o=e("assert"),s=e("./networks"),BN=e("bn.js"),a=e("elliptic/lib/elliptic/ec/signature"),u=e("../crypto/R"),c=function(){function e(e){this.key=e}return e.fromDER=function(e){return this.deserialize(e)},e.prototype.toDER=function(){return new Buffer(this.key.getPublic().encodeCompressed())},e.fromBase58DER=function(t){return new e(i.keyFromPublic(r.decode(t)))},e.prototype.toBase58DER=function(){return r.encode(this.toDER())},e.fromHexDER=function(t){return new e(i.keyFromPublic(t,"hex"))},e.prototype.toHexDER=function(){return this.key.getPublic().encodeCompressed("hex")},e.prototype.toBase58Address=function(e,t){var n=this;return t=t||s.networks.bitcoin,u.R(function(){return e.hash160(new Buffer(n.key.getPublic().encodeCompressed()))}).then(function(e){var n=t.pubKeyHash,i=new Buffer(21);return i.writeUInt8(n,0),e.copy(i,1),r.encode(i)})},e.prototype.verifyCompactSignature=function(e,t){o.equal(t.length,65,"Invalid signature length");var n=t.readUInt8(0)-27;o.equal(n,7&n,"Invalid signature parameter");var r=new BN(t.slice(1,33).toString("hex"),16),i=new BN(t.slice(33).toString("hex"),16),s=1,u=new a({r:r,s:i,recoveryParam:s});return this.key.verify(e,u)},e.prototype.equals=function(e){return this.toBase58DER()==e.toBase58DER()},e.deserialize=function(t){return new e(i.keyFromPublic(t))},e.prototype.serialize=function(){return new Buffer(this.key.getPublic().encode())},e}();n.PublicKey=c}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./networks":247,assert:561,"bn.js":26,bs58check:44,buffer:590,elliptic:56,"elliptic/lib/elliptic/ec/signature":65}],245:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("q"),r=e("crypto"),i=e("./PrivateKey"),o=e("./PublicKey"),s=e("elliptic"),a=s.ec("secp256k1"),BN=e("bn.js"),u=e("../openssl/oid"),c=e("../openssl/openssl-utils"),f=e("../openssl/openssl-handler"),l=e("../crypto/R"),h=c.asn.ECParameters.encode({type:"namedCurve",value:u.oid.idSecp256k1.split(".")},"der"),p=function(){function e(){}return e.ecdsaSign=function(e,t){e instanceof i.PrivateKey?e=d.encodePrivate(e,"pem"):e instanceof Buffer&&(e=d.encodePrivate(d.decodePrivate(e),"pem"));var n=r.createSign("sha256");return n.update(t),n.sign(e)},e.ecdsaVerify=function(e,t,n){d.isCompact(t)&&(t=d.compact2DER(t)),e instanceof o.PublicKey&&(e=d.encodePublic(e,"pem"));var i=r.createVerify("sha256");return i.update(n),i.verify(e,t)},e}();n.EccCryptoNode=p;var d=function(){function e(){}return e.encodePrivate=function(e,t){var n={algorithm:u.oid.idEcPublicKey.split("."),parameters:h},r=c.asn.ECPrivateKey.encode({version:1,privateKey:e.key.getPrivate().toArrayLike(Buffer),publicKey:{data:new Buffer(e.key.getPublic(!1,"binary"))}},"der");return c.encodePrivateKey(n,r,t)},e.decodePrivate=function(e){var t=c.decodePrivateKey(e),n="";if(t.algorithm&&t.algorithm.algorithm&&(n=t.algorithm.algorithm.join(".")),n!==u.oid.idEcPublicKey)throw new Error("Invalid algorithm ("+n+")");if(!t.algorithm.parameters||!h.equals(t.algorithm.parameters))throw new Error("Invalid parameters");if(!t.subjectPrivateKey)throw new Error("Missing private key data");var r=c.asn.ECPrivateKey.decode(t.subjectPrivateKey);if(!r.privateKey||!r.publicKey)throw new Error("Incorrect private key data");var o=a.keyPair({pub:r.publicKey.data,priv:r.privateKey});return new i.PrivateKey(o)},e.encodePublic=function(e,t){var n={algorithm:u.oid.idEcPublicKey.split("."),parameters:h},r=new Buffer(e.key.getPublic(!1,"binary"));return c.encodePublicKey(n,r,t)},e.decodePublic=function(e){var t=c.decodePublicKey(e),n="";if(t.algorithm&&t.algorithm.algorithm&&(n=t.algorithm.algorithm.join(".")),n!==u.oid.idEcPublicKey)throw new Error("Invalid algorithm ("+n+")");if(!t.algorithm.parameters||!h.equals(t.algorithm.parameters))throw new Error("Invalid parameters");if(!t.subjectPublicKey||!t.subjectPublicKey.data)throw new Error("Missing public key data");var r=a.keyFromPublic(t.subjectPublicKey.data);return new o.PublicKey(r)},e.eccGenerateKey=function(t,n){"undefined"==typeof n&&(n="pem");var r=i.PrivateKey.generateFromBuffer(t.randomBytes(32));return"raw"===n?r:e.encodePrivate(r,n)},e.ecdsaSign=function(t,n,r){return l.R(function(){return n instanceof i.PrivateKey||(n=e.decodePrivate(n)),t.signToCompactSignatureWithHash(n,r)}).then(function(t){return e.compact2DER(t)})},e.ecdsaVerify=function(t,n,r,i){return l.R(function(){return n instanceof o.PublicKey||(n=e.decodePublic(n)),e.isCompact(r)||(r=e.DER2compact(r)),t.verifyCompactSignatureWithHash(n,i,r)})},e.extractPublicKey=function(e){return f.OpenSSLHandlerBase.extractPublicKey(e)},e.eccEciesEncrypt=function(t,n,r,s){return l.R(function(){return n instanceof i.PrivateKey||(n=e.decodePrivate(n)),r instanceof o.PublicKey||(r=e.decodePublic(r)),n.eciesEncrypt(t,r,s)})},e.eccEciesDecrypt=function(t,n,r,s){return l.R(function(){return n instanceof i.PrivateKey||(n=e.decodePrivate(n)),r instanceof o.PublicKey||(r=e.decodePublic(r)),n.eciesDecrypt(t,r,s)})},e.isCompact=function(e){return 27===e.readUInt8(0)&&65===e.length},e.compact2DER=function(t){if(!e.isCompact(t))throw new Error("Unknown signature format");var n={r:new BN(t.slice(1,33)),s:new BN(t.slice(33))};return c.asn.Signature.encode(n,"der")},e.DER2compact=function(e){var t=c.asn.Signature.decode(e);return Buffer.concat([Buffer.from([27]),Buffer.from(t.r.toArray("be",32)),Buffer.from(t.s.toArray("be",32))])},e}();n.EccCryptoBase=d;var g=function(){function e(e){this.crypto=e;var t=new Function("try {return this===global;}catch(e){ return false;}");this.isNode=t()}return e.prototype.eccEciesEncrypt=function(e,t,n){return d.eccEciesEncrypt(this.crypto,e,t,n).async()},e.prototype.eccEciesDecrypt=function(e,t,n){return d.eccEciesDecrypt(this.crypto,e,t,n).async()},e.prototype.eccGenerateKey=function(e){return t(d.eccGenerateKey(this.crypto,e))},e.prototype.ecdsaSign=function(e,n){return this.isNode?t(p.ecdsaSign(e,n)):d.ecdsaSign(this.crypto,e,n).async()},e.prototype.ecdsaVerify=function(e,n,r){return this.isNode?t(p.ecdsaVerify(e,n,r)):d.ecdsaVerify(this.crypto,e,n,r).async()},e}();n.EccCrypto=g}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"../openssl/oid":251,"../openssl/openssl-handler":252,"../openssl/openssl-utils":253,"./PrivateKey":243,"./PublicKey":244,"bn.js":26,buffer:590,crypto:602,elliptic:56,q:327}],246:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./ecc-crypto");n.EccCryptoNode=r.EccCryptoNode,n.EccCryptoBase=r.EccCryptoBase,n.EccCrypto=r.EccCrypto;var i=e("./ECIES");n.ECIES=i.ECIES;var o=e("./ExtKey");n.ExtKey=o.ExtKey;var s=e("./HDNode");n.HDNode=s.HDNode;var a=e("./PublicKey");n.PublicKey=a.PublicKey;var u=e("./PrivateKey");n.PrivateKey=u.PrivateKey},{"./ECIES":240,"./ExtKey":241,"./HDNode":242,"./PrivateKey":243,"./PublicKey":244,"./ecc-crypto":245}],247:[function(e,t,n){"use strict";function r(e){return function(t){var r=n.networks[e],i=r.feePerKb,o=t.toBuffer().length,s=i*Math.ceil(o/1e3);return void 0===r.dustSoftThreshold?s:(t.outs.forEach(function(e){e.value<r.dustSoftThreshold&&(s+=i)}),s)}}n.__esModule=!0,n.networks={bitcoin:{magicPrefix:"Bitcoin Signed Message:\n",bip32:{"public":76067358,"private":76066276},pubKeyHash:0,scriptHash:5,wif:128,dustThreshold:546,feePerKb:1e4,estimateFee:r("bitcoin")},testnet:{magicPrefix:"Bitcoin Signed Message:\n",bip32:{"public":70617039,"private":70615956},pubKeyHash:111,scriptHash:196,wif:239,dustThreshold:546,feePerKb:1e4,estimateFee:r("testnet")},litecoin:{magicPrefix:"Litecoin Signed Message:\n",bip32:{"public":27108450,"private":27106558},pubKeyHash:48,scriptHash:5,wif:176,dustThreshold:0,dustSoftThreshold:1e5,feePerKb:1e5,estimateFee:r("litecoin")},dogecoin:{magicPrefix:"Dogecoin Signed Message:\n",bip32:{"public":49990397,"private":49988504},pubKeyHash:30,scriptHash:22,wif:158,dustThreshold:0,dustSoftThreshold:1e8,feePerKb:1e8,estimateFee:r("dogecoin")},viacoin:{magicPrefix:"Viacoin Signed Message:\n",bip32:{"public":76067358,"private":76066276},pubKeyHash:71,scriptHash:33,wif:199,dustThreshold:560,dustSoftThreshold:1e5,feePerKb:1e5,estimateFee:r("viacoin")},viacointestnet:{magicPrefix:"Viacoin Signed Message:\n",bip32:{"public":70617039,"private":70615956},pubKeyHash:127,scriptHash:196,wif:255,dustThreshold:560,dustSoftThreshold:1e5,feePerKb:1e5,estimateFee:r("viacointestnet")},gamerscoin:{magicPrefix:"Gamerscoin Signed Message:\n",bip32:{"public":27108450,"private":27106558},pubKeyHash:38,scriptHash:5,wif:166,dustThreshold:0,dustSoftThreshold:1e5,feePerKb:1e5,estimateFee:r("gamerscoin")},jumbucks:{magicPrefix:"Jumbucks Signed Message:\n",bip32:{"public":58353818,"private":58352736},pubKeyHash:43,scriptHash:5,wif:171,dustThreshold:0,dustSoftThreshold:1e4,feePerKb:1e4,estimateFee:r("jumbucks")},zetacoin:{magicPrefix:"Zetacoin Signed Message:\n",bip32:{"public":76067358,"private":76066276},pubKeyHash:80,scriptHash:9,wif:224,dustThreshold:546,feePerKb:1e4,estimateFee:r("zetacoin")}},n.networksMap=n.networks,n.estimateFee=r},{}],248:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./browserbuffer/BrowserBuffer");n.BrowserBuffer=r.BrowserBuffer;var i=e("./crypto");n.crypto=i;var o=e("./ecc");n.ecc=o;var s=e("./openssl");n.openssl=s;var a=e("./rsa");n.rsa=a;var u=e("./srp");n.srp=u;var c=e("./utils");n.utils=c;var f=i.Service,l=i.sync.CryptoSyncRandom;n.service=new f,n.serviceSync=new l},{"./browserbuffer/BrowserBuffer":219,"./crypto":233,"./ecc":246,"./openssl":250,"./rsa":255,"./srp":261,"./utils":265}],249:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("asn1.js");n.RSAPrivateKey=r.define("RSAPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("modulus")["int"](),this.key("publicExponent")["int"](),this.key("privateExponent")["int"](),this.key("prime1")["int"](),this.key("prime2")["int"](),this.key("exponent1")["int"](),this.key("exponent2")["int"](),this.key("coefficient")["int"]())}),n.RSAPublicKey=r.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus")["int"](),this.key("publicExponent")["int"]());
}),n.PublicKey=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(n.AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())}),n.AlgorithmIdentifier=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}),n.PrivateKey=r.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version")["int"](),this.key("algorithm").use(n.AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())}),n.EncryptedPrivateKey=r.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters")["int"]())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}),n.ECPrivateKey=r.define("ECPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(n.ECParameters),this.key("publicKey").optional().explicit(1).bitstr())}),n.ECParameters=r.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}),n.Signature=r.define("signature",function(){this.seq().obj(this.key("r")["int"](),this.key("s")["int"]())})},{"asn1.js":1}],250:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./asn1");n.asn1=r;var i=e("./oid");n.oid=i.oid;var o=e("./openssl-handler");n.OpenSSLHandlerBase=o.OpenSSLHandlerBase,n.OpenSSLHandler=o.OpenSSLHandler;var s=e("./openssl-utils");n.utils=s},{"./asn1":249,"./oid":251,"./openssl-handler":252,"./openssl-utils":253}],251:[function(e,t,n){"use strict";n.__esModule=!0,n.oid={idPBES2:"1.2.840.113549.1.5.13",idPBKDF2:"1.2.840.113549.1.5.12",idSHA1:"1.3.14.3.2.26",idSHA256:"2.16.840.1.101.3.4.2.1",idSHA384:"2.16.840.1.101.3.4.2.2",idSHA512:"2.16.840.1.101.3.4.2.3",idAES256CBC:"2.16.840.1.101.3.4.1.42",idrsaEncryption:"1.2.840.113549.1.1.1",idEcPublicKey:"1.2.840.10045.2.1",idSecp256k1:"1.3.132.0.10"}},{}],252:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("q"),r=e("./oid"),i=e("./openssl-utils"),o=e("../crypto/R"),s=function(){function e(){}return e.encryptKey=function(e,t,n){var s,a,u;return o.R(function(){if(!i.isDER(t)){var r=i.parsePem(t);if(!r||"PRIVATE KEY"!==r.name)throw new Error("Invalid argument");t=r.data}var o=e.randomBytes(32);return a=o.slice(0,16),s=o.slice(16),u=4096,e.pbkdf2(new Buffer(n,"utf8"),a,u,32,"sha1")}).then(function(n){return e.aes256CbcPkcs7Encrypt(t,n,s)}).then(function(e){var t={algorithm:{id:r.oid.idPBES2.split("."),decrypt:{kde:{id:r.oid.idPBKDF2.split("."),kdeparams:{salt:a,iters:u}},cipher:{algo:r.oid.idAES256CBC.split("."),iv:s}}},subjectPrivateKey:e};return i.asn.EncryptedPrivateKey.encode(t,"pem",{label:"ENCRYPTED PRIVATE KEY"})})},e.decryptKey=function(e,t,n){var s;return o.R(function(){if(!i.isDER(t)){var o=i.parsePem(t);if(!o||"ENCRYPTED PRIVATE KEY"!==o.name)throw new Error("Invalid argument");t=o.data}var s=i.asn.EncryptedPrivateKey.decode(t),a=s.algorithm.id.join(".");if(a!==r.oid.idPBES2)throw new Error("unsupported encrypted key algorithm "+a);var u=s.algorithm.decrypt.kde.id.join(".");if(u!==r.oid.idPBKDF2)throw new Error("unsupported encrypted key derivation algorithm "+u);var c=s.algorithm.decrypt.cipher.algo.join(".");if(c!==r.oid.idAES256CBC)throw new Error("unsupported encrypted key cipher "+c);var f=s.algorithm.decrypt.kde.kdeparams,l=f.salt,h=f.iters.toNumber();return e.pbkdf2(new Buffer(n,"utf8"),l,h,32,"sha1")}).then(function(t){var n=s.algorithm.decrypt.cipher.iv;return e.aes256CbcPkcs7Decrypt(s.subjectPrivateKey,t,n)}).then(function(e){return"-----BEGIN PRIVATE KEY-----\n"+i.chunk(e.toString("base64"),64)+"-----END PRIVATE KEY-----"})},e.extractPublicKey=function(e){var t,n=i.decodePrivateKey(e),o=n.algorithm.algorithm.join(".");switch(o){case r.oid.idrsaEncryption:var s=i.asn.RSAPrivateKey.decode(n.subjectPrivateKey);t=i.asn.RSAPublicKey.encode(s);break;case r.oid.idEcPublicKey:var a=i.asn.ECPrivateKey.decode(n.subjectPrivateKey);t=a.publicKey.data;break;default:throw new Error("unsupported pki algorithm "+o)}return i.encodePublicKey(n.algorithm,t,"pem")},e}();n.OpenSSLHandlerBase=s;var a=function(){function e(e){this.crypto=e}return e.prototype.encryptKey=function(e,t){return s.encryptKey(this.crypto,e,t).async()},e.prototype.decryptKey=function(e,t){return s.decryptKey(this.crypto,e,t).async()},e.prototype.extractPublicKey=function(e){return t(s.extractPublicKey(e))},e}();n.OpenSSLHandler=a}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./oid":251,"./openssl-utils":253,buffer:590,q:327}],253:[function(e,t,n){(function(Buffer){"use strict";function t(e,n){return 0==e.length?"":e.slice(0,n)+"\n"+t(e.slice(n),n)}function r(e){Buffer.isBuffer(e)&&(e=e.toString());var t=e.match(/\s*-----BEGIN ([^-]+)-----\s+((.|\s)*)\s+-----END (\1)-----/m);return null==t?null:{name:t[1],data:Buffer.from(t[2],"base64")}}function i(e){return Buffer.isBuffer(e)&&48===e[0]}function o(e,t,n){"undefined"==typeof n&&(n="pem");var r={version:0,algorithm:e,subjectPrivateKey:t};return"pem"===n?c.PrivateKey.encode(r,"pem",{label:"PRIVATE KEY"}):c.PrivateKey.encode(r,"der")}function s(e){if(!i(e)){var t=r(e);if(!t||"PRIVATE KEY"!==t.name)throw new Error("Invalid argument");e=t.data}return c.PrivateKey.decode(e)}function a(e,t,n){"undefined"==typeof n&&(n="pem");var r={algorithm:e,subjectPublicKey:{data:t}};return"pem"===n?c.PublicKey.encode(r,"pem",{label:"PUBLIC KEY"}):c.PublicKey.encode(r,"der")}function u(e){if(!i(e)){var t=r(e);if(!t||"PUBLIC KEY"!==t.name)throw new Error("Invalid argument");e=t.data}return c.PublicKey.decode(e)}n.__esModule=!0;var c=e("./asn1");n.asn=c,n.chunk=t,n.parsePem=r,n.isDER=i,n.encodePrivateKey=o,n.decodePrivateKey=s,n.encodePublicKey=a,n.decodePublicKey=u}).call(this,e("buffer").Buffer)},{"./asn1":249,buffer:590}],254:[function(e,t,n){(function(Buffer){"use strict";function t(e,t){var n=r(e,t),i={version:0,modulus:n.n,publicExponent:n.e,privateExponent:n.d,prime1:n.p,prime2:n.q,exponent1:n.dp,exponent2:n.dq,coefficient:n.qi},a={algorithm:s.oid.idrsaEncryption.split("."),parameters:Buffer.from("0500","hex")},u=o.asn.RSAPrivateKey.encode(i,"der");return o.encodePrivateKey(a,u,"pem")}function r(e,t){for(var n,r,o,s,a=(t+1)/2|0,u=t-a,c=new BN(65537);;)if(n=i.generate(e,a),r=n.subn(1),r.gcd(c).eqn(1))break;for(;;)if(o=i.generate(e,u),!n.eq(o)&&(s=o.subn(1),s.gcd(c).eqn(1)))break;if(n.cmp(o)<0){var f=n;n=o,o=f,f=r,r=s,s=f}var l=n.mul(o),h=r.mul(s),p=c.invm(h),d=p.mod(r),g=p.mod(s),y=o.invm(n);return{n:l,e:c,d:p,p:n,q:o,dp:d,dq:g,qi:y}}n.__esModule=!0;var BN=e("bn.js"),i=e("./prime"),o=e("../openssl/openssl-utils"),s=e("../openssl/oid");n.generateKey=t,n.generate=r}).call(this,e("buffer").Buffer)},{"../openssl/oid":251,"../openssl/openssl-utils":253,"./prime":256,"bn.js":26,buffer:590}],255:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./genrsa");n.genrsa=r;var i=e("./prime");n.prime=i;var o=e("./rsa-browser");n.RsaBrowserBase=o.RsaBrowserBase,n.RsaBrowser=o.RsaBrowser;var s=e("./rsa-crypto");n.RsaCryptoBase=s.RsaCryptoBase,n.RsaCrypto=s.RsaCrypto;var a=e("./rsa-subtle");n.RsaSubtle=a.RsaSubtle},{"./genrsa":254,"./prime":256,"./rsa-browser":257,"./rsa-crypto":258,"./rsa-subtle":259}],256:[function(e,t,n){"use strict";function r(e,t,n){if(t.isEven())return!1;var r=BN.red(t),i=t.subn(1),o=s.toRed(r),a=i.zeroBits(),u=i.shrn(a);for(i=i.toRed(r);n-- >0;){var c=e.randomBN(t.subn(4)).addn(2).toRed(r),f=c.redPow(u);if(!f.eq(o)&&!f.eq(i)){for(var l=0;l<a-1;++l){if(f=f.redSqr(),f.eq(o))return!1;if(f.eq(i))break}if(l==a-1)return!1}}return!0}function i(e,t,n){if(t.isEven())return t.eqn(2);if(t.eqn(1))return!1;for(var i=1;i<u.length;++i)if(t.modn(u[i]).eqn(0))return t.eqn(u[i]);var o=BN.red(t);return!!a.toRed(o).redPow(t.subn(1)).fromRed().eqn(1)&&r(e,t,n)}function o(e,t){for(var n,r=t>=1300?2:t>=850?3:t>=650?4:t>=550?5:t>=450?6:t>=400?7:t>=350?8:t>=300?9:t>=250?12:t>=200?15:t>=150?18:27;;)if(n=new BN(e.randomBits(t)),n.isEven()&&!n.eqn(2)&&n.iadd(s),i(e,n,r))return n}n.__esModule=!0;var BN=e("bn.js"),s=new BN(1),a=new BN(2),u=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999,5003,5009,5011,5021,5023,5039,5051,5059,5077,5081,5087,5099,5101,5107,5113,5119,5147,5153,5167,5171,5179,5189,5197,5209,5227,5231,5233,5237,5261,5273,5279,5281,5297,5303,5309,5323,5333,5347,5351,5381,5387,5393,5399,5407,5413,5417,5419,5431,5437,5441,5443,5449,5471,5477,5479,5483,5501,5503,5507,5519,5521,5527,5531,5557,5563,5569,5573,5581,5591,5623,5639,5641,5647,5651,5653,5657,5659,5669,5683,5689,5693,5701,5711,5717,5737,5741,5743,5749,5779,5783,5791,5801,5807,5813,5821,5827,5839,5843,5849,5851,5857,5861,5867,5869,5879,5881,5897,5903,5923,5927,5939,5953,5981,5987,6007,6011,6029,6037,6043,6047,6053,6067,6073,6079,6089,6091,6101,6113,6121,6131,6133,6143,6151,6163,6173,6197,6199,6203,6211,6217,6221,6229,6247,6257,6263,6269,6271,6277,6287,6299,6301,6311,6317,6323,6329,6337,6343,6353,6359,6361,6367,6373,6379,6389,6397,6421,6427,6449,6451,6469,6473,6481,6491,6521,6529,6547,6551,6553,6563,6569,6571,6577,6581,6599,6607,6619,6637,6653,6659,6661,6673,6679,6689,6691,6701,6703,6709,6719,6733,6737,6761,6763,6779,6781,6791,6793,6803,6823,6827,6829,6833,6841,6857,6863,6869,6871,6883,6899,6907,6911,6917,6947,6949,6959,6961,6967,6971,6977,6983,6991,6997,7001,7013,7019,7027,7039,7043,7057,7069,7079,7103,7109,7121,7127,7129,7151,7159,7177,7187,7193,7207,7211,7213,7219,7229,7237,7243,7247,7253,7283,7297,7307,7309,7321,7331,7333,7349,7351,7369,7393,7411,7417,7433,7451,7457,7459,7477,7481,7487,7489,7499,7507,7517,7523,7529,7537,7541,7547,7549,7559,7561,7573,7577,7583,7589,7591,7603,7607,7621,7639,7643,7649,7669,7673,7681,7687,7691,7699,7703,7717,7723,7727,7741,7753,7757,7759,7789,7793,7817,7823,7829,7841,7853,7867,7873,7877,7879,7883,7901,7907,7919,7927,7933,7937,7949,7951,7963,7993,8009,8011,8017,8039,8053,8059,8069,8081,8087,8089,8093,8101,8111,8117,8123,8147,8161,8167,8171,8179,8191,8209,8219,8221,8231,8233,8237,8243,8263,8269,8273,8287,8291,8293,8297,8311,8317,8329,8353,8363,8369,8377,8387,8389,8419,8423,8429,8431,8443,8447,8461,8467,8501,8513,8521,8527,8537,8539,8543,8563,8573,8581,8597,8599,8609,8623,8627,8629,8641,8647,8663,8669,8677,8681,8689,8693,8699,8707,8713,8719,8731,8737,8741,8747,8753,8761,8779,8783,8803,8807,8819,8821,8831,8837,8839,8849,8861,8863,8867,8887,8893,8923,8929,8933,8941,8951,8963,8969,8971,8999,9001,9007,9011,9013,9029,9041,9043,9049,9059,9067,9091,9103,9109,9127,9133,9137,9151,9157,9161,9173,9181,9187,9199,9203,9209,9221,9227,9239,9241,9257,9277,9281,9283,9293,9311,9319,9323,9337,9341,9343,9349,9371,9377,9391,9397,9403,9413,9419,9421,9431,9433,9437,9439,9461,9463,9467,9473,9479,9491,9497,9511,9521,9533,9539,9547,9551,9587,9601,9613,9619,9623,9629,9631,9643,9649,9661,9677,9679,9689,9697,9719,9721,9733,9739,9743,9749,9767,9769,9781,9787,9791,9803,9811,9817,9829,9833,9839,9851,9857,9859,9871,9883,9887,9901,9907,9923,9929,9931,9941,9949,9967,9973,10007,10009,10037,10039,10061,10067,10069,10079,10091,10093,10099,10103,10111,10133,10139,10141,10151,10159,10163,10169,10177,10181,10193,10211,10223,10243,10247,10253,10259,10267,10271,10273,10289,10301,10303,10313,10321,10331,10333,10337,10343,10357,10369,10391,10399,10427,10429,10433,10453,10457,10459,10463,10477,10487,10499,10501,10513,10529,10531,10559,10567,10589,10597,10601,10607,10613,10627,10631,10639,10651,10657,10663,10667,10687,10691,10709,10711,10723,10729,10733,10739,10753,10771,10781,10789,10799,10831,10837,10847,10853,10859,10861,10867,10883,10889,10891,10903,10909,10937,10939,10949,10957,10973,10979,10987,10993,11003,11027,11047,11057,11059,11069,11071,11083,11087,11093,11113,11117,11119,11131,11149,11159,11161,11171,11173,11177,11197,11213,11239,11243,11251,11257,11261,11273,11279,11287,11299,11311,11317,11321,11329,11351,11353,11369,11383,11393,11399,11411,11423,11437,11443,11447,11467,11471,11483,11489,11491,11497,11503,11519,11527,11549,11551,11579,11587,11593,11597,11617,11621,11633,11657,11677,11681,11689,11699,11701,11717,11719,11731,11743,11777,11779,11783,11789,11801,11807,11813,11821,11827,11831,11833,11839,11863,11867,11887,11897,11903,11909,11923,11927,11933,11939,11941,11953,11959,11969,11971,11981,11987,12007,12011,12037,12041,12043,12049,12071,12073,12097,12101,12107,12109,12113,12119,12143,12149,12157,12161,12163,12197,12203,12211,12227,12239,12241,12251,12253,12263,12269,12277,12281,12289,12301,12323,12329,12343,12347,12373,12377,12379,12391,12401,12409,12413,12421,12433,12437,12451,12457,12473,12479,12487,12491,12497,12503,12511,12517,12527,12539,12541,12547,12553,12569,12577,12583,12589,12601,12611,12613,12619,12637,12641,12647,12653,12659,12671,12689,12697,12703,12713,12721,12739,12743,12757,12763,12781,12791,12799,12809,12821,12823,12829,12841,12853,12889,12893,12899,12907,12911,12917,12919,12923,12941,12953,12959,12967,12973,12979,12983,13001,13003,13007,13009,13033,13037,13043,13049,13063,13093,13099,13103,13109,13121,13127,13147,13151,13159,13163,13171,13177,13183,13187,13217,13219,13229,13241,13249,13259,13267,13291,13297,13309,13313,13327,13331,13337,13339,13367,13381,13397,13399,13411,13417,13421,13441,13451,13457,13463,13469,13477,13487,13499,13513,13523,13537,13553,13567,13577,13591,13597,13613,13619,13627,13633,13649,13669,13679,13681,13687,13691,13693,13697,13709,13711,13721,13723,13729,13751,13757,13759,13763,13781,13789,13799,13807,13829,13831,13841,13859,13873,13877,13879,13883,13901,13903,13907,13913,13921,13931,13933,13963,13967,13997,13999,14009,14011,14029,14033,14051,14057,14071,14081,14083,14087,14107,14143,14149,14153,14159,14173,14177,14197,14207,14221,14243,14249,14251,14281,14293,14303,14321,14323,14327,14341,14347,14369,14387,14389,14401,14407,14411,14419,14423,14431,14437,14447,14449,14461,14479,14489,14503,14519,14533,14537,14543,14549,14551,14557,14561,14563,14591,14593,14621,14627,14629,14633,14639,14653,14657,14669,14683,14699,14713,14717,14723,14731,14737,14741,14747,14753,14759,14767,14771,14779,14783,14797,14813,14821,14827,14831,14843,14851,14867,14869,14879,14887,14891,14897,14923,14929,14939,14947,14951,14957,14969,14983,15013,15017,15031,15053,15061,15073,15077,15083,15091,15101,15107,15121,15131,15137,15139,15149,15161,15173,15187,15193,15199,15217,15227,15233,15241,15259,15263,15269,15271,15277,15287,15289,15299,15307,15313,15319,15329,15331,15349,15359,15361,15373,15377,15383,15391,15401,15413,15427,15439,15443,15451,15461,15467,15473,15493,15497,15511,15527,15541,15551,15559,15569,15581,15583,15601,15607,15619,15629,15641,15643,15647,15649,15661,15667,15671,15679,15683,15727,15731,15733,15737,15739,15749,15761,15767,15773,15787,15791,15797,15803,15809,15817,15823,15859,15877,15881,15887,15889,15901,15907,15913,15919,15923,15937,15959,15971,15973,15991,16001,16007,16033,16057,16061,16063,16067,16069,16073,16087,16091,16097,16103,16111,16127,16139,16141,16183,16187,16189,16193,16217,16223,16229,16231,16249,16253,16267,16273,16301,16319,16333,16339,16349,16361,16363,16369,16381,16411,16417,16421,16427,16433,16447,16451,16453,16477,16481,16487,16493,16519,16529,16547,16553,16561,16567,16573,16603,16607,16619,16631,16633,16649,16651,16657,16661,16673,16691,16693,16699,16703,16729,16741,16747,16759,16763,16787,16811,16823,16829,16831,16843,16871,16879,16883,16889,16901,16903,16921,16927,16931,16937,16943,16963,16979,16981,16987,16993,17011,17021,17027,17029,17033,17041,17047,17053,17077,17093,17099,17107,17117,17123,17137,17159,17167,17183,17189,17191,17203,17207,17209,17231,17239,17257,17291,17293,17299,17317,17321,17327,17333,17341,17351,17359,17377,17383,17387,17389,17393,17401,17417,17419,17431,17443,17449,17467,17471,17477,17483,17489,17491,17497,17509,17519,17539,17551,17569,17573,17579,17581,17597,17599,17609,17623,17627,17657,17659,17669,17681,17683,17707,17713,17729,17737,17747,17749,17761,17783,17789,17791,17807,17827,17837,17839,17851,17863];n.miller=r,n.isPrime=i,n.generate=o},{"bn.js":26}],257:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var BN=e("bn.js"),t=e("parse-asn1"),r=e("q"),i=e("./genrsa"),o=e("../crypto/R"),s=Buffer.from("da39a3ee5e6b4b0d3255bfef95601890afd80709","hex"),a=Buffer.from([0,1]),u=Buffer.from([0]),c=Buffer.from("3031300d060960864801650304020105000420","hex"),f=function(){function e(){}return e.rsaOaepEncrypt=function(n,r,i){return o.R(function(){var o=t(r);return Buffer.isBuffer(i)||(i=Buffer.from(i)),e.oaepEncrypt(n,o,i)})},e.rsaOaepDecrypt=function(n,r,i){return o.R(function(){var o=t(r);return Buffer.isBuffer(i)||(i=Buffer.from(i)),e.oaepDecrypt(n,o,i)})},e.rsaSign=function(n,r,i){return o.R(function(){var o=t(r);return Buffer.isBuffer(i)||(i=Buffer.from(i)),e.sign(n,o,i)})},e.rsaVerify=function(n,r,i,s){return o.R(function(){var o=t(r);return Buffer.isBuffer(s)||(s=Buffer.from(s)),e.verify(n,o,i,s)})},e.encrypt=function(e,t){var n=e.modulus.byteLength();if(t.length>n)throw new Error("data too long");var r=new BN(t);if(r.gte(e.modulus))throw new Error("data too long");var i=new BN(r).toRed(BN.red(e.modulus)).redPow(e.publicExponent).fromRed();return i.toArrayLike(Buffer,"be",n)},e.decrypt=function(e,t){var n=e.modulus.byteLength();if(t.length>n)throw new Error("data too long");var r=new BN(t);if(r.gte(e.modulus))throw new Error("data too long");if(!e.exponent1||!e.exponent2||!e.coefficient){var i=r.toRed(BN.red(e.modulus)).redPow(e.privateExponent).fromRed();return i.toArrayLike(Buffer,"be",n)}e.pred||(e.pred=BN.red(e.prime1)),e.qred||(e.qred=BN.red(e.prime2));var o=r.toRed(e.pred).redPow(e.exponent1),s=r.toRed(e.qred).redPow(e.exponent2),a=o.sub(s);return a.isNeg()?(a=a.neg(),a=a.mul(e.coefficient).mod(e.prime1),a=e.prime1.sub(a)):a=a.mul(e.coefficient).mod(e.prime1),a=s.add(e.prime2.mul(a)),a.toArrayLike(Buffer,"be",n)},e.mgf1=function(e,t,n){var r=[];return o.R(function(){var i=0,s=0,a=function(){if(!(i>=n)){var u=Buffer.alloc(4);return u.writeInt32BE(s,0),o.R(function(){return e.sha1(Buffer.concat([t,u]))}).then(function(e){return s++,r.push(e),i+=e.length,a()})}};return a()}).then(function(){return Buffer.concat(r)})},e.mgf1_xor=function(e,t,n){return o.R(function(){var r=n.length,i=0,s=0,a=function(){if(!(i>=r)){var u=Buffer.alloc(4);return u.writeInt32BE(s,0),o.R(function(){return e.sha1(Buffer.concat([t,u]))}).then(function(e){s++;var t;for(t=0;t<e.length&&i<r;++t,++i)n[i]^=e[t];return a()})}};return a()}).then(function(){return n})},e.timingSafeEqual=function(e,t){for(var n=e.length==t.length,r=e.length<t.length?e.length:t.length,i=0;i<r;++i)n=n&&e[i]==t[i];return n},e.oaepEncrypt=function(t,n,r){var i,a;return o.R(function(){var o=n.modulus.byteLength(),u=20;return i=t.randomBytes(u),a=Buffer.alloc(o-u-1,0),s.copy(a,0),r.copy(a,o-u-1-r.length),a[o-u-1-r.length-1]=1,e.mgf1_xor(t,i,a)}).then(function(){return e.mgf1_xor(t,a,i)}).then(function(){var t=Buffer.concat([Buffer.alloc(1,0),i,a]);return e.encrypt(n,t)})},e.oaepDecrypt=function(t,n,r){var i,a,u,c;return o.R(function(){var o=e.decrypt(n,r);return c=0==o[0],u=20,i=o.slice(1,1+u),a=o.slice(1+u),e.mgf1_xor(t,a,i)}).then(function(){return e.mgf1_xor(t,i,a)}).then(function(){for(var t=a.slice(0,u),n=-1,r=u+1;r<a.length;++r)1==a[r]&&n<0&&(n=r);n<0&&(c=!1);var i=s;if(e.timingSafeEqual(t,i)||(c=!1),!c)throw new Error("Invalid cipher");return a=a.slice(n+1)})},e.sign=function(t,n,r){return o.R(function(){return t.sha256(r)}).then(function(t){var r=n.modulus.byteLength(),i=c,o=Buffer.alloc(r-i.length-t.length-3,255),s=Buffer.concat([a,o,u,i,t]);return e.decrypt(n,s)})},e.verify=function(t,n,r,i){return o.R(function(){return t.sha256(i)}).then(function(t){var i=n.modulus.byteLength(),o=c,s=e.encrypt(n,r);if(0!=s[0]||1!=s[1])return!1;for(var a=i-t.length-o.length,u=2;u<a-1;++u)if(0==s[u])return!1;return 0==s[a-1]&&(0==o.compare(s,a,a+o.length)&&0==t.compare(s,a+o.length))})},e}();n.RsaBrowserBase=f;var l=function(){function e(e){this.service=e}return e.prototype.rsaGenerateKey=function(e){return r(i.generateKey(this.service,e))},e.prototype.rsaOaepEncrypt=function(e,t){return f.rsaOaepEncrypt(this.service,e,t).async()},e.prototype.rsaOaepDecrypt=function(e,t){return f.rsaOaepDecrypt(this.service,e,t).async()},e.prototype.rsaSign=function(e,t){return f.rsaSign(this.service,e,t).async()},e.prototype.rsaVerify=function(e,t,n){return f.rsaVerify(this.service,e,t,n).async()},e}();n.RsaBrowser=l}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"./genrsa":254,"bn.js":26,buffer:590,"parse-asn1":140,q:327}],258:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("../openssl/openssl-utils"),r=e("./genrsa"),i=e("crypto"),o=e("q"),s=e("../crypto/R"),a=4,u=function(){function e(){}return e.rsaOaepEncrypt=function(e,t){return Buffer.isBuffer(t)||(t=Buffer.from(t)),i.publicEncrypt({key:e,padding:a},t)},e.rsaOaepDecrypt=function(e,t){return Buffer.isBuffer(t)||(t=Buffer.from(t)),i.privateDecrypt({key:e,padding:a},t)},e.rsaSign=function(e,n){var r=t.parsePem(e);if(!r||"PRIVATE KEY"!=r.name)throw new Error("Invalid 'key' argument");var o=i.createSign("RSA-SHA256");return o.write(n),o.sign(e)},e.rsaVerify=function(e,n,r,o){return s.R(function(){var r=t.parsePem(n);return r&&"PRIVATE KEY"==r.name?s.R(function(){return e.extractPublicKey(n)}).then(function(e){return t.parsePem(e)}):r}).then(function(e){if(!e||"PUBLIC KEY"!=e.name)throw new Error("Invalid 'key' argument");var t=i.createVerify("RSA-SHA256");return t.write(o),t.verify(n,r)})},e}();n.RsaCryptoBase=u;var c=function(){function e(e){this.service=e}return e.prototype.rsaGenerateKey=function(e){return o(r.generateKey(this.service,e))},e.prototype.rsaOaepEncrypt=function(e,t){return o(u.rsaOaepEncrypt(e,t))},e.prototype.rsaOaepDecrypt=function(e,t){return o(u.rsaOaepDecrypt(e,t))},e.prototype.rsaSign=function(e,t){return o(u.rsaSign(e,t))},e.prototype.rsaVerify=function(e,t,n){return u.rsaVerify(this.service,e,t,n).async()},e}();n.RsaCrypto=c}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"../openssl/openssl-utils":253,"./genrsa":254,buffer:590,crypto:602,q:327}],259:[function(e,t,n){(function(Buffer){"use strict";function t(e){return e}n.__esModule=!0;var r=e("../openssl/openssl-utils"),i=e("q"),o=e("../crypto/R"),s="object"==typeof window&&window.crypto,a=function(){function e(e){this.service=e}return e.prototype.isSupported=function(){if(!s||!s.subtle||!s.subtle.generateKey)return!1;var e="-----BEGIN PRIVATE KEY-----\nMIIBVQIBADANBgkqhkiG9w0BAQEFAASCAT8wggE7AgEAAkEA0CGzPfzAL1Q+FnDZ\nKfsHb+T81YK6oN4LPLTFelcPQFmWvzteezi8xulmN9mQ+D6MztuPZr0kUyU+5ce6\nAdQJkQIDAQABAkBIovpDL+qCmgvxGQExPYKi8m+qtC0d52BUl2I0CB4yfnBjuljI\nnpuPBRqGDubD1M/8VGnbMxASTBOjCvg7LEhhAiEA8rbgA+tWaEEoLJP/UJ8EnImy\n5Jw8ABb++avKYQl9yo8CIQDbhjjUZS3yO218fgzJ2qnpoZs2H1XERpRXJQ1trM15\n3wIgDE9yNUCudUM4wmoPPQuTtEzXofi6olaIQCmSbjGJC8kCIQCDiHTcrpNNJNaB\nVXWMLPzKBA7f6v6U0EVpwcW+BWBIuQIhANGvd79Hg0cK79nGBYLc+byidnaX1Pb6\nEwYWFXU/a9Yt\n-----END PRIVATE KEY-----",t=Buffer.from("Xp5uW0NY8bvNJRXS0KSVXXZzMpqdwrWmQrx3f9SArsdBKcGguI030dB8FcIZD6OuGinfRKFDX5NsudI/wHb7xA==","base64");return this.rsaOaepDecrypt(e,t).timeout(100).then(function(e){return"abcd"==e.toString()})["catch"](function(){return!1})},e.prototype.rsaGenerateKey=function(e){return i().then(function(){var n={name:"RSA-OAEP",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}};return t(s.subtle.generateKey(n,!0,["encrypt","decrypt"]).then(function(e){return s.subtle.exportKey("pkcs8",e.privateKey)}).then(function(e){return"-----BEGIN PRIVATE KEY-----\n"+r.chunk(Buffer.from(e).toString("base64"),64)+"-----END PRIVATE KEY-----"}))})},e.prototype.rsaOaepEncrypt=function(e,n){var a=this,u={name:"RSA-OAEP",hash:{name:"SHA-1"}};return i().then(function(){var t=r.parsePem(e);return t&&"PRIVATE KEY"==t.name?o.R(function(){return a.service.extractPublicKey(e)}).then(function(e){return r.parsePem(e)}).async():t}).then(function(e){if(!e||"PUBLIC KEY"!=e.name)throw new Error("Invalid 'key' argument");return t(s.subtle.importKey("spki",e.data.buffer,u,!1,["encrypt"]).then(function(e){return s.subtle.encrypt(u,e,n.buffer)}).then(function(e){return Buffer.from(e)}))})},e.prototype.rsaOaepDecrypt=function(e,n){var o={name:"RSA-OAEP",hash:{name:"SHA-1"}};return i().then(function(){var i=r.parsePem(e);if(!i||"PRIVATE KEY"!=i.name)throw new Error("Invalid 'key' argument");return t(s.subtle.importKey("pkcs8",i.data.buffer,o,!1,["decrypt"]).then(function(e){return s.subtle.decrypt(o,e,n.buffer)}).then(function(e){return Buffer.from(e)}))})},e.prototype.rsaSign=function(e,n){var o={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};return i().then(function(){var i=r.parsePem(e);if(!i||"PRIVATE KEY"!=i.name)throw new Error("Invalid 'key' argument");return t(s.subtle.importKey("pkcs8",i.data.buffer,o,!1,["sign"]).then(function(e){return s.subtle.sign(o,e,n.buffer)}).then(function(e){return Buffer.from(e)}))})},e.prototype.rsaVerify=function(e,n,a){var u=this,c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};return i().then(function(){var t=r.parsePem(e);return t&&"PRIVATE KEY"==t.name?o.R(function(){return u.service.extractPublicKey(e)}).then(function(e){return r.parsePem(e)}).async():t}).then(function(e){if(!e||"PUBLIC KEY"!=e.name)throw new Error("Invalid 'key' argument");return t(s.subtle.importKey("spki",e.data.buffer,c,!1,["verify"]).then(function(e){return s.subtle.verify(c,e,n.buffer,a.buffer)}))})},e}();n.RsaSubtle=a}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"../openssl/openssl-utils":253,buffer:590,q:327}],260:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var BN=e("bn.js"),r=e("../crypto/R"),i=function(){function e(){}return e.get_a=function(e){return new BN(e.randomBytes(64))},e.get_b=function(e){return new BN(e.randomBytes(64))},e.get_s=function(e){return e.randomBytes(16)},e.get_k=function(e,t,n){return e.HBN(Buffer.concat([e.PAD(t,t),e.PAD(n,t)]))},e.get_v=function(e,t,n){var r=BN.red(t);return e.toRed(r).redPow(n).fromRed()},e.get_x=function(e,t,n,i){return r.R(function(){return e.H(new Buffer(n+":"+i,"utf8"))}).then(function(n){return e.HBN(Buffer.concat([t,n]))})},e.get_A=function(e,t,n){var r=BN.red(t);return e=e.toRed(r),e.redPow(n).fromRed()},e.get_B=function(e,t,n,r,i){var o=BN.red(t);return n=n.toRed(o),i=i.toRed(o),e=e.toRed(o),n.redMul(i).redAdd(e.redPow(r)).fromRed()},e.get_u=function(e,t,n,r){return e.HBN(Buffer.concat([e.PAD(t,r),e.PAD(n,r)]))},e.getClient_S=function(e,t,n,r,i,o,s){var a=BN.red(s);return e=e.toRed(a),t=t.toRed(a),n=n.toRed(a),e.redSub(t.redMul(n)).redPow(r.add(i.mul(o))).fromRed()},e.getServer_S=function(e,t,n,r,i){var o=BN.red(i);return e=e.toRed(o),t=t.toRed(o),e.redMul(t.redPow(n)).redPow(r).fromRed()},e.get_M1=function(e,t,n,r,i){return e.HBN(Buffer.concat([e.PAD(t,i),e.PAD(n,i),e.PAD(r,i)]))},e.get_M2=function(e,t,n,r,i){return e.HBN(Buffer.concat([e.PAD(t,i),e.PAD(n,i),e.PAD(r,i)]))},e.get_K=function(e,t,n){return e.HBN(e.PAD(t,n))},e.valid_A=function(e,t){return e.mod(t).eqn(0)===!1},e.valid_B=function(e,t){return e.mod(t).eqn(0)===!1},e.register=function(e,t,n,i,o,s){return r.R(function(){return e.get_x(s,i,o)}).then(function(r){var i=e.get_v(n,t,r);return{s:s,v:i}})},e.registerEx=function(e,t,n,r,i){return e.register(t,n,r,i,e.get_s())},e.server_init=function(e,t,n,i,o){return r.R(function(){return e.get_k(t,n)}).then(function(r){var s=e.get_B(n,t,r,o,i);return{b:o,B:s}})},e.server_initEx=function(e,t,n,r){return e.server_init(t,n,r,e.get_b())},e.server_exchange=function(e,t,n,i,o,s,a,u){var c,f,l;return r.R(function(){return e.get_u(i,a,t)}).then(function(n){return c=n,f=e.getServer_S(i,s,c,u,t),e.get_M2(i,o,f,t)}).then(function(n){return l=n,e.get_K(f,t)}).then(function(e){return{S:f,u:c,K:e,M2:l}})},e.login_step1=function(e,t,n,i,o,s,a,u){var c,f,l,h,p,d,g,y;return r.R(function(){if(!e.valid_B(o,t))throw new Error("InvalidBException");return e.get_k(t,n)}).then(function(r){return c=r,f=e.get_A(n,t,u),e.get_x(i,s,a)}).then(function(r){return l=r,h=e.get_v(n,t,l),e.get_u(f,o,t)}).then(function(n){return p=n,d=e.getClient_S(o,c,h,u,p,l,t),e.get_M1(f,o,d,t)}).then(function(n){return g=n,e.get_K(d,t)}).then(function(n){return y=n,e.get_M2(f,g,d,t)}).then(function(e){return{A:f,u:p,S:d,K:y,M1:g,M2:e}})},e.login_step1Ex=function(e,t,n,r,i,o,s){return e.login_step1(t,n,r,i,o,s,e.get_a())},e.login_step2=function(e,t){if(!e.eq(t))throw new Error("DifferentM2Exception - "+e+", "+t)},e}();n.SrpLogicBase=i;var o=function(){function e(e,t){this.service=e,this.hash=t}return e.prototype.PAD=function(e,t){return e.toArrayLike(Buffer,"be",t.byteLength());
},e.prototype.H=function(e){var t=this;return r.R(function(){return t.service.hash(t.hash,e)})},e.prototype.HBN=function(e){var t=this;return r.R(function(){return t.H(e)}).then(function(e){return new BN(e)})},e.prototype.get_k=function(e,t){return i.get_k(this,e,t)},e.prototype.get_v=function(e,t,n){return i.get_v(e,t,n)},e.prototype.get_x=function(e,t,n){return i.get_x(this,e,t,n)},e.prototype.get_A=function(e,t,n){return i.get_A(e,t,n)},e.prototype.get_B=function(e,t,n,r,o){return i.get_B(e,t,n,r,o)},e.prototype.get_u=function(e,t,n){return i.get_u(this,e,t,n)},e.prototype.getClient_S=function(e,t,n,r,o,s,a){return i.getClient_S(e,t,n,r,o,s,a)},e.prototype.getServer_S=function(e,t,n,r,o){return i.getServer_S(e,t,n,r,o)},e.prototype.get_M1=function(e,t,n,r){return i.get_M1(this,e,t,n,r)},e.prototype.get_M2=function(e,t,n,r){return i.get_M2(this,e,t,n,r)},e.prototype.get_K=function(e,t){return i.get_K(this,e,t)},e.prototype.valid_A=function(e,t){return i.valid_A(e,t)},e.prototype.valid_B=function(e,t){return i.valid_B(e,t)},e.prototype.register=function(e,t,n,r,o){return i.register(this,e,t,n,r,o)},e.prototype.server_init=function(e,t,n,r){return i.server_init(this,e,t,n,r)},e.prototype.server_exchange=function(e,t,n,r,o,s,a){return i.server_exchange(this,e,t,n,r,o,s,a)},e.prototype.login_step1=function(e,t,n,r,o,s,a){return i.login_step1(this,e,t,n,r,o,s,a)},e.login_step2=function(e,t){return i.login_step2(e,t)},e}();n.SrpLogic=o;var s=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.service=t,r}return t(n,e),n.prototype.get_a=function(){return i.get_a(this.service)},n.prototype.get_b=function(){return i.get_b(this.service)},n.prototype.get_s=function(){return i.get_s(this.service)},n.prototype.registerEx=function(e,t,n,r){return i.registerEx(this,e,t,n,r)},n.prototype.server_initEx=function(e,t,n){return i.server_initEx(this,e,t,n)},n.prototype.login_step1Ex=function(e,t,n,r,o,s){return i.login_step1Ex(this,e,t,n,r,o,s)},n}(o);n.SrpLogicEx=s}).call(this,e("buffer").Buffer)},{"../crypto/R":227,"bn.js":26,buffer:590}],261:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./SrpLogic");n.SrpLogicBase=r.SrpLogicBase,n.SrpLogic=r.SrpLogic,n.SrpLogicEx=r.SrpLogicEx},{"./SrpLogic":260}],262:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){this.callbacks=[]}return e.prototype.add=function(e){this.callbacks.push(e)},e.prototype.remove=function(e){for(var t=0;t<this.callbacks.length;t++)if(this.callbacks[t]==e)return void this.callbacks.splice(t,1)},e.prototype.clear=function(){this.callbacks=[]},e.prototype.trigger=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0!=this.callbacks.length){var r=arguments;setTimeout(function(){e.callbacks.forEach(function(e){e.apply(null,r)})},1)}},e}();n.Event=r},{}],263:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e){this.valueGetter=e,this.cache={}}return e.prototype.get=function(e){if(e in this)return this.cache[e];if(null!=this.valueGetter){var t=this.valueGetter(this,e);if("undefined"!=typeof t)return this.cache[e]=t,this.cache[e]}throw new Error("Value under key '"+e+"' cannot be resolved")},e}();n.LazyMap=r},{}],264:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("../browserbuffer/BrowserBuffer"),r=e("privmx-exception"),i=r.IllegalArgumentException,o=e("../crypto/R"),s=function(){function e(){}return e.encrypt=function(e,t,n,r){return o.R(function(){var i=new Buffer(JSON.stringify(n),"utf8");return e.privmxEncrypt(t,i,r)})},e.decrypt=function(e,t,n,r){return o.R(function(){return e.privmxDecrypt(t,n,r)}).then(function(e){return JSON.parse(e.toString("utf8"))})},e}();n.ObjectEncryptorBase=s;var a=function(){function e(e,n,r,o){if(this.crypto=e,!t.BrowserBuffer.isBuffer(n)||32!=n.length)throw new i("key",n);Object.defineProperty(this,"key",{value:n,enumerable:!0}),this.encryptOptions=r||e.privmxOptAesWithSignature(),this.decryptOptions=o||e.privmxOptSignedCipher()}return e.prototype.encrypt=function(e){return s.encrypt(this.crypto,this.encryptOptions,e,this.key).async()},e.prototype.decrypt=function(e){return s.decrypt(this.crypto,this.decryptOptions,e,this.key).async()},e}();n.ObjectEncryptor=a}).call(this,e("buffer").Buffer)},{"../browserbuffer/BrowserBuffer":219,"../crypto/R":227,buffer:590,"privmx-exception":266}],265:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Event");n.Event=r.Event;var i=e("./LazyMap");n.LazyMap=i.LazyMap;var o=e("./ObjectEncryptor");n.ObjectEncryptor=o.ObjectEncryptor},{"./Event":262,"./LazyMap":263,"./ObjectEncryptor":264}],266:[function(e,t,n){t.exports={Exception:e("./src/Exception"),IllegalArgumentException:e("./src/IllegalArgumentException"),UnsupportedOperationException:e("./src/UnsupportedOperationException")}},{"./src/Exception":267,"./src/IllegalArgumentException":268,"./src/UnsupportedOperationException":269}],267:[function(e,t,n){function r(e,t,n){this.init(new Error(e),t,n)}r.prototype.init=function(e,t,n){var r=arguments.callee.caller.toString();this.name=r.substring(8,r.indexOf("(")).trim(),this.error=e,this.message=this.error.message,this.data=t,this.couse=n;for(var i=this.error&&this.error.stack?this.error.stack.toString().split("\n"):"",o=[],s=-1,a=0;a<i.length;a++){var u=i[a];""!=u.trim()&&(0!=u.indexOf("   ")&&(u="    "+u),s==-1&&u.indexOf(this.name)!=-1?o=[]:o.push(u))}this.stack=o.join("\n")},r.prototype.toString=function(){var e=this.name+(this.data?" (with additional data)":"")+": "+this.message+"\n"+this.stack;return this.couse&&(e+="\nCoused by: "+this.couse),e},r.prototype.printData=function(e){this.data&&e(this.name+" additional data",this.data),this.couse&&this.couse instanceof r&&this.couse.printData(e)},r.printer=console.log.bind(console),r.print=function(e,t){if(t=t||r.printer,e instanceof r)t(e.toString()),e.printData(t);else if(e instanceof Error)if(e.stack){for(var n=e.toString().trim(),i=e.stack.toString().split("\n"),o=[],s=0;s<i.length;s++){var a=i[s];""!=a.trim()&&a.trim()!=n&&(0!=a.indexOf("   ")&&(a="    "+a),o.push(a))}t(n+"\n"+o.join("\n"))}else t(e.toString());else t(e)},t.exports=r},{}],268:[function(e,t,n){function r(e,t){this.init(new Error(e),t)}var i=e("./Exception");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./Exception":267}],269:[function(e,t,n){function r(){this.init(new Error(""))}var i=e("./Exception");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./Exception":267}],270:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./ErrorCodes"),r=function(){function e(n,r){if(void 0===r&&(r=-1),n instanceof e?this.value=n.value:n instanceof Buffer?this.value=n:this.value=new Buffer(n,"binary"),this._length=r==-1?8*this.value.length:r,this.length>8*this.value.length)throw{msg:"Incorrect length",value:{length:this.length,max:8*this.value.length},code:t.ErrorCodes.INVALID_DATA}}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.bytes=function(){var e=1+(this.length-1>>3),t=new Buffer(e);return this.value.copy(t,0,0,e),7&this.length&&(t[e-1]&=255^255>>(7&this.length)),t},e.prototype.encode=function(){var e=8-(7&this.length)&7;return Buffer.concat([this.bytes(),Buffer.from([e])])},e.prototype.prefix=function(n){if(this.length==n)return this;if(this.length<n)throw{msg:"Too short for prefix",value:{value:n,max:this.length},code:t.ErrorCodes.INVALID_DATA};return new e(this,n)},e.prototype.bit=function(e){if(e>=this.length)throw{msg:"Value is too short",value:{position:e,max:this.length-1},code:t.ErrorCodes.INVALID_DATA};var n=e>>3,r=1<<7-(7&e);return 0!=(this.value[n]&r)},e.prototype.equals=function(e){if(this===e)return!0;if(e.length!=this.length)return!1;for(var t=0;t<this.length;++t)if(this.bit(t)!=e.bit(t))return!1;return!0},e.prototype.isPrefixOf=function(e){if(this===e)return!0;if(e.length<this.length)return!1;for(var t=0;t<this.length;++t)if(this.bit(t)!=e.bit(t))return!1;return!0},e.decode=function(t){var n=t.length-1;if(n<=0)return new e("",0);var r=t[n],i=8*n-r;return new e(t,i)},e}();n["default"]=r}).call(this,e("buffer").Buffer)},{"./ErrorCodes":274,buffer:590}],271:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("pson"),r=e("q"),i=e("simplito-logger"),o=function(){function e(){this.map={}}return e.prototype.load=function(e){return r(this.map[e])},e.prototype.save=function(e,t){return this.map[e]=t,r(!0)},e}();n.MemoryCache=o;var s=function(){function e(){this.encoder=null,this.keyCache={},this.keyMangler=function(e){return r.resolve(e)},this.storage=null,this.logger=i.get("dbchain.Cache");try{"undefined"!=typeof localStorage&&this.setStorage(localStorage)}catch(e){}}return e.prototype.setStorage=function(e){this.storage=e},e.prototype.setKeyMangler=function(e){this.keyMangler=e},e.prototype.key=function(e){var t=this;return this.keyCache[e]?r.resolve(this.keyCache[e]):this.keyMangler(e).then(function(n){return n!==e&&(t.keyCache[e]=n),n})},e.prototype.getEncoder=function(){return null===this.encoder&&(this.encoder=new t.StaticPair),this.encoder},e.prototype.save=function(e,t){var n=this;return this.logger.debug("save",e),this.key(e).then(function(r){var i=n.getEncoder().encode(t);return n.logger.debug("save encode",e,i),n.storage.setItem(r,i.toBinary())}).then(function(e){return!0},function(e){return!1})},e.prototype.load=function(e){var t=this;return this.logger.debug("load",e),this.key(e).then(function(e){return t.storage.getItem(e)}).then(function(n){return t.logger.debug("load",e,n),null===n?null:t.getEncoder().decode(Buffer.from(n,"binary"))},function(e){return null})},e.prototype.remove=function(e){var t=this;return this.key(e).then(function(e){return t.storage.removeItem(e)})},e.prototype.clear=function(){if(this.storage&&"function"==typeof this.storage.clear)return this.storage.clear()},e}();n.StorageCache=s}).call(this,e("buffer").Buffer)},{buffer:590,pson:326,q:327,"simplito-logger":357}],272:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("q"),o=function(){function e(){}return e.prototype.selectCosigners=function(e){var t=null==e?this.getDefaultSelectCount():e;return this.getAllCosigners().then(function(e){var n=Object.keys(e);if(t<=0||n.length<=t)return e;for(var r={},i=0;i<t;++i){var o=Math.floor(Math.random()*n.length),s=n[o];r[s]=e[s],n.splice(o,1)}return r})},e}();n.BaseCosignersProvider=o;var s=function(e){function t(t,n){var r=e.call(this)||this;return r.cosigners=t,r.defaultSelectCount=n,r}return r(t,e),t.prototype.getDefaultSelectCount=function(){return this.defaultSelectCount},t.prototype.getAllCosigners=function(){return i(this.cosigners)},t}(o);n.CosignersProvider=s},{q:327}],273:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.forEach=function(e){for(var t=this.getEnumerator();t.hasNext();)e(t.next())},e.prototype.indexOf=function(e){for(var t=0,n=this.getEnumerator();n.hasNext();){var r=n.next();if(e(r))return t;t++}return-1},e.prototype.find=function(e){for(var t=this.getEnumerator();t.hasNext();){var n=t.next();if(e(n))return n}},e.prototype.findAll=function(e){return new u(this,e)},e.prototype.takeFirstNotNull=function(e){for(var t=this.getEnumerator();t.hasNext();){var n=e(t.next());if(null!=n)return n}},e.prototype.map=function(e){return new s(this,e)},e.prototype.max=function(e){for(var t=!1,n=void 0,r=this.getEnumerator();r.hasNext();){var i=r.next();(!t||e(n,i)<0)&&(t=!0,n=i)}return n},e.prototype.min=function(e){return this.max(function(t,n){return-e(t,n)})},e.prototype.contains=function(e){for(var t=this.getEnumerator();t.hasNext();){var n=t.next();if(e(n))return!0}return!1},e.prototype.containsValue=function(e){for(var t=this.getEnumerator();t.hasNext();)if(t.next()===e)return!0;return!1},e.prototype.allPass=function(e){return!this.contains(function(t){return!e(t)})},e.prototype.empty=function(){var e=this.getEnumerator();return!e.hasNext()},e.prototype.length=function(){for(var e=0,t=this.getEnumerator();t.hasNext();)t.next(),e++;return e},e.prototype.sort=function(e){var t=this.toArray();return t.sort(e),new f(t)},e.prototype.toArray=function(){for(var e=[],t=this.getEnumerator();t.hasNext();)e.push(t.next());return e},e.prototype.first=function(){var e=this.getEnumerator();return e.hasNext()?e.next():void 0},e.prototype.last=function(){for(var e=void 0,t=this.getEnumerator();t.hasNext();)e=t.next();return e},e.prototype.nth=function(e){if(!(e<0))for(var t=0,n=this.getEnumerator();n.hasNext();){var r=n.next();if(t==e)return r;t++}},e.prototype.firstOrDefault=function(e){var t=this.first();return void 0==t?e:t},e.prototype.lastOrDefault=function(e){var t=this.last();return void 0==t?e:t},e.prototype.nthOrDefault=function(e,t){var n=this.nth(e);return void 0==n?t:n},e.prototype.save=function(){return new f(this.toArray())},e}();n.BaseEnumerable=i;var o=function(){function e(e,t){this.enumerator=e,this.mapper=t}return e.prototype.next=function(){return this.mapper(this.enumerator.next())},e.prototype.hasNext=function(){return this.enumerator.hasNext()},e}();n.MapEnumerator=o;var s=function(e){function t(t,n){var r=e.call(this)||this;return r.enumerable=t,r.mapper=n,r}return r(t,e),t.prototype.getEnumerator=function(){return new o(this.enumerable.getEnumerator(),this.mapper)},t.prototype.empty=function(){return this.enumerable.empty()},t.prototype.length=function(){return this.enumerable.length()},t.prototype.first=function(){var e=this.enumerable.first();return void 0===e?void 0:this.mapper(e)},t.prototype.last=function(){var e=this.enumerable.last();return void 0===e?void 0:this.mapper(e)},t.prototype.nth=function(e){var t=this.enumerable.nth(e);return void 0===t?void 0:this.mapper(t)},t}(i);n.MapEnumerable=s;var a=function(){function e(e,t){this.enumerator=e,this.finder=t,this.consumed=!0}return e.prototype.prepareNextValue=function(){if(this.consumed)for(this.consumed=!1,this.hasNextValue=!1,this.current=null;this.enumerator.hasNext();){var e=this.enumerator.next();if(this.finder(e))return this.hasNextValue=!0,void(this.current=e)}},e.prototype.next=function(){return this.prepareNextValue(),this.consumed=!0,this.current},e.prototype.hasNext=function(){return this.prepareNextValue(),this.hasNextValue},e}();n.FindAllEnumerator=a;var u=function(e){function t(t,n){var r=e.call(this)||this;return r.enumerable=t,r.finder=n,r}return r(t,e),t.prototype.getEnumerator=function(){return new a(this.enumerable.getEnumerator(),this.finder)},t}(i);n.FindAllEnumerable=u;var c=function(){function e(e,t){this.array=e,this.index=t}return e.prototype.next=function(){return this.array[this.index++]},e.prototype.hasNext=function(){return this.index<this.array.length},e}();n.ArrayEnumerator=c;var f=function(e){function t(t){var n=e.call(this)||this;return n.array=t,n}return r(t,e),t.prototype.getEnumerator=function(){return new c(this.array,0)},t.prototype.containsValue=function(e){return this.array.indexOf(e)!=-1},t.prototype.empty=function(){return 0==this.array.length},t.prototype.length=function(){return this.array.length},t.prototype.toArray=function(){return[].concat(this.array)},t.prototype.first=function(){return this.array[0]},t.prototype.last=function(){return this.array[this.array.length-1]},t.prototype.nth=function(e){return this.array[e]},t}(i);n.ArrayEnumerable=f,n.$A=function(e){return new f(e)}},{}],274:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;!function(e){e[e.VERIFICATION_FAILURE=32769]="VERIFICATION_FAILURE",e[e.PARSE_FAILURE=32770]="PARSE_FAILURE",e[e.RPC_FAILURE=32771]="RPC_FAILURE",e[e.UNSUPPORTED_FEATURE=32772]="UNSUPPORTED_FEATURE",e[e.INVALID_DATA=32773]="INVALID_DATA"}(r=n.ErrorCodes||(n.ErrorCodes={}))},{}],275:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("../ErrorCodes"),i=e("../Utils"),o=e("../Types"),s=function(){function e(){}return e.create=function(t,n){var r=new e;return r.hash=t,r.data=n,r},e.prototype.serialize=function(){var e=1+this.hash.length+this.data.length,n=new i.BufferOutputStream(new Buffer(e),0);return n.writeOneOctetLengthBuffer(this.hash),n.writeBuffer(this.data),t.Packet.encode(n.buffer,o.keystore.PacketTag.ATTACHMENT_DATA)},e.deserialize=function(n){return e.deserializeFromPacket(t.Packet.decodeSinglePacket(n))},e.deserializeFromPacket=function(t){if(t.tag!==o.keystore.PacketTag.ATTACHMENT_DATA)throw{msg:"Incorrect tag for AttachmentDataPacket packet",value:t.tag,code:r.ErrorCodes.PARSE_FAILURE};var n=new e,s=new i.BufferInputStream(t.body);return n.hash=s.readOneOctetLengthBuffer(),n.data=s.readBufferUntilEnd(),n},e.prototype.validate=function(){return!0},e}();n.AttachmentDataPacket=s}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"../Utils":305,"./Packet":285,buffer:590}],276:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("../ErrorCodes"),i=e("../Utils"),o=e("../Types"),s=function(){function e(){}return e.create=function(t,n,r){var i=new e;return i.fileName=t,i.date=Math.floor((new Date).getTime()/1e3),i.algorithm=r,i.hash=n,i},e.prototype.serialize=function(){var e=new Buffer(this.fileName,"utf8"),n=1+e.length+4+1+this.hash.length,r=new i.BufferOutputStream(new Buffer(n),0);return r.writeOneOctetLengthBuffer(e),r.writeUInt32BE(this.date),r.writeUInt8(this.algorithm),r.writeBuffer(this.hash),t.Packet.encode(r.buffer,o.keystore.PacketTag.ATTACHMENT_POINTER)},e.deserialize=function(n){return e.deserializeFromPacket(t.Packet.decodeSinglePacket(n))},e.deserializeFromPacket=function(t){if(t.tag!==o.keystore.PacketTag.ATTACHMENT_POINTER)throw{msg:"Incorrect tag for AttachmentPointerPacket packet",value:t.tag,code:r.ErrorCodes.PARSE_FAILURE};var n=new e,s=new i.BufferInputStream(t.body);return n.fileName=s.readOneOctetLengthBuffer().toString("utf8"),n.date=s.readUInt32BE(),n.algorithm=s.readUInt8(),n.hash=s.readBufferUntilEnd(),n},e.prototype.validate=function(){return!0},e}();n.AttachmentPointerPacket=s}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"../Utils":305,"./Packet":285,buffer:590}],277:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Types"),i=e("./AttachmentDataPacket"),o=e("./AttachmentPointerPacket"),s=e("../Utils"),a=e("../Enumerable"),u=function(){function e(){}return e.addAttachment=function(e,t,n){var u=a.$A(e.attachmentPointerList).indexOf(function(e){return e.fileName==t});if(u!=-1){var c=e.attachmentPointerList[u];e.attachmentPointerList.splice(u,1);var f=a.$A(e.attachmentDataList).indexOf(function(e){return e.hash.equals(c.hash)});f!=-1&&e.attachmentDataList.splice(f,1)}var l=r.keystore.HashAlgorithm.SHA256,h=s["default"].hashWithAlgorithm(n,l),p=o.AttachmentPointerPacket.create(t,h,l),d=i.AttachmentDataPacket.create(h,n);e.attachmentPointerList.push(p),e.attachmentDataList.push(d)},e.getAttachment=function(e,t){var n=a.$A(e.attachmentPointerList).find(function(e){return e.fileName==t});if(null==n)return null;var r=a.$A(e.attachmentDataList).find(function(e){return e.hash.equals(n.hash)});return null==r?null:r.data},e.validate=function(e){return a.$A(e.attachmentPointerList).allPass(function(e){return e.validate()&&e.hash.length==s["default"].hashLength(e.algorithm)})&&a.$A(e.attachmentDataList).allPass(function(t){var n=a.$A(e.attachmentPointerList).find(function(e){return e.hash.equals(t.hash)});return t.validate()&&null!=n&&s["default"].hashWithAlgorithm(t.data,n.algorithm).equals(t.hash)})},e.isValidToSave=function(t){return e.validate(t)&&a.$A(t.attachmentPointerList).allPass(function(e){return a.$A(t.attachmentDataList).contains(function(t){return t.hash.equals(e.hash)})})},e}();n.AttachmentsStorage=u},{"../Enumerable":273,"../Types":304,"../Utils":305,"./AttachmentDataPacket":275,"./AttachmentPointerPacket":276}],278:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Subpacket"),r=e("./Packet"),i=e("./KeyPair"),o=e("./PkiDataTypePacket"),s=e("../Enumerable"),a=e("../ErrorCodes"),u=e("../Types"),c=e("./AttachmentDataPacket"),f=e("./AttachmentPointerPacket"),l=e("./AttachmentsStorage"),h=function(){function e(e,t){this.primaryKey=e,this.keys=t,this.attachmentPointerList=[],this.attachmentDataList=[]}return e.prototype.addAttachment=function(e,t){return l.AttachmentsStorage.addAttachment(this,e,t)},e.prototype.getAttachment=function(e){return l.AttachmentsStorage.getAttachment(this,e)},e.prototype.getKeyById=function(e){return s.$A(this.keys).find(function(t){return t.getKeyId().equals(e)})},e.prototype.removePrivate=function(){s.$A(this.keys).forEach(function(e){return e.removePrivate()})},e.prototype.getPublicView=function(){var t=e.deserialize(this.serialize());return t.removePrivate(),t},e.prototype.hasAnyPrivate=function(){return s.$A(this.keys).contains(function(e){return e.hasPrivate()})},e.prototype.generateKis=function(e){if(null==this.primaryKey||null==this.getKeyById(this.primaryKey.getKeyId()))throw{msg:"Cannot use key",value:this.primaryKey,code:a.ErrorCodes.INVALID_DATA};var n=this.getPublicView(),r=n.serializeWithoutAttachmentsData();return this.primaryKey.sign({data:{msg:r},hashed:[new t["default"].ConiksDbIdSubpacket(e)]})},e.prototype.verifyKis=function(e){var t=this.getKeyById(e.getIssuerId());if(null==t)return!1;var n=this.getPublicView(),r=n.serializeWithoutAttachmentsData();return t.verify({msg:r},e)},e.prototype.serialize=function(){return Buffer.concat([].concat(this.serializeWithoutAttachmentsData(),s.$A(this.attachmentDataList).map(function(e){return e.serialize()}).toArray()))},e.prototype.serializeWithoutAttachmentsData=function(){return Buffer.concat([].concat(new o.PkiDataTypePacket(u.keystore.PkiDataType.DOCUMENT).serialize(),s.$A(this.keys).map(function(e){return e.serialize()}).toArray(),s.$A(this.attachmentPointerList).map(function(e){return e.serialize()}).toArray()))},e.deserialize=function(t){var n=r.Packet.decode(t),i=e.deserializeFromStream(n);if(n.hasCurrent())throw new Error("Unexpected packets "+n.current.tag);return i},e.deserializeFromStream=function(t){if(!t.hasCurrent())throw new Error("Expected pki data type packet");var n=o.PkiDataTypePacket.deserializeFromPacket(t.current);if(n.type!=u.keystore.PkiDataType.DOCUMENT)throw new Error("Invalid pki data type "+n.type);t.next();for(var r=new e(null,[]);t.hasCurrent();)if(i.KeyPair.isMainKeyTag(t.current.tag))r.keys.push(i.KeyPair.deserializeFromPacket(t.current)),t.next();else if(t.current.tag==u.keystore.PacketTag.ATTACHMENT_DATA)r.attachmentDataList.push(c.AttachmentDataPacket.deserializeFromPacket(t.current)),t.next();else{if(t.current.tag!=u.keystore.PacketTag.ATTACHMENT_POINTER)break;r.attachmentPointerList.push(f.AttachmentPointerPacket.deserializeFromPacket(t.current)),t.next()}return r},e.prototype.validate=function(){return this.keys.length>0&&l.AttachmentsStorage.validate(this)},e.prototype.isValidToSave=function(){return this.keys.length>0&&l.AttachmentsStorage.isValidToSave(this)},e}();n.DocumentsPacket=h}).call(this,e("buffer").Buffer)},{"../Enumerable":273,"../ErrorCodes":274,"../Types":304,"./AttachmentDataPacket":275,"./AttachmentPointerPacket":276,"./AttachmentsStorage":277,"./KeyPair":280,"./Packet":285,"./PkiDataTypePacket":287,"./Subpacket":290,buffer:590}],279:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("./Signature"),i=e("../ErrorCodes"),o=e("../Types"),s=e("create-hash"),a=e("elliptic"),u=function(){function e(e,t,n,r){this.keyPair=e,this.subkey=t,this.timestamp=n,this.kdf=r,this.subkey=!!this.subkey,this.timestamp||Math.floor((new Date).getTime()/1e3+.5)}return e.generate=function(t){return void 0===t&&(t="secp256k1"),new e(a.ec(t).genKeyPair())},e.prototype.getKeyId=function(){var e=this.getFingerprint();return e.slice(e.length-8)},e.prototype.getFingerprint=function(){var e=s("sha1");return e.update(this.getFingerprintUnhashed()),e.digest()},e.prototype.getFingerprintUnhashed=function(){var e=c.encodePublic(this);return Buffer.concat([new Buffer([153,e.length>>8&255,255&e.length]),e])},e.prototype.getKeyAlgorithm=function(){return this.hasKdf()?o.keystore.PublicKeyAlgorithm.ECDH:o.keystore.PublicKeyAlgorithm.ECDSA},e.prototype.sign=function(e){return r.Signature.create(e,this)},e.prototype.signRaw=function(e){return this.encodeEccSignature(this.signEcc(e))},e.prototype.verify=function(e,t){return t.verify(e,this)},e.prototype.verifyRaw=function(e,t){return this.verifyEcc(e,this.decodeEccSignature(t))},e.prototype.hasPrivate=function(){return null!=this.keyPair.getPrivate()},e.prototype.removePrivate=function(){if(this.hasPrivate()){var e=this.keyPair.getPublic();this.keyPair=this.keyPair.ec.keyFromPublic(e)}},e.prototype.getPublicView=function(){var e=f.KeyPair.deserialize(this.serialize());return e.removePrivate(),e},e.prototype.isSubkey=function(){return this.subkey},e.prototype.setSubkey=function(e){this.subkey=e},e.prototype.serialize=function(){return c.encode(this)},e.prototype.serializeWithArmor=function(){return c.encodeWithArmor(this)},e.prototype.getPublic=function(){return this.keyPair.getPublic()},e.prototype.getPublicBuffer=function(e){return new Buffer(this.keyPair.getPublic(!!e,"binary"))},e.prototype.getPrivate=function(){return this.keyPair.getPrivate()},e.prototype.getPrivateBinary=function(){return new Buffer(this.keyPair.getPrivate().toArray())},e.prototype.setPrivate=function(e){if(e=this.keyPair.ec.keyFromPrivate(e),!this.keyPair.getPublic().eq(e.getPublic()))throw{msg:"Private key doesn't match public",value:e,code:i.ErrorCodes.INVALID_DATA};this.keyPair=e},e.prototype.hasKdf=function(){return null!=this.kdf},e.prototype.verifyEcc=function(e,t){return this.keyPair.verify(e,t)},e.prototype.decodeEccSignature=function(e){var t=Math.ceil(e.readInt16BE(0)/8),n=e.slice(2,t+2),r=e.slice(t+2);t=Math.ceil(r.readInt16BE(0)/8);var i=r.slice(2,t+2);return{r:n,s:i}},e.prototype.signEcc=function(e){if(!this.hasPrivate())throw new Error("Cannot sign without private part");return this.keyPair.sign(e)},e.prototype.encodeEccSignature=function(e){var t=[],n=e.r.bitLength();return t.push(n>>8&255),t.push(255&n),t=t.concat(e.r.toArray()),n=e.s.bitLength(),t.push(n>>8&255),t.push(255&n),t=t.concat(e.s.toArray()),new Buffer(t)},e}();n.EccKeyPair=u;var c=function(){function e(){}return e.getCurveName=function(e){for(var t in a.curves)if(e.ec.curve==a.curves[t].curve)return t;throw new Error("Unknown curve")},e.ec2oid=function(t){t=t.toLowerCase();for(var n in e.oids)if(t===e.oids[n])return n;throw{msg:"Unknown elliptic curve name",value:t,code:i.ErrorCodes.INVALID_DATA}},e.oid2ec=function(t){if(t=t.toUpperCase(),!e.oids[t])throw{msg:"Unknown oid",value:t,code:i.ErrorCodes.INVALID_DATA};return e.oids[t]},e.deserialize=function(t,n,r,o,s){var c=s.readUInt8(6);s=s.slice(7);var f=s.slice(0,c).toString("hex"),l=e.oid2ec(f);s=s.slice(c),c=Math.ceil(s.readUInt16BE(0)/8),s=s.slice(2);var h=new a.ec(l),p=h.keyFromPublic(s.slice(0,c));s=s.slice(c);var d=null;if(o){if(3!==s[0]&&1!==s[1])throw{msg:"Incorrect KDF params",value:s,code:i.ErrorCodes.PARSE_FAILURE};d={hashAlgorithm:s.readUInt8(2),symmetricAlgorithm:s.readUInt8(3)},s=s.slice(4)}if(t){if(0!==s[0])throw{msg:"Unsupported S2K type",value:s[0],code:i.ErrorCodes.UNSUPPORTED_FEATURE};c=Math.ceil(s.readUInt16BE(1)/8);var g=h.keyFromPrivate(s.slice(3,c+3));if(!g.getPublic().eq(p.getPublic()))throw{msg:"Decoded private key doesn't match public",value:g,code:i.ErrorCodes.INVALID_DATA};p=g}var y=p.validate();if(!y.result)throw{msg:"Invalid public key",value:y,code:i.ErrorCodes.INVALID_DATA};return new u(p,n,r,d)},e.getPublicMpi=function(t){for(var n=t.getPublicBuffer(),r=8*n.length,i=7;i>0&&!(n[0]&1<<i);--i)--r;var o=new Buffer(e.ec2oid(e.getCurveName(t.keyPair)),"hex");return Buffer.concat([new Buffer([o.length]),o,new Buffer([r>>8&255,255&r]),n])},e.encodePublic=function(t){return Buffer.concat([f.KeyPair.serializeHeader(t.timestamp,t.getKeyAlgorithm()),e.getPublicMpi(t)])},e.encodeKDF=function(e){return new Buffer(e.hasKdf()?[3,1,e.kdf.hashAlgorithm,e.kdf.symmetricAlgorithm]:0)},e.encodeS2K=function(e){var t=e.getPrivate();if(null===t)return new Buffer(0);var n=t.bitLength(),r=[n>>8&255,255&n].concat(t.toArray()),i=r.reduce(function(e,t){return e=(e+t)%65536});return r.push(i>>8&255),r.push(255&i),new Buffer([0].concat(r))},e.getBody=function(t){return Buffer.concat([e.encodePublic(t),e.encodeKDF(t),e.encodeS2K(t)])},e.encode=function(n){return t.Packet.encode(e.getBody(n),f.KeyPair.getTag(n))},e.encodeWithArmor=function(n){return t.Packet.enarmor(e.encode(n),f.KeyPair.getArmor(n))},e.oids={"2B8104000A":"secp256k1","2B06010401DA470F01":"ed25519","2A8648CE3D030107":"p256","2B81040022":"p384","2B81040023":"p521"},e}();n.EccKeyPairSerializer=c;var f=e("./KeyPair")}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"./KeyPair":280,"./Packet":285,"./Signature":288,buffer:590,"create-hash":51,elliptic:56}],280:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("../Types"),r=e("../ErrorCodes"),i=e("./Packet"),o=function(){function e(){}return e.isValidTag=function(e){return e==t.keystore.PacketTag.SECRET_KEY||e===t.keystore.PacketTag.SECRET_SUBKEY||e==t.keystore.PacketTag.PUBLIC_KEY||e==t.keystore.PacketTag.PUBLIC_SUBKEY},e.isMainKeyTag=function(e){return e===t.keystore.PacketTag.SECRET_KEY||e==t.keystore.PacketTag.PUBLIC_KEY},e.isSubkeyTag=function(e){return e===t.keystore.PacketTag.SECRET_SUBKEY||e==t.keystore.PacketTag.PUBLIC_SUBKEY},e.isPrivateTag=function(e){return e===t.keystore.PacketTag.SECRET_KEY||e==t.keystore.PacketTag.SECRET_SUBKEY},e.isPublicTag=function(e){return e===t.keystore.PacketTag.PUBLIC_KEY||e==t.keystore.PacketTag.PUBLIC_SUBKEY},e.getArmor=function(e){return e.hasPrivate()?"PRIVATE KEY BLOCK":"PUBLIC KEY BLOCK"},e.getTag=function(e){return e.isSubkey()?e.hasPrivate()?t.keystore.PacketTag.SECRET_SUBKEY:t.keystore.PacketTag.PUBLIC_SUBKEY:e.hasPrivate()?t.keystore.PacketTag.SECRET_KEY:t.keystore.PacketTag.PUBLIC_KEY},e.deserialize=function(t){return e.deserializeFromPacket(i.Packet.decodeSinglePacket(t))},e.deserializeFromPacket=function(n){if(!e.isValidTag(n.tag))throw{msg:"Incorrect tag for KeyPair packet",value:n.tag,code:r.ErrorCodes.PARSE_FAILURE};var i=e.isPrivateTag(n.tag),o=e.isSubkeyTag(n.tag),a=n.body.readUInt8(0);if(a!=e.VERSION)throw{msg:"Unsupported version",value:a,code:r.ErrorCodes.PARSE_FAILURE};var u=n.body.readUInt32BE(1),c=n.body.readUInt8(5);if(c==t.keystore.PublicKeyAlgorithm.ECDSA||c==t.keystore.PublicKeyAlgorithm.ECDH)return s.EccKeyPairSerializer.deserialize(i,o,u,c==t.keystore.PublicKeyAlgorithm.ECDH,n.body);throw{msg:"Unimplemented key algorithm",value:c,code:r.ErrorCodes.UNSUPPORTED_FEATURE}},e.serializeHeader=function(t,n){var r=new Buffer(6);return r.writeUInt8(e.VERSION,0),r.writeUInt32BE(t,1),r.writeUInt8(n,5),r},e.VERSION=4,e}();n.KeyPair=o;var s=e("./EccKeyPair")}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"./EccKeyPair":279,"./Packet":285,
buffer:590}],281:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Subpacket"),r=e("./MasterKeyPair"),i=e("./Packet"),o=e("./KeyPair"),s=e("./PkiDataTypePacket"),a=e("../ErrorCodes"),u=e("../Enumerable"),c=e("../Types"),f=e("./AttachmentDataPacket"),l=e("./AttachmentPointerPacket"),h=e("./AttachmentsStorage"),p=function(){function e(e){this.keys=e,this.attachmentPointerList=[],this.attachmentDataList=[]}return e.createFromKeyPair=function(t,n){var r=new e([]);return r.addKeyPair(t,n),r},e.prototype.removePrivate=function(){u.$A(this.keys).forEach(function(e){return e.removePrivate()})},e.prototype.getPublicView=function(){var t=e.deserialize(this.serialize());return t.removePrivate(),t},e.prototype.hasAnyPrivate=function(){return u.$A(this.keys).contains(function(e){return e.hasAnyPrivate()})},e.prototype.addKey=function(e){this.keys.push(e)},e.prototype.addKeyPair=function(e,t){var n=new r.MasterKeyPair(t,[],[],[]);n.addUserId(e),this.keys.push(n)},e.prototype.addAttachment=function(e,t){return h.AttachmentsStorage.addAttachment(this,e,t)},e.prototype.getPrimaryKey=function(){return u.$A(this.keys).first()},e.prototype.getPrimaryUserId=function(){var e=this.getPrimaryKey();return null==e?"":e.getPrimaryUserId()},e.prototype.getKeyById=function(e){return u.$A(this.keys).takeFirstNotNull(function(t){return t.getKeyById(e)})},e.prototype.getAttachment=function(e){return h.AttachmentsStorage.getAttachment(this,e)},e.prototype.generateKis=function(e){var n=this.getPrimaryKey();if(null==n||!n.hasFlag(c.keystore.KeyFlag.SIGNING))throw{msg:"Cannot use key",value:n,code:a.ErrorCodes.INVALID_DATA};var r=this.getPublicView(),i=r.serializeWithoutAttachmentsData();return n.sign({data:{msg:i},hashed:[new t["default"].ConiksDbIdSubpacket(e)]})},e.prototype.verifyKis=function(e){var t=this.getKeyById(e.getIssuerId());if(null==t||!t.hasFlag(c.keystore.KeyFlag.SIGNING))return!1;var n=this.getPublicView(),r=n.serializeWithoutAttachmentsData();return t.verify({msg:r},e)},e.prototype.serialize=function(){return Buffer.concat([].concat(this.serializeWithoutAttachmentsData(),u.$A(this.attachmentDataList).map(function(e){return e.serialize()}).toArray()))},e.prototype.serializeWithoutAttachmentsData=function(){return Buffer.concat([].concat(new s.PkiDataTypePacket(c.keystore.PkiDataType.KEYSTORE).serialize(),u.$A(this.keys).map(function(e){return e.serialize()}).toArray(),u.$A(this.attachmentPointerList).map(function(e){return e.serialize()}).toArray()))},e.prototype.serializeWithArmor=function(){var e=this.getPrimaryKey();return i.Packet.enarmor(this.serialize(),null==e?"MESSAGE":o.KeyPair.getArmor(e.keyPair))},e.deserialize=function(t){var n=i.Packet.decode(t),r=e.deserializeFromStream(n);if(n.hasCurrent())throw new Error("Unexpected packets "+n.current.tag);return r},e.deserializeFromStream=function(t){if(!t.hasCurrent())throw new Error("Expected pki data type packet");var n=s.PkiDataTypePacket.deserializeFromPacket(t.current);if(n.type!=c.keystore.PkiDataType.KEYSTORE)throw new Error("Invalid pki data type "+n.type);t.next();for(var i=new e([]);t.hasCurrent();)if(o.KeyPair.isMainKeyTag(t.current.tag))i.keys.push(r.MasterKeyPair.deserializeFromStream(t));else if(t.current.tag==c.keystore.PacketTag.ATTACHMENT_DATA)i.attachmentDataList.push(f.AttachmentDataPacket.deserializeFromPacket(t.current)),t.next();else{if(t.current.tag!=c.keystore.PacketTag.ATTACHMENT_POINTER)break;i.attachmentPointerList.push(l.AttachmentPointerPacket.deserializeFromPacket(t.current)),t.next()}return i},e.prototype.validate=function(){return u.$A(this.keys).allPass(function(e){return e.validate()})&&h.AttachmentsStorage.validate(this)},e.prototype.isValidToSave=function(){return u.$A(this.keys).allPass(function(e){return e.validate()})&&h.AttachmentsStorage.isValidToSave(this)},e}();n.KeyStore=p}).call(this,e("buffer").Buffer)},{"../Enumerable":273,"../ErrorCodes":274,"../Types":304,"./AttachmentDataPacket":275,"./AttachmentPointerPacket":276,"./AttachmentsStorage":277,"./KeyPair":280,"./MasterKeyPair":283,"./Packet":285,"./PkiDataTypePacket":287,"./Subpacket":290,buffer:590}],282:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("../ErrorCodes"),i=e("../Utils"),o=e("../Types"),s=function(){function e(){}return e.createBinary=function(t,n){var r=new e;return r.format=o.keystore.LiteralDataType.BINARY,r.fileName=t,r.date=Math.floor((new Date).getTime()/1e3),r.data=n,r},e.createUtf8=function(t,n){var r=new e;return r.format=o.keystore.LiteralDataType.UTF8,r.fileName=t,r.date=Math.floor((new Date).getTime()/1e3),r.data=new Buffer(n,"utf8"),r},e.prototype.getText=function(){return this.data.toString("utf8")},e.prototype.serialize=function(){var e=new Buffer(this.fileName,"utf8"),n=2+e.length+4+this.data.length,r=new i.BufferOutputStream(new Buffer(n),0);return r.writeUInt8(this.format),r.writeOneOctetLengthBuffer(e),r.writeUInt32BE(this.date),r.writeBuffer(this.data),t.Packet.encode(r.buffer,o.keystore.PacketTag.LITERAL_DATA)},e.deserialize=function(n){return e.deserializeFromPacket(t.Packet.decodeSinglePacket(n))},e.deserializeFromPacket=function(t){if(t.tag!==o.keystore.PacketTag.LITERAL_DATA)throw{msg:"Incorrect tag for LiteralData packet",value:t.tag,code:r.ErrorCodes.PARSE_FAILURE};var n=new e,s=new i.BufferInputStream(t.body);return n.format=s.readUInt8(),n.fileName=s.readOneOctetLengthBuffer().toString("utf8"),n.date=s.readUInt32BE(),n.data=s.readBufferUntilEnd(),n},e.prototype.validate=function(){return!0},e}();n.LiteralDataPacket=s}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"../Utils":305,"./Packet":285,buffer:590}],283:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("./PackagedKeyPair"),i=e("./SubKeyPair"),o=e("./UserId"),s=e("../Enumerable"),a=e("./Subpacket"),u=e("./Signature"),c=e("./Packet"),f=e("./KeyPair"),l=e("../Types"),h=function(e){function n(t,n,r,i){var o=e.call(this,t,n)||this;if(o.userIds=r,o.subkeys=i,t.isSubkey())throw new Error("Cannot use subkey in MasterKeyPair");return o.container=o,o}return t(n,e),n.prototype.getRevokeSignature=function(){return s.$A(this.signatures).find(function(e){return e.type===l.keystore.SignatureType.KEY_REVOCATION_SIGNATURE})},n.prototype.getBindSignature=function(){return s.$A(this.userIds).map(function(e){return e.getBindSignature()}).findAll(function(e){return null!=e}).max(function(e,t){return e.getTimestamp()-t.getTimestamp()})},n.prototype.isValidRevokeKey=function(e){return this.keyPair.getKeyId().equals(e.keyPair.getKeyId())},n.prototype.getKeyPairContainer=function(){return this.container},n.prototype.getKeyById=function(e){return this.keyPair.getKeyId().equals(e)?this:s.$A(this.subkeys).find(function(t){return t.keyPair.getKeyId().equals(e)})},n.prototype.getPrimaryUserId=function(){var e=s.$A(this.userIds).find(function(e){return e.validate()});return null==e?"":e.name},n.prototype.removePrivate=function(){this.keyPair.removePrivate(),s.$A(this.subkeys).forEach(function(e){return e.keyPair.removePrivate()})},n.prototype.hasAnyPrivate=function(){return this.keyPair.hasPrivate()||s.$A(this.subkeys).contains(function(e){return e.keyPair.hasPrivate()})},n.prototype.addSubkey=function(e,t,n){void 0===n&&(n=0),n||(n=l.keystore.KeyFlag.CERTIFICATION|l.keystore.KeyFlag.SIGNING);var r=new i.SubKeyPair(this,e,t),o={type:l.keystore.SignatureType.SUBKEY_BINDING_SIGNATURE,data:{key:this.keyPair,subkey:r.keyPair},hashed:[new a["default"].RevocationKeySubpacket(r.keyPair.getKeyAlgorithm(),r.keyPair.getFingerprint()),new a["default"].KeyFlagsSubpacket(n)]};return n&l.keystore.KeyFlag.SIGNING&&o.hashed.push(new a["default"].EmbededSignatureSubpacket(r.sign({type:l.keystore.SignatureType.PRIMARY_KEY_BINDING_SIGNATURE,data:{key:this.keyPair,subkey:r.keyPair},hashed:[new a["default"].KeyFlagsSubpacket(n)]}))),r.addSignature(this.sign(o)),this.subkeys.push(r),r},n.prototype.addUserId=function(e,t){void 0===t&&(t=0),t||(t=l.keystore.KeyFlag.CERTIFICATION|l.keystore.KeyFlag.SIGNING);var n=new o.UserId(this,e);return n.addSignature(this.sign({type:l.keystore.SignatureType.POSITIVE_PK_USER_ID_CERTIFICATION,data:{key:this.keyPair,userId:n.name},hashed:[new a["default"].KeyFlagsSubpacket(t)]})),this.userIds.push(n),n},n.prototype.serialize=function(){return Buffer.concat([].concat([this.keyPair.serialize()],s.$A(this.signatures).map(function(e){return e.serialize()}).toArray(),s.$A(this.userIds).map(function(e){return e.serialize()}).toArray(),s.$A(this.subkeys).map(function(e){return e.serialize()}).toArray()))},n.prototype.serializeWithArmor=function(){return c.Packet.enarmor(this.serialize(),f.KeyPair.getArmor(this.keyPair))},n.deserialize=function(e){var t=c.Packet.decode(e),r=n.deserializeFromStream(t);if(t.hasCurrent())throw new Error("Unexpected packets "+t.current.tag);return r},n.deserializeFromStream=function(e){if(!e.hasCurrent())throw new Error("Expected key packet");var t=f.KeyPair.deserializeFromPacket(e.current),r=new n(t,[],[],[]);for(e.next();e.hasCurrent()&&e.current.tag==l.keystore.PacketTag.SIGNATURE;)r.signatures.push(u.Signature.deserializeFromPacket(e.current)),e.next();for(;e.hasCurrent()&&e.current.tag==l.keystore.PacketTag.USER_ID;)r.userIds.push(o.UserId.deserializeFromStream(r,e));for(;e.hasCurrent()&&f.KeyPair.isSubkeyTag(e.current.tag);)r.subkeys.push(i.SubKeyPair.deserializeFromStream(r,e));return r},n.prototype.validate=function(){return!!e.prototype.validate.call(this)&&(0!==this.userIds.length&&(!!s.$A(this.userIds).allPass(function(e){return e.validate()})&&!!s.$A(this.subkeys).allPass(function(e){return e.validate()})))},n}(r.PackagedKeyPair);n.MasterKeyPair=h}).call(this,e("buffer").Buffer)},{"../Enumerable":273,"../Types":304,"./KeyPair":280,"./PackagedKeyPair":284,"./Packet":285,"./Signature":288,"./SubKeyPair":289,"./Subpacket":290,"./UserId":291,buffer:590}],284:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Signature"),i=e("../Enumerable"),o=e("../Types"),s=function(){function e(e,t){this.keyPair=e,this.signatures=t}return e.prototype.revoke=function(e){if(!e.isRevoked()){var t=e.keyPair.isSubkey()?{type:o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE,data:{subkey:e.keyPair}}:{type:o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE,data:{key:e.keyPair}},n=this.sign(t);e.addSignature(n)}},e.prototype.addSignature=function(e){e.type==o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE||e.type==o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE?this.signatures=[e].concat(this.signatures):this.signatures.push(e)},e.prototype.revokeSelf=function(){return this.revoke(this)},e.prototype.isRevoked=function(){return null!=this.getRevokeSignature()},e.prototype.getRevokeTime=function(){var e=this.getRevokeSignature();return null==e?-1:e.getTimestamp()},e.prototype.getFlags=function(){var e=this.getBindSignature();return null==e?0:e.getKeyFlags()},e.prototype.hasFlag=function(e){return 0!==(this.getFlags()&e)},e.prototype.sign=function(e){if(this.isRevoked())throw new Error("Cannot use revoked key");if(e.type==o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE){if(!e.data||!e.data.key)throw new Error("Invalid signature options");var t=this.getKeyPairContainer().getKeyById(e.data.key.getKeyId());if(null==t)throw new Error("Cannot find a revocating key");if(!t.isValidRevokeKey(this))throw new Error("Key has no permission to revoke given key")}else if(e.type==o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE){if(!e.data||!e.data.subkey)throw new Error("Invalid signature options");var n=this.getKeyPairContainer().getKeyById(e.data.subkey.getKeyId());if(null==n)throw new Error("Cannot find a revocating subkey");if(!n.isValidRevokeKey(this))throw new Error("Key has no permission to revoke given subkey")}return r.Signature.create(e,this.keyPair)},e.prototype.verify=function(e,t){if(this.isRevoked()&&this.getRevokeTime()<t.getTimestamp())return!1;if(t.type==o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE){if(!e||!e.key)return!1;var n=this.getKeyPairContainer().getKeyById(e.key.getKeyId());if(null==n||!n.isValidRevokeKey(this))return!1}else if(t.type==o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE){if(!e||!e.subkey)return!1;var r=this.getKeyPairContainer().getKeyById(e.subkey.getKeyId());if(null==r||!r.isValidRevokeKey(this))return!1}return t.verify(e,this.keyPair)},e.prototype.validate=function(){var e=this;return i.$A(this.signatures).allPass(function(t){if(t.type==o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE){var n=e.getKeyPairContainer().getKeyById(t.getIssuerId());return e.keyPair.isSubkey()&&n&&n.verify({subkey:e.keyPair},t)}if(t.type==o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE){var r=e.getKeyPairContainer().getKeyById(t.getIssuerId());return!e.keyPair.isSubkey()&&r&&r.verify({key:e.keyPair},t)}return!0})},e}();n.PackagedKeyPair=s},{"../Enumerable":273,"../Types":304,"./Signature":288}],285:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("../ErrorCodes"),r=e("../Utils"),i=e("bytebuffer"),o=function(){function e(){}return e.crc24=function(e){for(var t=11994318,n=25578747,r=0;r<e.length;r++){t^=e[r]<<16;for(var i=0;i<8;i++)t<<=1,16777216&t&&(t^=n)}return new Buffer([t>>16&255,t>>8&255,255&t])},e.enarmor=function(t,n){return void 0===n&&(n="MESSAGE"),n=n.toUpperCase(),"-----BEGIN PGP "+n+"-----\n\n"+t.toString("base64").match(/.{1,64}/g).join("\n")+"\n="+e.crc24(t).toString("base64")+"\n-----END PGP "+n+"-----\n"},e.unarmor=function(n){var r=n.split("\n"),i=0;for(i=0;i<r.length&&0!==r[i].trim().length;i++);for(r=r.splice(i),i=r.length-1;i>=0&&"="!==r[i].trim()[0];i--);var o=r[i];r=r.splice(0,i);var s=new Buffer(o.trim().substr(1),"base64"),a=new Buffer(r.join(""),"base64");if(!s.equals(e.crc24(a)))throw{msg:"Incorrect CRC 24",value:{armored:n,crc:s,data:a},code:t.ErrorCodes.PARSE_FAILURE};return a},e.encode=function(e,t){var n=[192|t],r=e.length;return r<192?n.push(e.length):r<8383?(r-=192,n.push((r>>8)+192),n.push(255&r)):(n.push(255),n.push(r>>24&255),n.push(r>>16&255),n.push(r>>8&255),n.push(255&r)),Buffer.concat([new Buffer(n),e])},e.decode=function(e){return new s(new r.BufferInputStream(e))},e.decodeSinglePacket=function(e){var t=new s(new r.BufferInputStream(e));if(!t.hasCurrent())throw new Error("Empty buffer");var n=t.current;if(t.next(),t.hasCurrent())throw new Error("Unexpected packets "+t.current.tag);return n},e.encodeToArmored=function(t,n,r){return e.enarmor(e.encode(t,n),r)},e.decodeFromArmored=function(t){return e.decode(e.unarmor(t))},e.isTag=function(t,n){return e.decodeTag(t)==n},e.decodeTag=function(e){return 0===(64&e)?(63&e)>>2:63&e},e.oneOfTags=function(t,n){var r=e.decodeTag(t);return n.indexOf(r)!=-1},e.decodeString=function(t){return"-----"===t.substr(0,5)?e.unarmor(t):t.replace(/[a-f]|[0-9]/gi,"").trim().length>0?new Buffer(t,"base64"):new Buffer(t,"hex")},e.decodePacket=function(t,n){if(n instanceof t)return n;if(n instanceof i)return t.deserialize(Buffer.from(n.toArrayBuffer()));if(n instanceof Buffer)return t.deserialize(n);if("string"==typeof n){var r=e.decodeString(n);return t.deserialize(r)}},e}();n.Packet=o;var s=function(){function e(e){this.bis=e,this.current=null,this.next()}return e.prototype.hasCurrent=function(){return null!=this.current},e.prototype.next=function(){if(this.bis.isEnd())return void(this.current=null);var e=this.bis.readUInt8(),n=0;if(0===(64&e))switch(3&e){case 0:n=this.bis.readUInt8();break;case 1:n=this.bis.readUInt16BE();break;case 2:n=this.bis.readUInt32BE();break;default:throw{msg:"Unsupported packet length",buffer:this.bis.buffer,offset:this.bis.offset,code:t.ErrorCodes.PARSE_FAILURE}}else{var r=this.bis.readUInt8();n=255==r?this.bis.readUInt32BE():192===(192&r)?(r-192<<8)+192+this.bis.readUInt8():r}if(!this.bis.canRead(n))throw{msg:"Cannot read packet body, expected "+n+" bytes at "+this.bis.offset+" but get "+(this.bis.buffer.length-this.bis.offset),buffer:this.bis.buffer,offset:this.bis.offset,code:t.ErrorCodes.PARSE_FAILURE};this.current={tag:o.decodeTag(e),body:this.bis.readBuffer(n)}},e}();n.PacketStream=s}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Utils":305,buffer:590,bytebuffer:48}],286:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("../Types"),i=e("./PkiDataTypePacket"),o=e("./DocumentsPacket"),s=e("./KeyStore"),a=e("bytebuffer"),u=function(){function e(){}return e.deserialize=function(n){var r=t.Packet.decode(n),i=e.deserializeFromStream(r);if(r.hasCurrent())throw new Error("Unexpected packets "+r.current.tag);return i},e.deserializeFromStream=function(e){if(!e.hasCurrent())throw new Error("Expected key packet");var t=i.PkiDataTypePacket.deserializeFromPacket(e.current);if(t.type==r.keystore.PkiDataType.KEYSTORE)return s.KeyStore.deserializeFromStream(e);if(t.type==r.keystore.PkiDataType.DOCUMENT)return o.DocumentsPacket.deserializeFromStream(e);throw new Error("Unsupported pki data type "+t.type)},e.decode=function(n){if(n instanceof s.KeyStore||n instanceof o.DocumentsPacket)return n;if(n instanceof a)return e.deserialize(Buffer.from(n.toArrayBuffer()));if(n instanceof Buffer)return e.deserialize(n);if("string"==typeof n){var r=t.Packet.decodeString(n);return e.deserialize(r)}},e}();n.PkiData=u}).call(this,e("buffer").Buffer)},{"../Types":304,"./DocumentsPacket":278,"./KeyStore":281,"./Packet":285,"./PkiDataTypePacket":287,buffer:590,bytebuffer:48}],287:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("../ErrorCodes"),i=e("../Types"),o=function(){function e(e){this.type=e}return e.prototype.serialize=function(){return t.Packet.encode(new Buffer([this.type]),i.keystore.PacketTag.PKI_DATA_TYPE)},e.deserialize=function(n){return e.deserializeFromPacket(t.Packet.decodeSinglePacket(n))},e.deserializeFromPacket=function(t){if(t.tag!==i.keystore.PacketTag.PKI_DATA_TYPE)throw{msg:"Incorrect tag for PkiDataType packet",value:t.tag,code:r.ErrorCodes.PARSE_FAILURE};var n=t.body.readUInt8(0);return new e(n)},e.prototype.validate=function(){return!0},e}();n.PkiDataTypePacket=o}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"./Packet":285,buffer:590}],288:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Packet"),r=e("./Subpacket"),i=e("../ErrorCodes"),o=e("../Types"),s=e("../Utils"),a=function(){function e(){this.type=o.keystore.SignatureType.BINARY_DOCUMENT_SIGNATURE,this.keyAlgorithm=o.keystore.PublicKeyAlgorithm.ECDSA,this.hashAlgorithm=o.keystore.HashAlgorithm.SHA256,this.hashedPackets=[],this.unhashedPackets=[],this.hashPrefix=null,this.signatureData=null}return e.createSignatureHashedPart=function(t){var n=t.getSubpacketData(!0),r=n.data,i=n.length,o=new Buffer([255&e.VERSION,255&t.type,255&t.keyAlgorithm,255&t.hashAlgorithm]);return Buffer.concat([o,i,r])},e.createSignatureTrailerPart=function(t){return new Buffer([255&e.VERSION,255,t>>24&255,t>>16&255,t>>8&255,255&t])},e.createSignatureUserIdPart=function(e){var t=new Buffer(e);return Buffer.concat([new Buffer([180,t.length>>24&255,t.length>>16&255,t.length>>8&255,255&t.length]),t])},e.buildHashData=function(t,n){var r=[];switch(t.type){case o.keystore.SignatureType.BINARY_DOCUMENT_SIGNATURE:r.push(n.msg);break;case o.keystore.SignatureType.STANDALONE_SIGNATURE:break;case o.keystore.SignatureType.GENERIC_PK_USER_ID_CERTIFICATION:case o.keystore.SignatureType.PERSONA_PK_USER_ID_CERTIFICATION:case o.keystore.SignatureType.CASUAL_PK_USER_ID_CERTIFICATION:case o.keystore.SignatureType.POSITIVE_PK_USER_ID_CERTIFICATION:if(!n.key||!n.userId)throw{msg:"Signature type "+t.type+" requires PublicKey and UserID",value:{signature:t,data:n},code:i.ErrorCodes.INVALID_DATA};r.push(n.key.getFingerprintUnhashed()),r.push(e.createSignatureUserIdPart(n.userId));break;case o.keystore.SignatureType.PRIMARY_KEY_BINDING_SIGNATURE:case o.keystore.SignatureType.SUBKEY_BINDING_SIGNATURE:if(!n.key||!n.subkey)throw{msg:"Signature type "+t.type+" requires PublicKey and Subkey",value:{signature:t,data:n},code:i.ErrorCodes.INVALID_DATA};r.push(n.key.getFingerprintUnhashed()),r.push(n.subkey.getFingerprintUnhashed());break;case o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE:if(!n.key)throw{msg:"Signature type "+t.type+" requires PublicKey",value:{signature:t,data:n},code:i.ErrorCodes.INVALID_DATA};r.push(n.key.getFingerprintUnhashed());break;case o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE:if(!n.subkey)throw{msg:"Signature type "+t.type+" requires PublicSubkey",value:{signature:t,data:n},code:i.ErrorCodes.INVALID_DATA};r.push(n.subkey.getFingerprintUnhashed());break;default:throw{msg:"Unsupported signature type "+t.type,value:{signature:t,data:n},code:i.ErrorCodes.UNSUPPORTED_FEATURE}}var a=e.createSignatureHashedPart(t);return r.push(a),r.push(e.createSignatureTrailerPart(a.length)),s["default"].hashWithAlgorithm(Buffer.concat(r),t.hashAlgorithm)},e.create=function(t,n){var i=new e;i.type=t.type?t.type:i.type,i.hashedPackets=t.hashed?t.hashed:[];for(var s=!1,a=0,u=i.hashedPackets;a<u.length;a++){var c=u[a];if(s=c instanceof r["default"].SignatureCreationTimeSubpacket)break}if(s||i.hashedPackets.push(new r["default"].SignatureCreationTimeSubpacket),i.type===o.keystore.SignatureType.KEY_REVOCATION_SIGNATURE||i.type===o.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE){s=!1;for(var f=0,l=i.hashedPackets;f<l.length;f++){var c=l[f];if(s=c instanceof r["default"].RevocableSubpacket)break}s||i.hashedPackets.push(new r["default"].RevocableSubpacket((!1)))}i.unhashedPackets=t.unhashed?t.unhashed:[],s=!1;for(var h=0,p=i.unhashedPackets;h<p.length;h++){var c=p[h];if(s=c instanceof r["default"].IssuerSubpacket)break}s||i.unhashedPackets.push(new r["default"].IssuerSubpacket(n.getKeyId())),i.hashAlgorithm=t.hashAlgorithm?t.hashAlgorithm:i.hashAlgorithm;var d=e.buildHashData(i,t.data);return i.hashPrefix=d.slice(0,2),i.signatureData=n.signRaw(d),i},e.deserialize=function(n){return e.deserializeFromPacket(t.Packet.decodeSinglePacket(n))},e.deserializeFromPacket=function(t){if(t.tag!==o.keystore.PacketTag.SIGNATURE)throw{msg:"Incorrect tag for Signature packet",value:t.tag,code:i.ErrorCodes.PARSE_FAILURE};var n=t.body,s=new e;n[0];if(s.type=n[1],n[2]!==o.keystore.PublicKeyAlgorithm.ECDSA)throw{msg:"Unimplemented public key algorithm",value:n[2],code:i.ErrorCodes.UNSUPPORTED_FEATURE};s.hashAlgorithm=n[3];var a=(n[4]<<8)+n[5];n=n.slice(6);var u=n.slice(0,a);s.hashedPackets=r["default"].deserialize(u),n=n.slice(a);var c=(n[0]<<8)+n[1],f=n.slice(2,c+2);return s.unhashedPackets=r["default"].deserialize(f),n=n.slice(c+2),s.hashPrefix=n.slice(0,2),s.signatureData=n.slice(2),s},e.prototype.getSubpacketData=function(e){var t;t=e?this.hashedPackets:this.unhashedPackets;for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];n.push(o.serialize())}var s=Buffer.concat(n),a=new Buffer([s.length>>8&255,255&s.length]);return{data:s,length:a}},e.prototype.getBody=function(){var t=this.getSubpacketData(!1),n=t.data,r=t.length;return Buffer.concat([e.createSignatureHashedPart(this),r,n,this.hashPrefix,this.signatureData])},e.prototype.verify=function(t,n){if(!this.getIssuerId().equals(n.getKeyId()))return!1;var r=e.buildHashData(this,t);return!!this.hashPrefix.equals(r.slice(0,2))&&n.verifyRaw(r,this.signatureData)},e.prototype.getIssuerId=function(){for(var e=0,t=this.unhashedPackets;e<t.length;e++){var n=t[e];if(n instanceof r["default"].IssuerSubpacket)return n.keyId}throw{msg:"Missing Issuer Subpacket",value:this,code:i.ErrorCodes.INVALID_DATA}},e.prototype.getTimestamp=function(){for(var e=0,t=this.hashedPackets;e<t.length;e++){var n=t[e];if(n instanceof r["default"].SignatureCreationTimeSubpacket)return n.timestamp}throw{msg:"Missing SignatureCreationTimeSubpacket",value:this,code:i.ErrorCodes.INVALID_DATA}},e.prototype.getRevocationKeys=function(){for(var e=[],t=0,n=this.hashedPackets;t<n.length;t++){var i=n[t];i instanceof r["default"].RevocationKeySubpacket&&e.push(i.fingerprint)}return e},e.prototype.getKeyFlags=function(){for(var e=0,t=this.hashedPackets;e<t.length;e++){var n=t[e];if(n instanceof r["default"].KeyFlagsSubpacket)return n.flags}return 0},e.prototype.getEmbeded=function(){for(var e=0,t=this.hashedPackets;e<t.length;e++){var n=t[e];if(n instanceof r["default"].EmbededSignatureSubpacket)return n.signature}return null},e.prototype.serialize=function(){return t.Packet.encode(this.getBody(),o.keystore.PacketTag.SIGNATURE)},e.prototype.serializeWithArmor=function(){return t.Packet.enarmor(this.serialize(),"SIGNATURE")},e.VERSION=4,e}();n.Signature=a}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Types":304,"../Utils":305,"./Packet":285,"./Subpacket":290,buffer:590}],289:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("./PackagedKeyPair"),i=e("../Enumerable"),o=e("./Packet"),s=e("./KeyPair"),a=e("./Signature"),u=e("../Types"),c=function(e){function n(t,n,r){var i=e.call(this,n,r)||this;if(i.parent=t,!n.isSubkey())throw new Error("Cannot use normal key in SubKeyPair");return i}return t(n,e),n.prototype.getRevokeSignature=function(){return i.$A(this.signatures).find(function(e){return e.type===u.keystore.SignatureType.SUBKEY_REVOCATION_SIGNATURE})},n.prototype.getBindSignature=function(){if(null===this.parent)return null;var e=this.parent.keyPair.getKeyId();return i.$A(this.signatures).findAll(function(t){return t.type===u.keystore.SignatureType.SUBKEY_BINDING_SIGNATURE&&t.getIssuerId().equals(e)}).max(function(e,t){return e.getTimestamp()-t.getTimestamp()})},n.prototype.isValidRevokeKey=function(e){if(this.parent&&this.parent.keyPair.getKeyId().equals(e.keyPair.getKeyId()))return!0;var t=e.keyPair.getFingerprint();return i.$A(this.getBindSignature().getRevocationKeys()).contains(function(e){return e.equals(t)})},n.prototype.getKeyPairContainer=function(){return this.parent},n.prototype.serialize=function(){return Buffer.concat([].concat([this.keyPair.serialize()],i.$A(this.signatures).map(function(e){return e.serialize()}).toArray()))},n.prototype.serializeWithArmor=function(){return o.Packet.enarmor(this.serialize(),s.KeyPair.getArmor(this.keyPair))},n.deserialize=function(e,t){var r=o.Packet.decode(t),i=n.deserializeFromStream(e,r);if(r.hasCurrent())throw new Error("Unexpected packets "+r.current.tag);return i},n.deserializeFromStream=function(e,t){if(!t.hasCurrent())throw new Error("Expected key packet");var r=s.KeyPair.deserializeFromPacket(t.current),i=new n(e,r,[]);for(t.next();t.hasCurrent()&&t.current.tag==u.keystore.PacketTag.SIGNATURE;)i.signatures.push(a.Signature.deserializeFromPacket(t.current)),t.next();return i},n.prototype.validate=function(){if(!e.prototype.validate.call(this)||null===this.parent)return!1;var t=this.getBindSignature();if(null===t)return!1;var n={key:this.parent.keyPair,subkey:this.keyPair};if(this.hasFlag(u.keystore.KeyFlag.SIGNING)){var r=t.getEmbeded();if(null===r||!this.verify(n,r)||r.type!==u.keystore.SignatureType.PRIMARY_KEY_BINDING_SIGNATURE)return!1}return this.parent.verify(n,t)},n}(r.PackagedKeyPair);n.SubKeyPair=c}).call(this,e("buffer").Buffer)},{"../Enumerable":273,"../Types":304,"./KeyPair":280,"./PackagedKeyPair":284,"./Packet":285,"./Signature":288,buffer:590}],290:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./Signature"),o=e("../Utils"),s=e("../Types");!function(e){function n(e){var t=e.type,n=e.body,r=null;switch(t){case s.keystore.SubPacketType.SIGNATURE_CREATION_TIME:r=new c(n.readUInt32BE(0));break;case s.keystore.SubPacketType.REVOCABLE:r=new p(1===n[0]);break;case s.keystore.SubPacketType.REVOCATION_KEY:r=new l(n[1],n.slice(2),n[0]);break;case s.keystore.SubPacketType.ISSUER:r=new u(n);break;case s.keystore.SubPacketType.KEY_FLAGS:r=new f(n);break;case s.keystore.SubPacketType.EMBEDDED_SIGNATURE:r=new h(i.Signature.deserialize(n));break;case s.keystore.SubPacketType.CONIKS_DB_ID:r=new g(n.slice(4),n.readUInt32BE(0));break;default:r=new d(t,n)}return r}function r(e){for(var t=new y(new o.BufferInputStream(e)),r=[];t.hasCurrent();)r.push(n(t.current)),t.next();return r}var a=function(){function e(){this.type=0}return e.prototype.serialize=function(){var e=this.getBody(),t=[],n=e.length+1;return n<192?t.push(n):n<8383?(n-=192,t.push((n>>8)+192),t.push(255&n)):(t.push(255),t.push(n>>24&255),t.push(n>>16&255),t.push(n>>8&255),t.push(255&n)),t.push(this.type),Buffer.concat([new Buffer(t),e])},e}();e.SubpacketBase=a;var u=function(e){function n(t){var n=e.call(this)||this;return n.keyId=t,n.type=s.keystore.SubPacketType.ISSUER,n}return t(n,e),n.prototype.getBody=function(){return this.keyId},n}(a);e.IssuerSubpacket=u;var c=function(e){function n(t){void 0===t&&(t=null);var n=e.call(this)||this;return n.timestamp=t,n.type=s.keystore.SubPacketType.SIGNATURE_CREATION_TIME,null===n.timestamp&&(n.timestamp=Math.floor((new Date).getTime()/1e3+.5)),n}return t(n,e),n.prototype.getBody=function(){return new Buffer([this.timestamp>>24&255,this.timestamp>>16&255,this.timestamp>>8&255,255&this.timestamp])},n}(a);e.SignatureCreationTimeSubpacket=c;var f=function(e){function n(t){var n=e.call(this)||this;if(n.type=s.keystore.SubPacketType.KEY_FLAGS,n.data=null,!(t instanceof Buffer)){var r=t,i=[];for(0===r&&i.push(0);r>0;)i.push(255&r),r>>=8;t=new Buffer(i.reverse())}return n.data=t,n}return t(n,e),Object.defineProperty(n.prototype,"flags",{get:function(){switch(this.data.length){case 0:return 0;case 1:return this.data.readUInt8(0);case 2:return this.data.readUInt16BE(0);case 3:return(this.data.readUInt16BE(0)<<8)+this.data.readUInt8(2);default:return this.data.readUInt32BE(0)}},enumerable:!0,configurable:!0}),n.prototype.getBody=function(){return this.data},n}(a);e.KeyFlagsSubpacket=f;var l=function(e){function n(t,n,r){void 0===r&&(r=64);var i=e.call(this)||this;return i.algorithm=t,i.fingerprint=n,i.sensitive=r,i.type=s.keystore.SubPacketType.REVOCATION_KEY,i}return t(n,e),n.prototype.getBody=function(){return Buffer.concat([new Buffer([this.sensitive,this.algorithm]),this.fingerprint])},n}(a);e.RevocationKeySubpacket=l;var h=function(e){function n(t){var n=e.call(this)||this;return n.signature=t,n.type=s.keystore.SubPacketType.EMBEDDED_SIGNATURE,n}return t(n,e),n.prototype.getBody=function(){return this.signature.serialize()},n}(a);e.EmbededSignatureSubpacket=h;var p=function(e){function n(t){var n=e.call(this)||this;return n.revocable=t,n.type=s.keystore.SubPacketType.REVOCABLE,n}return t(n,e),n.prototype.getBody=function(){return new Buffer([this.revocable])},n}(a);e.RevocableSubpacket=p;var d=function(e){function n(t,n){var r=e.call(this)||this;return r.type=t,r.data=n,r}return t(n,e),n.prototype.getBody=function(){return this.data},n}(a),g=function(e){function n(t,n){void 0===n&&(n=null);
var r=e.call(this)||this;return r.timestamp=n,r.type=s.keystore.SubPacketType.CONIKS_DB_ID,r.data=null,r.data=t instanceof Buffer?t:new Buffer(t,"hex"),null===r.timestamp&&(r.timestamp=Math.floor((new Date).getTime()/1e3+.5)),r}return t(n,e),n.prototype.getBody=function(){return Buffer.concat([new Buffer([this.timestamp>>24&255,this.timestamp>>16&255,this.timestamp>>8&255,255&this.timestamp]),this.data])},n}(a);e.ConiksDbIdSubpacket=g;var y=function(){function e(e){this.bis=e,this.current=null,this.next()}return e.prototype.hasCurrent=function(){return null!=this.current},e.prototype.next=function(){if(this.bis.isEnd())return void(this.current=null);var e=this.bis.readUInt8();if(e<192)this.current={type:this.bis.readUInt8(),body:this.bis.readBuffer(e-1)};else if(e<255){var t=(e-192<<8)+this.bis.readUInt8()+192;this.current={type:this.bis.readUInt8(),body:this.bis.readBuffer(t-1)}}else{var n=this.bis.readInt32BE();this.current={type:this.bis.readUInt8(),body:this.bis.readBuffer(n-1)}}},e}();e.SubpacketStream=y,e.deserialize=r}(r||(r={})),n["default"]=r}).call(this,e("buffer").Buffer)},{"../Types":304,"../Utils":305,"./Signature":288,buffer:590}],291:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("./Signature"),r=e("./Packet"),i=e("../Types"),o=e("../ErrorCodes"),s=e("../Enumerable"),a=function(){function e(e,t){this.parent=e,this.name=t,this.signatures=[]}return e.prototype.addSignature=function(e){this.signatures.push(e)},e.prototype.getBindSignature=function(){return s.$A(this.signatures).findAll(function(e){return e.type==i.keystore.SignatureType.GENERIC_PK_USER_ID_CERTIFICATION||e.type==i.keystore.SignatureType.PERSONA_PK_USER_ID_CERTIFICATION||e.type==i.keystore.SignatureType.CASUAL_PK_USER_ID_CERTIFICATION||e.type==i.keystore.SignatureType.POSITIVE_PK_USER_ID_CERTIFICATION}).max(function(e,t){return e.getTimestamp()-t.getTimestamp()})},e.prototype.serialize=function(){return Buffer.concat([].concat([r.Packet.encode(new Buffer(this.name,"utf8"),i.keystore.PacketTag.USER_ID)],s.$A(this.signatures).map(function(e){return e.serialize()}).toArray()))},e.deserialize=function(t,n){var i=r.Packet.decode(n),o=e.deserializeFromStream(t,i);if(i.hasCurrent())throw new Error("Unexpected packets "+i.current.tag);return o},e.deserializeFromStream=function(n,r){if(!r.hasCurrent())throw new Error("Expected userId packet");var s=r.current.tag;if(s!==i.keystore.PacketTag.USER_ID)throw{msg:"Incorrect tag for UserId packet",value:r.current.tag,code:o.ErrorCodes.PARSE_FAILURE};var a=new e(n,r.current.body.toString("utf8"));for(r.next();r.hasCurrent()&&r.current.tag==i.keystore.PacketTag.SIGNATURE;)a.signatures.push(t.Signature.deserializeFromPacket(r.current)),r.next();return a},e.prototype.validate=function(){var e=this.getBindSignature();return null!=e&&this.parent.verify({key:this.parent.keyPair,userId:this.name},e)},e}();n.UserId=a}).call(this,e("buffer").Buffer)},{"../Enumerable":273,"../ErrorCodes":274,"../Types":304,"./Packet":285,"./Signature":288,buffer:590}],292:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./AttachmentDataPacket");n.AttachmentDataPacket=r.AttachmentDataPacket;var i=e("./AttachmentPointerPacket");n.AttachmentPointerPacket=i.AttachmentPointerPacket;var o=e("./AttachmentsStorage");n.AttachmentsStorage=o.AttachmentsStorage;var s=e("./DocumentsPacket");n.DocumentsPacket=s.DocumentsPacket;var a=e("./EccKeyPair");n.EccKeyPair=a.EccKeyPair,n.EccKeyPairSerializer=a.EccKeyPairSerializer;var u=e("./KeyPair");n.KeyPair=u.KeyPair;var c=e("./KeyStore");n.KeyStore=c.KeyStore;var f=e("./LiteralDataPacket");n.LiteralDataPacket=f.LiteralDataPacket;var l=e("./MasterKeyPair");n.MasterKeyPair=l.MasterKeyPair;var h=e("./PackagedKeyPair");n.PackagedKeyPair=h.PackagedKeyPair;var p=e("./Packet");n.Packet=p.Packet,n.PacketStream=p.PacketStream;var d=e("./PkiData");n.PkiData=d.PkiData;var g=e("./PkiDataTypePacket");n.PkiDataTypePacket=g.PkiDataTypePacket;var y=e("./Signature");n.Signature=y.Signature;var m=e("./SubKeyPair");n.SubKeyPair=m.SubKeyPair;var v=e("./Subpacket");n.Subpacket=v["default"];var b=e("./UserId");n.UserId=b.UserId},{"./AttachmentDataPacket":275,"./AttachmentPointerPacket":276,"./AttachmentsStorage":277,"./DocumentsPacket":278,"./EccKeyPair":279,"./KeyPair":280,"./KeyStore":281,"./LiteralDataPacket":282,"./MasterKeyPair":283,"./PackagedKeyPair":284,"./Packet":285,"./PkiData":286,"./PkiDataTypePacket":287,"./Signature":288,"./SubKeyPair":289,"./Subpacket":290,"./UserId":291}],293:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("../BitString"),i=e("../Utils"),o=e("./MessageBase"),s=function(e){function n(t,n){void 0===t&&(t=null),void 0===n&&(n=null);var r=e.call(this)||this;return r.hash=null,r.auth=null,o.MessageBase.isEmptyConstructor([t,n])?r:(r.setHash(t).setAuth(n),r)}return t(n,e),n.prototype.authindex=function(e){return this.auth instanceof r["default"]?this.auth:e.prefix(this.auth)},n.prototype.authhash=function(e,t){return void 0===t&&(t=null),null==t&&(t=this.hash),i["default"].hash(Buffer.concat([e.encode(),t]))},n.prototype.interhash=function(e,t){var n=[this.hash,e];return i["default"].hash(Buffer.concat(t?n:n.reverse()))},n.prototype.setHash=function(e){return e=i["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("hash"),this.hash=e,this},n.prototype.getHash=function(){return this.hash},n.prototype.setAuth=function(e){return e=i["default"].fromLong(e),"number"!=typeof e?(e=i["default"].fromByteBuffer(e),e instanceof Buffer&&(e=r["default"].decode(e)),e instanceof r["default"]||this.incorrectFieldType("auth"),this.auth=e):this.auth=e,this},n.prototype.getAuth=function(){return this.auth},n.prototype.validate=function(){null===this.getHash()&&this.missingField("hash"),null===this.getAuth()&&this.missingField("auth")},n.prototype.psonSerialize=function(){this.validate();var e=this.getAuth();return{hash:this.getHash(),auth:"number"==typeof e?e:e.encode()}},n.prototype.psonDeserialize=function(e){e.hash&&this.setHash(e.hash),e.auth&&this.setAuth(e.auth),this.validate()},n.decode=function(e){return o.MessageBase.decodeMessage(n,e)},n}(o.MessageBase);n["default"]=s}).call(this,e("buffer").Buffer)},{"../BitString":270,"../Utils":305,"./MessageBase":297,buffer:590}],294:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./TreeMessage"),o=e("./MessageBase"),s=e("../KeyStore"),a=function(e){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=null);var r=e.call(this)||this;return r.history=null,r.serverKeystore=null,o.MessageBase.isEmptyConstructor([t,n])?r:r}return r(t,e),t.prototype.setHistory=function(e){Array.isArray(e)||this.incorrectFieldType("history");for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];o instanceof i["default"]||(o=i["default"].decode(o)),t.push(o)}return this.history=t,this},t.prototype.getHistory=function(){return this.history},t.prototype.setServerKeyStore=function(e){return this.serverKeystore=s.Packet.decodePacket(s.KeyStore,e),void 0==this.serverKeystore&&this.incorrectFieldType("serverKeystore"),this},t.prototype.getServerKeyStore=function(){return this.serverKeystore},t.prototype.validate=function(){null===this.getHistory()&&this.missingField("history"),null===this.getServerKeyStore()&&this.missingField("serverKeystore")},t.prototype.verify=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),null===e&&(e=this.getServerKeyStore());var n=this.getHistory();if(0===n.length)return!0;for(var r=n.length-1;r>=0;--r){var i=n[r];if(!i.verify(e,r<n.length-1)||null!=t&&!i.getPrevTree().equals(t.getHash()))return!1;t=i}return!0},t.prototype.psonSerialize=function(){return this.validate(),{history:o.MessageBase.serializeArray(this.history),serverKeystore:this.getServerKeyStore().serialize()}},t.prototype.psonDeserialize=function(e){e.history&&this.setHistory(e.history),e.serverKeystore&&this.setServerKeyStore(e.serverKeystore),this.validate()},t.decode=function(e){return o.MessageBase.decodeMessage(t,e)},t}(o.MessageBase);n["default"]=a},{"../KeyStore":292,"./MessageBase":297,"./TreeMessage":298}],295:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./MessageBase"),o=e("./VRFMessage"),s=e("./TreeMessage"),a=e("./AuthPathNodeMessage"),u=e("./LeafMessage"),c=e("../KeyStore"),f=function(e){function t(t,n,r,o,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null);var a=e.call(this)||this;return a.vrf=null,a.tree=null,a.path=null,a.leaf=null,a.serverKeystore=null,i.MessageBase.isEmptyConstructor([t,n,r,o,s])?a:(a.setVRF(t).setTree(n).setPath(r).setServerKeyStore(s),null!=o&&a.setLeaf(o),a)}return r(t,e),t.prototype.setVRF=function(e){return e instanceof o["default"]||(e=o["default"].decode(e)),this.vrf=e,this},t.prototype.getVRF=function(){return this.vrf},t.prototype.setTree=function(e){return e instanceof s["default"]||(e=s["default"].decode(e)),this.tree=e,this},t.prototype.getTree=function(){return this.tree},t.prototype.setPath=function(e){Array.isArray(e)||this.incorrectFieldType("path");for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i instanceof a["default"]||(i=a["default"].decode(i)),t.push(i)}return this.path=t,this},t.prototype.getPath=function(){return this.path},t.prototype.setLeaf=function(e){return e instanceof u["default"]||(e=u["default"].decode(e)),this.leaf=e,this},t.prototype.getLeaf=function(){return this.leaf},t.prototype.setServerKeyStore=function(e){return this.serverKeystore=c.Packet.decodePacket(c.KeyStore,e),void 0==this.serverKeystore&&this.incorrectFieldType("serverKeystore"),this},t.prototype.getServerKeyStore=function(){return this.serverKeystore},t.prototype.validate=function(){null===this.getVRF()&&this.missingField("vrf"),null===this.getTree()&&this.missingField("tree"),null===this.getPath()&&this.missingField("path"),null===this.getServerKeyStore()&&this.missingField("serverKeystore")},t.prototype.psonSerialize=function(){this.validate();var e={vrf:this.getVRF().encode("array"),tree:this.getTree().encode("array"),path:i.MessageBase.serializeArray(this.getPath()),serverKeystore:this.getServerKeyStore().serialize()},t=this.getLeaf();return null!=t&&(e.leaf=t.encode("array")),e},t.prototype.psonDeserialize=function(e){e.vrf&&this.setVRF(e.vrf),e.tree&&this.setTree(e.tree),e.path&&this.setPath(e.path),e.serverKeystore&&this.setServerKeyStore(e.serverKeystore),e.leaf&&this.setLeaf(e.leaf),this.validate()},t.prototype.getKeyStore=function(){var e=this.getLeaf();return e?e.getKeyStore():null},t.prototype.verifyVRF=function(e,t){return null===e||this.getVRF().verify(e,t)},t.prototype.verifyAuthPath=function(){var e=this.getVRF().getValue(),t=this.getLeaf(),n=this.getTree(),r=this.getPath();if(0===r.length)return!1;var i=r[0].authindex(e),o=i.equals(e);if(!o&&null!=t)return!1;var s=r[0].authhash(i);if(o&&(null==t||!t.getIndex().equals(e)||!t.getHash().equals(s)))return!1;for(var a=1;a<r.length;++a){var u=i;if(i=r[a].authindex(u),!i.isPrefixOf(u))return!1;var c=e.bit(i.length),f=r[a].interhash(s,c);s=r[a].authhash(i,f)}return n.getRoot().equals(s)},t.prototype.verify=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),null===t&&(t=this.getServerKeyStore());var n=this.getLeaf();return null===e&&null!=n&&(e=n.getName()),this.verifyVRF(e,t)&&this.getTree().verify(t)&&(null==n||n.verify())&&this.verifyAuthPath()},t.decode=function(e){return i.MessageBase.decodeMessage(t,e)},t}(i.MessageBase);n["default"]=f},{"../KeyStore":292,"./AuthPathNodeMessage":293,"./LeafMessage":296,"./MessageBase":297,"./TreeMessage":298,"./VRFMessage":300}],296:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Utils"),i=e("../BitString"),o=e("../ErrorCodes"),s=e("../KeyStore"),a=e("./MessageBase"),u=function(e){function n(t,n,r,i,o,s,u,c,f){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===f&&(f=null);var l=e.call(this)||this;return l.index=null,l.hash=null,l.name=null,l.datahash=null,l.nonce=null,l.revision=null,l.keystore=null,l.kis=null,l.prevRevision=null,a.MessageBase.isEmptyConstructor([t,n,r,i,o,s,u])?l:(l.setIndex(t).setHash(n).setName(r).setDatahash(i),l.setRevision(o).setKeyStore(s).setKis(u),null!=c&&l.setNonce(c),null!=f&&l.setPrevRevision(f),l)}return t(n,e),n.prototype.verify=function(){return!!this.getKeyStore().verifyKis(this.getKis())&&this.getKeyStore().validate()},n.prototype.toJSON=function(){return{index:this.index.encode().toString("base64"),name:this.name,hash:this.hash.toString("base64"),datahash:this.datahash.toString("base64"),nonce:this.nonce.toString("base64"),revision:this.revision.toString("base64"),key_store:this.keystore,kis:this.kis,prev_revision:this.prevRevision?this.prevRevision.toString("base64"):null}},n.FromJson=function(e){var t=!r["default"].isString(e.index)||!r["default"].isString(e.hash)||!r["default"].isString(e.name)||!r["default"].isString(e.datahash)||!r["default"].isString(e.nonce)||!r["default"].isString(e.revision)||!r["default"].isString(e.key_store)||!r["default"].isString(e.kis)||e.prev_revision&&!r["default"].isString(e.prev_revision);if(t)throw{msg:"Incorrect Leaf json",value:e,code:o.ErrorCodes.PARSE_FAILURE};var i=null;return e.prev_revision&&(i=r["default"].decodeString(e.prev_revision)),new n(r["default"].decodeBitString(e.index),r["default"].decodeString(e.hash),e.name,r["default"].decodeString(e.datahash),r["default"].decodeString(e.revision),s.Packet.decodePacket(s.KeyStore,e.key_store),s.Packet.decodePacket(s.Signature,e.kis),r["default"].decodeString(e.nonce),i)},n.prototype.setIndex=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer&&(e=i["default"].decode(e)),e instanceof i["default"]||this.incorrectFieldType("index"),this.index=e,this},n.prototype.getIndex=function(){return this.index},n.prototype.setHash=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("hash"),this.hash=e,this},n.prototype.getHash=function(){return this.hash},n.prototype.setName=function(e){return"string"!=typeof e&&this.incorrectFieldType("name"),this.name=e,this},n.prototype.getName=function(){return this.name},n.prototype.setDatahash=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("datahash"),this.datahash=e,this},n.prototype.getDatahash=function(){return this.datahash},n.prototype.setNonce=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("nonce"),this.nonce=e,this},n.prototype.getNonce=function(){return this.nonce},n.prototype.setRevision=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("revision"),this.revision=e,this},n.prototype.getRevision=function(){return this.revision},n.prototype.setKeyStore=function(e){return this.keystore=s.PkiData.decode(e),void 0==this.keystore&&this.incorrectFieldType("keystore"),this},n.prototype.getKeyStore=function(){return this.keystore},n.prototype.setKis=function(e){return this.kis=s.Packet.decodePacket(s.Signature,e),void 0==this.kis&&this.incorrectFieldType("signature"),this},n.prototype.getKis=function(){return this.kis},n.prototype.setPrevRevision=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("prevRevision"),this.prevRevision=e,this},n.prototype.getPrevRevision=function(){return this.prevRevision},n.prototype.validate=function(){null===this.getIndex()&&this.missingField("index"),null===this.getHash()&&this.missingField("hash"),null===this.getName()&&this.missingField("name"),null===this.getDatahash()&&this.missingField("datahash"),null===this.getRevision()&&this.missingField("revision"),null===this.getKeyStore()&&this.missingField("keystore"),null===this.getKis()&&this.missingField("kis")},n.prototype.psonSerialize=function(){this.validate();var e={index:this.getIndex().encode(),hash:this.getHash(),name:this.getName(),datahash:this.getDatahash(),revision:this.getRevision(),keystore:this.getKeyStore().serialize(),kis:this.getKis().serialize()},t=this.getNonce();return null!=t&&(e.nonce=t),t=this.getPrevRevision(),null!=t&&(e.prevRevision=t),e},n.prototype.psonDeserialize=function(e){e.index&&this.setIndex(e.index),e.hash&&this.setHash(e.hash),(e.name||""===e.name)&&this.setName(e.name),e.datahash&&this.setDatahash(e.datahash),e.nonce&&this.setNonce(e.nonce),e.revision&&this.setRevision(e.revision),e.keystore&&this.setKeyStore(e.keystore),e.kis&&this.setKis(e.kis),e.prevRevision&&this.setPrevRevision(e.prevRevision),this.validate()},n.decode=function(e){return a.MessageBase.decodeMessage(n,e)},n}(a.MessageBase);n["default"]=u}).call(this,e("buffer").Buffer)},{"../BitString":270,"../ErrorCodes":274,"../KeyStore":292,"../Utils":305,"./MessageBase":297,buffer:590}],297:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("pson"),r=e("../ErrorCodes"),i=e("../Utils"),o=function(){function e(){}return e.prototype.encode=function(t){void 0===t&&(t="pson");var n=this.psonSerialize();switch(t){case"array":return n;default:var r=e.getEncoder(),i=r.encode(n);return"buffer"===t?Buffer.from(i.toArrayBuffer()):i}},e.prototype.missingField=function(t){throw{msg:'Missing required field "'+t+'" for class '+e.getClass(this),value:this,code:r.ErrorCodes.PARSE_FAILURE}},e.prototype.incorrectFieldType=function(t){throw{msg:'Incorrect field type "'+t+'" for class '+e.getClass(this),value:this,code:r.ErrorCodes.PARSE_FAILURE}},e.serializeArray=function(e){return e.map(function(e){return e.psonSerialize()})},e.isEmptyConstructor=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(null!=r)return!1}return!0},e.decodeUint64=function(e){if(e=i["default"].fromByteBuffer(e),!(e instanceof Buffer))return e;for(var t=0,n=0;n<e.length;++n)t=256*t+e.readUInt8(n);return t},e.getClass=function(e){var t=/function (.{1,})\(/,n=t.exec(e.constructor.toString());return n&&n.length>1?n[1]:""},e.getEncoder=function(){return null===e.encoder&&(e.encoder=new t.StaticPair),e.encoder},e.decodeMessage=function(t,n){var r=new t;return n=i["default"].fromByteBuffer(n),i["default"].isString(n)&&(n=new Buffer(n)),n instanceof Buffer&&(n=e.getEncoder().decode(n)),r.psonDeserialize(n),r},e.encoder=null,e}();n.MessageBase=o}).call(this,e("buffer").Buffer)},{"../ErrorCodes":274,"../Utils":305,buffer:590,pson:326}],298:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Utils"),i=e("../KeyStore"),o=e("./MessageBase"),s=function(e){function n(t,n,r,i,s,a,u,c){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===c&&(c=null);var f=e.call(this)||this;return f.version=null,f.hash=null,f.prevTree=null,f.root=null,f.timestamp=null,f.nonce=null,f.signature=null,f.seq=null,o.MessageBase.isEmptyConstructor([t,n,r,i,s,a,u])?f:(f.setVersion(t).setHash(n).setPrevTree(r).setRoot(i),f.setTimestamp(s).setSignature(a).setSeq(u),null!=c&&f.setNonce(c),f)}return t(n,e),n.prototype.verify=function(e,t){void 0===t&&(t=!1);var n=Buffer.concat([r["default"].buffer32b(this.getVersion()),this.getPrevTree(),this.getRoot(),r["default"].buffer64b(this.getTimestamp()),this.getNonce(),r["default"].buffer64b(this.getSeq())]),i=this.getSignature(),o=e.getPrimaryKey();return!!r["default"].hash(Buffer.concat([i.serialize(),n])).equals(this.getHash())&&(!!t||o.verify({msg:n},i))},n.prototype.setVersion=function(e){return e=r["default"].fromLong(e),"number"!=typeof e&&this.incorrectFieldType("number"),this.version=e,this},n.prototype.getVersion=function(){return this.version},n.prototype.setHash=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("hash"),this.hash=e,this},n.prototype.getHash=function(){return this.hash},n.prototype.setPrevTree=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("prevTree"),this.prevTree=e,this},n.prototype.getPrevTree=function(){return this.prevTree},n.prototype.setRoot=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("root"),this.root=e,this},n.prototype.getRoot=function(){return this.root},n.prototype.setTimestamp=function(e){return e=r["default"].fromLong(e),e=o.MessageBase.decodeUint64(e),"number"!=typeof e&&this.incorrectFieldType("timestamp"),this.timestamp=e,this},n.prototype.getTimestamp=function(){return this.timestamp},n.prototype.setNonce=function(e){return e=r["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("nonce"),this.nonce=e,this},n.prototype.getNonce=function(){return this.nonce},n.prototype.setSignature=function(e){return this.signature=i.Packet.decodePacket(i.Signature,e),void 0==this.signature&&this.incorrectFieldType("signature"),this},n.prototype.getSignature=function(){return this.signature},n.prototype.setSeq=function(e){return e=r["default"].fromLong(e),"number"!=typeof e&&this.incorrectFieldType("seq"),this.seq=e,this},n.prototype.getSeq=function(){return this.seq},n.prototype.validate=function(){null===this.getVersion()&&this.missingField("version"),null===this.getHash()&&this.missingField("hash"),null===this.getPrevTree()&&this.missingField("prevTree"),null===this.getRoot()&&this.missingField("root"),null===this.getTimestamp()&&this.missingField("timestamp"),null===this.getSignature()&&this.missingField("signature"),null===this.getSeq()&&this.missingField("seq")},n.prototype.psonSerialize=function(){this.validate();var e={version:this.getVersion(),hash:this.getHash(),prevTree:this.getPrevTree(),root:this.getRoot(),timestamp:r["default"].buffer64b(this.getTimestamp()),signature:this.getSignature().serialize(),seq:this.getSeq()},t=this.getNonce();return null===t&&(e.nonce=t),e},n.prototype.psonDeserialize=function(e){e.version&&this.setVersion(e.version),e.hash&&this.setHash(e.hash),e.prevTree&&this.setPrevTree(e.prevTree),e.root&&this.setRoot(e.root),e.timestamp&&this.setTimestamp(e.timestamp),e.signature&&this.setSignature(e.signature),(e.seq||0===e.seq)&&this.setSeq(e.seq),e.nonce&&this.setNonce(e.nonce),this.validate()},n.decode=function(e){return o.MessageBase.decodeMessage(n,e)},n}(o.MessageBase);n["default"]=s}).call(this,e("buffer").Buffer)},{"../KeyStore":292,"../Utils":305,"./MessageBase":297,buffer:590}],299:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../Utils"),o=e("./MessageBase"),s=e("../KeyStore");!function(e){e[e.OK=0]="OK",e[e.INVALID_STATE=1]="INVALID_STATE",e[e.HAS_INVALID=2]="HAS_INVALID",e[e.NO_QUORUM=3]="NO_QUORUM"}(r=n.VerifyStatus||(n.VerifyStatus={}));var a;!function(e){e[e.OK=0]="OK",e[e.INVALID=1]="INVALID",e[e.MISSING=2]="MISSING"}(a=n.CosignedVerifyStatus||(n.CosignedVerifyStatus={}));var u=function(e){function n(t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null);var i=e.call(this)||this;return o.MessageBase.isEmptyConstructor([t,n,r])?i:(i.setDomain(t).setHash(n),null!=r&&i.setSignatures(r),i)}return t(n,e),n.prototype.setDomain=function(e){return i["default"].isString(e)||this.incorrectFieldType("domain"),this.domain=e,this},n.prototype.getDomain=function(){return this.domain},n.prototype.setHash=function(e){return e=i["default"].fromByteBuffer(e),e instanceof Buffer||this.incorrectFieldType("hash"),this.hash=e,this},n.prototype.getHash=function(){return this.hash},n.prototype.setSignatures=function(e){var t={};for(var n in e){i["default"].isString(n)||this.incorrectFieldType("signatures (Domain)");var r=e[n],o=s.Packet.decodePacket(s.Signature,r),a="";void 0==o&&("object"!=typeof r&&this.incorrectFieldType("signature"),"string"!=typeof r.info&&this.incorrectFieldType("signature[info]"),a=r.info,r.signature&&("string"!=typeof r.signature&&this.incorrectFieldType("signature[signature type]"),o=s.Packet.decodePacket(s.Signature,r.signature),void 0==o&&this.incorrectFieldType("signatures"))),t[n]={signature:o,info:a}}return this.signatures=t,this},n.prototype.getSignatures=function(){return this.signatures},n.prototype.validate=function(){null===this.getDomain()&&this.missingField("domain"),null===this.getHash()&&this.missingField("hash")},n.prototype.psonSerialize=function(){this.validate();var e={domain:this.getDomain(),hash:this.getHash()},t=this.getSignatures();if(null!=t){e.signatures={};for(var n in t){var r=t[n];e.signatures[n]={signature:r.signature?r.signature.serialize().toString("base64"):null,info:r.info}}}return e},n.prototype.psonDeserialize=function(e){e.domain&&this.setDomain(e.domain),e.hash&&this.setHash(e.hash),e.signatures&&this.setSignatures(e.signatures),this.validate()},n.prototype.verify=function(e,t,n){var i=this.verifyFull(e,t,n);return i.status===r.OK},n.prototype.verifyFull=function(e,t,n){if(t&&t!=this.getDomain()||n&&!n.equals(this.getHash()))return{status:r.INVALID_STATE,cosigners:[]};var i=Object.keys(e).length,o=0;if(0===i)return{status:r.OK,cosigners:[]};var s=this.getSignatures();if(null==s)return{status:r.INVALID_STATE,cosigners:[]};var u={msg:this.getHash()},c={status:r.OK,cosigners:[]};for(var f in e)if(s[f]){var l=s[f];if(l.signature){var h=l.signature,p=e[f].getKeyById(h.getIssuerId());null!==p&&p.verify(u,h)?(c.cosigners.push({domain:f,status:a.OK,info:l.info}),o+=f===this.domain?.6:1):(c.cosigners.push({domain:f,status:a.INVALID,info:l.info}),c.status=r.HAS_INVALID)}else c.cosigners.push({domain:f,status:a.MISSING,info:l.info})}else c.cosigners.push({domain:f,status:a.MISSING,info:""});return c.status==r.HAS_INVALID?c:2*o>i?c:(c.status=r.NO_QUORUM,c)},n.decode=function(e){return o.MessageBase.decodeMessage(n,e)},n}(o.MessageBase);n["default"]=u}).call(this,e("buffer").Buffer)},{"../KeyStore":292,"../Utils":305,"./MessageBase":297,buffer:590}],300:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("../BitString"),i=e("../ErrorCodes"),o=e("../Utils"),s=e("./MessageBase"),a=e("../KeyStore"),BN=e("bn.js"),u=e("elliptic"),c=e("create-hash"),f=e("../Types"),l=u.ec("secp256k1"),h=function(e){function n(t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null);var i=e.call(this)||this;return i.value=null,i.s=null,i.t=null,s.MessageBase.isEmptyConstructor([t,n,r])?i:(i.setValue(t).setProof(n,r),i)}return t(n,e),n.H2=function(e){var t=c("sha256");t.update(e);var n=t.digest();return new BN(n).umod(l.n)},n.H1=function(e){return l.g.mul(n.H2(e))},n.prototype.verify=function(e,t){var r=this.getProof(),i=r[0],o=r[1],s=new Buffer(e),u=n.H1(s),c=l.keyFromPublic(this.getValue().bytes()).getPublic(),h=t.getPrimaryKey().keyPair;if(h.getKeyAlgorithm()!=f.keystore.PublicKeyAlgorithm.ECDSA||!(h instanceof a.EccKeyPair))return!1;var p=h,d=Buffer.concat([s,new Buffer(l.g.mul(o).add(p.getPublic().mul(i)).encode()),new Buffer(u.mul(o).add(c.mul(i)).encode())]);return n.H2(d).eq(i)},n.FromJson=function(e){if(!e.value||!Array.isArray(e.proof)||2!=e.proof.length)throw{msg:"Incorrect VRF json",value:e,code:i.ErrorCodes.PARSE_FAILURE};var t=o["default"].decodeBitString(e.value),r=new BN(e.proof[0],16),s=new BN(e.proof[1],16);return new n(t,r,s)},n.prototype.setValue=function(e){return e=o["default"].fromByteBuffer(e),e instanceof Buffer&&(e=r["default"].decode(e)),e instanceof r["default"]||this.incorrectFieldType("value"),this.value=e,this},n.prototype.getValue=function(){return this.value},n.prototype.setProof=function(e,t){return e=o["default"].fromByteBuffer(e),e instanceof Buffer&&(e=new BN(e)),e instanceof BN||this.incorrectFieldType("proof - s"),this.s=e,t=o["default"].fromByteBuffer(t),t instanceof Buffer&&(t=new BN(t)),t instanceof BN||this.incorrectFieldType("proof - t"),this.t=t,this},n.prototype.getProof=function(){return null===this.s||null===this.t?null:[this.s,this.t]},n.prototype.validate=function(){null===this.getValue()&&this.missingField("value"),null===this.getProof()&&this.missingField("proof (s,t)")},n.prototype.psonSerialize=function(){this.validate();var e=this.getProof(),t=e[0],n=e[1];return{value:this.getValue().encode(),s:t.toArrayLike(Buffer),t:n.toArrayLike(Buffer)}},n.prototype.psonDeserialize=function(e){e.value&&this.setValue(e.value),e.s&&e.t&&this.setProof(e.s,e.t),this.validate()},n.decode=function(e){return s.MessageBase.decodeMessage(n,e)},n}(s.MessageBase);n["default"]=h}).call(this,e("buffer").Buffer)},{"../BitString":270,"../ErrorCodes":274,"../KeyStore":292,"../Types":304,"../Utils":305,"./MessageBase":297,"bn.js":26,buffer:590,"create-hash":51,elliptic:56}],301:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./LeafMessage");n.LeafMessage=r["default"];var i=e("./AuthPathNodeMessage");n.AuthPathNodeMessage=i["default"];var o=e("./TreeMessage");n.TreeMessage=o["default"];var s=e("./VRFMessage");n.VRFMessage=s["default"];var a=e("./KeyStoreMessage");n.KeyStoreMessage=a["default"];var u=e("./HistoryMessage");n.HistoryMessage=u["default"];var c=e("./TreeSignaturesMessage");n.TreeSignaturesMessage=c["default"];var f=e("./TreeSignaturesMessage");n.VerifyStatus=f.VerifyStatus,n.CosignedVerifyStatus=f.CosignedVerifyStatus},{"./AuthPathNodeMessage":293,"./HistoryMessage":294,"./KeyStoreMessage":295,"./LeafMessage":296,"./TreeMessage":298,"./TreeSignaturesMessage":299,"./VRFMessage":300}],302:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Messages"),i=e("./Messages/TreeSignaturesMessage"),o=e("./KeyStore"),s=e("./RpcClientFactory"),a=e("./ErrorCodes"),u=e("./Cache"),c=e("./CosignersProvider"),f=e("q"),l=e("simplito-logger"),h=function(){
function e(e,t,n,r,i,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.clientFactory=e,this.options=null,this.cosigners=null,this.logger=l.get("dbchain.PrivmxPKI"),null==this.clientFactory&&(this.clientFactory=new s.RpcClientFactory),t&&this.setOptions({domain:t}),this.cosignersProvider=n||new c.CosignersProvider({},3);var a=new u.MemoryCache;this.keyStoreCache=r||a,this.fetchCache=i||a,this.historyCache=o||a}return e.prototype.cacheKey=function(e,t){return e+"."+t},e.prototype.setOptions=function(e){var t=this;return this.overwriteOptions(e).then(function(e){return t.options=e,!0})},e.prototype.setClientRpcFactory=function(e){this.clientFactory=e},e.prototype.getOptions=function(){return null==this.options&&(this.options={domain:"undefined"!=typeof location?location.host:""}),f(this.options)},e.prototype.overwriteOptions=function(e){return this.getOptions().then(function(t){return e||(e={}),"string"!=typeof e.domain&&t.domain&&(e.domain=t.domain),"boolean"!=typeof e.noCache&&t.noCache&&(e.noCache=t.noCache),e})},e.prototype.remoteCall=function(e,t,n){return this.clientFactory.getClient(e).then(function(e){return e.call(t,n)})},e.prototype.getDomainKeyStore=function(t){return this.getKeyStoreFromCache(t,e.SERVER_KEYSTORE).then(function(e){if(null==e)return null;var t=r.KeyStoreMessage.decode(e.keyStoreRawMsg).getKeyStore();return t instanceof o.KeyStore?t:null})},e.prototype.getTreeSignatures=function(e,t,n){var o=this,s=null;n=n||{},n.failOnVerificationError=n.failOnVerificationError!==!1;var u=n.cosigners?f.resolve(n.cosigners):this.cosignersProvider.selectCosigners();return f.all([this.getOptions(),u]).then(function(n){var r=null;r=n[0],s=n[1];var i={domain:e,hash:t,cosigners:Object.keys(s)};return o.remoteCall(r.domain,"getTreeSignatures",i)}).then(function(o){var u=r.TreeSignaturesMessage.decode(o),c=u.verifyFull(s,e,t),f={data:o,msg:u,result:c};if(c.status!=i.VerifyStatus.OK&&n.failOnVerificationError)throw{msg:"Tree Signatures Verification failed",value:f,code2:"status-failure",code:a.ErrorCodes.VERIFICATION_FAILURE};return f})},e.prototype.isValidTreeTimestamp=function(t){return t.getTimestamp()+e.TREE_EXPIRATION_TIME>(new Date).getTime()},e.prototype.getKeyStore=function(t,n){var o=this,s=null,u=Math.floor((new Date).getTime()/1e3);return n=n||{},n.cacheLoad=n.cacheLoad!==!1,n.cacheSave=n.cacheSave!==!1,n.fetchSave=n.fetchSave!==!1,this.overwriteOptions(n.pkiOptions).then(function(e){return s=e,n.cacheLoad&&null==n.revision?o.getKeyStoreFromCache(s.domain,t):null}).then(function(c){if(c&&c.timestamp+e.CACHE_TTL>u){var l=r.KeyStoreMessage.decode(c.keyStoreRawMsg),h={keyStoreRawMsg:c.keyStoreRawMsg,keyStoreMsg:l,keystore:l.getKeyStore(),treeRawMsg:c.treeRawMsg,treeMsg:r.TreeSignaturesMessage.decode(c.treeRawMsg),result:c.result,timestamp:c.timestamp,fetchId:c.fetchId};return h}var p={name:t,includeAttachments:n.includeAttachments||!1,options:s};return n.revision&&(p.revision=n.revision),f.all([o.remoteCall(s.domain,"getKeyStore",p),o.getDomainKeyStore(s.domain)]).then(function(e){var c=e[0],l=e[1],h=r.KeyStoreMessage.decode(c);if(!o.isValidTreeTimestamp(h.getTree()))throw new Error("Tree head is too old");if(!h.verify(p.name,l)){if(h.verify(p.name))throw{msg:"Invalid Server Keystore",value:h,serverKeystore:l,code:a.ErrorCodes.VERIFICATION_FAILURE,errorType:"invalid-server-keystore",result:{keyStoreRawMsg:c,keyStoreMsg:h,keystore:h.getKeyStore(),timestamp:u,fetchId:null}};throw{msg:"Keystore Message Verification failed during get",value:h,code:a.ErrorCodes.VERIFICATION_FAILURE}}var d=h.getTree().getHash();return o.getTreeSignatures(s.domain,d,n.treeOptions).then(function(e){var r={keyStoreRawMsg:c,keyStoreMsg:h,keystore:h.getKeyStore(),treeRawMsg:e.data,treeMsg:e.msg,result:e.result,timestamp:u,fetchId:null};return n.fetchSave?(e.result.status==i.VerifyStatus.OK&&n.cacheSave&&null==n.revision?o.saveNewKeyStoreFetchInCache(s.domain,t,c,e.data,e.result,u):o.saveKeyStoreFetchInCache(c,e.data,e.result,u)).then(function(e){return r.fetchId=e,r}):r},function(e){if(e&&e.code==a.ErrorCodes.VERIFICATION_FAILURE&&"status-failure"==e.code2){var t=e.value,n={keyStoreRawMsg:c,keyStoreMsg:h,keystore:h.getKeyStore(),treeRawMsg:t.data,treeMsg:t.msg,result:t.result,timestamp:u,fetchId:null};e.errorType="invalid-tree-signature",e.pkiResult=n}return f.reject(e)})})})},e.prototype.callMethodByPkiCore=function(e,t,n){var i=this;return f(null).then(function(){return i.overwriteOptions(t.options)}).then(function(r){var o={name:t.name,keystore:t.data.getPublicView().serialize().toString("base64"),kis:t.kis.serialize().toString("base64"),options:r},s=n?n(o):o;return f.all([i.remoteCall(r.domain,e,s),i.getDomainKeyStore(r.domain)])}).then(function(e){var n=e[0],i=e[1],o=r.KeyStoreMessage.decode(n);if(!o.verify(t.name,i))throw{msg:"Keystore Message Verification failed after modify",value:o,code:a.ErrorCodes.VERIFICATION_FAILURE};return o})},e.prototype.unpackParams=function(e){var t=this;return f(null).then(function(){if(!e)throw new Error("Parameters are required");if(!e.data)throw new Error("Parameter data is required");if(!e.name){if(!(e.data instanceof o.KeyStore))throw new Error("Parameter name is required");e.name=(e.prefix||"user:")+e.data.getPrimaryUserId()}if(!e.kis)return f(null).then(function(){return t.getHead()}).then(function(t){if(null==t)throw{msg:"Cannot load head",value:e,code:a.ErrorCodes.INVALID_DATA};e.kis=e.data.generateKis(t.getHash())})}).thenResolve(e)},e.prototype.callMethodByPki=function(e,t,n){var r=this;return this.unpackParams(t).then(function(t){return r.callMethodByPkiCore(e,t,n)})},e.prototype.insertKeyStore=function(e){return this.callMethodByPki("insertKeyStore",e)},e.prototype.updateKeyStore=function(e){return this.callMethodByPki("updateKeyStore",e)},e.prototype.insertOrUpdateKeyStore=function(e){return this.callMethodByPki("insertOrUpdateKeyStore",e)},e.prototype.getHistory=function(t,n,i,o){var s=this;void 0===n&&(n=null),void 0===i&&(i=0),void 0===o&&(o=0);var u=null,c="",l=null;return this.overwriteOptions(t).then(function(t){return u=t,s.logger.debug("getHistory requestOptions",u),u.noCache!==!0?(c=s.cacheKey(u.domain,e.HEAD),s.historyCache.load(c)):null}).then(function(e){e&&(l=r.TreeMessage.decode(e));var t={};return null!==n&&(t.revision=n),i>0?t.seq=i:l&&(t.seq=l.getSeq()),o>0&&(t.timestamp=o),f.all([s.remoteCall(u.domain,"getHistory",t),s.getDomainKeyStore(u.domain)])}).then(function(e){var t=e[0],n=e[1],i=r.HistoryMessage.decode(t);if(s.logger.debug("getHistory msg",i),!i.verify(n,l))throw{msg:"History Message Verification failed",value:{msg:i,head:l},code:a.ErrorCodes.VERIFICATION_FAILURE};if(u.noCache!==!0){var o=i.getHistory();o.length>0&&s.historyCache.save(c,o[0].encode("buffer"))}return i})},e.prototype.getHead=function(t){var n=this;return this.overwriteOptions(t).then(function(t){return n.getHistory(t).then(function(i){var o=i.getHistory();if(n.logger.debug("getHead history",o),o&&o.length>0){if(!n.isValidTreeTimestamp(o[0]))throw new Error("Tree head is too old");return o[0]}if(t.noCache===!0)return null;var s=n.cacheKey(t.domain,e.HEAD);return n.historyCache.load(s).then(function(e){return n.logger.debug("getHead cached",e),e?r.TreeMessage.decode(e):null})})})},e.prototype.getServerKeyStore=function(t){return this.getKeyStore(e.SERVER_KEYSTORE,t)},e.prototype.getKeyStoreCacheKey=function(e,t){return"keystore.__CURRENT."+e+"."+t},e.prototype.getKeyStoreFromCache=function(e,t){var n=this,r=this.getKeyStoreCacheKey(e,t);return this.keyStoreCache.load(r).then(function(e){return null==e?null:n.getFetchById(e)})},e.prototype.getFetchById=function(e){return this.fetchCache.load(e).then(function(t){if(null==t)return null;var n={keyStoreRawMsg:t.keyStoreRawMsg,treeRawMsg:t.treeRawMsg,result:t.result,timestamp:t.timestamp,fetchId:e};return n})},e.prototype.getFetchExById=function(e){return this.getFetchById(e).then(function(e){if(null==e)return null;var t=r.KeyStoreMessage.decode(e.keyStoreRawMsg),n={keyStoreRawMsg:e.keyStoreRawMsg,keyStoreMsg:t,keystore:t.getKeyStore(),treeRawMsg:e.treeRawMsg,treeMsg:r.TreeSignaturesMessage.decode(e.treeRawMsg),result:e.result,timestamp:e.timestamp,fetchId:e.fetchId};return n})},e.prototype.generateFetchId=function(){return"fetch."+(new Date).getTime()+"."+Math.floor(1e6*Math.random())},e.prototype.saveKeyStoreFetchInCache=function(e,t,n,r){var i=this.generateFetchId(),o={keyStoreRawMsg:e,treeRawMsg:t,result:n,timestamp:r};return this.fetchCache.save(i,o).then(function(){return i})},e.prototype.saveNewKeyStoreFetchInCache=function(e,t,n,r,i,o){var s=this;return this.saveKeyStoreFetchInCache(n,r,i,o).then(function(n){var r=s.getKeyStoreCacheKey(e,t);return s.keyStoreCache.save(r,n).then(function(){return n})})},e.HEAD="__HEAD",e.SERVER_KEYSTORE="server:",e.OPTIONS="__OPTIONS",e.COSIGNERS="__COSIGNERS",e.CACHE_TTL=2592e3,e.TREE_EXPIRATION_TIME=39e5,e}();n["default"]=h},{"./Cache":271,"./CosignersProvider":272,"./ErrorCodes":274,"./KeyStore":292,"./Messages":301,"./Messages/TreeSignaturesMessage":299,"./RpcClientFactory":303,q:327,"simplito-logger":357}],303:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("pson"),r=e("./ErrorCodes"),i=e("q"),o=e("xhr"),s=function(){function e(e){this.uri=e,this.encoder=null,this.id=0,this.encoder=new t.StaticPair}return e.prototype.handleResponse=function(e,t){var n=this.encoder.decode(t),i={request:e,response:n,uri:this.uri};if(n.id!==e.id)throw{msg:"Invalid rpc id",value:i,code:r.ErrorCodes.RPC_FAILURE};if(n.error)throw{msg:"Server returned error",value:i,code:r.ErrorCodes.RPC_FAILURE};if(void 0===n.result)throw{msg:"Missing result",value:i,code:r.ErrorCodes.RPC_FAILURE};return n.result},e.prototype.call=function(e,t){var n=this,s=i.defer(),a={id:++this.id,method:e,params:t},u=Buffer.from(this.encoder.encode(a).toArrayBuffer());return o.post(this.uri,{body:u,headers:{"Content-Type":"application/octet-stream"},responseType:"arraybuffer"},function(e,t,i){try{if(e||200!==t.statusCode)throw{msg:"Request error",value:{error:e,uri:n.uri,request:a,response:t},code:r.ErrorCodes.RPC_FAILURE};s.resolve(n.handleResponse(a,i))}catch(o){s.reject(o)}}),s.promise},e}();n.RpcClient=s;var a=function(){function e(){this.clients={}}return e.prototype.getClient=function(e){return this.clients[e]||(this.clients[e]=new s(e)),i.resolve(this.clients[e])},e}();n.RpcClientFactory=a}).call(this,e("buffer").Buffer)},{"./ErrorCodes":274,buffer:590,pson:326,q:327,xhr:397}],304:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;!function(e){var t;!function(e){e[e.PUBLIC_KEY_ENCRYPTED_SESSION_KEY=1]="PUBLIC_KEY_ENCRYPTED_SESSION_KEY",e[e.SIGNATURE=2]="SIGNATURE",e[e.SYMMETRIC_KEY_ENCRYPTED_SESSION_KEY=3]="SYMMETRIC_KEY_ENCRYPTED_SESSION_KEY",e[e.ONE_PASS_SIGNATURE=4]="ONE_PASS_SIGNATURE",e[e.SECRET_KEY=5]="SECRET_KEY",e[e.PUBLIC_KEY=6]="PUBLIC_KEY",e[e.SECRET_SUBKEY=7]="SECRET_SUBKEY",e[e.COMPRESSED_DATA=8]="COMPRESSED_DATA",e[e.SYMMETRICALLY_ENCRYPTED_DATA=9]="SYMMETRICALLY_ENCRYPTED_DATA",e[e.MARKER_PACKET=10]="MARKER_PACKET",e[e.LITERAL_DATA=11]="LITERAL_DATA",e[e.TRUST_PACKET=12]="TRUST_PACKET",e[e.USER_ID=13]="USER_ID",e[e.PUBLIC_SUBKEY=14]="PUBLIC_SUBKEY",e[e.USER_ATTRIBUTE=17]="USER_ATTRIBUTE",e[e.SYM_ENCRYPTED_AND_INTEGRITY_PROTECTED_DATA=18]="SYM_ENCRYPTED_AND_INTEGRITY_PROTECTED_DATA",e[e.MODIFICATION_DETECTION_CODE=19]="MODIFICATION_DETECTION_CODE",e[e.PKI_DATA_TYPE=60]="PKI_DATA_TYPE",e[e.ATTACHMENT_POINTER=61]="ATTACHMENT_POINTER",e[e.ATTACHMENT_DATA=62]="ATTACHMENT_DATA"}(t=e.PacketTag||(e.PacketTag={}));var n;!function(e){e[e.BINARY_DOCUMENT_SIGNATURE=0]="BINARY_DOCUMENT_SIGNATURE",e[e.TEXT_DOCUMENT_SIGNATURE=1]="TEXT_DOCUMENT_SIGNATURE",e[e.STANDALONE_SIGNATURE=2]="STANDALONE_SIGNATURE",e[e.GENERIC_PK_USER_ID_CERTIFICATION=16]="GENERIC_PK_USER_ID_CERTIFICATION",e[e.PERSONA_PK_USER_ID_CERTIFICATION=17]="PERSONA_PK_USER_ID_CERTIFICATION",e[e.CASUAL_PK_USER_ID_CERTIFICATION=18]="CASUAL_PK_USER_ID_CERTIFICATION",e[e.POSITIVE_PK_USER_ID_CERTIFICATION=19]="POSITIVE_PK_USER_ID_CERTIFICATION",e[e.SUBKEY_BINDING_SIGNATURE=24]="SUBKEY_BINDING_SIGNATURE",e[e.PRIMARY_KEY_BINDING_SIGNATURE=25]="PRIMARY_KEY_BINDING_SIGNATURE",e[e.SIGNATURE_DIRECTLY_ON_KEY=31]="SIGNATURE_DIRECTLY_ON_KEY",e[e.KEY_REVOCATION_SIGNATURE=32]="KEY_REVOCATION_SIGNATURE",e[e.SUBKEY_REVOCATION_SIGNATURE=40]="SUBKEY_REVOCATION_SIGNATURE",e[e.CERTIFICATION_REVOCATION_SIGNATURE=48]="CERTIFICATION_REVOCATION_SIGNATURE",e[e.TIMESTAMP_SIGNATURE=64]="TIMESTAMP_SIGNATURE",e[e.THIRD_PARTY_CONFIRMATION_SIGNATURE=80]="THIRD_PARTY_CONFIRMATION_SIGNATURE"}(n=e.SignatureType||(e.SignatureType={}));var r;!function(e){e[e.RSA=1]="RSA",e[e.RSA_ENCRYPT_ONLY=2]="RSA_ENCRYPT_ONLY",e[e.RSA_SIGN_ONLY=3]="RSA_SIGN_ONLY",e[e.ELGAMAL_ENCRYPT_ONLY=16]="ELGAMAL_ENCRYPT_ONLY",e[e.DSA=17]="DSA",e[e.ECDH=18]="ECDH",e[e.ECDSA=19]="ECDSA",e[e.ELGAMAL=20]="ELGAMAL",e[e.DIFFIE_HELLMAN=21]="DIFFIE_HELLMAN"}(r=e.PublicKeyAlgorithm||(e.PublicKeyAlgorithm={}));var i;!function(e){e[e.MD5=1]="MD5",e[e.SHA1=2]="SHA1",e[e.RIPEMD160=3]="RIPEMD160",e[e.SHA256=8]="SHA256",e[e.SHA384=9]="SHA384",e[e.SHA512=10]="SHA512",e[e.SHA224=11]="SHA224"}(i=e.HashAlgorithm||(e.HashAlgorithm={}));var o;!function(e){e[e.PLAIN=0]="PLAIN",e[e.IDEA=1]="IDEA",e[e.TRIPLE_DES=2]="TRIPLE_DES",e[e.CAST5=3]="CAST5",e[e.BLOWFISH=4]="BLOWFISH",e[e.AES128=7]="AES128",e[e.AES192=8]="AES192",e[e.AES256=9]="AES256",e[e.TWOFISH=10]="TWOFISH"}(o=e.SymmetricAlgorithm||(e.SymmetricAlgorithm={}));var s;!function(e){e[e.SIGNATURE_CREATION_TIME=2]="SIGNATURE_CREATION_TIME",e[e.SIGNATURE_EXPIRATION_TIME=3]="SIGNATURE_EXPIRATION_TIME",e[e.EXPORTABLE_CERTIFICATION=4]="EXPORTABLE_CERTIFICATION",e[e.THRUST_SIGNATURE=5]="THRUST_SIGNATURE",e[e.REGULAR_EXPRESSION=6]="REGULAR_EXPRESSION",e[e.REVOCABLE=7]="REVOCABLE",e[e.KEY_EXPIRATION_TIME=9]="KEY_EXPIRATION_TIME",e[e.PREFERRED_SYMMETRIC_ALGORITHMS=11]="PREFERRED_SYMMETRIC_ALGORITHMS",e[e.REVOCATION_KEY=12]="REVOCATION_KEY",e[e.ISSUER=16]="ISSUER",e[e.NOTATION_DATA=20]="NOTATION_DATA",e[e.PREFERRED_HASH_ALGORITHMS=21]="PREFERRED_HASH_ALGORITHMS",e[e.PREFERRED_COMPRESSION_ALGORITHMS=22]="PREFERRED_COMPRESSION_ALGORITHMS",e[e.KEY_SERVER_PREFERENCES=23]="KEY_SERVER_PREFERENCES",e[e.PREFERRED_KEY_SERVER=24]="PREFERRED_KEY_SERVER",e[e.PRIMARY_USER_ID=25]="PRIMARY_USER_ID",e[e.POLICY_URI=26]="POLICY_URI",e[e.KEY_FLAGS=27]="KEY_FLAGS",e[e.SIGNER_USER_ID=28]="SIGNER_USER_ID",e[e.REASON_FOR_REVOCATION=29]="REASON_FOR_REVOCATION",e[e.FEATURES=30]="FEATURES",e[e.SIGNATURE_TARGET=31]="SIGNATURE_TARGET",e[e.EMBEDDED_SIGNATURE=32]="EMBEDDED_SIGNATURE",e[e.CONIKS_DB_ID=110]="CONIKS_DB_ID"}(s=e.SubPacketType||(e.SubPacketType={}));var a;!function(e){e[e.CERTIFICATION=1]="CERTIFICATION",e[e.SIGNING=2]="SIGNING",e[e.ENCRYPT_COMMUNICATION=4]="ENCRYPT_COMMUNICATION",e[e.ENCRYPT_STORAGE=8]="ENCRYPT_STORAGE",e[e.SPLIT_KEY=16]="SPLIT_KEY",e[e.AUTHENTICATION=32]="AUTHENTICATION",e[e.GROUP_KEY=128]="GROUP_KEY"}(a=e.KeyFlag||(e.KeyFlag={}));var u;!function(e){e[e.KEYSTORE=1]="KEYSTORE",e[e.DOCUMENT=2]="DOCUMENT"}(u=e.PkiDataType||(e.PkiDataType={}));var c;!function(e){e[e.BINARY=98]="BINARY",e[e.TEXT=116]="TEXT",e[e.UTF8=117]="UTF8"}(c=e.LiteralDataType||(e.LiteralDataType={}))}(r=n.keystore||(n.keystore={}))},{}],305:[function(e,t,n){(function(Buffer){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=e("create-hash"),r=e("elliptic"),i=e("bytebuffer"),o=e("long"),s=e("./BitString"),a=e("./ErrorCodes"),u=e("./Types"),c=r.ec("secp256k1"),f=function(){function e(e,t){this.buffer=e,this.offset=t,this.offset=t||0}return e.prototype.readInt8=function(){var e=this.buffer.readInt8(this.offset);return this.offset++,e},e.prototype.readUInt8=function(){var e=this.buffer.readUInt8(this.offset);return this.offset++,e},e.prototype.readInt16BE=function(){var e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e},e.prototype.readUInt16BE=function(){var e=this.buffer.readUInt16BE(this.offset);return this.offset+=2,e},e.prototype.readInt16LE=function(){var e=this.buffer.readInt16LE(this.offset);return this.offset+=2,e},e.prototype.readUInt16LE=function(){var e=this.buffer.readUInt16LE(this.offset);return this.offset+=2,e},e.prototype.readInt32BE=function(){var e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e},e.prototype.readUInt32BE=function(){var e=this.buffer.readUInt32BE(this.offset);return this.offset+=4,e},e.prototype.readInt32LE=function(){var e=this.buffer.readInt32LE(this.offset);return this.offset+=4,e},e.prototype.readUInt32LE=function(){var e=this.buffer.readUInt32LE(this.offset);return this.offset+=4,e},e.prototype.skip=function(e){this.offset+=e},e.prototype.readBuffer=function(e){var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},e.prototype.readOneOctetLengthBuffer=function(){var e=this.readUInt8();return this.readBuffer(e)},e.prototype.readBufferUntilEnd=function(){var e=this.buffer.slice(this.offset);return this.offset=this.buffer.length,e},e.prototype.canRead=function(e){return this.offset+e<=this.buffer.length},e.prototype.isEnd=function(){return this.offset>=this.buffer.length},e}();n.BufferInputStream=f;var l=function(){function e(e,t){this.buffer=e,this.offset=t,this.offset=t||0}return e.prototype.writeUInt8=function(e){this.buffer.writeUInt8(e,this.offset),this.offset++},e.prototype.writeUInt32BE=function(e){this.buffer.writeUInt32BE(e,this.offset),this.offset+=4},e.prototype.skip=function(e){this.offset+=e},e.prototype.writeBuffer=function(e){e.copy(this.buffer,this.offset),this.offset+=e.length},e.prototype.writeOneOctetLengthBuffer=function(e){this.writeUInt8(e.length),this.writeBuffer(e)},e}();n.BufferOutputStream=l;var h=function(){function e(){}return e.hash=function(e){var n=t("sha256");return n.update(e),n.digest()},e.numberToBuffer=function(e,t){for(var n=[],r=0;r<t;++r){var i=255&e;n.push(i),e=(e-i)/256}return Buffer.from(n.reverse())},e.buffer32b=function(e){return this.numberToBuffer(e,4)},e.buffer64b=function(e){return this.numberToBuffer(e,8)},e.signMessage=function(e,t){var n=t.sign(this.hash(e)),r=n.r.toString("hex"),i=n.s.toString("hex");return r.length%2==1&&(r="0"+r),i.length%2==1&&(i="0"+i),new Buffer("1B"+r+i,"hex")},e.index=function(e){return new s["default"](this.hash(e))},e.sign=function(e,t,n){var r=Buffer.concat([this.hash(new Buffer(e,"ascii")),this.hash(new Buffer(t,"ascii"))]);return this.signMessage(r,n)},e.signUpdate=function(e,t,n){var r=Buffer.concat([e,t]);return this.signMessage(r,n)},e.verify=function(e,t,n){var r=c.keyFromPublic(n),i=0;65==t.length&&27==t[0]&&(i=1);var o={r:t.slice(i,i+32),s:t.slice(i+32)};return r.verify(this.hash(e),o)},e.isString=function(e){return"string"==typeof e||e instanceof String},e.decodeString=function(e){return this.isString(e)?new Buffer(e,"base64"):e},e.decodeBitString=function(e){return this.isString(e)?s["default"].decode(new Buffer(e,"base64")):new s["default"](e)},e.fromByteBuffer=function(e){return e instanceof i&&(e=Buffer.from(e.toArrayBuffer())),e},e.fromLong=function(e){return e instanceof o&&(e=e.toNumber()),e},e.contains=function(e,t){return e.indexOf(t)!=-1},e.containsFunc=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n))return!0;return!1},e.findAll=function(e,t){for(var n=[],r=0;r<e.length;r++)t(e[r],r)&&n.push(e[r]);return n},e.max=function(e,t){for(var n=null,r=0;r<e.length;r++)(null==n||t(n,e[r])<0)&&(n=e[1]);return n},e.hashAlgorithmName=function(e){switch(e){case u.keystore.HashAlgorithm.MD5:return"md5";case u.keystore.HashAlgorithm.SHA1:return"sha1";case u.keystore.HashAlgorithm.RIPEMD160:return"ripemd160";case u.keystore.HashAlgorithm.SHA256:return"sha256";case u.keystore.HashAlgorithm.SHA384:return"sha384";case u.keystore.HashAlgorithm.SHA512:return"sha512";case u.keystore.HashAlgorithm.SHA224:return"sha224";default:throw{msg:"Unknown hash algorithm",value:e,code:a.ErrorCodes.UNSUPPORTED_FEATURE}}},e.hashLength=function(e){switch(e){case u.keystore.HashAlgorithm.MD5:return 16;case u.keystore.HashAlgorithm.SHA1:return 20;case u.keystore.HashAlgorithm.RIPEMD160:return 20;case u.keystore.HashAlgorithm.SHA256:return 32;case u.keystore.HashAlgorithm.SHA384:return 48;case u.keystore.HashAlgorithm.SHA512:return 64;case u.keystore.HashAlgorithm.SHA224:return 28;default:throw{msg:"Unknown hash algorithm",value:e,code:a.ErrorCodes.UNSUPPORTED_FEATURE}}},e.hashWithAlgorithm=function(n,r){var i=t(e.hashAlgorithmName(r));return i.update(n),i.digest()},e}();n["default"]=h}).call(this,e("buffer").Buffer)},{"./BitString":270,"./ErrorCodes":274,"./Types":304,buffer:590,bytebuffer:48,"create-hash":51,elliptic:56,"long":133}],306:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./KeyStore");n.KeyStore=r;var i=e("./Messages");n.messages=i;var o=e("./BitString");n.BitString=o["default"];var s=e("./Cache");n.Cache=s;var a=e("./CosignersProvider");n.CosignersProvider=a;var u=e("./Enumerable");n.Enumerable=u;var c=e("./ErrorCodes");n.ErrorCodes=c.ErrorCodes;var f=e("./PrivmxPKI");n.PrivmxPKI=f["default"];var l=e("./RpcClientFactory");n.rpc=l;var h=e("./Types");n.Types=h;var p=e("pson");n.StaticPair=p.StaticPair;var d=function(){function e(){}return e.decodeKeystore=function(e){return r.Packet.decodePacket(r.KeyStore,e)},e.decodeDocuments=function(e){return r.Packet.decodePacket(r.DocumentsPacket,e)},e.createEccKeystore=function(e,t){return r.KeyStore.createFromKeyPair(e,new r.EccKeyPair(t))},e}();n.Helper=d},{"./BitString":270,"./Cache":271,"./CosignersProvider":272,"./Enumerable":273,"./ErrorCodes":274,"./KeyStore":292,"./Messages":301,"./PrivmxPKI":302,"./RpcClientFactory":303,"./Types":304,pson:326}],307:[function(e,t,n){(function(Buffer){"use strict";var n=e("./StreamBuffer"),r=e("simplito-logger"),i=e("xhr2"),o=e("q"),s=r.get("privmx-rpc.PrivmxAjaxChannel"),a=function(){function e(e,t){this.messages=[],this.timer=null,this.connected=!1,this.autosending=!1,this.currentReadStateId=null,this.messagesSize=0,this.maxMessagesNumber=250,this.maxMessagesSize=131072,this.config=e,this.connection=t}return e.prototype.setCurrentReadState=function(e){this.currentReadStateId=e},e.prototype.connect=function(e){return this.connected=!0,o(null).thenResolve(null)},e.prototype.postMessage=function(e,t){if(void 0===t&&(t=!1),this.connection.broken)throw"Connection Broken";if(!this.connected)throw"Not Connected";try{null!=e?(s.debug("postMessage: ",e.toString("hex")),this.messages.push({buf:e}),this.messagesSize+=e.length):s.debug("postMessage: message null (it's not a bug) "),s.debug("Current messages size:",this.messagesSize),this.enableTimer(t)}catch(n){throw n}},e.prototype.disconnect=function(){},e.prototype.send=function(e){var t=this;void 0===e&&(e=!1),s.debug("sending package");var r=null;try{var o=this.currentReadStateId,a=[];if(this.messages.forEach(function(e){t.onMessage&&a.push(e.buf)}),this.messages=[],this.messagesSize=0,0==a.length)return;this.timer=null;var u=this,c=new i;c.open("POST",this.config.url,!0),c.responseType="arraybuffer",c.setRequestHeader("Content-Type","application/octet-stream"),r=this.messages,c.onload=function(e){var r=e.currentTarget.status;if(200!=r)return s.warn("Wrong response status: "+r),void t.connection.stopAll("Wrong response status: "+r);var i=c.response;s.getLevel()==s.DEBUG&&s.debug("Received: ",Buffer.from(i).toString("hex"));var a=new n;a.write(Buffer.from(i)),u.onMessage(a,o)};var f=Buffer.concat(a);s.getLevel()==s.DEBUG&&a.forEach(function(e,t){s.debug("sending "+(t+1)+"/"+a.length+": ",e.toString("hex"))}),c.onerror=function(e){s.warn("AjaxChannel error:",e),t.connection.stopAll("AjaxChannel error")},c.send(f)}catch(l){return s.warn("AjaxChannel error:",l),void this.connection.stopAll("AjaxChannel error")}},e.prototype.stop=function(){this.autosending=!1,this.connected=!1,this.timer&&clearTimeout(this.timer);this.messages;this.messages=[],this.maxMessagesSize=0,this.currentReadStateId=null},e.prototype.enableTimer=function(e){if(void 0===e&&(e=!1),s.debug("enableTimer, messagesSize: "+this.messagesSize),this.messages.length>this.maxMessagesNumber||this.messagesSize>this.maxMessagesSize||e)return this.messages.length>this.maxMessagesNumber&&s.debug("Sending - number of messages"),this.messagesSize>this.maxMessagesSize&&s.debug("Sending - size"),e&&s.debug("Sending - sendNow falg"),this.timer&&clearTimeout(this.timer),void this.send(e);if(null==this.timer&&0!=this.autosending){var t=this;this.timer=setTimeout(function(){s.debug("Sending - timer (adding to Queue)"),t.connection.sendQueue=t.connection.sendQueue.then(function(){s.debug("Sending - NOW!"),t.send()})},0)}},e}();t.exports=a}).call(this,e("buffer").Buffer)},{"./StreamBuffer":314,buffer:590,q:327,"simplito-logger":357,xhr2:398}],308:[function(e,t,n){(function(Buffer){"use strict";var n=e("./RwState"),r=e("./Session"),i=e("./PrivmxAjaxChannel"),o=e("./Types"),s=e("q"),a=e("pson"),u=e("simplito-logger"),c=e("elliptic"),f=c.ec,l=e("randombytes"),h=e("bytebuffer"),p=e("privmx-crypto"),d=e("simplito-utils"),g=p.service,y=p.serviceSync,m=p.ecc,v=u.get("privmx-rpc.PrivmxConnection"),b=function(){function e(e,t){this.version=1,this.maxDataLengthForSyncHmac=256,this.tickets={},this.usedTickets={},this.connecting=null,this.broken=!1,this.maxKeysNumber=256,this.minKeysNumber=4,this.ttlTreshold=6e4,this.ticketsTTL=null,this.minTicketTTL=5e3,this.currentReadStateId=0,this.savedStates={},this.srpDeferred=null,this.keyDeferred=null,this.ticketHandshakeInProgress=!1,this.calls={},this.waitingMessages=[],this.ticketProblem=!1,this.config=e,this.rpc=t,this.initChannel(),this.codec=new a.StaticPair(["type","ticket","tickets","ticket_id","ticket_request","ticket_response","ecdhe","ecdh","key","count","client_random"]),this.writeState=new n,this.readState=new n,this.session=new r,this.clientRandom=Buffer.alloc(0),this.serverRandom=Buffer.alloc(0),this.sendQueue=s()}return e.prototype.clone=function(t){var r=new e(this.config,t);r.ekey=this.ekey,r.clientRandom=this.clientRandom,r.serverRandom=this.serverRandom,r.masterSecret=this.masterSecret,r.broken=this.broken,r.channel.connected=this.channel.connected,r.channel.autosending=this.channel.autosending,r.session.save("srp_data",this.session.get("srp_data"));var i=Object.keys(this.tickets).reverse()[0];r.tickets[i]=this.tickets[i],delete this.tickets[i];var o=this.session.get("srp_data");return r.setPreMasterSecret(this.fillTo32(o.K),{readState:new n,nextReadState:new n}).then(function(){return r})},e.prototype.initChannel=function(){this.channel=new i(this.config,this),this.channel.onMessage=this.process.bind(this)},e.prototype.connect=function(e){var t=this,n=s.defer();return this.connecting?this.connecting.promise:(this.connecting=n,this.channel.connect().then(function(){return s().then(function(){return t.ecdheHandshake()}).then(function(){return t.ticketRequest(t.maxKeysNumber)}).then(function(){return t.channel.send(!0),t.channel.autosending=!0,n.promise.timeout(e).then(function(){v.info("resetuje"),t.reset()})})})["catch"](function(e){throw v.warn("Error during connecting: ",e),t.stopAll("Error during connecting: "+e.toString()),e}))},e.prototype.ecdheHandshake=function(){if(this.session.contains("ecdhe_key"))throw v.warn("Invalid handshake state"),new Error("Invalid handshake state");var e=new f("secp256k1"),t=e.genKeyPair();this.ekey=t;var n={type:"ecdhe",agent:this.config.agent,key:Buffer.from(t.getPublic(!0,"binary"))};this.session.save("ecdhe_key",{pub:Buffer.from(t.getPublic(!0,"binary")),pubEnc:"hex",priv:t.getPrivate("hex"),privEnc:"hex"}),this.sendMessage(n,o.ContentType.HANDSHAKE,!0)},e.prototype.keyHandshake=function(e,t){var n=s.defer();this.keyDeferred=n;var r=e.getPublicKey(),i={type:"key_init",agent:this.config.agent,pub:r.toBase58DER(),properties:t},a=l(32),u={priv:e,type:"key",K:a};return this.session.save("srp_data",u),this.addToQueue(i,o.ContentType.HANDSHAKE),n.promise},e.prototype.onKeyInit=function(e,t){var n=this;v.debug("onKeyInit",e);var r=this.session.get("srp_data");r.sessionId=e.sessionId,r.I=e.I;var i,s=m.PublicKey.fromBase58DER(e.pub),a=l(32).toString("base64"),u=r.priv,c=(new Date).getTime().toString();return this.session.save("srp_data",r),this.session.save("serverAgent",e.agent),g.eciesEncrypt(u,s,r.K).then(function(e){i=e.toString("base64");var t="login"+i+" "+a+" "+c;return g.signToCompactSignatureWithHash(u,Buffer.from(t,"utf8"))}).then(function(t){var r={type:"key_exchange",sessionId:e.sessionId,nonce:a,timestamp:c,K:i,signature:t.toString("base64"),tickets:n.maxKeysNumber};return n.addToQueue(r,o.ContentType.HANDSHAKE)})},e.prototype.fillTo=function(e,t){if(e.length<t){var n=new Buffer(t-e.length);return n.fill(0),Buffer.concat([n,e])}return e.length>t?e.slice(0,t):e},e.prototype.fillTo32=function(e){return this.fillTo(e,32)},e.prototype.onKeyExchange=function(e,t){var n=this;v.debug("onKeyExchange",e);var r=this.session.get("srp_data");return Object.keys(this.tickets).forEach(function(e){delete n.tickets[e]}),v.getLevel()==v.DEBUG&&(v.debug("onKeyExchange: srp_data: ",r),v.debug("onKeyExchange: K: ",r.K.toString("hex"))),s().then(function(){return n.setPreMasterSecret(n.fillTo32(r.K),t)}).then(function(){var t=n.getTTLDate(e);e.tickets.forEach(function(e){var r=Buffer.from(e.toString("binary"),"binary");v.getLevel()==v.DEBUG&&v.debug("onKeyExchange: add ticket: ",r.toString("hex")),n.addTicket(r,t)});var r=n.keyDeferred;return n.keyDeferred=null,r.resolve(n.session.get("srp_data"))})},e.prototype.srpHandshake=function(e,t,n){var r=s.defer();this.srpDeferred=r;var i=e.split("#");if(2!=i.length)throw v.warn("Incorrect hashmail "+e),new Error("Incorrect hashmail "+e);var a=i[0],u=i[1];if(this.session.contains("srp_data"))throw v.warn("Invalid srpHandshake state"),new Error("Invalid srpHandshake state");var c={type:"srp_init",agent:this.config.agent,I:a,host:u,properties:n};return this.session.save("srp_data",{I:a,password:t,host:u}),this.addToQueue(c,o.ContentType.HANDSHAKE),r.promise},e.prototype.ticketRequest=function(e){void 0===e&&(e=1);var t={type:"ticket_request",count:e};return this.sendMessage(t,o.ContentType.HANDSHAKE,!0)},e.prototype.addToQueue=function(e,t,n){var r=this;return void 0===t&&(t=o.ContentType.APPLICATION_DATA),void 0===n&&(n=!1),s().then(function(){if(r.broken)throw"Connection Broken";if(!r.channel.connected)throw"Not connected";return r.sendQueue=r.sendQueue.then(function(){return v.debug("Sending message: ",e.id,n),r.sendMessage(e,t,!0,n)}).then(function(t){v.debug("Finished sending message: ",e.id)}).fail(function(e){return v.warn("Error on addToQueue",e),r.stopAll("Error on addToQueue"+e.toString()),s.reject(e)})})},e.prototype.sendMessage=function(e,t,n,r){var i=this;void 0===t&&(t=o.ContentType.APPLICATION_DATA),void 0===n&&(n=!0),void 0===r&&(r=!1),v.info("sendMessage: type",t,", sendNow",r,", message:",e);var a=!1;return s().then(function(){r&&(v.info("force sending"),i.channel.enableTimer(!0)),i.dropExpiredTickets();var o=Object.keys(i.tickets).length;if(v.info("ticketHandshakeInProgress: "+i.ticketHandshakeInProgress+", doTicketHandshake: "+n+", channel.messages.length: "+i.channel.messages.length+", ticketsCount: "+o),i.ticketProblem&&!i.ticketHandshakeInProgress&&"ticket_request"!=e.type){var u={message:e,contentType:t,sendNow:r};v.info("Message put on waiting list (ticket request already sent):",u),i.waitingMessages.push(u),a=!0}else if(!i.ticketHandshakeInProgress&&n&&i.channel.autosending&&0==i.channel.messages.length)return i.ticketHandshakeInProgress=!0,s().then(function(){return i.reset(),i.ticketHandshake()}).then(function(){i.ticketHandshakeInProgress=!1,v.info("ticketsCount: ",o);var n=(new Date).getTime();if(o<i.minKeysNumber||null!==i.ticketsTTL&&i.ticketsTTL<=n){i.ticketsTTL=null,v.info("asking for tickets: "+i.maxKeysNumber),i.ticketProblem=!0;var s={message:e,contentType:t,sendNow:r};return v.info("Message put on waiting list:",s),i.waitingMessages.push(s),
a=!0,i.ticketRequest(i.maxKeysNumber).then(function(){i.channel.postMessage(null,!0)})}})}).then(function(){if(!a)return v.info("Sending ",t,e.type?e.type:e.method?e.method:"changeCipher",e),i.encodeMessage(e,t).then(function(e){i.channel.postMessage(e,r)})})},e.prototype.buildFrame=function(e,t){var n=this;void 0===t&&(t=o.ContentType.APPLICATION_DATA);var r=e.length;return s(null).then(function(){if(n.writeState.initialized){v.debug("Creating crypted message"),r>0&&(r=r+16>>4<<4);var i=null;i=Buffer.alloc(8),i.writeUInt8(n.version,0),i.writeUInt8(t,1),i.writeUInt32BE(r,2),i.writeUInt8(0,6),i.writeInt8(0,7);var o=Buffer.alloc(8);o.writeUInt32BE(n.writeState.sequenceNumber>>8,0),o.writeUInt32BE(255&n.writeState.sequenceNumber,4),o=Buffer.concat([o,i]);var s,a,u=void 0,c=y.hmacSha256(n.writeState.macKey,o);if(u=c.slice(0,8),i=Buffer.concat([i,u]),v.getLevel()==v.DEBUG&&v.debug("source header:",i.toString("hex")),s=new Buffer(0),a=new Buffer(0),i=y.aes256EcbEncrypt(i,n.writeState.key),v.getLevel()==v.DEBUG&&v.debug("crypted header: ",i.toString("hex")),n.writeState.sequenceNumber+=1,r>0){var f=Buffer.from(i);return g.aes256CbcPkcs7Encrypt(e,n.writeState.key,f).then(function(e){s=e;var t=Buffer.concat([o,f,s]);return t.byteLength<n.maxDataLengthForSyncHmac?void(a=y.hmacSha256(n.writeState.macKey,t).slice(0,16)):g.hmacSha256(n.writeState.macKey,t).then(function(e){a=e.slice(0,16)})}).then(function(){var e=Buffer.concat([i,s,a]);return v.getLevel()==v.DEBUG&&(v.debug("sending crypted - key:",n.writeState.key.toString("hex")),v.debug("sending crypted - macKey:",n.writeState.macKey.toString("hex")),v.debug("sending crypted - message:",e.toString("hex"))),e})}var l=Buffer.concat([i,s,a]);return v.getLevel()==v.DEBUG&&(v.debug("sending crypted - key:",n.writeState.key.toString("hex")),v.debug("sending crypted - macKey:",n.writeState.macKey.toString("hex")),v.debug("sending crypted - message:",l.toString("hex"))),l}var h=null;h=new Buffer(8),h.writeUInt8(n.version,0),h.writeUInt8(t,1),h.writeUInt32BE(r,2),h.writeUInt8(0,6),h.writeUInt8(0,7);var p=Buffer.concat([h,e]);return v.getLevel()==v.DEBUG&&v.debug("sending plain - message:",p.toString("hex")),p})},e.prototype.dropExpiredTickets=function(){for(var e=(new Date).getTime(),t=0,n=0,r=Object.keys(this.tickets);n<r.length;n++){var i=r[n];this.tickets[i].ttl.getTime()-this.minTicketTTL>e||(delete this.tickets[i],++t)}0!==t&&v.debug("Deleted "+t+" expired tickets")},e.prototype.hasTickets=function(){return this.dropExpiredTickets(),Object.keys(this.tickets).length>0},e.prototype.getTTLDate=function(e){var t=new Date;return t.setSeconds(t.getSeconds()+e.ttl),t},e.prototype.ticketHandshake=function(){var e=this;if(v.info("ticket handshake, tickets left: "+Object.keys(this.tickets).length),0==Object.keys(this.tickets).length)throw v.warn("No tickets"),this.stopAll("No tickets"),new Error("No tickets");var t=Object.keys(this.tickets)[0],n=this.tickets[t];delete this.tickets[t],this.usedTickets[t]=n;var r=this.generateTicketId();v.getLevel()==v.DEBUG&&v.debug("ticketHandshake - clientRandom",r.toString("hex")),v.info("ticketHandshake with ticket: ",t," stateId: "+this.currentReadStateId);var i={id:this.generateId(),type:"ticket",ticket_id:Buffer.from(t,"hex"),client_random:r};return this.channel.setCurrentReadState(this.currentReadStateId),this.sendMessage(i,o.ContentType.HANDSHAKE,!1).then(function(){return e.restore(n,r)}).then(function(){e.savedStates[e.currentReadStateId]={id:t,clientRandom:r},e.currentReadStateId+=1})},e.prototype.process=function(e,t){var r=this;v.info("process",this.config.destination);var i=Buffer.alloc(0);null!==t&&v.info("Processing id: ",t,", ticket: ",this.savedStates[t]);var a=null;s().then(function(){if(null!=t){var e=r.usedTickets[r.savedStates[t].id];if(!e)throw new Error("Wrong ticket");var i=r.savedStates[t].clientRandom,o=e.data.masterSercret;return r.getFreshRWStates(o,i,Buffer.from(r.savedStates[t].id,"hex")).then(function(e){a={readState:new n,nextReadState:e.readState}})}a={readState:r.readState,nextReadState:r.nextReadState}}).then(function(){v.debug("readStates (for "+t+"): ",JSON.parse(JSON.stringify(a)));s();e.readAll(function(e){i=Buffer.concat([i,e]);var t=!1,n=function(e){return e().then(function(){return t?(v.debug("process: loop finished"),s.resolve(null)):n(e)})};return n(function(){return s().then(function(){if(v.debug("process: loop execution"),null!=a){if(a.readState.initialized&&i.length<16||!a.readState.initialized&&i.length<8)return void(t=!0)}else if(r.readState.initialized&&i.length<16||!r.readState.initialized&&i.length<8)return void(t=!0);return r.parseHeader(i,a).then(function(e){var n=e.headerLength+e.frameLength+e.macLength;if(i.length<n)return void(t=!0);var o=i.slice(0,n);return i=i.slice(e.headerLength+e.frameLength+e.macLength,i.length),r.processMessage(o,e,a).then(function(){v.debug("process: received.length",i.length),i.length<=0&&(t=!0)})})})})}).then(function(){null!=t&&(delete r.usedTickets[r.savedStates[t].id],delete r.savedStates[t])}).fail(function(e){throw v.warn("process: error -",e),r.sendMessage(e,o.ContentType.ALERT),r.stopAll("process error: "+e.toString()),e})})},e.prototype.processMessage=function(e,t,n){var r=this;v.info("processMessage"),v.getLevel()==v.DEBUG&&(v.debug("processMessage: input:",e.toString("hex")),v.debug("processMessage: headerInfo:",t));var i,a=t.frameSeed,u=t.iv,c=t.headerLength,f=t.frameContentType,l=t.frameLength,h=!1;return n.readState.initialized&&(n.readState.sequenceNumber+=1),s().then(function(){if(l>0){var t=e.slice(c,c+l);if(n.readState.initialized){h=!0;var r=e.slice(c+l,c+l+16),o=Buffer.concat([a,u,t]),s=void 0,f=y.hmacSha256(n.readState.macKey,o);if(s=f.slice(0,16),r.toString("hex")!=s.toString("hex"))throw v.warn("processMessage: invalid frame MAC"),new Error("Invalid frame MAC");return g.aes256CbcPkcs7Decrypt(t,n.readState.key,u).then(function(e){i=e})}i=t}else i=Buffer.alloc(0)}).then(function(){switch(f){case o.ContentType.HANDSHAKE:v.info("HANDSHAKE received");var e=r.codec.decode(i);if("ecdhe"==e.type)return v.info("processMessage: ecdhe"),r.onEcdheHandshake(e,n);if("ticket_response"==e.type)return v.info("processMessage: ticket_response"),r.onTicketResponse(e);if("srp_init"==e.type)return v.info("processMessage: srp_init"),r.onSrpInit(e);if("srp_exchange"==e.type)return v.info("processMessage: srp_exchange"),r.onSrpExchange(e,n);if("key_init"==e.type)return v.info("processMessage: key_init"),r.onKeyInit(e,n);if("key_exchange"==e.type)return v.info("processMessage: key_exchange"),r.onKeyExchange(e,n);v.warn("processMessage: unknown packet: ",e);break;case o.ContentType.CHANGE_CIPHER_SPEC:return r.inChangeCipherSpec(n);case o.ContentType.APPLICATION_DATA:if(v.debug("processMessage: application data processed"),!h)throw v.warn("processMessage: plain application data received"),new Error("Plain application data received");if(i.length>0){var t=r.codec.decode(i);t=r.clearBuffors(t),r.onReceivedMessage(t)}break;case o.ContentType.ALERT:throw v.warn("processMessage: Got ALERT: ",i.toString()),r.stopAll("processMessage - got ALERT: "+i.toString()),new Error(i.toString());default:throw r.stopAll("processMessage - not implemented: "+f),new Error("processMessage: Not implemented: "+f)}})},e.prototype.stopAll=function(e){var t=this,n="Connection Broken";e&&(n+=" ("+e+")"),v.warn("Stop All "+n),this.broken=!0,Object.keys(this.calls).forEach(function(e){t.calls[e].deferred.reject(n)}),this.connecting&&this.connecting.reject(n),this.srpDeferred&&this.srpDeferred.reject(n),this.keyDeferred&&this.keyDeferred.reject(n),this.calls={},this.sendQueue=s(),this.channel.stop(),this.tickets={},this.usedTickets={},this.connecting=null,this.srpDeferred=null,this.keyDeferred=null,this.reset()},e.prototype.clearBuffors=function(e){return Object.keys(e).forEach(function(t){e[t]instanceof h&&(e[t]=Buffer.from(e[t].toArrayBuffer()))}),e},e.prototype.reset=function(){v.debug("reset"),this.writeState=new n,this.readState=new n,this.nextWriteState=new n,this.nextReadState=new n,this.clientRandom=Buffer.alloc(0),this.serverRandom=Buffer.alloc(0),this.masterSecret=Buffer.alloc(0)},e.prototype.disconnect=function(){},e.prototype.encodeMessage=function(e,t){var n=Buffer.from(this.codec.encode(e).toString("binary"),"binary");return this.buildFrame(n,t).then(function(e){return e})},e.prototype.onSrpExchange=function(e,t){var n=this;v.debug("onSrpExchange",e);try{var r=this.session.get("srp_data");if(r.M2.toString("hex")!=e.M2)throw v.warn("onSrpExchange: Invalid M2 "+r.M2.toString("hex")+" != "+e.M2),new Error("Invalid M2 "+r.M2.toString("hex")+" != "+e.M2);return Object.keys(this.tickets).forEach(function(e){delete n.tickets[e]}),v.getLevel()==v.DEBUG&&(v.debug("onSrpExchange: srp_data: ",r),v.debug("onSrpExchange: K: ",r.K.toString("hex"))),s().then(function(){return n.setPreMasterSecret(n.fillTo32(r.K),t)}).then(function(){var t=n.getTTLDate(e);e.tickets.forEach(function(e){var r=Buffer.from(e.toString("binary"),"binary");v.getLevel()==v.DEBUG&&v.debug("onSrpExchange: add ticket: ",r.toString("hex")),n.addTicket(r,t)});var i=n.srpDeferred;return n.srpDeferred=null,delete r.password,n.session.save("srp_data",r),v.debug("clearing session from user data"),i.resolve(r)})["catch"](function(e){throw v.warn("Error during onSrpExchange: ",e.toString()),n.stopAll("Error during onSrpExchange: "+e.toString()),e})}catch(i){v.warn("Error during onSrpExchange: ",i.toString()),this.stopAll("Error during onSrpExchange: "+i.toString())}},e.prototype.onSrpInit=function(e,t){var n=this;try{v.info("onSrpInit");var r=this.session.get("srp_data"),i={g:new Buffer(d.padHex(e.g),"hex"),N:new Buffer(d.padHex(e.N),"hex"),s:new Buffer(d.padHex(e.s),"hex"),B:new Buffer(d.padHex(e.B),"hex"),k:new Buffer(d.padHex(e.k),"hex")},s=g.getPasswordMixer(),a=s.deserializeData(e.loginData);return this.session.save("serverAgent",e.agent),s.perform(new Buffer(r.password,"utf8"),a).then(function(e){return r.mixed=e,g.srpLoginStep1(i.N,i.g,i.s,i.B,i.k,r.I,e.toString("base64"))}).then(function(t){r.K=t.K,r.M2=t.M2,n.session.save("srp_data",r),v.getLevel()==v.DEBUG&&(v.debug("onSrpInit: K: ",t.K.toString("hex")),v.debug("onSrpInit: M1: ",t.M1.toString("hex")),v.debug("onSrpInit: M2: ",t.M2.toString("hex")));var i={type:"srp_exchange",A:t.A.toString("hex"),M1:t.M1.toString("hex"),sessionId:e.sessionId,tickets:n.maxKeysNumber};return n.addToQueue(i,o.ContentType.HANDSHAKE)})["catch"](function(e){throw v.warn("Error while onSrpInit (in promise): ",e),n.stopAll("Error while onSrpInit (in promise): "+e.toString()),e})}catch(u){v.warn("Error during onSrpInit: ",u),this.stopAll("Error while onSrpInit (in promise): "+u.toString())}},e.prototype.onEcdheHandshake=function(e,t){var n=this;v.info("onEcdheHandshake");var r,i=new f("secp256k1");return s().then(function(){if(!n.session.contains("ecdhe_key")){r=i.genKeyPair();var e={type:"ecdhe",agent:n.config.agent,key:Buffer.from(r.getPublic(!0,"binary"))};return n.addToQueue(e,o.ContentType.HANDSHAKE)}r=i.keyPair(n.session.get("ecdhe_key"))}).then(function(){n.session.save("serverAgent",e.agent);var o=i.keyFromPublic(Buffer.from(e.key.toString("binary"),"binary")),s=Buffer.from(r.derive(o.getPublic()).toString("hex",2).trim(),"hex");return n.setPreMasterSecret(n.fillTo32(s),t)})["catch"](function(e){throw v.warn("Error during onEcdheHandshake: ",e),n.stopAll("Error during onEcdheHandshake: "+e.toString()),e})},e.prototype.setPreMasterSecret=function(e,t){var n,r=this,i=this.clientRandom,o=this.serverRandom;return g.prf_tls12(e,Buffer.concat([Buffer.from("master secret"),i,o]),48).then(function(t){n=t,r.masterSecret=n,v.getLevel()==v.DEBUG&&(v.debug("setPreMasterSecret: ",e.toString("hex")),v.debug("setPreMasterSecret: masterSecret",n.toString("hex")),v.debug("setPreMasterSecret: clientRandom",i.toString("hex")),v.debug("setPreMasterSecret: serverRandom",o.toString("hex")))}).then(function(){return r.getFreshRWStates(n,i,o)}).then(function(e){r.nextReadState=e.readState,r.nextWriteState=e.writeState,t.nextReadState=e.readState})},e.prototype.onTicketResponse=function(e){var t=this;return v.info("onTicketResponse, tickets: "+e.tickets.length),s().then(function(){var n=t.getTTLDate(e);e.tickets.forEach(function(e){var r=Buffer.from(e.toString("binary"),"binary");v.getLevel()==v.DEBUG&&v.debug("onTicketResponse: add ticket: ",r.toString("hex")),t.addTicket(r,n)}),t.connecting&&(t.connecting.resolve(),t.connecting=null)}).then(function(){t.ticketProblem=!1,t.waitingMessages.length>0&&(t.waitingMessages.forEach(function(e){v.info("Repeating message:",e.message),t.addToQueue(e.message,e.contentType,e.sendNow)}),t.waitingMessages=[])})["catch"](function(e){v.warn("Error during onTicketResponse: ",e),t.stopAll("Error during onTicketResponse: "+e.toString())})},e.prototype.addTicket=function(e,t){v.info("addTicket: adding ticket, id",e.toString("hex"));var n={id:e,data:this.serializeTicketData(),ttl:t};this.ticketsTTL=t.getTime()-this.ttlTreshold,this.tickets[e.toString("hex")]=n},e.prototype.serializeTicketData=function(){return{masterSercret:this.masterSecret}},e.prototype.inChangeCipherSpec=function(e){var t=this;return s().then(function(){if(v.info("inChangeCipherSpec"),null==e){if(!t.nextReadState.initialized)throw new Error("Invalid next read state");return t.readState=t.nextReadState,void(t.nextReadState=new n)}if(!e.nextReadState.initialized)throw new Error("Invalid next read state");e.readState=e.nextReadState,e.nextReadState=new n})},e.prototype.parseHeader=function(e,t){var n,r,i,o,a=this,u=0;return s().then(function(){if(t.readState.initialized){u=16,n=e.slice(0,16),o=16,i=Buffer.from(n),n=y.aes256EcbDecrypt(n,t.readState.key),v.getLevel()==v.DEBUG&&(v.debug("parseHeader: readState.key",t.readState.key.toString("hex")),v.debug("parseHeader: decrypted header",n.toString("hex")));var s=n.slice(8,16);n=n.slice(0,8);var a=Buffer.alloc(8);a.writeUInt32BE(t.readState.sequenceNumber>>8,0),a.writeUInt32BE(255&t.readState.sequenceNumber,4),r=Buffer.concat([a,n]);var c=y.hmacSha256(t.readState.macKey,r),f=c.slice(0,8);if(s.toString("hex")!=f.toString("hex"))throw v.warn("parseHeader: Invalid frame TAG in:",n.toString("hex")),new Error("Invalid frame TAG")}else n=e.slice(0,8),o=8}).then(function(){var e=n.readUInt8(0);if(e!=a.version)throw v.warn("parseHeader: Unsupported version"),new Error("Unsupported version");var t=n.readUInt8(1),s=n.readUInt32BE(2);return{frameSeed:r,frameContentType:t,frameLength:s,headerLength:o,iv:i,macLength:u}})},e.prototype.generateId=function(){return(new Date).getTime().toString()+Math.random().toString()},e.prototype.generateTicketId=function(){var e=((new Date).getTime(),Buffer.from(l(6))),t=Buffer.from(l(10));return Buffer.concat([e,t])},e.prototype.restore=function(e,t){var n=this;v.getLevel()==v.DEBUG&&v.debug("restore "+e.id.toString("hex")+" "+t.toString("hex"));var r=e.data;return this.clientRandom=t,this.serverRandom=e.id,this.masterSecret=r.masterSercret,s().then(function(){return n.getFreshRWStates(n.masterSecret,n.clientRandom,n.serverRandom)}).then(function(e){return n.nextReadState=e.readState,n.nextWriteState=e.writeState,n.changeCipherSpec(!1)})},e.prototype.getFreshRWStates=function(e,t,r){v.getLevel()==v.DEBUG&&(v.debug("getFreshRWStates: masterSecret: ",e.toString("hex")),v.debug("getFreshRWStates: clientRandom: ",t.toString("hex")),v.debug("getFreshRWStates: serverRandom: ",r.toString("hex"))),v.info("getFreshRWStates");var i,o=Buffer.concat([Buffer.from("key expansion"),r,t]);return s().then(function(){return g.prf_tls12(e,o,128)}).then(function(e){i=e,v.debug("getFreshRWStates: keyBlock: ",i);var t=i.slice(0,32),r=i.slice(32,64),o=i.slice(64,96),s=i.slice(96,128),a={readState:null,writeState:null};return a.writeState=new n(o,t),a.readState=new n(s,r),a})},e.prototype.changeCipherSpec=function(e){var t=this;if(void 0===e&&(e=!0),v.info("changeCipherSpec"),!this.nextWriteState.initialized)throw new Error("Invalid next write state");return this.sendMessage({},o.ContentType.CHANGE_CIPHER_SPEC,e).then(function(){t.writeState=t.nextWriteState,t.nextWriteState=new n})},e}();t.exports=b}).call(this,e("buffer").Buffer)},{"./PrivmxAjaxChannel":307,"./RwState":312,"./Session":313,"./Types":315,buffer:590,bytebuffer:48,elliptic:56,"privmx-crypto":248,pson:326,q:327,randombytes:329,"simplito-logger":357,"simplito-utils":373}],309:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=e("./PrivmxConnection"),o=e("./PrivmxRpcChannel"),s=e("./Types"),a=e("q"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initChannel=function(){this.channel=new o(this.config,this),this.channel.onMessage=this.process.bind(this)},t.prototype.addToQueue=function(t,n,r){if(void 0===n&&(n=s.ContentType.APPLICATION_DATA),void 0===r&&(r=!1),this.rpc.connection.broken){var i=a.defer();return i.reject("Connection Broken"),i.promise}if(!this.rpc.connected){var i=a.defer();return i.reject("Not connected"),i.promise}return e.prototype.addToQueue.call(this,t,n,r)},t.prototype.stopAll=function(){e.prototype.stopAll.call(this),this.rpc.proxyManager.removeFromList(this.config.destination)},t}(i);t.exports=u},{"./PrivmxConnection":308,"./PrivmxRpcChannel":311,"./Types":315,q:327}],310:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("q"),o=e("./PrivmxConnection"),s=e("./Types"),a=e("./PrivmxProxyConnection"),u=e("simplito-logger"),c=u.get("privmx-rpc.PrivmxRpc"),f=function(){function e(e){this.timer=null,this.connected=!1,this.timeoutTimerValue=500,this.defaultTimeout=4e4,this.config=e,this.initConnection()}return e.prototype.initConnection=function(){this.connection=new o(this.config,this),this.connection.onReceivedMessage=this.onMessage.bind(this),this.proxyManager=new h(this)},e.prototype.clone=function(){var t=new e(this.config);return t.connected=this.connected,this.connection.clone(t).then(function(e){return t.connection=e,e.onReceivedMessage=t.onMessage.bind(t),t})},e.prototype.connect=function(e){var t=this;return void 0===e&&(e=this.defaultTimeout),c.info("connect"),this.connection.connect(e).then(function(){c.info("connected"),t.connected=!0})},e.prototype.login=function(e,t,n){return void 0===n&&(n={}),this.connection.srpHandshake(e,t,n)},e.prototype.keyHandshake=function(e,t){return this.connection.keyHandshake(e,t)},e.prototype.proxy=function(e,t,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),e===this.config.destination?this.call(t,n,r):this.proxyManager.getProxyRpc(e).then(function(e){return e.call(t,n,r)})},e.prototype.call=function(e,t,n){var r=this;void 0===n&&(n={});var o=this.connection.generateId(),a=i.defer(),u=n.timeout;if(void 0===u&&(u=this.defaultTimeout),!this.connected)return a.reject("Not Connected"),a.promise;if(this.connection.broken)return a.reject("Connection Broken"),a.promise;var c={id:o,deferred:a,createDate:(new Date).getTime()+u,method:e};this.connection.calls[o]=c;var f={method:e,params:t,id:o};return this.connection.addToQueue(f,s.ContentType.APPLICATION_DATA,n.sendAlone).fail(function(e){delete r.connection.calls[o],a.reject(e)}),null==this.timer&&this.createTimer(),a.promise.then(function(e){if(e.error)throw e.error;return e.result})},e.prototype.cast=function(e,t){c.info("cast: ",e,t);var n=this.connection.generateId();if(!this.connected)throw new Error("not connected");if(this.connection.broken)throw new Error("Connection Broken");var r={method:e,params:t,id:n};this.connection.addToQueue(r)},e.prototype.disconnect=function(){return this.connection.disconnect()},e.prototype.getSrpData=function(){return this.connected&&this.connection.session.contains("srp_data")?this.connection.session.get("srp_data"):null},e.prototype.createTimer=function(){var e=this;c.debug("createTimer"),this.timer=setTimeout(function(){return Object.keys(e.connection.calls).forEach(function(t){(new Date).getTime()>e.connection.calls[t].createDate&&(e.connection.calls[t].deferred.reject("timeout ( "+e.connection.calls[t].method+")"),delete e.connection.calls[t])}),0==Object.keys(e.connection.calls).length?void(e.timer=null):void e.createTimer()},this.timeoutTimerValue)},e.prototype.disableTimer=function(){c.debug("disableTimer"),null!=this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.onMessage=function(e){c.info("onMessage: ",e);var t=e.id;if(this.connection.calls[t]){var n=this.connection.calls[t];n.deferred.resolve(e),delete this.connection.calls[t],0==Object.keys(this.connection.calls).length&&null!=this.timer&&this.disableTimer()}},e}();n.PrivmxRpc=f;var l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.rpc=n,r.reinitConnection(),r}return r(t,e),t.prototype.initConnection=function(){},t.prototype.reinitConnection=function(){this.connection=new a(this.config,this.rpc),this.connection.onReceivedMessage=this.onMessage.bind(this)},t}(f);n.PrivmxProxyRpc=l;var h=function(){function e(e){this.proxyRpcs={},this.rpc=e}return e.prototype.getProxyRpc=function(e){var t=this;if(this.proxyRpcs[e]){var n=this.proxyRpcs[e];if(!n.ready.promise.isFulfilled())return i().then(function(){return n.ready.promise}).then(function(){return n.rpc});if(n.rpc.connection.hasTickets())return i().thenResolve(n.rpc)}var r={url:this.rpc.config.url,destination:e,agent:this.rpc.config.agent},o=new l(r,this.rpc);return this.proxyRpcs[e]={rpc:o,ready:i.defer()},o.connect().then(function(){return t.proxyRpcs[e].ready.resolve(),o})},e.prototype.removeFromList=function(e){if(!this.proxyRpcs[e])throw new Error("Host "+e+" not found!");c.warn("remove ProxyRpc for "+e+" because Connection is broken"),this.proxyRpcs[e].ready.reject("Connection Broken"),delete this.proxyRpcs[e]},e}();n.PrivmxProxyManager=h},{"./PrivmxConnection":308,"./PrivmxProxyConnection":309,"./Types":315,q:327,"simplito-logger":357}],311:[function(e,t,n){(function(Buffer){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=e("./StreamBuffer"),i=e("./PrivmxAjaxChannel"),o=e("simplito-logger"),s=e("q"),a=o.get("privmx-rpc.PrivmxAjaxChannel"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.connect=function(e){return this.connected=!0,s(null).thenResolve(null)},t.prototype.send=function(e){var t=this;void 0===e&&(e=!1),a.debug("sending package");var n=this.currentReadStateId,i=[];this.messages.forEach(function(e){t.onMessage&&i.push(e.buf)});var o=this.messages;if(this.messages=[],this.messagesSize=0,this.timer=null,0!=o.length){var s=Buffer.concat(i);a.getLevel()==a.DEBUG&&i.forEach(function(e,t){a.debug("sending "+(t+1)+"/"+i.length+": ",e.toString("hex"))});var u={destination:this.connection.config.destination,encrypt:!1,data:s};this.connection.rpc.call("proxy",u,{sendAlone:e}).then(function(e){var i=new r;i.write(e),t.onMessage(i,n)}).fail(function(e){a.warn("Rpc channel error: ",e),t.connection.stopAll()})}},t}(i);t.exports=u}).call(this,e("buffer").Buffer)},{"./PrivmxAjaxChannel":307,"./StreamBuffer":314,buffer:590,q:327,"simplito-logger":357}],312:[function(e,t,n){"use strict";var r=function(){function e(e,t){return this.sequenceNumber=0,e&&t?(this.initialized=!0,this.key=e,void(this.macKey=t)):void(this.initialized=!1)}return e}();t.exports=r},{}],313:[function(e,t,n){"use strict";var r=function(){function e(){this.container={}}return e.prototype.contains=function(e){return!!this.container[e]},e.prototype.save=function(e,t){this.container[e]=t},e.prototype.get=function(e,t){return void 0===t&&(t=null),this.container[e]?this.container[e]:t},e.prototype["delete"]=function(e){delete this.container[e]},e}();t.exports=r},{}],314:[function(e,t,n){(function(Buffer){"use strict";var n=e("q"),r=function(){function e(){this.deferred=null,this.closed=!1,this.error=null,this.data=Buffer.alloc(0)}return e.prototype.write=function(e){this.data=Buffer.concat([this.data,e]),this.deferred&&(this.deferred.resolve(this.data),this.data=Buffer.alloc(0),this.deferred=null)},e.prototype.close=function(){this.closed=!0},e.prototype.read=function(){var e=n.defer();this.deferred=e;var t=!1;return this.closed&&0==this.data.length&&(this.deferred.resolve(Buffer.alloc(0)),this.deferred=null,t=!0),this.error&&(this.deferred.reject(this.error),this.deferred=null,t=!0),!t&&this.data.length>0&&(this.deferred.resolve(this.data),this.data=Buffer.alloc(0),this.deferred=null),e.promise},e.prototype.eof=function(){return!!this.closed&&0==this.data.length},e.prototype.setError=function(e){this.error=e,this.deferred&&(this.deferred.reject(e),this.deferred=null)},e.prototype.readAll=function(e){function t(e){return n(null).then(e).then(function(r){return r.done?n(null).thenResolve(r.value):t(e)})}var r=this,i=0;return t(function(){return i+=1,n(null).then(function(){return r.read()}).then(function(t){return e(t)}).then(function(){var e={done:r.eof(),value:i};if(i>100)throw new Error("error: za duo tego");return e})})},e}();t.exports=r}).call(this,e("buffer").Buffer)},{buffer:590,q:327}],315:[function(e,t,n){"use strict";n.__esModule=!0;var r;!function(e){e[e.CHANGE_CIPHER_SPEC=20]="CHANGE_CIPHER_SPEC",e[e.ALERT=21]="ALERT",e[e.HANDSHAKE=22]="HANDSHAKE",e[e.APPLICATION_DATA=23]="APPLICATION_DATA"}(r=n.ContentType||(n.ContentType={}))},{}],316:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./PrivmxAjaxChannel");n.PrivmxAjaxChannel=r;var i=e("./PrivmxConnection");n.PrivmxConnection=i;var o=e("./PrivmxProxyConnection");n.PrivmxProxyConnection=o;var s=e("./PrivmxRpc");n.PrivmxRpc=s.PrivmxRpc,n.PrivmxProxyRpc=s.PrivmxProxyRpc,n.PrivmxProxyManager=s.PrivmxProxyManager;var a=e("./RwState");n.RwState=a;var u=e("./Session");n.Session=u;var c=e("./StreamBuffer");n.StreamBuffer=c;var f=e("./Types");n.Types=f},{"./PrivmxAjaxChannel":307,"./PrivmxConnection":308,"./PrivmxProxyConnection":309,"./PrivmxRpc":310,"./RwState":312,"./Session":313,"./StreamBuffer":314,"./Types":315}],317:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./CacheEntry"),i=function(){function e(t){this.entries={},this.defaultTTL=t||e.DefaultTTL,this.storage=null}return e.prototype.save=function(e,t,n){var i=this.computeExpireDate(n),o=new r["default"](e,t,i);this.entries[e]=o,null!=this.storage&&this.storage.setItem(e,o.serialize())},e.prototype.fetch=function(e){var t=this.entries[e];if(!t&&null!==this.storage){var n=this.storage.getItem(e);n&&(t=r["default"].deserialize(n),this.entries[e]=t)}if(t){if(!t.expired())return t.value;this["delete"](e)}},e.prototype["delete"]=function(e){delete this.entries[e],null!==this.storage&&this.storage.removeItem(e)},e.prototype.computeExpireDate=function(e){return(new Date).getTime()+1e3*(e||this.defaultTTL)},e.prototype.setStorage=function(e){this.storage=e},e.DefaultTTL=600,e}();n["default"]=i},{"./CacheEntry":318}],318:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e,t,n){this.key=e,this.value=t,this.expires=n}return e.prototype.expired=function(){return this.expires<(new Date).getTime()},e.prototype.serialize=function(){return JSON.stringify(this)},e.deserialize=function(t){var n=JSON.parse(t);return new e(n.key,n.value,n.expires)},e}();n["default"]=r},{}],319:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){}return e.fromJSON=function(t){var n=JSON.parse(t);if(!n)throw new Error("No data");var r=new e;return r.ttl=n.ttl||600,r.apiBaseEndpoint=n.apiBaseEndpoint,r.defaultEndpoint=n.defaultEndpoint,r.version=n.version,r},e}();n["default"]=r},{}],320:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e,t){this.location=e,this.config=t}return e}();n["default"]=r},{}],321:[function(e,t,n){"use strict";n.__esModule=!0;var r,i=e("./FetchResult"),o=e("./Config"),s=e("./Cache"),a=e("./SimpleHttpClient"),u=e("q");!function(e){e[e.HTTP_ONLY=0]="HTTP_ONLY",e[e.HTTPS_ONLY=1]="HTTPS_ONLY",e[e.HTTP_AND_HTTPS=2]="HTTP_AND_HTTPS"}(r=n.JsonMode||(n.JsonMode={}));var c;!function(e){e[e.JSON_ONLY=0]="JSON_ONLY",e[e.DNS_ONLY=1]="DNS_ONLY",e[e.JSON_AND_DNS=2]="JSON_AND_DNS"}(c=n.DiscoveryMode||(n.DiscoveryMode={}));var f=function(){function e(t){t=t||{},this.cache=t.cache||new s["default"],this.httpClient=t.httpClient||new a["default"],this.remoteResolverUrl=t.remoteResolverUrl||e.DefaultRemoteResolverUrl}return e.prototype.discover=function(e,t,n){var r=this;return u(null).then(function(){e=e.trim();var i=r.cache.fetch(e);return i?i:(n||(n=c.JSON_ONLY),u(null).then(function(){return n===c.JSON_ONLY||n===c.JSON_AND_DNS?r.discoverJSON(e,t).fail(function(t){return n===c.JSON_AND_DNS?r.discoverDNS(e):t}):r.discoverDNS(e)}).then(function(t){return r.cache.save(e,t),t}))})},e.prototype.isHttpSupported=function(e){return e==r.HTTP_ONLY||e==r.HTTP_AND_HTTPS},e.prototype.isHttpsSupported=function(e){return e==r.HTTPS_ONLY||e==r.HTTP_AND_HTTPS},e.prototype.resolveSchemeless=function(e,t,n){return n=n||[],this.isHttpSupported(e)&&n.push("http:"+t),this.isHttpsSupported(e)&&n.push("https:"+t),n},e.prototype.getConfigLocations=function(t,n){var i=this,o=[];return n=null==n?r.HTTP_AND_HTTPS:n,e.ConfigPaths.forEach(function(e){i.resolveSchemeless(n,"//"+t+e,o)}),o},e.prototype.fetchConfig=function(e,t,n){var r="GET"===e?this.httpClient.get:this.httpClient.post;return r.call(this.httpClient,t,n).then(function(e){var n=o["default"].fromJSON(e);return new i["default"](t,n)})},e.prototype.discoverJSON=function(e,t){var n=this,r=this.getConfigLocations(e,t),i={x:(new Date).getTime()};return this.fetchConfig("GET",r[0],i).fail(function(e){return n.fetchConfig("GET",r[1],i)}).then(function(e){return e.config}).fail(function(e){var t=r.slice(2).map(function(e){return n.fetchConfig("GET",e,i)});return u.allSettled(t).then(function(e){var t,n;e.forEach(function(e){if("fulfilled"===e.state){var r=e.value;0===r.location.lastIndexOf("https://",0)?n||(n=r.config):t||(t=r.config)}});var r=n||t;if(!r)throw new Error("Config not found");return r})})},e.prototype.discoverDNS=function(e){var t={host:e,dnsOnly:1};return this.fetchConfig("POST",this.remoteResolverUrl,t).then(function(e){return e.config})},e.prototype.setCache=function(e){this.cache=e},e.prototype.setCacheStorage=function(e){this.cache.setStorage(e)},e.ConfigPaths=["/privmx/privmx-configuration.json","/.well-known/privmx-configuration.json","/privmx-configuration.json"],e.DefaultRemoteResolverUrl="https://privmx.com/resolve-config",e}();n["default"]=f},{"./Cache":317,"./Config":319,"./FetchResult":320,"./SimpleHttpClient":323,q:327}],322:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./CacheEntry"),o=e("./Cache"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.save=function(e,t,n){var r=this.computeExpireDate(n),o=new i["default"](e,t,r);window.sessionStorage.setItem(e,o.serialize())},t.prototype.fetch=function(e){var t=window.sessionStorage.getItem(e);
if(t){var n=i["default"].deserialize(t);if(n){if(!n.expired())return n.value;this["delete"](e)}}},t.prototype["delete"]=function(e){window.sessionStorage.removeItem(e)},t}(o["default"]);n["default"]=s},{"./Cache":317,"./CacheEntry":318}],323:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("simplito-net"),o=i.HttpRequest,s=function(){function e(){}return e.prototype.get=function(e,t){t&&(e+="?"+this.serializeParams(t));var n=r.defer();return o.start({url:e,method:"GET",responseType:"text",success:function(e){n.resolve(e)},error:function(e){n.reject(e)}}),n.promise},e.prototype.post=function(e,t){var n=r.defer();return o.start({url:e,method:"POST",responseType:"text",data:t,success:function(e){n.resolve(e)},error:function(e){n.reject(e)}}),n.promise},e.prototype.serializeParams=function(e){return Object.keys(e).map(function(t){return[encodeURIComponent(t),encodeURIComponent(e[t])].join("=")}).join("&")},e}();n["default"]=s},{q:327,"simplito-net":360}],324:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Cache");n.Cache=r["default"];var i=e("./CacheEntry");n.CacheEntry=i["default"];var o=e("./Config");n.Config=o["default"];var s=e("./FetchResult");n.FetchResult=s["default"];var a=e("./PrivMXServiceDiscovery");n.DiscoveryMode=a.DiscoveryMode,n.JsonMode=a.JsonMode,n.PrivMXServiceDiscovery=a["default"];var u=e("./SessionStorageCache");n.SessionStorageCache=u["default"];var c=e("./SimpleHttpClient");n.SimpleHttpClient=c["default"]},{"./Cache":317,"./CacheEntry":318,"./Config":319,"./FetchResult":320,"./PrivMXServiceDiscovery":321,"./SessionStorageCache":322,"./SimpleHttpClient":323}],325:[function(e,t,n){(function(e){"use strict";function n(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=n:t.exports=e.nextTick}).call(this,e("_process"))},{_process:592}],326:[function(e,t,n){!function(n){"use strict";function r(e){if(!e)throw new Error("PSON requires ByteBuffer.js: Get it at https://github.com/dcodeIO/ByteBuffer.js");var t={};return t.T=function(){var e={};return e.ZERO=0,e.MAX=239,e.NULL=240,e.TRUE=241,e.FALSE=242,e.EOBJECT=243,e.EARRAY=244,e.ESTRING=245,e.OBJECT=246,e.ARRAY=247,e.INTEGER=248,e.LONG=249,e.FLOAT=250,e.DOUBLE=251,e.STRING=252,e.STRING_ADD=253,e.STRING_GET=254,e.BINARY=255,e}(),t.Encoder=function(e,t){var n=new e(4);n.length=4;var r=e.Long,i=function(e,t,n){if(this.dict={},this.next=0,e&&Array.isArray(e))for(;this.next<e.length;)this.dict[e[this.next]]=this.next++;this.progressive=!!t,this.options=n||{}};return i.prototype.encode=function(t,n){var r=!1;n||(n=new e,r=!0);var i=n.littleEndian;try{return this._encodeValue(t,n.LE()),n.littleEndian=i,r?n.flip():n}catch(o){throw n.littleEndian=i,o}},i.prototype._encodeValue=function(i,o,s){if(null===i)o.writeUint8(t.NULL);else switch(typeof i){case"function":i=i.toString();case"string":0===i.length?o.writeUint8(t.ESTRING):this.dict.hasOwnProperty(i)?(o.writeUint8(t.STRING_GET),o.writeVarint32(this.dict[i])):(o.writeUint8(t.STRING),o.writeVString(i));break;case"number":var a=parseInt(i);if(i===a){var u=e.zigZagEncode32(i);u<=t.MAX?o.writeUint8(u):(o.writeUint8(t.INTEGER),o.writeVarint32ZigZag(i))}else n.writeFloat32(i,0),i===n.readFloat32(0)?(o.writeUint8(t.FLOAT),o.writeFloat32(i)):(o.writeUint8(t.DOUBLE),o.writeFloat64(i));break;case"boolean":o.writeUint8(i?t.TRUE:t.FALSE);break;case"object":var c;if(Array.isArray(i))if(0===i.length)o.writeUint8(t.EARRAY);else for(o.writeUint8(t.ARRAY),o.writeVarint32(i.length),c=0;c<i.length;c++)this._encodeValue(i[c],o);else if(r&&i instanceof r)o.writeUint8(t.LONG),o.writeVarint64ZigZag(i);else try{i=e.wrap(i),o.writeUint8(t.BINARY),o.writeVarint32(i.remaining()),o.append(i)}catch(f){var l=Object.keys(i),h=0;for(c=0;c<l.length;c++)"undefined"!=typeof i[l[c]]&&h++;if(0===h)o.writeUint8(t.EOBJECT);else for(o.writeUint8(t.OBJECT),o.writeVarint32(h),s||(s=!!i._PSON_EXCL_),c=0;c<l.length;c++){var p=l[c];"undefined"!=typeof i[p]&&(this.dict.hasOwnProperty(p)?(o.writeUint8(t.STRING_GET),o.writeVarint32(this.dict[p])):(this.progressive&&!s?(this.dict[p]=this.next++,o.writeUint8(t.STRING_ADD)):o.writeUint8(t.STRING),o.writeVString(p)),this._encodeValue(i[p],o))}}break;case"undefined":o.writeUint8(t.NULL)}},i}(e,t.T),t.Decoder=function(e,t){var n=e.Long,r=function(e,t,n){this.dict=e&&Array.isArray(e)?e:[],this.progressive=!!t,this.options=n||{}};return r.prototype.decode=function(t){t instanceof e||(t=e.wrap(t));var n=t.littleEndian;try{var r=this._decodeValue(t.LE());return t.littleEndian=n,r}catch(i){throw t.littleEndian=n,i}},r.prototype._decodeValue=function(r){var i=r.readUint8();if(i<=t.MAX)return e.zigZagDecode32(i);switch(i){case t.NULL:return null;case t.TRUE:return!0;case t.FALSE:return!1;case t.EOBJECT:return{};case t.EARRAY:return[];case t.ESTRING:return"";case t.OBJECT:i=r.readVarint32();for(var o={};--i>=0;)o[this._decodeValue(r)]=this._decodeValue(r);return o;case t.ARRAY:i=r.readVarint32();for(var s=[];--i>=0;)s.push(this._decodeValue(r));return s;case t.INTEGER:return r.readVarint32ZigZag();case t.LONG:return n?r.readVarint64ZigZag():r.readVarint32ZigZag();case t.FLOAT:return r.readFloat32();case t.DOUBLE:return r.readFloat64();case t.STRING:return r.readVString();case t.STRING_ADD:var a=r.readVString();return this.dict.push(a),a;case t.STRING_GET:return this.dict[r.readVarint32()];case t.BINARY:i=r.readVarint32();var u=r.slice(r.offset,r.offset+i);return r.offset+=i,u;default:throw new Error("Illegal type at "+r.offset+": "+i)}},r}(e,t.T),t.Pair=function(){var e=function(){this.encoder,this.decoder};return e.prototype.encode=function(e){return this.encoder.encode(e)},e.prototype.toArrayBuffer=function(e){return this.encoder.encode(e).toArrayBuffer()},e.prototype.toBuffer=function(e){return this.encoder.encode(e).toBuffer()},e.prototype.decode=function(e){return this.decoder.decode(e)},e}(),t.StaticPair=function(e,t,n){var r=function(r,i){e.call(this),this.encoder=new t(r,(!1),i),this.decoder=new n(r,(!1),i)};return r.prototype=Object.create(e.prototype),r}(t.Pair,t.Encoder,t.Decoder),t.ProgressivePair=function(e,n,r){var i=function(t,i){e.call(this),this.encoder=new n(t,(!0),i),this.decoder=new r(t,(!0),i)};return i.prototype=Object.create(e.prototype),i.prototype.exclude=function(e){t.exclude(e)},i.prototype.include=function(e){t.include(e)},i}(t.Pair,t.Encoder,t.Decoder),t.exclude=function(e){"object"==typeof e&&Object.defineProperty(e,"_PSON_EXCL_",{value:!0,enumerable:!1,configurable:!0})},t.include=function(e){"object"==typeof e&&delete e._PSON_EXCL_},t}"undefined"!=typeof t&&t.exports?t.exports=r(e("bytebuffer")):"undefined"!=typeof define&&define.amd?define("PSON",["ByteBuffer"],r):(n.dcodeIO||(n.dcodeIO={}),n.dcodeIO.PSON=r(n.dcodeIO.ByteBuffer))}(this)},{bytebuffer:48}],327:[function(e,t,n){(function(e){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof n&&"object"==typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var r="undefined"!=typeof window?window:self,i=r.Q;r.Q=e(),r.Q.noConflict=function(){return r.Q=i,this}}}(function(){"use strict";function t(e){return function(){return X.apply(e,arguments)}}function n(e){return e===Object(e)}function r(e){return"[object StopIteration]"===re(e)||e instanceof V}function i(e,t){if(K&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&e.stack.indexOf(ie)===-1){for(var n=[],r=t;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(e.stack);var i=n.join("\n"+ie+"\n");e.stack=o(i)}}function o(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var i=t[r];u(i)||s(i)||!i||n.push(i)}return n.join("\n")}function s(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function u(e){var t=a(e);if(!t)return!1;var n=t[0],r=t[1];return n===q&&r>=W&&r<=ce}function c(){if(K)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],r=a(n);if(!r)return;return q=r[0],r[1]}}function f(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function l(e){return e instanceof g?e:b(e)?A(e):I(e)}function h(){function e(e){t=e,o.source=e,J(n,function(t,n){l.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],i=ee(h.prototype),o=ee(g.prototype);if(o.promiseDispatch=function(e,i,o){var s=$(arguments);n?(n.push(s),"when"===i&&o[1]&&r.push(o[1])):l.nextTick(function(){t.promiseDispatch.apply(t,s)})},o.valueOf=function(){if(n)return o;var e=m(t);return v(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},l.longStackSupport&&K)try{throw new Error}catch(s){o.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(n){t||e(l(n))},i.fulfill=function(n){t||e(I(n))},i.reject=function(n){t||e(x(n))},i.notify=function(e){t||J(r,function(t,n){l.nextTick(function(){n(e)})},void 0)},i}function p(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=h();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function d(e){return p(function(t,n){for(var r=0,i=e.length;r<i;r++)l(e[r]).then(t,n)})}function g(e,t,n){void 0===t&&(t=function(e){return x(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=ee(g.prototype);if(r.promiseDispatch=function(n,i,o){var s;try{s=e[i]?e[i].apply(r,o):t.call(r,i,o)}catch(a){s=x(a)}n&&n(s)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function y(e,t,n,r){return l(e).then(t,n,r)}function m(e){if(v(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function v(e){return e instanceof g}function b(e){return n(e)&&"function"==typeof e.then}function w(e){return v(e)&&"pending"===e.inspect().state}function E(e){return!v(e)||"fulfilled"===e.inspect().state}function _(e){return v(e)&&"rejected"===e.inspect().state}function S(){oe.length=0,se.length=0,ue||(ue=!0)}function k(t,n){ue&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){Q(se,t)!==-1&&(e.emit("unhandledRejection",n,t),ae.push(t))}),se.push(t),n&&"undefined"!=typeof n.stack?oe.push(n.stack):oe.push("(no stack) "+n))}function C(t){if(ue){var n=Q(se,t);n!==-1&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){var r=Q(ae,t);r!==-1&&(e.emit("rejectionHandled",oe[n],t),ae.splice(r,1))}),se.splice(n,1),oe.splice(n,1))}}function x(e){var t=g({when:function(t){return t&&C(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return k(t,e),t}function I(e){return g({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return ne(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function A(e){var t=h();return l.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function P(e){return g({isDef:function(){}},function(t,n){return D(e,t,n)},function(){return l(e).inspect()})}function T(e,t,n){return l(e).spread(t,n)}function M(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=n[e](t)}catch(a){return x(a)}return s.done?l(s.value):y(s.value,i,o)}try{s=n[e](t)}catch(a){return r(a)?l(a.value):x(a)}return y(s,i,o)}var n=e.apply(this,arguments),i=t.bind(t,"next"),o=t.bind(t,"throw");return i()}}function R(e){l.done(l.async(e)())}function O(e){throw new V(e)}function B(e){return function(){return T([this,N(arguments)],function(t,n){return e.apply(t,n)})}}function D(e,t,n){return l(e).dispatch(t,n)}function N(e){return y(e,function(e){var t=0,n=h();return J(e,function(r,i,o){var s;v(i)&&"fulfilled"===(s=i.inspect()).state?e[o]=s.value:(++t,y(i,function(r){e[o]=r,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:o,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function L(e){if(0===e.length)return l.resolve();var t=l.defer(),n=0;return J(e,function(r,i,o){function s(e){t.resolve(e)}function a(){n--,0===n&&t.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function u(e){t.notify({index:o,value:e})}var c=e[o];n++,y(c,s,a,u)},void 0),t.promise}function F(e){return y(e,function(e){return e=Z(e,l),y(N(Z(e,function(e){return y(e,G,G)})),function(){return e})})}function U(e){return l(e).allSettled()}function j(e,t){return l(e).then(void 0,void 0,t)}function z(e,t){return l(e).nodeify(t)}var K=!1;try{throw new Error}catch(H){K=!!H.stack}var q,V,W=c(),G=function(){},Y=function(){function t(){for(var e,t;r.next;)r=r.next,e=r.task,r.task=void 0,t=r.domain,t&&(r.domain=void 0,t.enter()),n(e,t);for(;u.length;)e=u.pop(),n(e);o=!1}function n(e,n){try{e()}catch(r){if(a)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),r;setTimeout(function(){throw r},0)}n&&n.exit()}var r={task:void 0,next:null},i=r,o=!1,s=void 0,a=!1,u=[];if(Y=function(t){i=i.next={task:t,domain:a&&e.domain,next:null},o||(o=!0,s())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)a=!0,s=function(){e.nextTick(t)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var c=new MessageChannel;c.port1.onmessage=function(){s=f,c.port1.onmessage=t,t()};var f=function(){c.port2.postMessage(0)};s=function(){setTimeout(t,0),f()}}else s=function(){setTimeout(t,0)};return Y.runAfter=function(e){u.push(e),o||(o=!0,s())},Y}(),X=Function.call,$=t(Array.prototype.slice),J=t(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),Q=t(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Z=t(Array.prototype.map||function(e,t){var n=this,r=[];return J(n,function(i,o,s){r.push(e.call(t,o,s,n))},void 0),r}),ee=Object.create||function(e){function t(){}return t.prototype=e,new t},te=t(Object.prototype.hasOwnProperty),ne=Object.keys||function(e){var t=[];for(var n in e)te(e,n)&&t.push(n);return t},re=t(Object.prototype.toString);V="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ie="From previous event:";l.resolve=l,l.nextTick=Y,l.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=h,h.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve($(arguments,1)):e.resolve(n)}},l.Promise=p,l.promise=p,p.race=d,p.all=N,p.reject=x,p.resolve=l,l.passByCopy=function(e){return e},g.prototype.passByCopy=function(){return this},l.join=function(e,t){return l(e).join(t)},g.prototype.join=function(e){return l([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},l.race=d,g.prototype.race=function(){return this.then(l.race)},l.makePromise=g,g.prototype.toString=function(){return"[object Promise]"},g.prototype.then=function(e,t,n){function r(t){try{return"function"==typeof e?e(t):t}catch(n){return x(n)}}function o(e){if("function"==typeof t){i(e,a);try{return t(e)}catch(n){return x(n)}}return x(e)}function s(e){return"function"==typeof n?n(e):e}var a=this,u=h(),c=!1;return l.nextTick(function(){a.promiseDispatch(function(e){c||(c=!0,u.resolve(r(e)))},"when",[function(e){c||(c=!0,u.resolve(o(e)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(r){if(n=!0,!l.onerror)throw r;l.onerror(r)}n||u.notify(t)}]),u.promise},l.tap=function(e,t){return l(e).tap(t)},g.prototype.tap=function(e){return e=l(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},l.when=y,g.prototype.thenResolve=function(e){return this.then(function(){return e})},l.thenResolve=function(e,t){return l(e).thenResolve(t)},g.prototype.thenReject=function(e){return this.then(function(){throw e})},l.thenReject=function(e,t){return l(e).thenReject(t)},l.nearer=m,l.isPromise=v,l.isPromiseAlike=b,l.isPending=w,g.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=E,g.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=_,g.prototype.isRejected=function(){return"rejected"===this.inspect().state};var oe=[],se=[],ae=[],ue=!0;l.resetUnhandledRejections=S,l.getUnhandledReasons=function(){return oe.slice()},l.stopUnhandledRejectionTracking=function(){S(),ue=!1},S(),l.reject=x,l.fulfill=I,l.master=P,l.spread=T,g.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},l.async=M,l.spawn=R,l["return"]=O,l.promised=B,l.dispatch=D,g.prototype.dispatch=function(e,t){var n=this,r=h();return l.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},l.get=function(e,t){return l(e).dispatch("get",[t])},g.prototype.get=function(e){return this.dispatch("get",[e])},l.set=function(e,t,n){return l(e).dispatch("set",[t,n])},g.prototype.set=function(e,t){return this.dispatch("set",[e,t])},l.del=l["delete"]=function(e,t){return l(e).dispatch("delete",[t])},g.prototype.del=g.prototype["delete"]=function(e){return this.dispatch("delete",[e])},l.mapply=l.post=function(e,t,n){return l(e).dispatch("post",[t,n])},g.prototype.mapply=g.prototype.post=function(e,t){return this.dispatch("post",[e,t])},l.send=l.mcall=l.invoke=function(e,t){return l(e).dispatch("post",[t,$(arguments,2)])},g.prototype.send=g.prototype.mcall=g.prototype.invoke=function(e){return this.dispatch("post",[e,$(arguments,1)])},l.fapply=function(e,t){return l(e).dispatch("apply",[void 0,t])},g.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},l["try"]=l.fcall=function(e){return l(e).dispatch("apply",[void 0,$(arguments,1)])},g.prototype.fcall=function(){return this.dispatch("apply",[void 0,$(arguments)])},l.fbind=function(e){var t=l(e),n=$(arguments,1);return function(){return t.dispatch("apply",[this,n.concat($(arguments))])}},g.prototype.fbind=function(){var e=this,t=$(arguments);return function(){return e.dispatch("apply",[this,t.concat($(arguments))])}},l.keys=function(e){return l(e).dispatch("keys",[])},g.prototype.keys=function(){return this.dispatch("keys",[])},l.all=N,g.prototype.all=function(){return N(this)},l.any=L,g.prototype.any=function(){return L(this)},l.allResolved=f(F,"allResolved","allSettled"),g.prototype.allResolved=function(){return F(this)},l.allSettled=U,g.prototype.allSettled=function(){return this.then(function(e){return N(Z(e,function(e){function t(){return e.inspect()}return e=l(e),e.then(t,t)}))})},l.fail=l["catch"]=function(e,t){return l(e).then(void 0,t)},g.prototype.fail=g.prototype["catch"]=function(e){return this.then(void 0,e)},l.progress=j,g.prototype.progress=function(e){return this.then(void 0,void 0,e)},l.fin=l["finally"]=function(e,t){return l(e)["finally"](t)},g.prototype.fin=g.prototype["finally"]=function(e){return e=l(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},l.done=function(e,t,n,r){return l(e).done(t,n,r)},g.prototype.done=function(t,n,r){var o=function(e){l.nextTick(function(){if(i(e,s),!l.onerror)throw e;l.onerror(e)})},s=t||n||r?this.then(t,n,r):this;"object"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),s.then(void 0,o)},l.timeout=function(e,t,n){return l(e).timeout(t,n)},g.prototype.timeout=function(e,t){var n=h(),r=setTimeout(function(){t&&"string"!=typeof t||(t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT"),n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},l.delay=function(e,t){return void 0===t&&(t=e,e=void 0),l(e).delay(t)},g.prototype.delay=function(e){return this.then(function(t){var n=h();return setTimeout(function(){n.resolve(t)},e),n.promise})},l.nfapply=function(e,t){return l(e).nfapply(t)},g.prototype.nfapply=function(e){var t=h(),n=$(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},l.nfcall=function(e){var t=$(arguments,1);return l(e).nfapply(t)},g.prototype.nfcall=function(){var e=$(arguments),t=h();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},l.nfbind=l.denodeify=function(e){var t=$(arguments,1);return function(){var n=t.concat($(arguments)),r=h();return n.push(r.makeNodeResolver()),l(e).fapply(n).fail(r.reject),r.promise}},g.prototype.nfbind=g.prototype.denodeify=function(){var e=$(arguments);return e.unshift(this),l.denodeify.apply(void 0,e)},l.nbind=function(e,t){var n=$(arguments,2);return function(){function r(){return e.apply(t,arguments)}var i=n.concat($(arguments)),o=h();return i.push(o.makeNodeResolver()),l(r).fapply(i).fail(o.reject),o.promise}},g.prototype.nbind=function(){var e=$(arguments,0);return e.unshift(this),l.nbind.apply(void 0,e)},l.nmapply=l.npost=function(e,t,n){return l(e).npost(t,n)},g.prototype.nmapply=g.prototype.npost=function(e,t){var n=$(t||[]),r=h();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(e,t){var n=$(arguments,2),r=h();return n.push(r.makeNodeResolver()),l(e).dispatch("post",[t,n]).fail(r.reject),r.promise},g.prototype.nsend=g.prototype.nmcall=g.prototype.ninvoke=function(e){var t=$(arguments,1),n=h();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},l.nodeify=z,g.prototype.nodeify=function(e){return e?void this.then(function(t){l.nextTick(function(){e(null,t)})},function(t){l.nextTick(function(){e(t)})}):this},l.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ce=c();return l})}).call(this,e("_process"))},{_process:592}],328:[function(e,t,n){"use strict";function r(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[o(t,e),"[",r,"]"].join(""):[o(t,e),"[",o(r,e),"]=",o(n,e)].join("")};case"bracket":return function(t,n){return null===n?o(t,e):[o(t,e),"[]=",o(n,e)].join("")};default:return function(t,n){return null===n?o(t,e):[o(t,e),"=",o(n,e)].join("")}}}function i(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){return t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===r[e]&&(r[e]={}),void(r[e][t[1]]=n)):void(r[e]=n)};case"bracket":return function(e,n,r){return t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t&&void 0!==r[e]?void(r[e]=[].concat(r[e],n)):void(r[e]=n)};default:return function(e,t,n){return void 0===n[e]?void(n[e]=t):void(n[e]=[].concat(n[e],t))}}}function o(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function s(e){return Array.isArray(e)?e.sort():"object"==typeof e?s(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}var a=e("strict-uri-encode"),u=e("object-assign");n.extract=function(e){return e.split("?")[1]||""},n.parse=function(e,t){t=u({arrayFormat:"none"},t);var n=i(t),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),n(decodeURIComponent(i),o,r)}),Object.keys(r).sort().reduce(function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=s(n):e[t]=n,e},Object.create(null))):r},n.stringify=function(e,t){var n={encode:!0,strict:!0,arrayFormat:"none"};t=u(n,t);var i=r(t);return e?Object.keys(e).sort().map(function(n){var r=e[n];if(void 0===r)return"";if(null===r)return o(n,t);if(Array.isArray(r)){var s=[];return r.slice().forEach(function(e){void 0!==e&&s.push(i(n,e,s.length))}),s.join("&")}return o(n,t)+"="+o(r,t)}).filter(function(e){return e.length>0}).join("&"):""}},{"object-assign":135,"strict-uri-encode":374}],329:[function(e,t,n){(function(e,n,Buffer){"use strict";function r(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function i(t,r){if(t>65536)throw new Error("requested too many random bytes");var i=new n.Uint8Array(t);t>0&&o.getRandomValues(i);var s=new Buffer(i.buffer);return"function"==typeof r?e.nextTick(function(){r(null,s)}):s}var o=n.crypto||n.msCrypto;o&&o.getRandomValues?t.exports=i:t.exports=r}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{_process:592,buffer:590}],330:[function(e,t,n){(function(Buffer){function e(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t}function n(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t}function r(e,t,n){for(var r=0;r<16;r++){var f=n+r,m=t[f];t[f]=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8)}var v,b,w,E,_,S,k,C,x,I;S=v=e[0],k=b=e[1],C=w=e[2],x=E=e[3],I=_=e[4];var A;for(r=0;r<80;r+=1)A=v+t[n+l[r]]|0,A+=r<16?i(b,w,E)+g[0]:r<32?o(b,w,E)+g[1]:r<48?s(b,w,E)+g[2]:r<64?a(b,w,E)+g[3]:u(b,w,E)+g[4],A=0|A,A=c(A,p[r]),A=A+_|0,v=_,_=E,E=c(w,10),w=b,b=A,A=S+t[n+h[r]]|0,A+=r<16?u(k,C,x)+y[0]:r<32?a(k,C,x)+y[1]:r<48?s(k,C,x)+y[2]:r<64?o(k,C,x)+y[3]:i(k,C,x)+y[4],A=0|A,A=c(A,d[r]),A=A+I|0,S=I,I=x,x=c(C,10),C=k,k=A;A=e[1]+w+x|0,e[1]=e[2]+E+I|0,e[2]=e[3]+_+S|0,e[3]=e[4]+v+k|0,e[4]=e[0]+b+C|0,e[0]=A}function i(e,t,n){return e^t^n}function o(e,t,n){return e&t|~e&n}function s(e,t,n){return(e|~t)^n}function a(e,t,n){return e&n|t&~n}function u(e,t,n){return e^(t|~n)}function c(e,t){return e<<t|e>>>32-t}function f(t){var i=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof t&&(t=new Buffer(t,"utf8"));var o=e(t),s=8*t.length,a=8*t.length;o[s>>>5]|=128<<24-s%32,o[(s+64>>>9<<4)+14]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);for(var u=0;u<o.length;u+=16)r(i,o,u);for(u=0;u<5;u++){var c=i[u];i[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var f=n(i);return new Buffer(f)}var l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],d=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],g=[0,1518500249,1859775393,2400959708,2840853838],y=[1352829926,1548603684,1836072691,2053994217,0];t.exports=f}).call(this,e("buffer").Buffer)},{buffer:590}],331:[function(e,t,n){var r=e("./lib/alea"),i=e("./lib/xor128"),o=e("./lib/xorwow"),s=e("./lib/xorshift7"),a=e("./lib/xor4096"),u=e("./lib/tychei"),c=e("./seedrandom");c.alea=r,c.xor128=i,c.xorwow=o,c.xorshift7=s,c.xor4096=a,c.tychei=u,t.exports=c},{"./lib/alea":332,"./lib/tychei":333,"./lib/xor128":334,"./lib/xor4096":335,"./lib/xorshift7":336,"./lib/xorwow":337,"./seedrandom":338}],332:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n=s();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new r(e),o=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s["double"]=function(){return s()+1.1102230246251565e-16*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}function s(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)};return t}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.alea=o}(this,"object"==typeof t&&t,"function"==typeof define&&define)},{}],333:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s["double"]=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(0===r);return r},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.tychei=o}(this,"object"==typeof t&&t,"function"==typeof define&&define)},{}],334:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s["double"]=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(0===r);return r},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xor128=o}(this,"object"==typeof t&&t,"function"==typeof define&&define)},{}],335:[function(e,t,n){!function(e,t,n){function r(e){function t(e,t){var n,r,i,o,s,a=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),i=0,o=-32;o<u;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,n=a[127&o]^=r+s,i=0==n?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;e.w=s,e.X=a,e.i=i}var n=this;n.next=function(){var e,t,r=n.w,i=n.X,o=n.i;return n.w=r=r+1640531527|0,t=i[o+34&127],e=i[o=o+1&127],t^=t<<13,e^=e<<17,t^=t>>>15,e^=e>>>12,t=i[o]=t^e,n.i=o,t+(r^r>>>16)|0},t(n,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s["double"]=function(){
do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(0===r);return r},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xor4096=o}(this,"object"==typeof t&&t,"function"==typeof define&&define)},{}],336:[function(e,t,n){!function(e,t,n){function r(e){function t(e,t){var n,r,i=[];if(t===(0|t))r=i[0]=t;else for(t=""+t,n=0;n<t.length;++n)i[7&n]=i[7&n]<<15^t.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(r=8==n?i[7]=-1:i[n],e.x=i,e.i=0,n=256;n>0;--n)e.next()}var n=this;n.next=function(){var e,t,r=n.x,i=n.i;return e=r[i],e^=e>>>7,t=e^e<<24,e=r[i+1&7],t^=e^e>>>10,e=r[i+3&7],t^=e^e>>>3,e=r[i+4&7],t^=e^e<<7,e=r[i+7&7],e^=e<<13,t^=e^e<<9,r[i]=t,n.i=i+1&7,t},t(n,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s["double"]=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(0===r);return r},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xorshift7=o}(this,"object"==typeof t&&t,"function"==typeof define&&define)},{}],337:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^(e^e<<1))|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s["double"]=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(0===r);return r},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xorwow=o}(this,"object"==typeof t&&t,"function"==typeof define&&define)},{}],338:[function(e,t,n){!function(n,r){function i(e,t,i){var l=[];t=1==t?{entropy:!0}:t||{};var h=u(a(t.entropy?[e,f(n)]:null==e?c():e,3),l),g=new o(l),w=function(){for(var e=g.g(d),t=m,n=0;e<v;)e=(e+n)*p,t*=p,n=g.g(1);for(;e>=b;)e/=2,t/=2,n>>>=1;return(e+n)/t};return w.int32=function(){return 0|g.g(4)},w.quick=function(){return g.g(4)/4294967296},w["double"]=w,u(f(g.S),n),(t.pass||i||function(e,t,n,i){return i&&(i.S&&s(i,g),e.state=function(){return s(g,{})}),n?(r[y]=e,t):e})(w,h,"global"in t?t.global:this==r,t.state)}function o(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);i<p;)s[i]=i++;for(i=0;i<p;i++)s[i]=s[o=w&o+e[i%n]+(t=s[i])],s[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,s=r.S;e--;)t=s[i=w&i+1],n=n*p+s[w&(s[i]=s[o=w&o+t])+(s[o]=t)];return r.i=i,r.j=o,n})(p)}function s(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function a(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(a(e[n],t-1))}catch(o){}return r.length?r:"string"==i?e:e+"\0"}function u(e,t){for(var n,r=e+"",i=0;i<r.length;)t[w&i]=w&(n^=19*t[w&i])+r.charCodeAt(i++);return f(t)}function c(){try{if(l)return f(l.randomBytes(p));var e=new Uint8Array(p);return(h.crypto||h.msCrypto).getRandomValues(e),f(e)}catch(t){var r=h.navigator,i=r&&r.plugins;return[+new Date,h,i,h.screen,f(n)]}}function f(e){return String.fromCharCode.apply(0,e)}var l,h=this,p=256,d=6,g=52,y="random",m=r.pow(p,d),v=r.pow(2,g),b=2*v,w=p-1;if(r["seed"+y]=i,u(r.random(),n),"object"==typeof t&&t.exports){t.exports=i;try{l=e("crypto")}catch(E){}}else"function"==typeof define&&define.amd&&define(function(){return i})}([],Math)},{crypto:602}],339:[function(e,t,n){(function(Buffer){function e(e,t){this._block=new Buffer(e),this._finalSize=t,this._blockSize=e,this._len=0,this._s=0}e.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=new Buffer(e,t));for(var n=this._len+=e.length,r=this._s||0,i=0,o=this._block;r<n;){for(var s=Math.min(e.length,i+this._blockSize-r%this._blockSize),a=s-i,u=0;u<a;u++)o[r%this._blockSize+u]=e[u+i];r+=a,i+=a,r%this._blockSize===0&&this._update(o)}return this._s=r,this},e.prototype.digest=function(e){var t=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),t%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(t,this._blockSize-4);var n=this._update(this._block)||this._hash();return e?n.toString(e):n},e.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=e}).call(this,e("buffer").Buffer)},{buffer:590}],340:[function(e,t,n){var n=t.exports=function(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};n.sha=e("./sha"),n.sha1=e("./sha1"),n.sha224=e("./sha224"),n.sha256=e("./sha256"),n.sha384=e("./sha384"),n.sha512=e("./sha512")},{"./sha":341,"./sha1":342,"./sha224":343,"./sha256":344,"./sha384":345,"./sha512":346}],341:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=c,a.call(this,64,56)}function r(e){return e<<5|e>>>27}function i(e){return e<<30|e>>>2}function o(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var s=e("inherits"),a=e("./hash"),u=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);s(n,a),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._a,s=0|this._b,a=0|this._c,c=0|this._d,f=0|this._e,l=0;l<16;++l)t[l]=e.readInt32BE(4*l);for(;l<80;++l)t[l]=t[l-3]^t[l-8]^t[l-14]^t[l-16];for(var h=0;h<80;++h){var p=~~(h/20),d=r(n)+o(p,s,a,c)+f+t[h]+u[p]|0;f=c,c=a,a=i(s),s=n,n=d}this._a=n+this._a|0,this._b=s+this._b|0,this._c=a+this._c|0,this._d=c+this._d|0,this._e=f+this._e|0},n.prototype._hash=function(){var e=new Buffer(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":339,buffer:590,inherits:102}],342:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=f,u.call(this,64,56)}function r(e){return e<<1|e>>>31}function i(e){return e<<5|e>>>27}function o(e){return e<<30|e>>>2}function s(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var a=e("inherits"),u=e("./hash"),c=[1518500249,1859775393,-1894007588,-899497514],f=new Array(80);a(n,u),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._a,a=0|this._b,u=0|this._c,f=0|this._d,l=0|this._e,h=0;h<16;++h)t[h]=e.readInt32BE(4*h);for(;h<80;++h)t[h]=r(t[h-3]^t[h-8]^t[h-14]^t[h-16]);for(var p=0;p<80;++p){var d=~~(p/20),g=i(n)+s(d,a,u,f)+l+t[p]+c[d]|0;l=f,f=u,u=o(a),a=n,n=g}this._a=n+this._a|0,this._b=a+this._b|0,this._c=u+this._c|0,this._d=f+this._d|0,this._e=l+this._e|0},n.prototype._hash=function(){var e=new Buffer(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":339,buffer:590,inherits:102}],343:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=s,o.call(this,64,56)}var r=e("inherits"),i=e("./sha256"),o=e("./hash"),s=new Array(64);r(n,i),n.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},n.prototype._hash=function(){var e=new Buffer(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":339,"./sha256":344,buffer:590,inherits:102}],344:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=h,f.call(this,64,56)}function r(e,t,n){return n^e&(t^n)}function i(e,t,n){return e&t|n&(e|t)}function o(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function s(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function a(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function u(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}var c=e("inherits"),f=e("./hash"),l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],h=new Array(64);c(n,f),n.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._a,c=0|this._b,f=0|this._c,h=0|this._d,p=0|this._e,d=0|this._f,g=0|this._g,y=0|this._h,m=0;m<16;++m)t[m]=e.readInt32BE(4*m);for(;m<64;++m)t[m]=u(t[m-2])+t[m-7]+a(t[m-15])+t[m-16]|0;for(var v=0;v<64;++v){var b=y+s(p)+r(p,d,g)+l[v]+t[v]|0,w=o(n)+i(n,c,f)|0;y=g,g=d,d=p,p=h+b|0,h=f,f=c,c=n,n=b+w|0}this._a=n+this._a|0,this._b=c+this._b|0,this._c=f+this._c|0,this._d=h+this._d|0,this._e=p+this._e|0,this._f=d+this._f|0,this._g=g+this._g|0,this._h=y+this._h|0},n.prototype._hash=function(){var e=new Buffer(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":339,buffer:590,inherits:102}],345:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=s,o.call(this,128,112)}var r=e("inherits"),i=e("./sha512"),o=e("./hash"),s=new Array(160);r(n,i),n.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},n.prototype._hash=function(){function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}var t=new Buffer(48);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":339,"./sha512":346,buffer:590,inherits:102}],346:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=g,p.call(this,128,112)}function r(e,t,n){return n^e&(t^n)}function i(e,t,n){return e&t|n&(e|t)}function o(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function s(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function a(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function u(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function c(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function f(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function l(e,t){return e>>>0<t>>>0?1:0}var h=e("inherits"),p=e("./hash"),d=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],g=new Array(160);h(n,p),n.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._ah,h=0|this._bh,p=0|this._ch,g=0|this._dh,y=0|this._eh,m=0|this._fh,v=0|this._gh,b=0|this._hh,w=0|this._al,E=0|this._bl,_=0|this._cl,S=0|this._dl,k=0|this._el,C=0|this._fl,x=0|this._gl,I=0|this._hl,A=0;A<32;A+=2)t[A]=e.readInt32BE(4*A),t[A+1]=e.readInt32BE(4*A+4);for(;A<160;A+=2){var P=t[A-30],T=t[A-30+1],M=a(P,T),R=u(T,P);P=t[A-4],T=t[A-4+1];var O=c(P,T),B=f(T,P),D=t[A-14],N=t[A-14+1],L=t[A-32],F=t[A-32+1],U=R+N|0,j=M+D+l(U,R)|0;U=U+B|0,j=j+O+l(U,B)|0,U=U+F|0,j=j+L+l(U,F)|0,t[A]=j,t[A+1]=U}for(var z=0;z<160;z+=2){j=t[z],U=t[z+1];var K=i(n,h,p),H=i(w,E,_),q=o(n,w),V=o(w,n),W=s(y,k),G=s(k,y),Y=d[z],X=d[z+1],$=r(y,m,v),J=r(k,C,x),Q=I+G|0,Z=b+W+l(Q,I)|0;Q=Q+J|0,Z=Z+$+l(Q,J)|0,Q=Q+X|0,Z=Z+Y+l(Q,X)|0,Q=Q+U|0,Z=Z+j+l(Q,U)|0;var ee=V+H|0,te=q+K+l(ee,V)|0;b=v,I=x,v=m,x=C,m=y,C=k,k=S+Q|0,y=g+Z+l(k,S)|0,g=p,S=_,p=h,_=E,h=n,E=w,w=Q+ee|0,n=Z+te+l(w,Q)|0}this._al=this._al+w|0,this._bl=this._bl+E|0,this._cl=this._cl+_|0,this._dl=this._dl+S|0,this._el=this._el+k|0,this._fl=this._fl+C|0,this._gl=this._gl+x|0,this._hl=this._hl+I|0,this._ah=this._ah+n+l(this._al,w)|0,this._bh=this._bh+h+l(this._bl,E)|0,this._ch=this._ch+p+l(this._cl,_)|0,this._dh=this._dh+g+l(this._dl,S)|0,this._eh=this._eh+y+l(this._el,k)|0,this._fh=this._fh+m+l(this._fl,C)|0,this._gh=this._gh+v+l(this._gl,x)|0,this._hh=this._hh+b+l(this._hl,I)|0},n.prototype._hash=function(){function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}var t=new Buffer(64);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":339,buffer:590,inherits:102}],347:[function(e,t,n){(function(Buffer){function e(){}e.prototype.bufferToArray=function(e,t){if(void 0===t&&(t=!0),"function"==typeof e.toArrayBuffer)return e.toArrayBuffer();for(var n=new ArrayBuffer(e.length),r=new Uint8Array(n),i=0;i<e.length;++i)r[i]=e[i];return n},e.prototype.arrayToBuffer=function(e){return Buffer.from(e)},e.prototype.isBuffer=function(e){return Buffer.isBuffer(e)||e instanceof Uint8Array},e.prototype.createBlob=function(e,t){return new Blob([this.bufferToArray(e)],{type:t})},t.exports=new e}).call(this,e("buffer").Buffer)},{buffer:590}],348:[function(e,t,n){arguments[4][266][0].apply(n,arguments)},{"./src/Exception":349,"./src/IllegalArgumentException":350,"./src/UnsupportedOperationException":351,dup:266}],349:[function(e,t,n){arguments[4][267][0].apply(n,arguments)},{dup:267}],350:[function(e,t,n){arguments[4][268][0].apply(n,arguments)},{"./Exception":349,dup:268}],351:[function(e,t,n){arguments[4][269][0].apply(n,arguments)},{"./Exception":349,dup:269}],352:[function(e,t,n){t.exports={LazyBuffer:e("./common/LazyBuffer"),SimpleLazyBuffer:e("./common/SimpleLazyBuffer"),Content:e("./common/Content"),BrowserLazyBuffer:e("./browser/BrowserLazyBuffer")}},{"./browser/BrowserLazyBuffer":353,"./common/Content":354,"./common/LazyBuffer":355,"./common/SimpleLazyBuffer":356}],353:[function(e,t,n){function r(e){o.call(this),this.blob=e,this.name=e.name,this.mimetype=e.type,this.size=e.size}var i=e("simplito-browserbuffer"),o=e("../common/LazyBuffer"),s=e("q");r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.slice=function(e,t){var n=r.createPromiseFromFileReader();return n.fileReader.readAsArrayBuffer(this.blob.slice(e,t)),n.promise.then(function(){return i.arrayToBuffer(n.fileReader.result)})},r.prototype.getBuffer=function(){var e=r.createPromiseFromFileReader();return e.fileReader.readAsArrayBuffer(this.blob),e.promise.then(function(){return i.arrayToBuffer(e.fileReader.result)})},r.prototype.getDataURL=function(){var e=r.createPromiseFromFileReader();return e.fileReader.readAsDataURL(this.blob),e.promise.then(function(){return e.fileReader.result})},r.prototype.getString=function(){return this.getBuffer().then(function(e){return e.toString("utf-8")})},r.createPromiseFromFileReader=function(){var e=s.defer(),t=new FileReader;return t.onload=e.resolve,t.onerror=e.reject,{promise:e.promise,fileReader:t}},t.exports=r},{"../common/LazyBuffer":355,q:327,"simplito-browserbuffer":347}],354:[function(e,t,n){function r(e,t,n){this.buffer=e,this.mimetype=t,this.name=n,this.size=e.length}var i=e("./SimpleLazyBuffer");r.prototype.withName=function(e){return new r(this.buffer,this.mimetype,e)},r.prototype.asLazyBuffer=function(){return new i(this.buffer,this.mimetype,this.name)},r.prototype.getDataUrl=function(){return"data:"+this.mimetype+";base64,"+this.buffer.toString("base64")},t.exports=r},{"./SimpleLazyBuffer":356}],355:[function(e,t,n){function r(){}var i=e("q");r.prototype.getName=function(){return this.name},r.prototype.getMimetype=function(){return this.mimetype},r.prototype.getSize=function(){return this.size},r.prototype.slice=function(e,t){return i.reject("NotImplemented")},r.prototype.getBuffer=function(){return i.reject("NotImplemented")},r.prototype.getDataURL=function(){return i.reject("NotImplemented")},r.prototype.getString=function(){return i.reject("NotImplemented")},t.exports=r},{q:327}],356:[function(e,t,n){(function(Buffer){function n(e,t,n){i.call(this),this.buffer=e,this.mimetype=t,this.name=n,this.size=e.length}var r=e("q"),i=e("./LazyBuffer");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.createFromBuffers=function(e,t,r){return new n(1==e.length?e[0]:Buffer.concat(e),t,r)},n.prototype.slice=function(e,t){return r().thenResolve(this.buffer.slice(e,t))},n.prototype.getBuffer=function(){return r().thenResolve(this.buffer)},n.prototype.getDataURL=function(){return r().thenResolve("data:"+this.mimetype+";base64,"+this.buffer.toString("base64"))},n.prototype.getString=function(){return r().thenResolve(this.buffer.toString("utf-8"))},t.exports=n}).call(this,e("buffer").Buffer)},{"./LazyBuffer":355,buffer:590,q:327}],357:[function(e,t,n){var r=e("./src/Logger");e("./src/Level");t.exports=new r(null,"")},{"./src/Level":358,"./src/Logger":359}],358:[function(e,t,n){function r(e,t){this.value=e,this.name=t}r.DEBUG=new r(1,"DEBUG"),r.INFO=new r(2,"INFO"),r.WARN=new r(4,"WARN"),r.ERROR=new r(5,"ERROR"),r.OFF=new r(6,"OFF"),r.isValidLevel=function(e){return e==r.DEBUG||e==r.INFO||e==r.WARN||e==r.ERROR||e==r.OFF},t.exports=r},{}],359:[function(e,t,n){function r(e,t){if(this.parent=e,this.name=t,this.fullName=null==this.parent||""==this.parent.fullName?this.name:this.parent.fullName+"."+this.name,this.inheritedLevel=null==this.parent?i.OFF:this.parent.getLevel(),this.children={},this.empty=function(){},"undefined"==typeof console||"undefined"==typeof console.log)this.debugLog=this.empty,this.infoLog=this.empty,this.warnLog=this.empty,this.errorLog=this.empty;else{var n="["+this.fullName+"]",r=console.log.bind(console,n);this.debugLog=console.debug?console.debug.bind(console,n):r,this.infoLog=console.info?console.info.bind(console,n):r,this.warnLog=console.warn?console.warn.bind(console,n):r,this.errorLog=console.error?console.error.bind(console,n):r}this.refresh()}var i=e("./Level");r.prototype.DEBUG=i.DEBUG,r.prototype.INFO=i.INFO,r.prototype.WARN=i.WARN,r.prototype.ERROR=i.ERROR,r.prototype.OFF=i.OFF,r.prototype.getLevel=function(e){return this.level?this.level:this.inheritedLevel},r.prototype.setLevel=function(e,t){if(i.isValidLevel(e)&&(this.level=e,this.refresh(),t!==!1))for(var n in this.children)this.children[n].setInheritedLevel(this.level)},r.prototype.setInheritedLevel=function(e){if(this.inheritedLevel=e,null==this.level){this.refresh();for(var t in this.children)this.children[t].setInheritedLevel(this.inheritedLevel)}},r.prototype.get=function(e){return this.getLoggerByNames(e.split("."))},r.prototype.getLoggerByNames=function(e){if(0==e.length||1==e.length&&""==e[0])return this;var t=e.shift(),n=this.children[t];return null==n&&(n=new r(this,t),this.children[t]=n),n.getLoggerByNames(e)},r.prototype.refresh=function(){var e=this.level?this.level:this.inheritedLevel;this.debug=e.value<=i.DEBUG.value?this.debugLog:this.empty,this.info=e.value<=i.INFO.value?this.infoLog:this.empty,this.warn=e.value<=i.WARN.value?this.warnLog:this.empty,this.error=e.value<=i.ERROR.value?this.errorLog:this.empty},t.exports=r},{"./Level":358}],360:[function(e,t,n){t.exports={ConnectionException:e("./common/ConnectionException"),InvalidJsonRpcException:e("./common/InvalidJsonRpcException"),InvalidStatusCodeException:e("./common/InvalidStatusCodeException"),JsonRpcException:e("./common/JsonRpcException"),NoJsonResponseException:e("./common/NoJsonResponseException"),ServerNotRespondingException:e("./common/ServerNotRespondingException"),UnknownConnectionException:e("./common/UnknownConnectionException"),HttpRequest:e("./browser/HttpRequest"),JsonRpcRequest:e("./browser/JsonRpcRequest")}},{"./browser/HttpRequest":361,"./browser/JsonRpcRequest":362,"./common/ConnectionException":363,"./common/InvalidJsonRpcException":364,"./common/InvalidStatusCodeException":365,"./common/JsonRpcException":366,"./common/NoJsonResponseException":367,"./common/ServerNotRespondingException":368,"./common/UnknownConnectionException":369}],361:[function(e,t,n){function r(){}var i=e("simplito-browserbuffer"),o=e("../common/NoJsonResponseException"),s=e("../common/InvalidStatusCodeException"),a=e("../common/UnknownConnectionException"),u=e("../common/ServerNotRespondingException");r.setBasicAuth=function(e,t,n){r.basicAuth={username:e,password:t,byUrl:n}},r.isValidUrl=function(e){return"string"==typeof e&&/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(e)},r.prepareFormData=function(e){if(!e||e instanceof FormData)return e||null;if("object"!=typeof e)throw new Error("Invalid data. Allowed values: null, object, FormData");var t=new FormData;for(var n in e){var r=e[n];i.isBuffer(r)?t.append(n,new Blob([i.bufferToArray(r)])):t.append(n,r)}return t},r.start=function(e){if(null==e)throw new Error("Parameter options is required");if("object"!=typeof e)throw new Error("Parameter options is invalid");if(null==e.url)throw new Error("Parameter options.url is required");if(null==e.method&&(e.method="GET"),null==e.responseType&&(e.responseType="buffer"),null==e.withCredentials&&(e.withCredentials=!1),null==e.success&&(e.success=function(){}),null==e.error&&(e.error=function(){}),!r.isValidUrl(e.url))throw new Error("Parameter options.url is invalid");if("GET"!==e.method&&"POST"!==e.method)throw new Error("Parameter options.method is invalid");if("buffer"!==e.responseType&&"text"!==e.responseType&&"json"!==e.responseType)throw new Error("Parameter options.responseType is invalid");if(e.withCredentials!==!0&&e.withCredentials!==!1)throw new Error("Parameter options.withCredentials is invalid");if("function"!=typeof e.success)throw new Error("Parameter options.success is invalid");if("function"!=typeof e.error)throw new Error("Parameter options.error is invalid");if(this.basicAuth&&this.basicAuth.byUrl){var t=e.url.indexOf("://"),n=e.url.substring(0,t),c=e.url.substring(t+3);e.url=n+"://"+this.basicAuth.username+":"+this.basicAuth.password+"@"+c}var f=r.prepareFormData(e.data),l=new XMLHttpRequest;l.withCredentials=e.withCredentials,l.onreadystatechange=function(){if(l.readyState==XMLHttpRequest.DONE){if(0==l.status)return void e.error(new u(e));var t=l.response;if("buffer"==e.responseType)t=l.response instanceof ArrayBuffer?i.arrayToBuffer(l.response):null;else if("json"==e.responseType)try{t=JSON.parse(l.response)}catch(n){return void e.error(new o(t,l.status,n))}200==l.status?e.success(t):e.error(new s(t,l.status))}},l.open(e.method,e.url,!0),l.responseType="buffer"==e.responseType?"arraybuffer":"text",r.basicAuth&&!r.basicAuth.byUrl&&l.setRequestHeader("Authorization","Basic "+btoa(r.basicAuth.username+":"+r.basicAuth.password));try{l.send(f)}catch(h){e.error(new a(h))}},t.exports=r},{"../common/InvalidStatusCodeException":365,"../common/NoJsonResponseException":367,"../common/ServerNotRespondingException":368,"../common/UnknownConnectionException":369,"simplito-browserbuffer":347}],362:[function(e,t,n){(function(Buffer){function n(){}var r=e("simplito-browserbuffer"),i=e("../common/NoJsonResponseException"),o=e("../common/UnknownConnectionException"),s=e("../common/InvalidJsonRpcException"),a=e("../common/JsonRpcException"),u=e("../common/ServerNotRespondingException"),c=e("q").Promise;n.prototype.setBasicAuth=function(e,t,n){this.basicAuth={username:e,password:t,byUrl:n}},n.prototype.isValidUrl=function(e){return"string"==typeof e&&/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(e)},n.prototype.prepareRequestAsBuffer=function(e,t){return new Buffer(this.prepareRequestAsString(e,t),"utf8")},n.prototype.prepareRequestAsString=function(e,t){return JSON.stringify(this.prepareRequestAsObject(e,t))},n.prototype.prepareRequestAsObject=function(e,t){return{jsonrpc:"2.0",method:e,params:t,id:0}},n.prototype.processBuffer=function(e,t,n){return this.processText(e.toString("utf8"),t,n)},n.prototype.processText=function(e,t,n){var r;try{r=JSON.parse(e)}catch(o){throw new i(e,t,n,o)}return this.processObject(r,t,n)},n.prototype.processObject=function(e,t,n){if("2.0"!=e.jsonrpc||null==e.result&&null==e.error||null!=e.result&&null!=e.error||null!=e.result&&"undefined"!=typeof t&&200!=t||null!=e.error&&(null==e.error.code||null==e.error.message))throw new s(e,t,n);if(null!=e.result&&0==e.id)return e.result;throw new a(e.error,n)},n.prototype.promise=function(e){return c(function(t,n){if(null==e)throw new Error("Parameter options is required");e.success=t,e.error=n;try{this.start(e)}catch(r){n(r)}}.bind(this))},n.prototype.start=function(e){if(null==e)throw new Error("Parameter options is required");if("object"!=typeof e)throw new Error("Parameter options is invalid");if(null==e.url)throw new Error("Parameter options.url is required");if(null==e.method)throw new Error("Parameter options.method is required");if(null==e.params)throw new Error("Parameter options.params is required");if(null==e.withCredentials&&(e.withCredentials=!1),null==e.success&&(e.success=function(){}),null==e.error&&(e.error=function(){}),!this.isValidUrl(e.url))throw new Error("Parameter options.url is invalid");if("string"!=typeof e.method)throw new Error("Parameter options.method is invalid");if("object"!=typeof e.params)throw new Error("Parameter options.params is invalid");if(e.withCredentials!==!0&&e.withCredentials!==!1)throw new Error("Parameter options.withCredentials is invalid");if("function"!=typeof e.success)throw new Error("Parameter options.success is invalid");if("function"!=typeof e.error)throw new Error("Parameter options.error is invalid");if(this.basicAuth&&this.basicAuth.byUrl){var t=e.url.indexOf("://"),n=e.url.substring(0,t),i=e.url.substring(t+3);e.url=n+"://"+this.basicAuth.username+":"+this.basicAuth.password+"@"+i}var s=this.prepareRequestAsObject(e.method,e.params),a=JSON.stringify(s),c=new XMLHttpRequest;c.withCredentials=e.withCredentials,c.onreadystatechange=function(){if(c.readyState==XMLHttpRequest.DONE){if(0==c.status)return void e.error(new u(s));if(e.expectedBuffer){var t=r.arrayToBuffer(c.response),n=c.getResponseHeader("content-type");if(200==c.status&&"binary/octet-stream"==n)e.success(t);else{var i;try{i=this.processText(t.toString("utf8"),c.status,s)}catch(o){e.error(o)}e.success(i)}}else{var i;try{i=this.processText(c.response,c.status,s)}catch(o){e.error(o)}e.success(i)}}}.bind(this);var f;if(c.open("POST",e.url,!0),c.responseType=e.expectedBuffer?"arraybuffer":"text",e.data){if(f=new FormData,f.append("jsonrpc",a),!r.isBuffer(e.data))throw new Error("Parameter options.data is invalid, expected Buffer");f.append("data",new Blob([r.bufferToArray(e.data)]))}else c.setRequestHeader("Content-Type","application/json"),f=a;this.basicAuth&&!this.basicAuth.byUrl&&c.setRequestHeader("Authorization","Basic "+btoa(this.basicAuth.username+":"+this.basicAuth.password));try{c.send(f)}catch(l){e.error(new o(l))}},t.exports=new n}).call(this,e("buffer").Buffer)},{"../common/InvalidJsonRpcException":364,"../common/JsonRpcException":366,"../common/NoJsonResponseException":367,"../common/ServerNotRespondingException":368,"../common/UnknownConnectionException":369,buffer:590,q:327,"simplito-browserbuffer":347}],363:[function(e,t,n){function r(e,t,n){this.init(new Error(e),t,n)}var i=e("simplito-exception").Exception;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"simplito-exception":348}],364:[function(e,t,n){function r(e,t,n){this.init(new Error(""),{response:e,status:t,request:n})}var i=e("./ConnectionException");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./ConnectionException":363}],365:[function(e,t,n){function r(e,t){this.init(new Error(""),{response:e,status:t})}var i=e("./ConnectionException");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./ConnectionException":363}],366:[function(e,t,n){function r(e,t){this.init(new Error(""),{error:e,request:t})}var i=e("./ConnectionException");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./ConnectionException":363}],367:[function(e,t,n){function r(e,t,n,r){this.init(new Error(""),{response:e,status:t,request:n},r)}var i=e("./ConnectionException");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./ConnectionException":363}],368:[function(e,t,n){function r(e,t){this.init(new Error(""),{request:e},t)}var i=e("./ConnectionException");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./ConnectionException":363}],369:[function(e,t,n){function r(e){this.init(new Error(""),null,e)}var i=e("./ConnectionException");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"./ConnectionException":363}],370:[function(e,t,n){t.exports={PromiseUtils:e("./src/PromiseUtils"),PromiseQueue:e("./src/PromiseQueue")
}},{"./src/PromiseQueue":371,"./src/PromiseUtils":372}],371:[function(e,t,n){function r(){this.queue=[],this.isRunning=!1}var i=e("q"),o=e("./PromiseUtils");r.prototype.add=function(e){var t=i.defer();return this.queue.push({deferred:t,func:e}),this.run(),t.promise},r.prototype.run=function(){this.isRunning||(this.isRunning=!0,o.queue(this.queue,function(e){return i().then(e.func).then(e.deferred.resolve).fail(e.deferred.reject).progress(e.deferred.notify)}.bind(this)).then(function(){this.isRunning=!1,this.queue.length>0&&this.run()}.bind(this)))},t.exports=r},{"./PromiseUtils":372,q:327}],372:[function(e,t,n){function r(){}var i=e("q");r.prototype.oneByOne=function(e,t){return i().then(function(){var n=[];for(var r in e)n.push(r);var o=0,s=function(){if(!(o>=n.length)){var r=n[o],a=e[r];return i().then(function(){return t(r,a)}).then(function(){return o++,s()})}};return s()})},r.prototype.collect=function(e,t){return i().then(function(){var n=[],r=[];for(var o in e)r.push(o);var s=0,a=function(){if(!(s>=r.length)){var o=r[s],u=e[o];return i().then(function(){return t(o,u)}).then(function(e){return n.push(e),s++,a()})}};return i().then(a).thenResolve(n)})},r.prototype.collectMap=function(e,t){return i().then(function(){var n={},r=[];for(var o in e)r.push(o);var s=0,a=function(){if(!(s>=r.length)){var o=r[s],u=e[o];return i().then(function(){return t(o,u)}).then(function(e){return n[o]=e,s++,a()})}};return i().then(a).thenResolve(n)})},r.prototype.settle=function(e,t){return i().then(function(){var n=Array.isArray(e)?[]:{},r=Object.keys(e),o=[];for(var s in r){var a=r[s],u=e[a],c=function(e,n){return i().then(function(){return t(e,n)})}(a,u);o.push(c)}return i.allSettled(o).then(function(e){var t=!0;for(var i in r){var o=r[i];n[o]=e[i],t&&"fulfilled"!=e[i].state&&(t=!1)}return{allFulfilled:t,results:n}})})},r.prototype.nTimes=function(e,t){return i().then(function(){var n=0,r=function(){return n>=e?i():i().then(function(){return t(n)}).then(function(){return n++,r()})};return r()})},r.prototype.queue=function(e,t){return i().then(function(){var n=function(){return 0==e.length?i():i(e.shift()).then(t).then(n)};return n()})},r.prototype.infinity=function(e,t){return i().then(function(){var n=function(){return e.value?i().then(t).then(n):i()};return n()})},r.prototype.timeout=function(e){return i.Promise(function(t){setTimeout(t,e||1)})},r.prototype.notify=function(e){var t=i.defer();return i.delay(1).then(e.bind(null,t.notify)).then(t.resolve).fail(t.reject),t.promise},r.prototype.clearProgress=function(e){var t=i.defer();return i.delay(1).then(e).then(t.resolve).fail(t.reject),t.promise},t.exports=new r},{q:327}],373:[function(e,t,n){(function(Buffer){function n(){}var r=e("buffer");n.prototype.isNumber=function(e){return"number"==typeof e&&isFinite(e)&&!isNaN(e)},n.prototype.isInteger=function(e){return this.isNumber(e)&&Math.floor(e)==e},n.prototype.isPositiveInteger=function(e){return this.isInteger(e)&&e>=0},n.prototype.isBuffer=function(e){return r.Buffer.isBuffer(e)||e instanceof Uint8Array},n.prototype.padHex=function(e){return e.length%2==1?"0"+e:e},n.prototype.clone=function(e,t){t=null==t?[]:t;var n=typeof e;if("object"==n){if(null==e)return e;for(var r in t)if(t[r].src===e)return t[r].clone;if(this.isBuffer(e)){var i=new Buffer(e);return t.push({src:e,clone:i}),i}if(e instanceof Date){var i=new Date(e.getTime());return t.push({src:e,clone:i}),i}var i=Array.isArray(e)?[]:{};t.push({src:e,clone:i});var o=Object.getOwnPropertyNames(e);for(var r in o){var s=o[r];i[s]=this.clone(e[s],t)}return i}if("string"==n||"number"==n||"boolean"==n||"undefined"==n)return e;throw new Error("Cannot clone object of type '"+n+"'")},n.prototype.startsWith=function(e,t,n){return"function"==typeof e.startsWith?e.startsWith(t,n):(n=n||0,e.indexOf(t,n)===n)},n.prototype.endsWith=function(e,t,n){if("function"==typeof e.endsWith)return e.endsWith(t,n);var r=e;("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n>r.length)&&(n=r.length),n-=t.length;var i=r.indexOf(t,n);return i!==-1&&i===n},n.prototype.simpleDeepClone=function(e){return JSON.parse(JSON.stringify(e))},n.prototype.isObject=function(e){return"object"==typeof e&&null!=e},n.prototype.fillByDefaults=function(e,t){if("undefined"==typeof e)return t;if(this.isObject(e)&&this.isObject(t))for(var n in t)n in e?this.fillByDefaults(e[n],t[n]):e[n]=t[n];return e},n.prototype.defineLazyReadOnlyProperty=function(e,t,n){Object.defineProperty(e,t,{get:function(){var r=n.call(e);return Object.defineProperty(e,t,{value:r,enumerable:!0}),r},enumerable:!0,configurable:!0})},n.prototype.isInstanceOf=function(e,t){for(var n=0;n<t.length;n++)if(e instanceof t[n])return!0;return!1},t.exports=new n}).call(this,e("buffer").Buffer)},{buffer:590}],374:[function(e,t,n){"use strict";t.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},{}],375:[function(e,t,n){function r(e){if(e&&!a(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var Buffer=e("buffer").Buffer,a=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=n.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},{buffer:590}],376:[function(e,t,n){var r=e("util"),i=e("bl"),o=e("xtend"),s=e("./headers"),a=e("readable-stream").Writable,u=e("readable-stream").PassThrough,c=function(){},f=function(e){return e&=511,e&&512-e},l=function(e,t){var n=new p(e,t);return n.end(),n},h=function(e,t){return t.path&&(e.name=t.path),t.linkpath&&(e.linkname=t.linkpath),e.pax=t,e},p=function(e,t){this._parent=e,this.offset=t,u.call(this)};r.inherits(p,u),p.prototype.destroy=function(e){this._parent.destroy(e)};var d=function(e){if(!(this instanceof d))return new d(e);a.call(this,e),this._offset=0,this._buffer=i(),this._missing=0,this._onparse=c,this._header=null,this._stream=null,this._overflow=null,this._cb=null,this._locked=!1,this._destroyed=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null;var t=this,n=t._buffer,r=function(){t._continue()},u=function(e){return t._locked=!1,e?t.destroy(e):void(t._stream||r())},g=function(){t._stream=null;var e=f(t._header.size);e?t._parse(e,y):t._parse(512,E),t._locked||r()},y=function(){t._buffer.consume(f(t._header.size)),t._parse(512,E),r()},m=function(){var e=t._header.size;t._paxGlobal=s.decodePax(n.slice(0,e)),n.consume(e),g()},v=function(){var e=t._header.size;t._pax=s.decodePax(n.slice(0,e)),t._paxGlobal&&(t._pax=o(t._paxGlobal,t._pax)),n.consume(e),g()},b=function(){var e=t._header.size;this._gnuLongPath=s.decodeLongPath(n.slice(0,e)),n.consume(e),g()},w=function(){var e=t._header.size;this._gnuLongLinkPath=s.decodeLongPath(n.slice(0,e)),n.consume(e),g()},E=function(){var e,i=t._offset;try{e=t._header=s.decode(n.slice(0,512))}catch(o){t.emit("error",o)}return n.consume(512),e?"gnu-long-path"===e.type?(t._parse(e.size,b),void r()):"gnu-long-link-path"===e.type?(t._parse(e.size,w),void r()):"pax-global-header"===e.type?(t._parse(e.size,m),void r()):"pax-header"===e.type?(t._parse(e.size,v),void r()):(t._gnuLongPath&&(e.name=t._gnuLongPath,t._gnuLongPath=null),t._gnuLongLinkPath&&(e.linkname=t._gnuLongLinkPath,t._gnuLongLinkPath=null),t._pax&&(t._header=e=h(e,t._pax),t._pax=null),t._locked=!0,e.size?(t._stream=new p(t,i),t.emit("entry",e,t._stream,u),t._parse(e.size,g),void r()):(t._parse(512,E),void t.emit("entry",e,l(t,i),u))):(t._parse(512,E),void r())};this._parse(512,E)};r.inherits(d,a),d.prototype.destroy=function(e){this._destroyed||(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.emit("close"))},d.prototype._parse=function(e,t){this._destroyed||(this._offset+=e,this._missing=e,this._onparse=t)},d.prototype._continue=function(){if(!this._destroyed){var e=this._cb;this._cb=c,this._overflow?this._write(this._overflow,void 0,e):e()}},d.prototype._write=function(e,t,n){if(!this._destroyed){var r=this._stream,i=this._buffer,o=this._missing;if(e.length<o)return this._missing-=e.length,this._overflow=null,r?r.write(e,n):(i.append(e),n());this._cb=n,this._missing=0;var s=null;e.length>o&&(s=e.slice(o),e=e.slice(0,o)),r?r.end(e):i.append(e),this._overflow=s,this._onparse()}},t.exports=d},{"./headers":377,bl:19,"readable-stream":386,util:689,xtend:400}],377:[function(e,t,n){(function(Buffer){function e(e){var t;if(128===e[0])t=!0;else{if(255!==e[0])return null;t=!1}for(var n=!1,r=[],i=e.length-1;i>0;i--){var o=e[i];t?r.push(o):n&&0===o?r.push(0):n?(n=!1,r.push(256-o)):r.push(255-o)}var s=0,a=r.length;for(i=0;i<a;i++)s+=r[i]*Math.pow(256,i);return t?s:-1*s}var t="0000000000000000000",r="0".charCodeAt(0),i="ustar\x0000",o=parseInt("7777",8),s=function(e,t,n){return"number"!=typeof e?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))},a=function(e){switch(e){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},u=function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},c=function(e){var t=new Buffer(e);return t.fill(0),t},f=function(e,t,n,r){for(;n<r;n++)if(e[n]===t)return n;return r},l=function(e){for(var t=256,n=0;n<148;n++)t+=e[n];for(var r=156;r<512;r++)t+=e[r];return t},h=function(e,n){return e=e.toString(8),t.slice(0,n-e.length)+e+" "},p=function(t,n){if(128&t[n])return e(t.slice(n,n+8));for(;n<t.length&&32===t[n];)n++;for(var r=s(f(t,32,n,t.length),t.length,t.length);n<r&&0===t[n];)n++;return r===n?0:parseInt(t.slice(n,r).toString(),8)},d=function(e,t,n){return e.slice(t,f(e,0,t,t+n)).toString()},g=function(e){var t=Buffer.byteLength(e),n=Math.floor(Math.log(t)/Math.log(10))+1;return t+n>Math.pow(10,n)&&n++,t+n+e};n.decodeLongPath=function(e){return d(e,0,e.length)},n.encodePax=function(e){var t="";e.name&&(t+=g(" path="+e.name+"\n")),e.linkname&&(t+=g(" linkpath="+e.linkname+"\n"));var n=e.pax;if(n)for(var r in n)t+=g(" "+r+"="+n[r]+"\n");return new Buffer(t)},n.decodePax=function(e){for(var t={};e.length;){for(var n=0;n<e.length&&32!==e[n];)n++;var r=parseInt(e.slice(0,n).toString(),10);if(!r)return t;var i=e.slice(n+1,r-1).toString(),o=i.indexOf("=");if(o===-1)return t;t[i.slice(0,o)]=i.slice(o+1),e=e.slice(r)}return t},n.encode=function(e){var t=c(512),n=e.name,s="";if(5===e.typeflag&&"/"!==n[n.length-1]&&(n+="/"),Buffer.byteLength(n)!==n.length)return null;for(;Buffer.byteLength(n)>100;){var a=n.indexOf("/");if(a===-1)return null;s+=s?"/"+n.slice(0,a):n.slice(0,a),n=n.slice(a+1)}return Buffer.byteLength(n)>100||Buffer.byteLength(s)>155?null:e.linkname&&Buffer.byteLength(e.linkname)>100?null:(t.write(n),t.write(h(e.mode&o,6),100),t.write(h(e.uid,6),108),t.write(h(e.gid,6),116),t.write(h(e.size,11),124),t.write(h(e.mtime.getTime()/1e3|0,11),136),t[156]=r+u(e.type),e.linkname&&t.write(e.linkname,157),t.write(i,257),e.uname&&t.write(e.uname,265),e.gname&&t.write(e.gname,297),t.write(h(e.devmajor||0,6),329),t.write(h(e.devminor||0,6),337),s&&t.write(s,345),t.write(h(l(t),6),148),t)},n.decode=function(e){var t=0===e[156]?0:e[156]-r,n=d(e,0,100),i=p(e,100),o=p(e,108),s=p(e,116),u=p(e,124),c=p(e,136),f=a(t),h=0===e[157]?null:d(e,157,100),g=d(e,265,32),y=d(e,297,32),m=p(e,329),v=p(e,337);e[345]&&(n=d(e,345,155)+"/"+n),0===t&&n&&"/"===n[n.length-1]&&(t=5);var b=l(e);if(256===b)return null;if(b!==p(e,148))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");return{name:n,mode:i,uid:o,gid:s,size:u,mtime:new Date(1e3*c),type:f,linkname:h,uname:g,gname:y,devmajor:m,devminor:v}}}).call(this,e("buffer").Buffer)},{buffer:590}],378:[function(e,t,n){n.extract=e("./extract"),n.pack=e("./pack")},{"./extract":376,"./pack":387}],379:[function(e,t,n){arguments[4][20][0].apply(n,arguments)},{dup:20}],380:[function(e,t,n){arguments[4][22][0].apply(n,arguments)},{"./_stream_readable":382,"./_stream_writable":384,"core-util-is":50,dup:22,inherits:102,"process-nextick-args":325}],381:[function(e,t,n){"use strict";function r(e){return this instanceof r?void i.call(this,e):new r(e)}t.exports=r;var i=e("./_stream_transform"),o=e("core-util-is");o.inherits=e("inherits"),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":383,"core-util-is":50,inherits:102}],382:[function(e,t,n){(function(n){"use strict";function r(e,t,n){return"function"==typeof e.prependListener?e.prependListener(t,n):void(e._events&&e._events[t]?M(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n))}function i(t,n){P=P||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof P&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new U,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(F||(F=e("string_decoder/").StringDecoder),this.decoder=new F(t.encoding),this.encoding=t.encoding)}function o(t){return P=P||e("./_stream_duplex"),this instanceof o?(this._readableState=new i(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),void R.call(this)):new o(t)}function s(e,t,n,r,i){var o=f(t,n);if(o)e.emit("error",o);else if(null===n)t.reading=!1,l(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&i){var u=new Error("stream.unshift() after end event");e.emit("error",u)}else{var c;!t.decoder||i||r||(n=t.decoder.write(n),c=!t.objectMode&&0===n.length),i||(t.reading=!1),c||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&h(e))),d(e,t)}else i||(t.reading=!1);return a(t)}function a(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function u(e){return e>=j?e=j:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function c(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=u(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function f(e,t){var n=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function l(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,h(e)}}function h(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(L("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?T(p,e):p(e))}function p(e){L("emit readable"),e.emit("readable"),w(e)}function d(e,t){t.readingMore||(t.readingMore=!0,T(g,e,t))}function g(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(L("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function y(e){return function(){var t=e._readableState;L("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&O(e,"data")&&(t.flowing=!0,w(e))}}function m(e){L("readable nexttick read 0"),e.read(0)}function v(e,t){t.resumeScheduled||(t.resumeScheduled=!0,T(b,e,t))}function b(e,t){t.reading||(L("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),w(e),t.flowing&&!t.reading&&e.read(0)}function w(e){var t=e._readableState;for(L("flow",t.flowing);t.flowing&&null!==e.read(););}function E(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=_(e,t.buffer,t.decoder),n}function _(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?S(e,t):k(e,t),r}function S(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(i+=s===o.length?o:o.slice(0,e),e-=s,0===e){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}function k(e,t){var n=B.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,s),e-=s,0===e){s===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}function C(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,T(x,t,e))}function x(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function I(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function A(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}t.exports=o;var P,T=e("process-nextick-args"),M=e("isarray");o.ReadableState=i;var R,O=(e("events").EventEmitter,function(e,t){return e.listeners(t).length});!function(){try{R=e("stream")}catch(t){}finally{R||(R=e("events").EventEmitter)}}();var Buffer=e("buffer").Buffer,B=e("buffer-shims"),D=e("core-util-is");D.inherits=e("inherits");var N=e("util"),L=void 0;L=N&&N.debuglog?N.debuglog("stream"):function(){};var F,U=e("./internal/streams/BufferList");D.inherits(o,R),o.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding,t!==n.encoding&&(e=B.from(e,t),t="")),s(this,n,e,t,!1)},o.prototype.unshift=function(e){var t=this._readableState;return s(this,t,e,"",!0)},o.prototype.isPaused=function(){return this._readableState.flowing===!1},o.prototype.setEncoding=function(t){return F||(F=e("string_decoder/").StringDecoder),this._readableState.decoder=new F(t),this._readableState.encoding=t,this};var j=8388608;o.prototype.read=function(e){L("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return L("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?C(this):h(this),null;if(e=c(e,t),0===e&&t.ended)return 0===t.length&&C(this),null;var r=t.needReadable;L("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,L("length less than watermark",r)),t.ended||t.reading?(r=!1,L("reading or ended",r)):r&&(L("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=c(n,t)));var i;return i=e>0?E(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&C(this)),null!==i&&this.emit("data",i),i},o.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},o.prototype.pipe=function(e,t){function i(e){L("onunpipe"),e===h&&s()}function o(){L("onend"),e.end()}function s(){L("cleanup"),e.removeListener("close",c),e.removeListener("finish",f),e.removeListener("drain",m),e.removeListener("error",u),e.removeListener("unpipe",i),h.removeListener("end",o),h.removeListener("end",s),h.removeListener("data",a),v=!0,!p.awaitDrain||e._writableState&&!e._writableState.needDrain||m()}function a(t){L("ondata"),b=!1;var n=e.write(t);!1!==n||b||((1===p.pipesCount&&p.pipes===e||p.pipesCount>1&&A(p.pipes,e)!==-1)&&!v&&(L("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,b=!0),h.pause())}function u(t){L("onerror",t),l(),e.removeListener("error",u),0===O(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",f),l()}function f(){L("onfinish"),e.removeListener("close",c),l()}function l(){L("unpipe"),h.unpipe(e)}var h=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=e;break;case 1:p.pipes=[p.pipes,e];break;default:p.pipes.push(e)}p.pipesCount+=1,L("pipe count=%d opts=%j",p.pipesCount,t);var d=(!t||t.end!==!1)&&e!==n.stdout&&e!==n.stderr,g=d?o:s;p.endEmitted?T(g):h.once("end",g),e.on("unpipe",i);var m=y(h);e.on("drain",m);var v=!1,b=!1;return h.on("data",a),r(e,"error",u),e.once("close",c),e.once("finish",f),e.emit("pipe",h),p.flowing||(L("pipe resume"),h.resume()),e},o.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var o=A(t.pipes,e);return o===-1?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},o.prototype.on=function(e,t){var n=R.prototype.on.call(this,e,t);if("data"===e)this._readableState.flowing!==!1&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&h(this,r):T(m,this))}return n},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){var e=this._readableState;return e.flowing||(L("resume"),e.flowing=!0,v(this,e)),this},o.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this},o.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(L("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(L("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return I(o,function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){L("wrapped _read",t),n&&(n=!1,e.resume())},r},o._fromList=E}).call(this,e("_process"))},{"./_stream_duplex":380,"./internal/streams/BufferList":385,_process:592,buffer:590,"buffer-shims":46,"core-util-is":50,events:630,inherits:102,isarray:379,"process-nextick-args":325,"string_decoder/":375,util:564}],383:[function(e,t,n){"use strict";function r(e){this.afterTransform=function(t,n){return i(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e),this._transformState=new r(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,n){s(t,e,n)}):s(t)})}function s(e,t,n){if(t)return e.emit("error",t);null!==n&&void 0!==n&&e.push(n);var r=e._writableState,i=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}t.exports=o;var a=e("./_stream_duplex"),u=e("core-util-is");u.inherits=e("inherits"),u.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},{"./_stream_duplex":380,"core-util-is":50,inherits:102}],384:[function(e,t,n){(function(n){"use strict";function r(){}function i(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function o(t,n){S=S||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof S&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=t.decodeStrings===!1;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){d(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}function s(t){return S=S||e("./_stream_duplex"),T.call(s,this)||this instanceof S?(this._writableState=new o(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),void I.call(this)):new s(t)}function a(e,t){var n=new Error("write after end");e.emit("error",n),k(t,n)}function u(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):Buffer.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),k(r,o),i=!1),i}function c(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=P.from(t,n)),t}function f(e,t,n,r,o){n=c(t,n,r),Buffer.isBuffer(n)&&(r="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new i(n,r,o),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else l(e,t,!1,s,n,r,o);return a}function l(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function h(e,t,n,r,i){--t.pendingcb,n?k(i,r):i(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function p(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function d(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(p(n),t)h(e,n,r,t,i);else{var o=v(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||m(e,n),r?C(g,e,n,o,i):g(e,n,o,i)}}function g(e,t,n,r){n||y(e,t),t.pendingcb--,r(),w(e,t)}function y(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function m(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0;n;)i[s]=n,n=n.next,s+=1;l(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new _(t)}else{for(;n;){var a=n.chunk,u=n.encoding,c=n.callback,f=t.objectMode?1:a.length;if(l(e,t,!1,f,a,u,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function v(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function w(e,t){var n=v(t);return n&&(0===t.pendingcb?(b(e,t),t.finished=!0,e.emit("finish")):b(e,t)),n}function E(e,t,n){t.ending=!0,w(e,t),n&&(t.finished?k(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function _(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}t.exports=s;var S,k=e("process-nextick-args"),C=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?setImmediate:k;s.WritableState=o;var x=e("core-util-is");x.inherits=e("inherits");var I,A={deprecate:e("util-deprecate")};!function(){try{I=e("stream")}catch(t){}finally{I||(I=e("events").EventEmitter)}}();var Buffer=e("buffer").Buffer,P=e("buffer-shims");x.inherits(s,I),o.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(o.prototype,"buffer",{get:A.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}();var T;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(T=Function.prototype[Symbol.hasInstance],Object.defineProperty(s,Symbol.hasInstance,{value:function(e){return!!T.call(this,e)||e&&e._writableState instanceof o}})):T=function(e){return e instanceof this},s.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},s.prototype.write=function(e,t,n){var i=this._writableState,o=!1;return"function"==typeof t&&(n=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=r),
i.ended?a(this,n):u(this,i,e,n)&&(i.pendingcb++,o=f(this,i,e,t,n)),o},s.prototype.cork=function(){var e=this._writableState;e.corked++},s.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||m(this,e))},s.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},s.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},s.prototype._writev=null,s.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||E(this,r,n)}}).call(this,e("_process"))},{"./_stream_duplex":380,_process:592,buffer:590,"buffer-shims":46,"core-util-is":50,events:630,inherits:102,"process-nextick-args":325,"util-deprecate":394}],385:[function(e,t,n){arguments[4][25][0].apply(n,arguments)},{buffer:590,"buffer-shims":46,dup:25}],386:[function(e,t,n){(function(r){var i=function(){try{return e("stream")}catch(t){}}();n=t.exports=e("./lib/_stream_readable.js"),n.Stream=i||n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),!r.browser&&"disable"===r.env.READABLE_STREAM&&i&&(t.exports=i)}).call(this,e("_process"))},{"./lib/_stream_duplex.js":380,"./lib/_stream_passthrough.js":381,"./lib/_stream_readable.js":382,"./lib/_stream_transform.js":383,"./lib/_stream_writable.js":384,_process:592}],387:[function(e,t,n){(function(n,Buffer){function r(e){switch(e&i.S_IFMT){case i.S_IFBLK:return"block-device";case i.S_IFCHR:return"character-device";case i.S_IFDIR:return"directory";case i.S_IFIFO:return"fifo";case i.S_IFLNK:return"symlink"}return"file"}var i=e("constants"),o=e("end-of-stream"),s=e("util"),a=e("readable-stream").Readable,u=e("readable-stream").Writable,c=e("string_decoder").StringDecoder,f=e("./headers"),l=parseInt("755",8),h=parseInt("644",8),p=new Buffer(1024);p.fill(0);var d=function(){},g=function(e,t){t&=511,t&&e.push(p.slice(0,512-t))},y=function(e){u.call(this),this.written=0,this._to=e,this._destroyed=!1};s.inherits(y,u),y.prototype._write=function(e,t,n){return this.written+=e.length,this._to.push(e)?n():void(this._to._drain=n)},y.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var m=function(){u.call(this),this.linkname="",this._decoder=new c("utf-8"),this._destroyed=!1};s.inherits(m,u),m.prototype._write=function(e,t,n){this.linkname+=this._decoder.write(e),n()},m.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var v=function(){u.call(this),this._destroyed=!1};s.inherits(v,u),v.prototype._write=function(e,t,n){n(new Error("No body allowed for this entry"))},v.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var b=function(e){return this instanceof b?(a.call(this,e),this._drain=d,this._finalized=!1,this._finalizing=!1,this._destroyed=!1,void(this._stream=null)):new b(e)};s.inherits(b,a),b.prototype.entry=function(e,t,i){if(this._stream)throw new Error("already piping an entry");if(!this._finalized&&!this._destroyed){"function"==typeof t&&(i=t,t=null),i||(i=d);var s=this;if(e.size&&"symlink"!==e.type||(e.size=0),e.type||(e.type=r(e.mode)),e.mode||(e.mode="directory"===e.type?l:h),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),"string"==typeof t&&(t=new Buffer(t)),Buffer.isBuffer(t))return e.size=t.length,this._encode(e),this.push(t),g(s,e.size),n.nextTick(i),new v;if("symlink"===e.type&&!e.linkname){var a=new m;return o(a,function(t){return t?(s.destroy(),i(t)):(e.linkname=a.linkname,s._encode(e),void i())}),a}if(this._encode(e),"file"!==e.type&&"contiguous-file"!==e.type)return n.nextTick(i),new v;var u=new y(this);return this._stream=u,o(u,function(t){return s._stream=null,t?(s.destroy(),i(t)):u.written!==e.size?(s.destroy(),i(new Error("size mismatch"))):(g(s,e.size),s._finalizing&&s.finalize(),void i())}),u}},b.prototype.finalize=function(){return this._stream?void(this._finalizing=!0):void(this._finalized||(this._finalized=!0,this.push(p),this.push(null)))},b.prototype.destroy=function(e){this._destroyed||(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.destroy&&this._stream.destroy())},b.prototype._encode=function(e){if(!e.pax){var t=f.encode(e);if(t)return void this.push(t)}this._encodePax(e)},b.prototype._encodePax=function(e){var t=f.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),n={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(f.encode(n)),this.push(t),g(this,t.length),n.size=e.size,n.type=e.type,this.push(f.encode(n))},b.prototype._read=function(e){var t=this._drain;this._drain=d,t()},t.exports=b}).call(this,e("_process"),e("buffer").Buffer)},{"./headers":377,_process:592,buffer:590,constants:595,"end-of-stream":73,"readable-stream":386,string_decoder:685,util:689}],388:[function(e,t,n){function r(e){return e.replace(/^\s*|\s*$/g,"")}n=t.exports=r,n.left=function(e){return e.replace(/^\s*/,"")},n.right=function(e){return e.replace(/\s*$/,"")}},{}],389:[function(e,t,n){function r(e,t,n){this.__error=Error.call(this),this.__type=e,this.__value=t,this.__valueTypeName=n;var r;Object.defineProperty(this,"message",{enumerable:!0,get:function(){return r?r:(n=n||u(t),r=l(e,t,n))}})}function i(e,t,n,r,i,o){this.__error=i||Error.call(this),this.__label=n,this.__property=t,this.__type=e,this.__value=r,this.__valueTypeName=o;var s;Object.defineProperty(this,"message",{enumerable:!0,get:function(){return s?s:(e?(o=o||u(r),s=h(e,n,t,r,o)):s='Unexpected property "'+t+'"',s)}})}function o(e,t){return new r(e,{},t)}function s(e,t,n){return e instanceof i?(t=t+"."+e.__property,n=e.__label,new i(e.__type,t,n,e.__value,e.__error,e.__valueTypeName)):e instanceof r?new i(e.__type,t,n,e.__value,e.__error,e.__valueTypeName):e}function a(e){return e.name||e.toString().match(/function (.*?)\s*\(/)[1]}function u(e){return d.Null(e)?"":a(e.constructor)}function c(e){return d.Function(e)?"":d.String(e)?JSON.stringify(e):e&&d.Object(e)?"":e}function f(e){return d.Function(e)?e.toJSON?e.toJSON():a(e):d.Array(e)?"Array":e&&d.Object(e)?"Object":void 0!==e?e:""}function l(e,t,n){var r=c(t);return"Expected "+f(e)+", got"+(""!==n?" "+n:"")+(""!==r?" "+r:"")}function h(e,t,n,r,i){var o='" of type ';return"key"===t&&(o='" with key type '),l('property "'+f(n)+o+f(e),r,i)}var p=e("inherits"),d=e("./native");[r,i].forEach(function(e){p(e,Error),Object.defineProperty(e,"stack",{get:function(){return this.__error.stack}})}),t.exports={TfTypeError:r,TfPropertyTypeError:i,tfCustomError:o,tfSubError:s,tfJSON:f,getValueTypeName:u}},{"./native":392,inherits:102}],390:[function(e,t,n){(function(Buffer){function n(e){return Buffer.isBuffer(e)}function r(e){function t(t){if(!Buffer.isBuffer(t))return!1;if(t.length!==e)throw d.tfCustomError("Buffer(Length: "+e+")","Buffer(Length: "+t.length+")");return!0}return t.toJSON=function(){return"Buffer"},t}function i(e){return"string"==typeof e&&/^([0-9a-f]{2})+$/i.test(e)}function o(e){function t(t){if(!i(t))return!1;if(t.length!==e)throw d.tfCustomError("Hex(Length: "+e+")","Hex(Length: "+t.length+")");return!0}return t.toJSON=function(){return"Hex"},t}function s(e){return"number"==typeof e&&isFinite(e)}function a(e){return e<<24>>24===e}function u(e){return e<<16>>16===e}function c(e){return(0|e)===e}function f(e){return(255&e)===e}function l(e){return(65535&e)===e}function h(e){return e>>>0===e}function p(e){return"number"==typeof e&&e>=0&&e<=g&&Math.floor(e)===e}var d=e("./errors");n.toJSON=function(){return"Buffer"};var g=Math.pow(2,53)-1;t.exports={Buffer:n,BufferN:r,Finite:s,Hex:i,HexN:o,Int8:a,Int16:u,Int32:c,UInt8:f,UInt16:l,UInt32:h,UInt53:p}}).call(this,{isBuffer:e("../../../node_modules/is-buffer/index.js")})},{"../../../node_modules/is-buffer/index.js":641,"./errors":389}],391:[function(e,t,n){function r(e){return a.String(e)?"?"===e[0]?p.maybe(r(e.slice(1))):a[e]||p.quacksLike(e):e&&a.Object(e)?a.Array(e)?p.arrayOf(r(e[0])):p.object(e):a.Function(e)?e:p.value(e)}function i(e,t,n,o){if(a.Function(e)){if(e(t,n))return!0;throw new c(o||e,t)}return i(r(e),t,n)}function o(e,t,n,r){if("function"==typeof n)return o(e,t,!1,n);try{i(e,t,n)}catch(s){return r(s)}r()}var s=e("./errors"),a=e("./native"),u=s.tfJSON,c=s.TfTypeError,f=s.TfPropertyTypeError,l=s.tfSubError,h=s.getValueTypeName,p={arrayOf:function(e){function t(t,n){return!!a.Array(t)&&t.every(function(t,r){try{return i(e,t,n)}catch(o){throw l(o,r)}})}return e=r(e),t.toJSON=function(){return"["+u(e)+"]"},t},maybe:function y(e){function t(t,n){return a.Null(t)||e(t,n,y)}return e=r(e),t.toJSON=function(){return"?"+u(e)},t},map:function(e,t){function n(n,r){if(!a.Object(n,r))return!1;if(a.Null(n,r))return!1;for(var o in n){try{t&&i(t,o,r)}catch(s){throw l(s,o,"key")}try{var u=n[o];i(e,u,r)}catch(s){throw l(s,o)}}return!0}return e=r(e),t&&(t=r(t)),t?n.toJSON=function(){return"{"+u(t)+": "+u(e)+"}"}:n.toJSON=function(){return"{"+u(e)+"}"},n},object:function(e){function t(e,t){if(!a.Object(e))return!1;if(a.Null(e))return!1;var r;try{for(r in n){var o=n[r],s=e[r];i(o,s,t)}}catch(u){throw l(u,r)}if(t)for(r in e)if(!n[r])throw new f((void 0),r);return!0}var n={};for(var o in e)n[o]=r(e[o]);return t.toJSON=function(){return u(n)},t},oneOf:function(){function e(e,n){return t.some(function(t){try{return i(t,e,n)}catch(r){return!1}})}var t=[].slice.call(arguments).map(r);return e.toJSON=function(){return t.map(u).join("|")},e},quacksLike:function(e){function t(t){return e===h(t)}return t.toJSON=function(){return e},t},tuple:function(){function e(e,n){return t.every(function(t,r){try{return i(t,e[r],n)}catch(o){throw l(o,r)}})&&(!n||e.length===arguments.length)}var t=[].slice.call(arguments).map(r);return e.toJSON=function(){return"("+t.map(u).join(", ")+")"},e},value:function(e){function t(t){return t===e}return t.toJSON=function(){return e},t}};for(var d in a)i[d]=a[d];for(d in p)i[d]=p[d];var g=e("./extra");for(d in g)i[d]=g[d];i.async=o,i.compile=r,i.TfTypeError=c,i.TfPropertyTypeError=f,t.exports=i},{"./errors":389,"./extra":390,"./native":392}],392:[function(e,t,n){var r={Array:function(e){return null!==e&&void 0!==e&&e.constructor===Array},Boolean:function(e){return"boolean"==typeof e},Function:function(e){return"function"==typeof e},Null:function(e){return void 0===e||null===e},Number:function(e){return"number"==typeof e},Object:function(e){return"object"==typeof e},String:function(e){return"string"==typeof e},"":function(){return!0}};for(var i in r)r[i].toJSON=function(e){return e}.bind(null,i);t.exports=r},{}],393:[function(e,t,n){!function(e){"use strict";function n(e,t,n){var r=S[t];return r||(r=e(t,n),r.feature&&++k[t>>8&255]>h&&(S[t]=r)),r}function r(e,t,n){var r=65280&t,i=_.udata[r]||{},o=i[t];return o?new _(t,o):new _(t,l)}function i(e,t,n){return n?e(t,n):new _(t,null)}function o(e,t,n){var r;if(t<d||d+m<=t&&t<p||p+E<t)return e(t,n);if(d<=t&&t<d+m){var i={},o=(t-d)*v;for(r=0;r<v;++r)i[g+r]=p+b*(r+o);return new _(t,[,,i])}var s=t-p,a=s%b,u=[];if(0!==a)u[0]=[p+s-a,y+a];else for(u[0]=[d+Math.floor(s/w),g+Math.floor(s%w/b)],u[2]={},r=1;r<b;++r)u[2][y+r]=t+r;return new _(t,u)}function s(e,t,n){return t<60||13311<t&&t<42607?new _(t,l):e(t,n)}function a(e){return R("NFD",e)}function u(e){return R("NFKD",e)}function c(e){return R("NFC",e)}function f(e){return R("NFKC",e)}for(var l=[null,0,{}],h=10,p=44032,d=4352,g=4449,y=4519,m=19,v=21,b=28,w=v*b,E=m*w,_=function(e,t){this.codepoint=e,this.feature=t},S={},k=[],C=0;C<=255;++C)k[C]=0;var x=[s,n,i,o,r];_.fromCharCode=x.reduceRight(function(e,t){return function(n,r){return t(e,n,r)}},null),_.isHighSurrogate=function(e){return e>=55296&&e<=56319},_.isLowSurrogate=function(e){return e>=56320&&e<=57343},_.prototype.prepFeature=function(){this.feature||(this.feature=_.fromCharCode(this.codepoint,!0).feature)},_.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var e=this.codepoint-65536;return String.fromCharCode(Math.floor(e/1024)+55296,e%1024+56320)},_.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},_.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},_.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},_.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},_.prototype.getComposite=function(e){if(this.prepFeature(),!this.feature[2])return null;var t=this.feature[2][e.codepoint];return t?_.fromCharCode(t):null};var I=function(e){this.str=e,this.cursor=0};I.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var e,t=this.str.charCodeAt(this.cursor++);return _.isHighSurrogate(t)&&this.cursor<this.str.length&&_.isLowSurrogate(e=this.str.charCodeAt(this.cursor))&&(t=1024*(t-55296)+(e-56320)+65536,++this.cursor),_.fromCharCode(t)}return this.str=null,null};var A=function(e,t){this.it=e,this.canonical=t,this.resBuf=[]};A.prototype.next=function(){function e(t,n){var r=n.getDecomp();if(!r||t&&n.isCompatibility())return[n];for(var i=[],o=0;o<r.length;++o){var s=e(t,_.fromCharCode(r[o]));i=i.concat(s)}return i}if(0===this.resBuf.length){var t=this.it.next();if(!t)return null;this.resBuf=e(this.canonical,t)}return this.resBuf.shift()};var P=function(e){this.it=e,this.resBuf=[]};P.prototype.next=function(){var e;if(0===this.resBuf.length)do{var t=this.it.next();if(!t)break;e=t.getCanonicalClass();var n=this.resBuf.length;if(0!==e)for(;n>0;--n){var r=this.resBuf[n-1],i=r.getCanonicalClass();if(i<=e)break}this.resBuf.splice(n,0,t)}while(0!==e);return this.resBuf.shift()};var T=function(e){this.it=e,this.procBuf=[],this.resBuf=[],this.lastClass=null};T.prototype.next=function(){for(;0===this.resBuf.length;){var e=this.it.next();if(!e){this.resBuf=this.procBuf,this.procBuf=[];break}if(0===this.procBuf.length)this.lastClass=e.getCanonicalClass(),this.procBuf.push(e);else{var t=this.procBuf[0],n=t.getComposite(e),r=e.getCanonicalClass();n&&(this.lastClass<r||0===this.lastClass)?this.procBuf[0]=n:(0===r&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=r,this.procBuf.push(e))}}return this.resBuf.shift()};var M=function(e,t){switch(e){case"NFD":return new P(new A(new I(t),(!0)));case"NFKD":return new P(new A(new I(t),(!1)));case"NFC":return new T(new P(new A(new I(t),(!0))));case"NFKC":return new T(new P(new A(new I(t),(!1))))}throw e+" is invalid"},R=function(e,t){for(var n,r=M(e,t),i="";n=r.next();)i+=n.toString();return i};_.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],
2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],
12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],
120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],
64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var O={nfc:c,nfd:a,nfkc:f,nfkd:u};"object"==typeof t?t.exports=O:"function"==typeof define&&define.amd?define("unorm",function(){return O}):e.unorm=O,O.shimApplied=!1,String.prototype.normalize||(String.prototype.normalize=function(e){var t=""+this;if(e=void 0===e?"NFC":e,"NFC"===e)return O.nfc(t);if("NFD"===e)return O.nfd(t);if("NFKC"===e)return O.nfkc(t);if("NFKD"===e)return O.nfkd(t);throw new RangeError("Invalid normalization form: "+e)},O.shimApplied=!0)}(this)},{}],394:[function(e,t,n){(function(e){function n(e,t){function n(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(r("noDeprecation"))return e;var i=!1;return n}function r(t){try{if(!e.localStorage)return!1}catch(n){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],395:[function(e,t,n){(function(e){"use strict";var n=function(){};"production"!==e.env.NODE_ENV&&(n=function(e,t,n){var r=arguments.length;n=new Array(r>2?r-2:0);for(var i=2;i<r;i++)n[i-2]=arguments[i];if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(t.length<10||/^[s\W]*$/.test(t))throw new Error("The warning format should be able to uniquely identify this warning. Please, use a more descriptive format than: "+t);if(!e){var o=0,s="Warning: "+t.replace(/%s/g,function(){return n[o++]});"undefined"!=typeof console&&console.error(s);try{throw new Error(s)}catch(a){}}}),t.exports=n}).call(this,e("_process"))},{_process:592}],396:[function(e,t,n){function r(e,t){function n(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var r=e.apply(this,t),i=t[t.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach(function(e){r[e]=i[e]}),r}if(e&&t)return r(e)(t);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(t){n[t]=e[t]}),n}t.exports=r},{}],397:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<e.length;n++)t(e[n])}function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e,t,n){var r=e;return l(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=p(t,{uri:e}),r.callback=n,r}function s(e,t,n){return t=o(e,t,n),a(t)}function a(e){function t(){4===f.readyState&&setTimeout(o,0)}function n(){var e=void 0;if(e=f.response?f.response:f.responseText||u(f),w)try{e=JSON.parse(e)}catch(t){}return e}function r(e){return clearTimeout(d),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,c(e,E)}function o(){if(!p){var t;clearTimeout(d),t=e.useXDR&&void 0===f.status?200:1223===f.status?204:f.status;var r=E,i=null;return 0!==t?(r={body:n(),statusCode:t,method:y,headers:{},url:g,rawRequest:f},f.getAllResponseHeaders&&(r.headers=h(f.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),c(i,r,r.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var a=!1,c=function(t,n,r){a||(a=!0,e.callback(t,n,r))},f=e.xhr||null;f||(f=e.cors||e.useXDR?new s.XDomainRequest:new s.XMLHttpRequest);var l,p,d,g=f.url=e.uri||e.url,y=f.method=e.method||"GET",m=e.body||e.data,v=f.headers=e.headers||{},b=!!e.sync,w=!1,E={body:void 0,headers:{},statusCode:0,method:y,url:g,rawRequest:f};if("json"in e&&e.json!==!1&&(w=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==y&&"HEAD"!==y&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),m=JSON.stringify(e.json===!0?m:e.json))),f.onreadystatechange=t,f.onload=o,f.onerror=r,f.onprogress=function(){},f.onabort=function(){p=!0},f.ontimeout=r,f.open(y,g,!b,e.username,e.password),b||(f.withCredentials=!!e.withCredentials),!b&&e.timeout>0&&(d=setTimeout(function(){if(!p){p=!0,f.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}},e.timeout)),f.setRequestHeader)for(l in v)v.hasOwnProperty(l)&&f.setRequestHeader(l,v[l]);else if(e.headers&&!i(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(f.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(f),f.send(m||null),f}function u(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function c(){}var f=e("global/window"),l=e("is-function"),h=e("parse-headers"),p=e("xtend");t.exports=s,s.XMLHttpRequest=f.XMLHttpRequest||c,s.XDomainRequest="withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:f.XDomainRequest,r(["get","put","post","patch","head","delete"],function(e){s["delete"===e?"del":e]=function(t,n,r){return n=o(t,n,r),n.method=e.toUpperCase(),a(n)}})},{"global/window":76,"is-function":104,"parse-headers":141,xtend:400}],398:[function(e,t,n){t.exports=XMLHttpRequest},{}],399:[function(e,t,n){function r(e,t){for(var n=e[0],r=e[1],i=0,o=d*p>>>0;i!==o;)n+=(r<<4>>>0^r>>>5)+r^i+t[3&i],n>>>=0,i=i+d>>>0,r+=(n<<4>>>0^n>>>5)+n^i+t[i>>11&3],r>>>=0;e[0]=n,e[1]=r}function i(e,t){for(var n=e[0],r=e[1],i=d*p>>>0;i;)r-=(n<<4>>>0^n>>>5)+n^i+t[i>>11&3],r>>>=0,i=i-d>>>0,n-=(r<<4>>>0^r>>>5)+r^i+t[3&i],n>>>=0;e[0]=n,e[1]=r}function o(e,t,n){e[0]^=n[0],e[1]^=n[1],r(e,t),n[0]=e[0],n[1]=e[1]}function s(e,t,n){var r=new Uint32Array(e);i(e,t),e[0]^=n[0],e[1]^=n[1],n[0]=r[0],n[1]=r[1]}function a(e,t,n){for(var r=new Uint32Array(4),i=new Uint32Array(2),o=new Buffer(8),s=0;s<4;++s)r[s]=n.readUInt32BE(4*s);return i[0]=t.readUInt32BE(0),i[1]=t.readUInt32BE(4),e(i,r),o.writeUInt32BE(i[0],0),o.writeUInt32BE(i[1],4),o}function u(e,t,n,r,i,o){r=r||"ecb",i||(i=new Buffer(8),i.fill(0));var s=g[r];if(!s)throw new Error("Unimplemented mode: "+r);var a;a=e?s.encrypt:s.decrypt;var u=t.length,c=8-(7&u);if(o||!e){if(8!==c)throw new Error("Data not aligned to 8 bytes block boundary");c=0}var f=new Buffer(u+c),l=new Uint32Array(4),h=new Uint32Array(2),p=new Uint32Array(2);p[0]=i.readUInt32BE(0),p[1]=i.readUInt32BE(4);for(var d=0;d<4;++d)l[d]=n.readUInt32BE(4*d);for(var y=0;y<=u;){if(u-y<8){if(o||!e)break;var m=new Buffer(c);m.fill(c),m=Buffer.concat([t.slice(y),m]),h[0]=m.readUInt32BE(0),h[1]=m.readUInt32BE(4)}else h[0]=t.readUInt32BE(y),h[1]=t.readUInt32BE(y+4);a(h,l,p),f.writeUInt32BE(h[0],y),f.writeUInt32BE(h[1],y+4),y+=8}if(o||e)return f;var c=f[f.length-1];return f.slice(0,f.length-c)}function c(e,t){return a(r,e,t)}function f(e,t){return a(i,e,t)}function l(e,t,n,r,i){return u(!0,e,t,n,r,i)}function h(e,t,n,r,i){return u(!1,e,t,n,r,i)}var Buffer=e("buffer").Buffer,p=32,d=2654435769,g={ecb:{encrypt:r,decrypt:i},cbc:{encrypt:o,decrypt:s}};n.encryptBlock=c,n.decryptBlock=f,n.encrypt=l,n.decrypt=h},{buffer:590}],400:[function(e,t,n){function r(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)i.call(n,r)&&(e[r]=n[r])}return e}t.exports=r;var i=Object.prototype.hasOwnProperty},{}],401:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("privfs-client"),i=e("simplito-lazybuffer"),o=e("eligrey-filesaver"),s=e("q"),a=e("jquery"),u=i.BrowserLazyBuffer,c=e("../../utils/Lang"),f=window,l=function(){function e(){}return e.openFile=function(e){var t=s.defer(),n=a('<input type="file" style="height:0;display:block;margin:0;" />'),r="nightwatch-file-upload-"+(new Date).getTime()+"-"+Math.random(),i=r+"-raw";return n.on("change",function(o){var s=o.target.files;s.length&&t.resolve(new u(s[0])),n.remove(),e&&(delete f[r],delete f[i])}),a("body").append(n),e?(n.addClass("nightwatch-file-upload"),n.attr("data",r),f[r]=function(e){t.resolve(new u(e)),n.remove(),delete f[r],delete f[i]},f[i]=function(e){t.resolve(e),n.remove(),delete f[r],delete f[i]}):n.trigger("click"),t.promise},e.openFiles=function(e){var t=s.defer(),n=a('<input type="file" multiple="multiple" style="height:0;display:block;margin:0;" />'),r="nightwatch-file-upload-"+(new Date).getTime()+"-"+Math.random(),i=r+"-raw";return n.on("change",function(o){var s=o.target.files;if(s.length){for(var a=[],c=0;c<s.length;c++)a.push(new u(s[c]));t.resolve(a)}n.remove(),e&&(delete f[r],delete f[i])}),a("body").append(n),e?(n.addClass("nightwatch-file-upload"),n.attr("data",r),f[r]=function(e){t.resolve(c.Lang.map(e,function(e){return new u(e)})),n.remove(),delete f[r],delete f[i]},f[i]=function(e){t.resolve(e),n.remove(),delete f[r],delete f[i]}):n.trigger("click"),t.promise},e.saveContent=function(e,t){t?f.lastSavedContent=e:o.saveAs(r.crypto.BrowserBuffer.createBlob(e.buffer,e.mimetype),e.name)},e}();n.FileUtils=l},{"../../utils/Lang":489,"eligrey-filesaver":55,jquery:111,"privfs-client":204,q:327,"simplito-lazybuffer":352}],402:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("q"),r=function(){function e(e){this.rootUrl=e}return e.prototype.readResourceFromUrl=function(e,n,r){var i=this,o=t.defer();try{var s=new XMLHttpRequest;s.open("GET",this.rootUrl+e,!0),s.responseType="arraybuffer",s.onreadystatechange=function(){s.readyState==XMLHttpRequest.DONE&&(0==s.status?o.reject("server-not-responding"):200!=s.status?o.reject("invalid-status-code "+s.status):o.resolve({name:n||i.nameFromUrl(e),mimetype:r||i.contentTypeToMime(s.getResponseHeader("Content-Type")),content:Buffer.from(s.response)}))},s.send()}catch(a){o.reject(a)}return o.promise},e.prototype.nameFromUrl=function(e){var t=e.split("/");return t[t.length-1]},e.prototype.contentTypeToMime=function(e){for(var t=e.split(";"),n=0;n<t.length;n++){var r=t[n].trim();if(/^[a-z]+\/[a-z]+$/.test(r))return r}return""},e}();n.UrlResourceLoader=r;var i=function(){function e(e){this.urlResourceLoader=e}return e.prototype.getResource=function(e){return"welcomeMailPic"==e?this.urlResourceLoader.readResourceFromUrl("themes/default/images/welcome-mail-pic.png","privmx-logo.png","image/png"):t.reject("not-found")},e.prototype.getResourceSafe=function(e,t){return this.getResource(e).fail(function(e){return t})},e}();n.MailResourceLoader=i}).call(this,e("buffer").Buffer)},{buffer:590,q:327}],403:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../window/msgbox/MsgBoxWindowController"),o=e("../common/CommonApplication"),s=e("../../utils/WebStorage"),a=e("../../web-utils/AudioPlayer"),u=e("../../web-utils/ScreenCover"),c=e("../../web-utils/Fullscreen"),f=e("../../web-utils/UrlOpener"),l=e("../../web-utils/Window"),h=e("../../component/base/ComponentInitializer"),p=e("../../component/status-bar-main/StatusBarMainController"),d=e("../../component/status-bar-main/StatusBarMainView"),g=e("./window/WindowManager"),y=e("history"),m=e("is_js"),v=e("jquery"),b=e("simplito-utils"),w=e("../../web-utils/WebMonitor"),E=e("simplito-net"),_=E.HttpRequest,S=e("../common/window/template/offline-error.html"),k=e("./ResourceLoader"),C=e("./FileUtils"),x=function(e){function t(t){var n=e.call(this,new s.WebStorage,t.localeService,new k.MailResourceLoader(new k.UrlResourceLoader(t.rootUrl)))||this;n.maxFileSizeLimit=26214400,n.initializer=t,n.screenCover=new u.ScreenCover({timeout:18e4,timeoutCheck:18e4,$toCover:v("#main"),$cover:v("#screen-cover")}),n.initAudio(),n.initHistory(),n.setNewCount(0),n.windowManager=new g.WindowManager(n.initializer.rootUrl,c.Fullscreen,n.getWindowsTitleBarButtonsPosition()),n.hideOfflineIndicator();var r=n;n.webMonitor=new w.WebMonitor,n.webMonitor.addEventListener("network-status-change",function(e){switch(e.data){case"offline":r.mailClientApi.networkActivityIsPaused()||r.mailClientApi.pauseNetworkActivity(),v("body").addClass("offline"),r.showOfflineIndicator();break;case"online":r.mailClientApi.networkActivityIsPaused()&&r.mailClientApi.restoreNetworkActivity(),v("body").removeClass("offline"),r.hideOfflineIndicator()}});var i=!1,o=function(){i=!1,_.start({url:r.getCurrentUrlWithParam("t",(new Date).getTime().toString()),success:function(){r.webMonitor.updateNetworkStatus("online")},error:function(){setTimeout(function(){i=!0},1e4)}})};return n.webMonitor.addEventListener("wakeup",function(e){r.webMonitor.updateNetworkStatus("offline"),o()}),n.webMonitor.addEventListener("loop",function(){i&&"offline"===r.webMonitor.getNetworkStatus()?o():i=!1}),n.webMonitor.start(),n}return r(t,e),t.prototype.getCurrentUrlWithParam=function(e,t){var n=document.location.origin;return n+=""==document.location.pathname?"/":document.location.pathname,n+=document.location.search,n+=""==document.location.search?"?":"&",
n+=e+"="+encodeURIComponent(t)},t.prototype.isElectronApp=function(){return!1},t.prototype.isWebApp=function(){return!0},t.prototype.isAutoUpdateSupport=function(){return!1},t.prototype.isTestMode=function(){return this.initializer.testMode},t.prototype.isDemo=function(){return this.initializer.isDemo()},t.prototype.supportsSecureForms=function(){return this.initializer.supportsSecureForms()},t.prototype.getSecureFormsSettings=function(){return this.initializer.getSecureFormsSettings()},t.prototype.getAutoUpdateStatusModel=function(){throw new Error("AutoUpdate is not supported on this platform")},t.prototype.initAudio=function(){this.audioPlayer=new a.AudioPlayer,this.audioPlayer.add("new-messages",this.getAssetUrl("sounds/new-messages.wav")),this.audioPlayer.add("message-sent",this.getAssetUrl("sounds/message-sent.wav")),this.audioPlayer.add("message-deleted",this.getAssetUrl("sounds/message-deleted.wav"))},t.prototype.getAssetUrl=function(e){return this.initializer.assetsPrefix+e},t.prototype.openWindow=function(e,t,n,r){return this.windowManager.open(e,t,n)},t.prototype.afterLogin=function(){this.statusBarController=new p.StatusBarMainController(this.windows.container.mainTaskStream,this.localeService),this.statusBarView=h.ComponentInitializer.createViewAndSetContainer(d.StatusBarMainView,this.statusBarController,v("#opened-windows-bar .current-tasks-info")).view,this.screenCover.start()},t.prototype.logout=function(){l.window.location.href=l.window.location.pathname+l.window.location.search},t.prototype.forceRestart=function(){l.window.onbeforeunload&&(l.window.onbeforeunload=null),l.window.location.href=l.window.location.pathname+l.window.location.search},t.prototype.getUIEventsListener=function(){return this.screenCover.onEventBinded},t.prototype.getFullscreenModel=function(){return c.Fullscreen.getFullscreenModel()},t.prototype.getBrowser=function(){return this.initializer.browser},t.prototype.getVersion=function(){return this.initializer.version},t.prototype.isContextMenuBlocked=function(){return!this.isInDevMode()},t.prototype.isInDevMode=function(){return!!this.initializer.query.devmode},t.prototype.getToken=function(){return this.tokenUsed?null:this.token},t.prototype.getAdminRegistration=function(){return this.adminRegistration},t.prototype.getPredefinedUsername=function(){return this.predefinedUsername},t.prototype.getOriginalUrl=function(){return this.originalUrl},t.prototype.markTokenAsUsed=function(){this.tokenUsed=!0},t.prototype.changeLang=function(e){this.localeService.setLang(e);var t=(new Date).getTime(),n="?t="+t,r=this.getToken();r&&(n+="#token="+r,this.predefinedUsername&&(n+="&u="+encodeURIComponent(this.predefinedUsername)),this.adminRegistration&&(n+="&a=1"));var i=this.getAbsoluteUrl(n);l.window.location.href=i},t.prototype.getAbsoluteUrl=function(e){var t=document.createElement("a");return t.href=e,t.href},t.prototype.getDefaultHost=function(){return l.window.location.hostname},t.prototype.openExternalUrl=function(e){f.UrlOpener.open(e)},t.prototype.isSupportedHashmail=function(e){if(null==this.supportedHosts)return!0;for(var t=0;t<this.supportedHosts.length;t++)if(b.endsWith(e,"#"+this.supportedHosts[t]))return!0;return!1},t.prototype.getSupportedHosts=function(){return this.supportedHosts||[]},t.prototype.getTokenRegistrationUrl=function(e){return l.window.location.origin+l.window.location.pathname+"#token="+e},t.prototype.setNewCount=function(e){this.newCount=e,l.window.document.title=(this.newCount>0?"("+this.newCount+") ":"")+"PrivMX WebMail"},t.prototype.playAudio=function(e){this.audioPlayer.play(e)},t.prototype.getWindowsTitleBarButtonsPosition=function(){var e=this.initializer.settings.getItem("windowsTitleBarButtonsPosition");return"left"==e||"right"==e?e:"right"},t.prototype.setWindowsTitleBarButtonsPosition=function(e){"left"!=e&&"right"!=e||(this.initializer.settings.setItem("windowsTitleBarButtonsPosition",e),this.windowManager.setWindowsTitleBarButtonsPosition(e))},t.prototype.setAudioEnabled=function(e){e?this.audioPlayer.enable():this.audioPlayer.disable()},t.prototype.setUiLang=function(e){this.localeService.isValidLang(e)&&this.initializer.saveLang(e)},t.prototype.openFile=function(){return C.FileUtils.openFile(this.isTestMode())},t.prototype.openFiles=function(){return C.FileUtils.openFiles(this.isTestMode())},t.prototype.saveContent=function(e){if(m.safari()){var t=new i.MsgBoxWindowController(this,{message:this.localeService.i18n("app.saveBlob.text"),focusOn:"ok",ok:{visible:!0,btnClass:"btn-success",label:this.localeService.i18n("app.saveBlob.button.download.label"),action:{type:"hideAndClose",timeout:1e4},link:{attrs:{href:e.getDataUrl(),download:name,target:"_blank"}}},cancel:{visible:!0,label:this.localeService.i18n("app.saveBlob.button.cancel.label")}});return void t.open()}return C.FileUtils.saveContent(e,this.isTestMode())},t.prototype.parseHash=function(){this.originalUrl=l.window.location.toString();var e=l.window.location.hash;return e=0==e.indexOf("#")?e.substring(1):e,this.initializer.parseQueryString(e)},t.prototype.initHistory=function(){var e=this,t=this.parseHash();this.token=t.token,this.adminRegistration=this.token&&t.a,this.predefinedUsername=this.token&&t.u,l.window.addEventListener("hashchange",function(t){var n=e.parseHash();if(n.token)return t.stopImmediatePropagation(),document.location.reload(),!1}),this.history=y.createHashHistory(),this.history.replace({pathname:"/"}),this.history.listen(this.onHistoryChange.bind(this))},t.prototype.setContainerWindowHistoryEntry=function(e,t){t?this.history.replace(e):this.history.push(e)},t.prototype.onHistoryChange=function(e){this.windows.container&&this.windows.container.onHistoryChange(e)},t.prototype.getScreenResolution=function(){return l.window.screen.availWidth+"x"+l.window.screen.availHeight},t.prototype.getNetworkStatus=function(){return this.webMonitor.getNetworkStatus()},t.prototype.networkIsDown=function(){return"offline"===this.getNetworkStatus()},t.prototype.goBack=function(){this.history.goBack()},t.prototype.showOfflineIndicator=function(){this.$offlineIndicator&&this.$offlineIndicatorParent.prepend(this.$offlineIndicator)},t.prototype.hideOfflineIndicator=function(){this.$offlineIndicator||(this.$offlineIndicator=v("#offline-indicator"),this.$offlineIndicatorParent=this.$offlineIndicator.parent()),this.$offlineIndicator.detach(),this.$offlineIndicator.removeClass("hidden")},t.prototype.getRegisterDomain=function(){return location.hostname},t.prototype.hasNetworkConnection=function(){return!this.networkIsDown()||(this.showOfflineError(),!1)},t.prototype.openHtmlWindow=function(e,t){var n=this.windowManager.open(e,t,null,!0);n.on("close",function(){n.close(!0)});var r=n.iframe.contentWindow.document;return r.getElementById("close-button").addEventListener("click",function(e){n.close(!0)}),n},t.prototype.showOfflineError=function(){var e=S.func({message1:this.localeService.i18n("core.error.offline.message1"),message2:this.localeService.i18n("core.error.offline.message2"),assetUrl:this.getAssetUrl("")}),t=this.openHtmlWindow(e,{title:"PrivMX",width:400,height:200,position:"center",draggable:!0,resizable:!1,modal:!0});t.hideLoadingScreen()},t}(o.CommonApplication);n.WebApplication=x},{"../../component/base/ComponentInitializer":422,"../../component/status-bar-main/StatusBarMainController":429,"../../component/status-bar-main/StatusBarMainView":430,"../../utils/WebStorage":497,"../../web-utils/AudioPlayer":505,"../../web-utils/Fullscreen":506,"../../web-utils/ScreenCover":507,"../../web-utils/UrlOpener":508,"../../web-utils/WebMonitor":509,"../../web-utils/Window":510,"../../window/msgbox/MsgBoxWindowController":543,"../common/CommonApplication":412,"../common/window/template/offline-error.html":419,"./FileUtils":401,"./ResourceLoader":402,"./window/WindowManager":410,history:97,is_js:105,jquery:111,"simplito-net":360,"simplito-utils":373}],404:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./IpcRenderer"),i=function(){function e(){this.ipcRenderer=new r.IpcRenderer}return e}();n.Electron=i},{"./IpcRenderer":405}],405:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-logger"),i=r.get("privfs-mail-client.app.browser.electron.IpcRenderer"),o=function(){function e(){this.eventsForView=[],this.eventsForMain=[],this.callbackMapForView={},this.callbackMapForMain={}}return e.prototype.on=function(e,t){this.callbackMapForView[e]=t,this.propagateEventsForView()},e.prototype.onInMainThread=function(e,t){this.callbackMapForMain[e]=t,this.propagateEventsForMain()},e.prototype.send=function(e,t){this.eventsForMain.push({name:e,data:t}),this.propagateEventsForMain()},e.prototype.sendFromMainThread=function(e,t){this.eventsForView.push({name:e,data:t}),this.propagateEventsForView()},e.prototype.propagateEventsForView=function(){this.eventsForView=e.propagateEvents(this.eventsForView,this.callbackMapForView)},e.prototype.propagateEventsForMain=function(){this.eventsForMain=e.propagateEvents(this.eventsForMain,this.callbackMapForMain)},e.propagateEvents=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(o.name in t)try{t[o.name](null,o.data)}catch(s){i.error(s)}else n.push(o)}return n},e}();n.IpcRenderer=o},{"simplito-logger":357}],406:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../../utils/ObjectMap"),i=function(){function e(){}return e.prototype.require=function(e){if("../../utils/ObjectMap"==e)return r.ObjectMap;throw new Error("Cannot find remote module '"+e+"'")},e}();n.Remote=i},{"../../../utils/ObjectMap":492}],407:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Electron"),i=e("./Remote"),o=function(){function e(){this.electron=new r.Electron,this.remote=new i.Remote,this.requireBinded=this.require.bind(this)}return e.prototype.require=function(e){if("electron"==e)return this.electron;if("remote"==e)return this.remote;throw new Error("Cannot find electron module '"+e+"'")},e}();n.Require=o},{"./Electron":404,"./Remote":406}],408:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../common/window/Window"),o=e("../electron/Require"),s=e("jquery"),a=function(e){function t(t,n,r,i,s){var a=e.call(this)||this;return a.manager=t,a.iframe=n,a.container=r,a.iframeContainer=i,a.controllerId=s,a.require=new o.Require,a.require.electron.ipcRenderer.onInMainThread("docked",a.onDockedEvent.bind(a)),a}return r(t,e),t.prototype.start=function(){this.iframe.contentWindow.electronRequire=this.require.requireBinded,this.iframe.contentWindow.initView(),this.require.electron.ipcRenderer.sendFromMainThread("controller-start",this.controllerId)},t.prototype.sendFromDocked=function(e,t,n){this.require.electron.ipcRenderer.sendFromMainThread("docked",{route:e,name:t,data:n})},t.prototype.close=function(e){if(e===!0){this.destroy(),this.options.modal&&s("#windows-overlay").addClass("hidden");var t=this.manager.instances.indexOf(this);t!=-1&&(this.manager.instances.splice(t,1),this.manager.focusOnTheMostTopWindow(),this.manager.updateOpenedWindowsCounter())}else this.events.trigger("close")},t.prototype.showLoadingScreen=function(){this.$loadingScreen||(this.$loadingScreen=s("#templates").find(".window-loading-screen").clone()),this.$loadingScreen.prependTo(this.iframeContainer)},t.prototype.hideLoadingScreen=function(){this.$loadingScreen&&this.$loadingScreen.detach()},t.prototype.loaded=function(){var e=this;this.focus(),this.events.trigger("loaded"),this.iframe.contentWindow.webRequire("Starter").Starter.onViewInitialized(function(){e.events.trigger("initialized")})},t.prototype.resized=function(e){this.events.trigger("resize",e)},t.prototype.enterDistractionFreeMode=function(){this.distractionFreeMode=!0,s("#windows-container").addClass("distraction-free-mode"),s(this.dfmIframe).addClass("distraction-free-mode"),this.manager.fullscreen.isInFullscreenMode()||this.manager.fullscreen.toggleFullscreenMode(),this.iframe===this.dfmIframe&&this.maximize(),this.dfmIframe.contentWindow.webRequire("Starter").Starter.triggerJQEvent("distraction-free-mode-on")},t.prototype.exitDistractionFreeMode=function(){s("#windows-container").removeClass("distraction-free-mode"),s(this.dfmIframe).removeClass("distraction-free-mode"),this.distractionFreeMode=!1,this.manager.fullscreen.isInFullscreenMode()&&this.manager.fullscreen.toggleFullscreenMode(),this.iframe===this.dfmIframe&&this.restoreMaximized(),this.dfmIframe.contentWindow.webRequire("Starter").Starter.triggerJQEvent("distraction-free-mode-off")},t.prototype.toggleDistractionFreeModeCore=function(){this.distractionFreeMode?this.exitDistractionFreeMode():this.enterDistractionFreeMode()},t.prototype.toggleDistractionFreeMode=function(){this.dfmIframe=this.iframe,this.toggleDistractionFreeModeCore()},t.prototype.toggleDistractionFreeModeFromDocked=function(e){this.dfmIframe=this.iframe.contentWindow.webRequire("Starter").Starter.findDockedFrame(e),this.toggleDistractionFreeModeCore()},t.prototype.maximize=function(){this.stateBeforeMaximize={width:this.domElement.style.width,height:this.domElement.style.height,x:this.domElement.style.left,y:this.domElement.style.top},this.domElement.style.top="0",this.domElement.style.left="0",this.domElement.style.bottom="0",this.domElement.style.right="0",this.domElement.style.width="auto",this.domElement.style.height="auto",this.domElement.classList.add("maximized"),this.domElement.classList.remove("minimized"),this.maximized=!0,this.minimized=!1,this.resized("maximize")},t.prototype.restoreMaximized=function(){var e={width:"60%",height:"40%",x:"center",y:"center"};this.stateBeforeMaximize&&(e.width=this.stateBeforeMaximize.width,e.height=this.stateBeforeMaximize.height,e.x=this.stateBeforeMaximize.x,e.y=this.stateBeforeMaximize.y),this.domElement.style.bottom="auto",this.domElement.style.right="auto",this.setWidth(e.width),this.setHeight(e.height),this.setPosition(e.x,e.y),this.stateBeforeMaximize=null,this.domElement.classList.remove("maximized"),this.maximized=!1,this.resized("restore-maximized")},t.prototype.maximizeToggle=function(){this.stateBeforeMaximize?this.restoreMaximized():this.maximize()},t.prototype.minimize=function(){this.options.modal&&s("#windows-overlay").addClass("hidden"),this.stateBeforeMinimize={width:this.domElement.style.width,height:this.domElement.style.height,x:this.domElement.style.left,y:this.domElement.style.top},this.domElement.style.visibility="hidden",this.setWidth(0),this.setHeight(0),this.setPosition(0,0),this.domElement.classList.add("minimized"),this.domElement.classList.remove("maximized"),this.minimized=!0,this.maximized=!1,this.blur(),this.resized("minimize"),this.manager.focusOnTheMostTopWindow()},t.prototype.restoreMinimized=function(){var e={width:"60%",height:"40%",x:"center",y:"center"};this.options.modal&&s("#windows-overlay").removeClass("hidden"),this.stateBeforeMinimize&&(e.width=this.stateBeforeMinimize.width,e.height=this.stateBeforeMinimize.height,e.x=this.stateBeforeMinimize.x,e.y=this.stateBeforeMinimize.y),this.domElement.style.visibility="visible",this.setWidth(e.width),this.setHeight(e.height),this.setPosition(e.x,e.y),this.stateBeforeMinimize=null,this.domElement.classList.remove("minimized"),this.minimized=!1,this.resized("restore-minimized"),this.focus()},t.prototype.minimizeToggle=function(){this.stateBeforeMinimize?this.restoreMinimized():this.minimize()},t.prototype.setWidth=function(e){this.domElement.style.width=this.getMeasureForCss(e);var t=s(this.container).innerWidth();s(this.domElement).outerWidth()>t&&(this.domElement.style.width=this.getMeasureForCss(t-10))},t.prototype.setHeight=function(e){"number"==typeof e&&this.header&&(e+=35),this.domElement.style.height=this.getMeasureForCss(e);var t=s(this.container).innerHeight();s(this.domElement).outerHeight()>t&&(this.domElement.style.height=this.getMeasureForCss(t-10))},t.prototype.getWidth=function(){return this.domElement.offsetWidth},t.prototype.getHeight=function(){return this.domElement.offsetHeight},t.prototype.setPosition=function(e,t){"center"==e&&(e=Math.max(0,(s(this.container).innerWidth()-this.getWidth())/2)),"center"==t&&(t=Math.max(0,(s(this.container).innerHeight()-this.getHeight())/2)),this.domElement.style.left=this.getMeasureForCss(e),this.domElement.style.top=this.getMeasureForCss(t)},t.prototype.setTitle=function(e){this.header&&this.header.setTitle(e),this.widget&&this.widget.setTitle(e)},t.prototype.destroy=function(){this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),this.widget&&this.widget.destroy()},t.prototype.focus=function(){var e=+this.domElement.style.zIndex,t=this.manager.zIndexCounter,n=!1;e<t&&(this.domElement.style.zIndex=(++this.manager.zIndexCounter).toString(),n=!0),this.minimized&&(this.restoreMinimized(),n=!0),n&&(s(".window-wrapper.focused").removeClass("focused"),this.domElement.classList.add("focused"),this.widget?this.widget.setActive():this.manager.instances.forEach(function(e){e.widget&&e.widget.setInactive()}),this.options.modal?s("#windows-overlay").removeClass("hidden").css("z-index",parseInt(this.domElement.style.zIndex)-1):s("#windows-overlay").addClass("hidden")),this.events.trigger("focus")},t.prototype.blur=function(){this.domElement.style.zIndex=(parseInt(this.domElement.style.zIndex)-2).toString(),this.domElement.classList.remove("focused"),this.widget&&this.widget.setInactive()},t.prototype.isFocused=function(){return parseInt(this.domElement.style.zIndex)==this.manager.zIndexCounter},t.prototype.getMeasureForCss=function(e){var t="string"==typeof e&&e.indexOf("%")!=-1?"%":"px",n=+e;return isNaN(n)?e:n+t},t.prototype.setDirty=function(e){e?this.domElement.classList.add("dirty"):this.domElement.classList.remove("dirty"),this.widget&&this.widget.setDirty(e)},t.prototype.setIcon=function(e){this.header&&this.header.setIcon(e),this.widget&&this.widget.setIcon(e)},t}(i.Window);n.WebWindow=a,Object.defineProperty(a.prototype,"window",{get:function(){return this.iframe.contentWindow},enumerable:!0})},{"../../common/window/Window":418,"../electron/Require":407,jquery:111}],409:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("jquery"),i=function(){function e(){var e=document.createElement("div"),t=document.createElement("a"),n=document.createElement("a"),r=document.createElement("a"),i=document.createElement("div"),o=document.createElement("span"),s=document.createElement("i"),a=document.createElement("div");e.classList.add("window-header"),a.classList.add("window-header-buttons"),t.classList.add("window-header-button","window-header-button-maximize","ico-maximize"),n.classList.add("window-header-button","window-header-button-minimize","ico-minimize"),r.classList.add("window-header-button","window-header-button-close","ico-x"),i.classList.add("window-header-title"),s.classList.add("fa","fa-circle","window-dirty-marker"),e.appendChild(i),e.appendChild(a),a.appendChild(r),a.appendChild(t),a.appendChild(n),i.appendChild(s),i.appendChild(o),this.domElement=e,this.buttons={maximize:t,minimize:n,close:r},this.titleSpan=o}return e.prototype.setTitle=function(e){r(this.titleSpan).text(e)},e.prototype.hideMaximizeButton=function(){this.buttons.maximize.style.display="none"},e.prototype.hideMinimizeButton=function(){this.buttons.minimize.style.display="none"},e.prototype.setIcon=function(e){if(e){if(!this.icon){this.icon=document.createElement("i");var t=this.titleSpan.parentNode;t.insertBefore(this.icon,this.titleSpan)}this.icon.className=e}else this.icon&&this.icon.remove()},e}();n.WindowHeader=i},{jquery:111}],410:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./WebWindow"),i=e("./WindowHeader"),o=e("./WindowWidget"),s=e("jquery");e("jquery-ui/resizable"),e("jquery-ui/draggable");var a=function(){function e(e,t,n){this.zIndexCounter=1e3,this.instances=[],this.fullscreen=t,this.rootUrl=e,s(window).on("resize",this.onGlobalResize.bind(this)),this.fullscreen.getFullscreenModel().changeEvent.add(this.onFullscreenChange.bind(this)),this.setWindowsTitleBarButtonsPosition(n)}return e.prototype.open=function(e,t,n,a){var u={decoration:!0,widget:!0,resizable:!0,draggable:!0};t=s.extend(!0,{},u,t||{}),void 0===t.minimizable&&(t.minimizable=t.resizable),void 0===t.maximizable&&(t.maximizable=t.resizable);var c=document.createElement("div"),f=document.createElement("div"),l=document.createElement("iframe"),h=document.getElementById("windows-container"),p=new r.WebWindow(this,l,h,f,n);if(t.showLoadingScreen&&p.showLoadingScreen(),p.options=t,c.style.zIndex="-1",c.classList.add("window-wrapper"),c.appendChild(f),c.addEventListener("mousedown",function(){p.focus()}),f.classList.add("iframe-container"),f.appendChild(l),p.domElement=c,(t.decoration||t.widget)&&h.appendChild(c),t.cssClass&&c.classList.add.apply(c.classList,t.cssClass.split(" ")),t.fullscreen)c.classList.add("fullscreen");else{if(t.decoration){if(p.header=new i.WindowHeader,p.header.buttons.close.addEventListener("click",function(e){e.stopPropagation(),p.close()}),t.minimizable?p.header.buttons.minimize.addEventListener("click",function(e){e.stopPropagation(),p.minimizeToggle()}):p.header.hideMinimizeButton(),t.maximizable?(p.header.buttons.maximize.addEventListener("click",function(e){e.stopPropagation(),p.maximizeToggle()}),p.header.domElement.addEventListener("dblclick",function(e){e.stopPropagation(),p.maximizeToggle()})):p.header.hideMaximizeButton(),c.appendChild(p.header.domElement),t.draggable&&s(c).draggable({containment:"parent",iframeFix:!0,handle:p.header.domElement,opacity:.9,cursor:"move"}),t.resizable){var d={start:function(){s('<div class="ui-resizable-iframeFix" style="background: #fff;"></div>').css({width:"100%",height:"100%",position:"absolute",opacity:"0.001",zIndex:1e5,top:0,left:0}).appendTo("body")},stop:function(){s(".ui-resizable-iframeFix").remove()},minWidth:void 0,minHeight:void 0,maxWidth:void 0,maxHeight:void 0};t.minWidth&&(d.minWidth=t.minWidth),t.minHeight&&(d.minHeight=t.minHeight),t.maxWidth&&(d.maxWidth=t.maxWidth),t.maxHeight&&(d.maxHeight=t.maxHeight),s(c).resizable(d)}t.widget&&(p.widget=new o.WindowWidget,s("#opened-windows-bar > .inner > .fake").before(p.widget.domElement),p.widget.closer.addEventListener("click",function(e){e.stopPropagation(),p.close()}),p.widget.domElement.addEventListener("click",function(){p.minimized?(p.restoreMinimized(),p.focus()):p.isFocused()?p.minimize():p.focus()})),t.icon&&p.setIcon(t.icon)}else c.classList.add("no-decoration");null!=t.width&&p.setWidth(t.width),null!=t.height&&p.setHeight(t.height),null!=t.title&&p.setTitle(t.title),null!=t.position&&"center"!=t.position&&"center-always"!=t.position||p.setPosition("center","center"),t.maximized&&p.maximize(),t.modal&&c.classList.add("modal")}if(this.instances.push(p),l.onload=function(){return p.loaded()},a){var g=l.contentWindow.document;g.open("text/html","replace"),g.write(e),g.close()}else l.src=this.rootUrl+e;return this.updateOpenedWindowsCounter(),p},e.prototype.onGlobalResize=function(){this.instances.forEach(function(e){if(!e.domElement.classList.contains("fullscreen")&&!e.maximized){var t=s(e.domElement);("center-always"==e.options.position||t.outerWidth()+t.offset().left>s("body").width())&&e.setPosition("center","center")}})},e.prototype.focusOnTheMostTopWindow=function(){var e=null;this.instances.forEach(function(t){t.minimized||(!e||t.domElement.style.zIndex>=e.domElement.style.zIndex)&&(e=t)}),e&&e.focus()},e.prototype.updateOpenedWindowsCounter=function(){var e=0;this.instances.forEach(function(t){t.widget&&e++}),s("#opened-windows-bar .windows-counter .count").text(e)},e.prototype.setWindowsTitleBarButtonsPosition=function(e){var t=document.getElementById("windows-container");"left"==e?t.classList.add("header-buttons-to-left"):t.classList.remove("header-buttons-to-left")},e.prototype.onFullscreenChange=function(e,t){t||this.instances.forEach(function(e){e.distractionFreeMode&&e.exitDistractionFreeMode()})},e.prototype.hideWindowsBar=function(){s("#main").addClass("without-windows-bar")},e.prototype.showWindowsBar=function(){s("#main").removeClass("without-windows-bar")},e}();n.WindowManager=a},{"./WebWindow":408,"./WindowHeader":409,"./WindowWidget":411,jquery:111,"jquery-ui/draggable":107,"jquery-ui/resizable":109}],411:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("jquery"),i=function(){function e(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("span"),i=document.createElement("i"),o=document.createElement("div");o.classList.add("ico-x"),e.appendChild(t),t.appendChild(n),t.appendChild(o),i.classList.add("fa","fa-circle","dirty-marker"),e.classList.add("cell"),n.classList.add("title"),o.classList.add("closer"),n.appendChild(i),n.appendChild(r),this.domElement=e,this.titleSpan=r,this.closer=o}return e.prototype.setTitle=function(e){r(this.titleSpan).text(e)},e.prototype.destroy=function(){this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement)},e.prototype.setActive=function(){r("#opened-windows-bar").find(".cell.active").removeClass("active"),this.domElement.classList.add("active")},e.prototype.setInactive=function(){this.domElement.classList.remove("active")},e.prototype.setDirty=function(e){e?this.domElement.classList.add("dirty"):this.domElement.classList.remove("dirty")},e.prototype.setIcon=function(e){if(e){if(!this.icon){this.icon=document.createElement("i");var t=this.titleSpan.parentNode;t.insertBefore(this.icon,this.titleSpan)}this.icon.className=e}else this.icon&&this.icon.remove()},e}();n.WindowWidget=i},{jquery:111}],412:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("../../window/container/ContainerWindowController"),r=e("../../window/settings/SettingsWindowController"),i=e("../../window/compose/ComposeWindowController"),o=e("../../window/login/LoginWindowController"),s=e("../../window/image/ImageWindowController"),a=e("../../window/admin/AdminWindowController"),u=e("../../window/about/AboutWindowController"),c=e("../../utils/EncryptedPromiseMap"),f=e("../../mail/MailClientApi"),l=e("simplito-utils"),h=e("q"),p=e("./MsgBox"),d=e("./Notifier"),g=e("../../utils/PluginsRegistry"),y=e("./ConnectionStatusChecker"),m=e("./installed-plugins"),v=e("simplito-logger"),b=v.get("app.common.CommonApplication");m.plugins.forEach(function(e){b.debug("Plugin loaded",e.name)});var w=function(){function e(t,n,r){this.app=this,this.storage=t,this.localeService=n,this.mailResourceLoader=r,this.msgBox=p.MsgBox.create(this,this.localeService),this.viewLogLevel="ERROR",this.defaultSettings=new c.EncryptedPromiseMap(e.ENC_KEY,this.storage),this.mailClientApi=new f.MailClientApi(new c.EncryptedPromiseMap(null,this.storage),this.localeService,this.mailResourceLoader),this.windows={}}return e.prototype.isElectronApp=function(){throw new Error("Abstract method CommonApplication.isElectronApp")},e.prototype.isWebApp=function(){throw new Error("Abstract method CommonApplication.isWebApp")},e.prototype.isTestMode=function(){return!1},e.prototype.isDemo=function(){return!1},e.prototype.supportsSecureForms=function(){return!1},e.prototype.isAutoUpdateSupport=function(){throw new Error("Abstract method CommonApplication.isAutoUpdateSupport")},e.prototype.getAutoUpdateStatusModel=function(){throw new Error("Abstract method CommonApplication.getAutoUpdateStatusModel")},e.prototype.openWindow=function(e,t,n,r){throw new Error("Abstract method CommonApplication.openWindow")},e.prototype.getUIEventsListener=function(){return null},e.prototype.getFullscreenModel=function(){return null},e.prototype.getBrowser=function(){return null},e.prototype.getVersion=function(){throw new Error("Abstract method CommonApplication.getVersion")},e.prototype.isInviteFriendEnabled=function(){return!1},e.prototype.isContextMenuBlocked=function(){return!0},e.prototype.start=function(){this.windows.login=new o.LoginWindowController(this),this.windows.login.open()},e.prototype.onLogin=function(){this.connectionStatusChecker=new y.ConnectionStatusChecker(this,this.mailClientApi.gateway.onConnectionLostEvent),this.mailClientApi.userPreferences.changeEvent.add(this.onUserPreferencesChange.bind(this),"multi"),this.onUserPreferencesChange(),this.notifier=new d.Notifier(this),this.windows.container=new t.ContainerWindowController(this),this.windows.container.open(),this.windows.login.close(),delete this.windows.login,this.afterLogin(),g.PluginsRegistry.events.trigger("after-login",this)},e.prototype.afterLogin=function(){},e.prototype.afterStart=function(){},e.prototype.logout=function(){throw new Error("Abstract method CommonApplication.logout")},e.prototype.getSettings=function(){return this.mailClientApi.settings},e.prototype.getDefaultSettings=function(){return this.defaultSettings},e.prototype.getToken=function(){return null},e.prototype.getAdminRegistration=function(){return null},e.prototype.getPredefinedUsername=function(){return null},e.prototype.getOriginalUrl=function(){return null},e.prototype.markTokenAsUsed=function(e){},e.prototype.changeLang=function(e){},e.prototype.getDefaultHost=function(){return null},e.prototype.onDockedLoad=function(e){throw new Error("Application cannot be parent of docked window")},e.prototype.getClosestNotDockedController=function(){throw new Error("Application cannot be parent of docked window")},e.prototype.onChildWindowClose=function(e){for(var t in this.windows)this.windows[t]==e&&delete this.windows[t]},e.prototype.openSingletonWindow=function(e,t,n){if(this.windows[e])this.windows[e].nwin.focus(),this.windows[e].reopenWithParams(n);else{if(!this.hasNetworkConnection())return;this.windows[e]=new t(this,n),this.windows[e].open()}},e.prototype.openSettings=function(e){this.openSingletonWindow("settings",r.SettingsWindowController,e)},e.prototype.openAdmin=function(e){this.openSingletonWindow("admin",a.AdminWindowController,e)},e.prototype.openAbout=function(){this.openSingletonWindow("about",u.AboutWindowController)},e.prototype.openPresenceSettings=function(){},e.prototype.sendMail=function(e){if(this.hasNetworkConnection()){var t=new i.ComposeWindowController(this,e);t.open(),t.nwin.focus()}},e.prototype.sendBlankMail=function(){this.sendMail({type:"blank"})},e.prototype.sendMailTo=function(e){this.sendMail({type:"predefined",receivers:[e]})},e.prototype.openUrl=function(e){if(l.startsWith(e,"hashmailto:")){var t=e.substring(11);this.sendMailTo(t)}else if(l.startsWith(e,"mailto:")){var n=e.substring(7);this.sendMailTo(n)}else this.openExternalUrl(e)},e.prototype.openExternalUrl=function(e){throw new Error("Abstract method CommonApplication.openExternalUrl")},e.prototype.isSupportedHashmail=function(e){throw new Error("Abstract method CommonApplication.isSupportedHashmail")},e.prototype.getSupportedHosts=function(){throw new Error("Abstract method CommonApplication.getSupportedHosts")},e.prototype.getTokenRegistrationUrl=function(e){throw new Error("Abstract method CommonApplication.getTokenRegistrationUrl")},e.prototype.setContainerWindowHistoryEntry=function(e,t){"container"in this.windows&&this.windows.container.onHistoryChange(e)},e.prototype.playAudio=function(e){},e.prototype.onUserPreferencesChange=function(){this.setWindowsTitleBarButtonsPosition(this.mailClientApi.userPreferences.getValue("ui.windowTitleBarButtonsPosition")),this.setAudioEnabled(this.mailClientApi.userPreferences.getValue("ui.audio")),this.setUiLang(this.mailClientApi.userPreferences.getValue("ui.lang"))},e.prototype.setWindowsTitleBarButtonsPosition=function(e){},e.prototype.setAudioEnabled=function(e){},e.prototype.setUiLang=function(e){},e.prototype.setNewCount=function(e){},e.prototype.openFile=function(){throw new Error("Abstract method CommonApplication.openFile");
},e.prototype.openFiles=function(){throw new Error("Abstract method CommonApplication.openFiles")},e.prototype.downloadAttachment=function(e,t){if(this.hasNetworkConnection()){var n=this;return h(null).then(function(){if(!l.startsWith(t.mimeType,"image/"))return h(null).then(function(){return n.mailClientApi.getAttachmentContent(e,t)}).then(function(e){n.saveContent(e)});var r=new s.ImageWindowController(n,{message:e,entry:t});r.open()})}},e.prototype.hasNetworkConnection=function(){throw new Error("Abstract method CommonApplication.saveBlob")},e.prototype.exportMessages=function(e,t){var n=this;return h(null).then(function(){return n.mailClientApi.exportMessages(e,t)}).then(function(e){n.saveContent(e)})},e.prototype.saveContent=function(e){throw new Error("Abstract method CommonApplication.saveBlob")},e.prototype.getScreenResolution=function(){throw new Error("Abstract method CommonApplication.getScreenResolution")},e.prototype.hasMaxFileSizeLimit=function(){return null!=this.getMaxFileSizeLimit()},e.prototype.getMaxFileSizeLimit=function(){return this.maxFileSizeLimit},e.prototype.getNetworkStatus=function(){throw new Error("Abstract method CommonApplication.getNetworkStatus")},e.prototype.networkIsDown=function(){throw new Error("Abstract method CommonApplication.networkIsDown")},e.prototype.showOfflineError=function(){throw new Error("Abstract method CommonApplication.networkIsDown")},e.prototype.goBack=function(){},e.prototype.getRegisterDomain=function(){throw new Error("Abstract method CommonApplication.getRegisterDomain")},e.prototype.forceRestart=function(){},e.prototype.getViewLogLevel=function(){return this.viewLogLevel},e.ENC_KEY=new Buffer("d2014a39e7c4d0f524279560f82aa57ec1c894acbd242ef74aaaf3cce47cfde4","hex"),e}();n.CommonApplication=w}).call(this,e("buffer").Buffer)},{"../../mail/MailClientApi":440,"../../utils/EncryptedPromiseMap":484,"../../utils/PluginsRegistry":493,"../../window/about/AboutWindowController":515,"../../window/admin/AdminWindowController":516,"../../window/compose/ComposeWindowController":530,"../../window/container/ContainerWindowController":531,"../../window/image/ImageWindowController":535,"../../window/login/LoginWindowController":536,"../../window/settings/SettingsWindowController":545,"./ConnectionStatusChecker":413,"./MsgBox":414,"./Notifier":415,"./installed-plugins":416,buffer:590,q:327,"simplito-logger":357,"simplito-utils":373}],413:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-logger"),i=r.get("privfs-mail-client.app.common.ConnectionStatusChecker"),o=e("../../window/base/BaseWindowController"),s=e("privfs-client"),a=function(){function e(e,t){this.app=e,this.event=t,this.eventProcessing=!1,this.onConnectionLostBinded=this.onConnectionLost.bind(this),this.event.add(this.onConnectionLostBinded)}return e.prototype.onConnectionLost=function(){if(!this.eventProcessing){this.eventProcessing=!0,this.app.mailClientApi.pauseNetworkActivity();var e=this,t=e.app.mailClientApi.identity.user,n=e.app.localeService.i18nBinded,r={i18n:n,prepareErrorMessage:o.BaseWindowController.prototype.prepareErrorMessage},a=function(o){return"ok"!=o.result?(e.eventProcessing=!1,void o.close()):""==o.value?void o.showInputError(n("window.login.submit.error.emptyPassword")):(o.hideInputError(),o.startProcessing(""),void e.app.mailClientApi.gateway.srpRelogin(t,o.value).then(function(){e.eventProcessing=!1,e.app.mailClientApi.restoreNetworkActivity(),o.close()}).fail(function(e){i.error("Error during login",e);var t="";t=s.core.ApiErrorCodes.isEx(e,"DIFFERENT_M1")?n("window.login.submit.error.invalidPassword"):s.core.ApiErrorCodes.isEx(e,"USER_DOESNT_EXIST")?n("window.login.submit.error.invalidPassword"):s.core.ApiErrorCodes.isEx(e,"INVALID_VERIFER")?n("window.login.submit.error.invalidPassword"):s.core.ApiErrorCodes.isEx(e,"LOGIN_BLOCKED")?n("window.login.submit.error.loginBlocked"):r.prepareErrorMessage(e),o.showInputError(t)}).fin(function(){o.stopProcessing()}))};e.innerPageWindow!==!1&&e.app.initializer?e.app.initializer.showLoginDialog(t,a):this.app.msgBox.promptEx({message:n("window.relogin.info"),height:285,ok:{faIcon:"",label:n("window.relogin.login")},cancel:{visible:!1},input:{preHtml:'<label style="display: block; margin-top: 10px; font-size: 14px;">'+n("window.relogin.username")+'</label><input class="form-control" readonly="readonly" placeholder="" value="'+t+'" type="text"><label style="margin: 10px 0 -10px 0; display: block; font-size: 14px;">'+n("window.relogin.password")+"</label>",type:"password"},processing:"ok",onClose:a})}},e}();n.ConnectionStatusChecker=a},{"../../window/base/BaseWindowController":527,"privfs-client":204,"simplito-logger":357}],414:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("simplito-utils"),o=function(){function e(){}return e.create=function(e,t){return new s(e,t)},e.prototype.alert=function(e){return this.alertEx({message:e})},e.prototype.alertEx=function(e){return this.msgBox(i.fillByDefaults(e,{focusOn:"ok",ok:{btnClass:"btn-success",visible:!0}}))},e.prototype.confirm=function(e){return this.confirmEx({message:e||this.i18n("window.confirm.message")})},e.prototype.confirmEx=function(e){return this.msgBox(i.fillByDefaults(e,{focusOn:"yes",yes:{btnClass:"btn-success",visible:!0},no:{visible:!0}}))},e.prototype.prompt=function(e,t){return this.promptEx({message:e,input:{value:t||""}})},e.prototype.promptEx=function(e){return this.msgBox(i.fillByDefaults(e,{focusOn:"input",ok:{btnClass:"btn-success",visible:!0},cancel:{visible:!0},input:{visible:!0,action:{result:"ok"}}}))},e.prototype.msgBox=function(e){var t=this.openChildWindow(new a.MsgBoxWindowController(this.getChilWindowParent(),e));return t.getPromise()},e}();n.MsgBox=o;var s=function(e){function t(t,n){var r=e.call(this)||this;return r.parent=t,r.localeService=n,r}return r(t,e),t.prototype.openChildWindow=function(e){return e.open(),e},t.prototype.getChilWindowParent=function(){return this.parent},t.prototype.i18n=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.localeService.i18n.apply(this.localeService,arguments)},t}(o);n.SimpleMsgBox=s;var a=e("../../window/msgbox/MsgBoxWindowController")},{"../../window/msgbox/MsgBoxWindowController":543,"simplito-utils":373}],415:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../utils/Event"),i=e("simplito-logger"),o=i.get("privfs-mail-client.app.common.Notifier"),s=function(){function e(e){this.app=e,this.app.mailClientApi.mailUnreadCountModel.changeEvent.add(this.onNewCountChange.bind(this),"multi"),this.app.mailClientApi.unknownDomainsMessagesCountModel.changeEvent.add(this.onNewCountChange.bind(this),"multi"),this.newMessagesInfo={entries:[],tid:null},this.app.mailClientApi.events.on("new-entry",this.onNewEntry.bind(this),"multi"),this.app.mailClientApi.events.on("revert-entry",this.onRevertEntry.bind(this)),this.onNewCountChange()}return e.prototype.onNewCountChange=function(){var e=this.app.mailClientApi.mailUnreadCountModel.get()+this.app.mailClientApi.unknownDomainsMessagesCountModel.get();this.app.setNewCount(e)},e.prototype.onNewEntry=function(e){var t=this;o.debug("onNewEntry",e),r.Event.applyEvents(e,function(e){var n=t.newMessagesInfo.entries.some(function(t){return t.source.serverId==e.source.serverId&&t.index.sink.id==e.index.sink.id});n||t.newMessagesInfo.entries.push(e)}),this.newMessagesInfo.tid&&clearTimeout(this.newMessagesInfo.tid),this.newMessagesInfo.tid=setTimeout(function(){var e=t.newMessagesInfo.entries.filter(function(e){return!e.isRead()});e.length>0&&(o.debug("something new",e.length),t.app.playAudio("new-messages")),t.newMessagesInfo.entries=[]},500)},e.prototype.onRevertEntry=function(e,t){var n=this.app.localeService.i18n("window.apps.error.revert.default");"update-revert"==e&&(n=this.app.localeService.i18n("window.apps.error.revert.update")),"delete-revert"==e&&(n=this.app.localeService.i18n("window.apps.error.revert.delete")),"move-revert"==e&&(n=this.app.localeService.i18n("window.apps.error.revert.move")),"delete-bulk-revert"==e&&(n=this.app.localeService.i18n("window.apps.error.revert.bulk")),this.app.msgBox.alert(n)},e}();n.Notifier=s},{"../../utils/Event":485,"simplito-logger":357}],416:[function(e,t,n){t.exports.plugins=[e("../../plugins/updater/app").plugin]},{"../../plugins/updater/app":469}],417:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./Window"),o=function(e){function t(t,n,r,i,o){var s=e.call(this)||this;return s.parentWindow=t,s.id=n,s.url=r,s.options=i,s.controllerId=o,s.docked=!0,s}return r(t,e),t.prototype.isDocked=function(){return!0},t.prototype.setTitle=function(e){},t.prototype.focus=function(){},t.prototype.hideLoadingScreen=function(){},t.prototype.toggleDistractionFreeMode=function(){this.parentWindow.toggleDistractionFreeModeFromDocked([this.id.toString()])},t.prototype.toggleDistractionFreeModeFromDocked=function(e){e.push(this.id.toString()),this.parentWindow.toggleDistractionFreeModeFromDocked(e)},t.prototype.close=function(e){},t.prototype.start=function(){this.parentWindow.sendFromDocked([this.id.toString()],"controller-start",this.controllerId)},t.prototype.sendFromDocked=function(e,t,n){e.push(this.id.toString()),this.parentWindow.sendFromDocked(e,t,n)},t.prototype.setDirty=function(e){},t.prototype.setIcon=function(e){},t}(i.Window);n.DockedWindow=o},{"./Window":418}],418:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../../utils/Events"),i=function(){function e(){this.events=new r.Events,this.dockedWindows={}}return e.prototype.isDocked=function(){return!1},e.prototype.setTitle=function(e){throw new Error("Abstract method Window.setTitle")},e.prototype.focus=function(){throw new Error("Abstract method Window.focus")},e.prototype.close=function(e){throw new Error("Abstract method Window.close")},e.prototype.start=function(){throw new Error("Abstract method Window.start")},e.prototype.hideLoadingScreen=function(){throw new Error("Abstract method Window.hideLoadingScreen")},e.prototype.toggleDistractionFreeMode=function(){throw new Error("Abstract method Window.toggleDistractionFreeMode")},e.prototype.toggleDistractionFreeModeFromDocked=function(e){throw new Error("Abstract method Window.toggleDistractionFreeModeFromDocked")},e.prototype.on=function(e,t){this.events.on(e,t)},e.prototype.createDockedWindow=function(e,t,n,r){var i=new o.DockedWindow(this,e,t,n,r);return this.dockedWindows[e]=i,i},e.prototype.sendFromDocked=function(e,t,n){throw new Error("Abstract method Window.sendFromDocked")},e.prototype.onDockedEvent=function(e,t){0==t.route.length&&this.events.trigger(t.name);var n=t.route.pop();n in this.dockedWindows&&this.dockedWindows[n].onDockedEvent(e,t)},e.prototype.setDirty=function(e){throw new Error("Abstract method Window.setDirty")},e.prototype.setIcon=function(e){throw new Error("Abstract method Window.setIcon")},e.prototype.minimize=function(){throw new Error("Abstract method Window.minimize")},e}();n.Window=i;var o=e("./DockedWindow")},{"../../../utils/Events":486,"./DockedWindow":417}],419:[function(e,t,n){"use strict";n.__esModule=!0,n.func=function(e,t,n){var r="",i=function(e){r+=e};return i('<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8">\n    <style>\n      @import "'),i(e.assetUrl),i('themes/default/css/fonts.css";\n      body {\n        font-family: source_sans_pro, arial, sans-serif;\n        -webkit-font-smoothing: antialiased;\n        font-size: 18px;\n        color: #333;\n        padding: 20px;\n        text-align: center;\n      }\n      small {\n        display: block;\n        margin-top: 30px;\n        margin-bottom: 30px;\n      }\n      button {\n        padding: 5px 10px;\n        cursor: pointer;\n        background-color: #84d501;\n        color: #1b1d1e;\n        border: 1px solid transparent;\n        border-bottom: 1px solid #457000;\n        font-size: 14px;\n        border-radius: 4px;\n      }\n    </style>\n  </head>\n  <body>\n    '),i(e.message1),i("\n    <small>"),i(e.message2),i('</small>\n    <button id="close-button">OK</button>\n  </body>\n</html>\n'),r}},{}],420:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=function(e){function t(t){var n=e.call(this)||this;return n.model=t.model,n.isRaw=t.isRaw,n.isActiveCollection=t.isActiveCollection,n.isCollectionSize=t.isCollectionSize,n.context=t.context,n.model&&"changeEvent"in n.model&&n.registerChangeEvent(n.model.changeEvent,n.onChange,"multi"),n}return r(t,e),t.prototype.getModel=function(){return this.isRaw?this.model:this.isCollectionSize?this.model.size():this.isActiveCollection?this.model.getActive():this.model.get()},t.prototype.onChange=function(){this.callViewMethod("render",this.getModel())},t}(i.ComponentController);n.AutoRefreshController=o},{"../base/ComponentController":421}],421:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=function(){function e(){this.requestId=0,this.requests={},this.registeredChangeEvents=[],this.registeredNamedEvents=[],this.registeredComponents=[],this.namedComponents={}}return e.prototype.initView=function(e){return this.viewCallMethodListener=e,{nextTick:this.onViewEventNextTick.bind(this),theSameTick:this.onViewEventTheSameTick.bind(this)}},e.prototype.onViewInit=function(e){this.sendToViewChannel(e,this.getModel())},e.prototype.getModel=function(){return null},e.prototype.callViewMethod=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.viewCallMethodListener&&this.viewCallMethodListener.apply(null,arguments)},e.prototype.sendToViewChannel=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.callViewMethod.apply(this,["channelMessage"].concat(Array.prototype.slice.call(arguments,0)))},e.prototype.retrieveFromView=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!this.viewCallMethodListener)return r(null);var i={id:++this.requestId,defer:r.defer()};this.requests[i.id]=i;var o=["onRequest",i.id].concat(Array.prototype.slice.call(arguments,0));return this.viewCallMethodListener.apply(null,o),i.defer.promise},e.prototype.onViewEventNextTick=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.onViewEvent(!0,e,Array.prototype.slice.call(arguments,1))},e.prototype.onViewEventTheSameTick=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.onViewEvent(!1,e,Array.prototype.slice.call(arguments,1))},e.prototype.onViewEvent=function(e,t,n){var r="onView"+t.charAt(0).toUpperCase()+t.substring(1);if(r in this){var i=this[r],o=this;e?setTimeout(function(){i.apply(o,n)},1):i.apply(o,n)}},e.prototype.onViewResponse=function(e,t){e in this.requests&&(this.requests[e].defer.resolve(t),delete this.requests[e])},e.prototype.registerChangeEvent=function(e,t,n){var r=t.bind(this);e.add(r,n);var i={handler:r,changeEvent:e};return this.registeredChangeEvents.push(i),i},e.prototype.registerNamedEvents=function(e,t,n,r){var i=n.bind(this);e.on(t,i,r);var o={handler:i,eventName:t,events:e};return this.registeredNamedEvents.push(o),o},e.prototype.registerComponent=function(e){return this.registeredComponents.push(e),e},e.prototype.registerNamedComponent=function(e,t){return this.registerComponent(t),this.namedComponents[e]=t,t},e.prototype.destroy=function(){for(var e=0;e<this.registeredComponents.length;e++)this.unregisterComponent(this.registeredComponents[e],!1);this.registeredComponents=[],this.namedComponents={};for(var e=0;e<this.registeredChangeEvents.length;e++)this.unregisterChangeEvent(this.registeredChangeEvents[e],!1);this.registeredChangeEvents=[];for(var e=0;e<this.registeredNamedEvents.length;e++)this.unregisterNamedEvents(this.registeredNamedEvents[e],!1);this.registeredNamedEvents=[]},e.prototype.unregisterComponent=function(e,t){if(e.destroy&&e.destroy(),t!==!1){var n=this.registeredComponents.indexOf(e);n!=-1&&this.registeredComponents.splice(n,1);for(var r in this.namedComponents)this.namedComponents[r]==e&&delete this.namedComponents[r]}},e.prototype.unregisterChangeEvent=function(e,t){if(e.changeEvent.remove(e.handler),t!==!1){var n=this.registeredChangeEvents.indexOf(e);n!=-1&&this.registeredChangeEvents.splice(n,1)}},e.prototype.unregisterNamedEvents=function(e,t){if(e.events.off(e.eventName,e.handler),t!==!1){var n=this.registeredNamedEvents.indexOf(e);n!=-1&&this.registeredNamedEvents.splice(n,1)}},e}();n.ComponentController=i},{q:327}],422:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./ComponentView"),i=e("simplito-logger"),o=i.get("privfs-mail-client.component.base.ComponentInitializer"),s=function(){function e(){}return e.bind=function(t,n){if(null==t||null==n)return!1;t.eventListener=n.initView(t.onCallMethod.bind(t));for(var i in t)"parent"!=i&&t[i]instanceof r.ComponentView&&(e.bind(t[i],n[i])||o.warn("Cannot initialize view",i,"in",t.constructor.name));t.componentsContainers.forEach(function(r){var i=t[r],s=n[r];for(var a in i)e.bind(i[a],s[a])||o.warn("Cannot initialize view",r+"."+a,"in",t.constructor.name)});for(var s in t.plugins)t.plugins[s]instanceof r.ComponentView&&(e.bind(t.plugins[s],n.namedComponents[s])||o.warn("Cannot initialize view",s,"in",t.constructor.name));return!0},e.createView=function(t,n){var r=new t;return e.bind(r,n)||o.warn("Cannot initialize view",r.constructor.name),{view:r,initPromise:r.triggerInit()}},e.createViewAndSetContainer=function(t,n,r){var i=new t;return i.$container=r,e.bind(i,n)||o.warn("Cannot initialize view",i,n),{view:i,initPromise:i.triggerInit()}},e}();n.ComponentInitializer=s},{"./ComponentView":423,"simplito-logger":357}],423:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../web-utils/template/Manager"),i=e("q"),o=function(){function e(){this.templateManager=r.Manager,this.methodCalls={list:[],binded:this.callMethods.bind(this),timeout:null},this.channelId=0,this.channels={},this.plugins={},this.componentsContainers=[]}return e.prototype.triggerEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.eventListener&&this.eventListener.nextTick.apply(null,arguments)},e.prototype.triggerEventInTheSameTick=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.eventListener&&this.eventListener.theSameTick.apply(null,arguments)},e.prototype.onCallMethod=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e in this&&(this.methodCalls.list.push({name:e,args:Array.prototype.slice.call(arguments,1)}),null==this.methodCalls.timeout&&(this.methodCalls.timeout=setTimeout(this.methodCalls.binded,1)))},e.prototype.callMethods=function(){this.performingControllerCalls=!0;for(var e=0;e<this.methodCalls.list.length;e++){var t=this.methodCalls.list[e];try{(this.loaded||"channelMessage"==t.name)&&this[t.name].apply(this,t.args)}catch(n){console.log("callViewMethod error",n,n.stack)}}this.methodCalls.list=[],this.methodCalls.timeout=null,this.performingControllerCalls=!1,this.finalizeControllerCall()},e.prototype.finalizeControllerCall=function(){},e.prototype.onRequest=function(e,t){if(t in this){var n=this[t].apply(this,Array.prototype.slice.call(arguments,2));this.triggerEvent("response",e,n)}},e.prototype.newChannel=function(e){var t=this.channelId++;return this.channels[t]=e,t},e.prototype.destroyChannel=function(e){delete this.channels[e]},e.prototype.channelMessage=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e in this.channels&&this.channels[e].apply(this,Array.prototype.slice.call(arguments,1))},e.prototype.channelPromise=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=i.defer(),s=this.newChannel(function(e){t.destroyChannel(s),o.resolve(e)}),a=[e,s].concat(Array.prototype.slice.call(arguments,1));return this.triggerEvent.apply(this,a),o.promise},e.prototype.triggerInit=function(){var e=this;return this.channelPromise("init").then(function(t){return e.init(t)}).then(function(){e.loaded=!0,e.triggerEvent("load")})},e.prototype.init=function(e){},e}();n.ComponentView=o},{"../../web-utils/template/Manager":513,q:327}],424:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e,t){this.controller=e,this.id=t}return e.prototype.send=function(e,t){this.controller.sendToViewChannel.apply(this.controller,[this.id,e].concat(Array.prototype.slice.call(t,0)))},e.prototype.start=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.send("start",arguments)},e.prototype.progress=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.send("progress",arguments)},e.prototype.finish=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.send("finish",arguments)},e}();n.ProgressController=r},{}],425:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=e("../../utils/Event"),s=function(e){function t(t){var n=e.call(this)||this;return n.collection=t,n.onCollectionChangeBinded=n.onCollectionChange.bind(n),n.registerChangeEvent(n.collection.changeEvent,n.onCollectionChanges,"multi"),n}return r(t,e),t.prototype.getModel=function(){return this.collection},t.prototype.onCollectionChanges=function(e){o.Event.applyEvents(e,this.onCollectionChangeBinded)},t.prototype.onCollectionChange=function(e){"add"==e.type?this.callViewMethod("add",e.index,e.element):"remove"==e.type?this.callViewMethod("remove",e.index,e.element):"update"==e.type?this.callViewMethod("update",e.index,e.element):"clear"==e.type?this.callViewMethod("clear"):"active"==e.type?this.callViewMethod("active",e.oldActive,e.newActive):"reorganize"==e.type?this.callViewMethod("reorganize",e.indicies):"move"==e.type?this.callViewMethod("move",e.oldIndex,e.newIndex):"rebuild"==e.type?this.callViewMethod("render",this.collection):console.log("ExtListController unknown event type: "+(null==e?"":e.type),e)},t}(i.ComponentController);n.ExtListController=s},{"../../utils/Event":485,"../base/ComponentController":421}],426:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=e("../ext-list/ExtListController"),s=function(e){function t(t,n){var r=e.call(this)||this;return r.columns=t,r.list=r.registerComponent(new o.ExtListController(n)),r.model=r.calculateModel(),r}return r(t,e),t.prototype.getModel=function(){return this.model},t.prototype.calculateModel=function(){var e=[];return this.columns.forEach(function(t,n){e.push({index:n,type:t.type,min:t.min,value:"fixed"==t.type?t.value:t.value.get("float")})}),e},t.prototype.onViewColumnValueChange=function(e,t){this.model[e].value=t,this.columns[e].value.set(t)},t}(i.ComponentController);n.ExtTableController=s},{"../base/ComponentController":421,"../ext-list/ExtListController":425}],427:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=function(e){function t(t,n){var r=e.call(this)||this;return r.activeApp=t,r.containerController=n,r.app=r.containerController.app,r.registerChangeEvent(r.app.mailClientApi.persons.changeEvent,r.onPersonsChange),r.registerChangeEvent(r.app.mailClientApi.unknownDomainsCountModel.changeEvent,r.onUnknownDomainsCountModelChange,"multi"),r.registerChangeEvent(r.app.mailClientApi.unknownDomainsMessagesCountModel.changeEvent,r.onUnknownDomainsMessagesCountModelChange,"multi"),r.registerChangeEvent(r.app.mailClientApi.mailUnreadCountModel.changeEvent,r.onMailUnreadCountModelChange,"multi"),r.fullscreenModel=r.app.getFullscreenModel(),r.fullscreenModel&&r.registerChangeEvent(r.fullscreenModel.changeEvent,r.onFullscreenChange,"multi"),r}return r(t,e),t.prototype.getModel=function(){return{person:this.app.mailClientApi.getPerson(this.app.mailClientApi.identity.hashmail),unknownDomainsCount:this.app.mailClientApi.unknownDomainsCountModel.get(),unknownDomainsMessagesCount:this.app.mailClientApi.unknownDomainsMessagesCountModel.get(),mailCount:this.app.mailClientApi.mailUnreadCountModel.get(),inFullscreen:!!this.fullscreenModel&&this.fullscreenModel.get(),customMenuItems:this.app.mailClientApi.userConfig.customMenuItems||[]}},t.prototype.onViewLogout=function(){this.app.logout()},t.prototype.onViewOpenSettings=function(){this.app.openSettings()},t.prototype.onViewOpenAdmin=function(){this.app.openAdmin()},t.prototype.onViewOpenAbout=function(){this.app.openAbout()},t.prototype.onViewSendFeedback=function(){var e=this.app.isDemo()?"team#demo.privmx.com":"team#privmx.com";this.app.sendMail({type:"predefined",receivers:[e],title:"Feedback..."})},t.prototype.onViewOpenNewMail=function(){this.app.sendBlankMail()},t.prototype.onViewToogleFullscreen=function(){this.fullscreenModel&&this.fullscreenModel.toggle()},t.prototype.onViewOpenMailFilter=function(){this.app.openSettings("whitelist")},t.prototype.onViewCustomAction=function(e){0==e.indexOf("http")&&this.app.openUrl(e)},t.prototype.onViewLoad=function(){var e=this.app.mailClientApi.userPreferences.getValue("ui.seenFirstLoginInfo",0);e||(this.app.mailClientApi.userPreferences.set("ui.seenFirstLoginInfo",1,!0),this.app.openAbout(),this.callViewMethod("showFirstLoginInfo"))},t.prototype.onUnknownDomainsCountModelChange=function(){this.callViewMethod("setUnknownDomainsIndicator",this.app.mailClientApi.unknownDomainsCountModel.get())},t.prototype.onUnknownDomainsMessagesCountModelChange=function(){this.callViewMethod("setUnknownDomainsMessagesCount",this.app.mailClientApi.unknownDomainsMessagesCountModel.get())},t.prototype.onMailUnreadCountModelChange=function(){this.callViewMethod("setMailBadge",this.app.mailClientApi.mailUnreadCountModel.get())},t.prototype.onPersonsChange=function(e){e.hashmail==this.app.mailClientApi.identity.hashmail&&this.callViewMethod("setUserState",{person:e,customMenuItems:this.app.mailClientApi.userConfig.customMenuItems||[]})},t.prototype.onFullscreenChange=function(){this.callViewMethod("setFullscreenState",!!this.fullscreenModel&&this.fullscreenModel.get())},t}(i.ComponentController);n.NavBarController=o},{"../base/ComponentController":421}],428:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=function(e){function t(t){var n=e.call(this)||this;return n.settings=t,n}return r(t,e),t.prototype.getModel=function(){return this.settings.get("int")},t.prototype.onViewChangeRelativeHandlePosition=function(e){this.settings.set(e)},t}(i.ComponentController);n.SplitterController=o},{"../base/ComponentController":421}],429:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=function(e){function t(t,n){var r=e.call(this)||this;return r.multiTaskStream=t,r.localeService=n,r.registerChangeEvent(r.multiTaskStream.changeEvent,r.onChange,"multi"),r}return r(t,e),t.prototype.onChange=function(){var e=this,t=this.multiTaskStream.getCurrentTasks(),n=null,r=(new Date).getTime(),i=!1,o=[];t.forEach(function(t){var s=r-t.getStartDate().getTime();return s<100?(s=100-s,void((null==n||n>s)&&(n=s))):(i=i||"sink-polling"==t.name,void o.push(e.localeService.getTaskName(t.name)))}),null!=n&&setTimeout(this.onChange.bind(this),n),0==o.length?this.callViewMethod("hideTasksInfo"):1==o.length?this.callViewMethod("showTasksInfo",o[0],i):this.callViewMethod("showTasksInfo",this.localeService.i18n("app.task.runningCount",[o.length]))},t}(i.ComponentController);n.StatusBarMainController=o},{"../base/ComponentController":421}],430:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentView"),o=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.showTasksInfo=function(e,t){t?this.$container.addClass("important"):this.$container.removeClass("important"),this.$container.find(".fa").length||this.$container.prepend("<i class='fa fa-circle-o-notch fa-spin'></i>"),this.$container.find(".info").text(e),this.$container.show()},t.prototype.hideTasksInfo=function(){this.$container.find(".fa").remove(),this.$container.hide().find(".info").text("")},t}(i.ComponentView);n.StatusBarMainView=o},{"../base/ComponentView":423}],431:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/ComponentController"),o=e("../../utils/Event"),s=function(e){function t(t){var n=e.call(this)||this;return n.syncTaskStream=t,n.registerChangeEvent(n.syncTaskStream.changeEvent,n.onChange,"multi"),n}return r(t,e),t.prototype.getModel=function(){return this.syncTaskStream.currentTask},t.prototype.onChange=function(e){var t=null,n=null;o.Event.applyEvents(e,function(e,r,i){"task-progress"==e?(null==t&&(t=!0),n=i):t=!1}),t?this.callViewMethod("setProgress",n):this.callViewMethod("render",this.getModel())},t}(i.ComponentController);n.StatusBarController=s},{"../../utils/Event":485,"../base/ComponentController":421}],432:[function(e,t,n){"use strict";n.__esModule=!0;var r,i=e("privfs-client"),o=e("../utils/Bracket");!function(e){e[e.PRIVMX=0]="PRIVMX",e[e.EMAIL=1]="EMAIL";
}(r=n.ContactType||(n.ContactType={}));var s=function(){function e(){}return e.prototype.isStarred=function(){return this.starred},e.prototype.setStarred=function(e){this.starred=e},e.prototype.setDisplayName=function(e){this.user?this.user.name=e:(null==this.profile&&(this.profile={}),this.profile.name=e)},e.prototype.isPrivmx=function(){return null===this.type||this.type==r.PRIVMX},e.prototype.isEmail=function(){return this.type==r.EMAIL},e.prototype.hasName=function(){return!!(this.isPrivmx()&&this.user&&this.user.name||this.profile&&this.profile.name)},e.prototype.getDisplayName=function(){return this.isPrivmx()&&this.user&&this.user.name?this.user.name:this.profile&&this.profile.name?this.profile.name:this.getHashmail()},e.prototype.getDisplayNameWithHashmail=function(e){var t=o.Bracket.getChars(e);return this.isPrivmx()&&this.user&&this.user.name?this.user.name+" "+t.open+this.user.hashmail+t.close:this.profile&&this.profile.name?this.profile.name+" "+t.open+this.getHashmail()+t.close:this.getHashmail()},e.prototype.getHashmail=function(){return this.isEmail()?this.email:this.user.hashmail},e.prototype.serialize=function(){var e={user:this.user?this.user.serialize():null,sinks:[],starred:this.starred,profile:this.profile||{},type:null==this.type?r.PRIVMX:this.type,email:this.email};return(this.sinks||[]).forEach(function(t){e.sinks.push(t.serialize())}),e},e.deserialize=function(t){var n=new e;return n.user=t.user?i.identity.User.fromSerialized(t.user.hashmail,t.user.pub58,t.user.name):null,n.starred=!!t.starred,n.sinks=[],n.profile=t.profile||{},n.type="type"in t?t.type:r.PRIVMX,n.email=t.email,(t.sinks||[]).forEach(function(e){n.sinks.push(i.message.MessageSink.fromSerialized(e.id,e.name,e.description))}),n},e.serializeMany=function(e){var t=[];return e.forEach(function(e){t.push(e.serialize())}),t},e.deserializeMany=function(t){var n=[];return t.forEach(function(t){n.push(e.deserialize(t))}),n},e}();n.Contact=s},{"../utils/Bracket":483,"privfs-client":204}],433:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e,t,n){this.id=e,this.persons=t,this.predefined=n,this.entries=[],this.stats={unread:0,byType:{}}}return e.create=function(t,n,r){for(var i=t.split(","),o=[],s=0;s<i.length;s++)o.push(n(i[s]));return new e(t,o,r)},e.prototype.add=function(e){this.entries.push(e),e.isRead()||(this.stats.unread++,this.updateStatsByType(e,1))},e.prototype.update=function(e){this.stats={unread:0,byType:{}};for(var t=0;t<this.entries.length;t++)this.entries[t].isRead()||(this.stats.unread++,this.updateStatsByType(this.entries[t],1))},e.prototype.remove=function(e){var t=this.entries.indexOf(e);t!=-1&&(this.entries.splice(t,1),e.isRead()||(this.stats.unread--,this.updateStatsByType(e,-1)))},e.prototype.isEmpty=function(){return 0==this.entries.length},e.prototype.setPredefined=function(e){this.predefined=e},e.prototype.isPredfined=function(){return!!this.predefined},e.prototype.hasPerson=function(e){for(var t=0;t<this.persons.length;t++)if(this.persons[t]==e)return!0;return!1},e.prototype.getHashmails=function(){for(var e=[],t=0;t<this.persons.length;t++)e.push(this.persons[t].getHashmail());return e},e.prototype.updateStatsByType=function(e,t){var n=e.source.data.type||"";this.stats.byType[n]?this.stats.byType[n].unread+=t:this.stats.byType[n]={unread:t}},e.prototype.isSingleContact=function(){return 1==this.persons.length&&this.persons[0].hasContact()},e.prototype.getFirstPerson=function(){return 0==this.persons.length?null:this.persons[0]},e.prototype.canBeRemoved=function(){return this.isEmpty()&&!this.isPredfined()&&!this.isSingleContact()},e}();n.Conversation=r},{}],434:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e){this.hashmails=e||[]}return e.prototype.add=function(e){this.hashmails.indexOf(e)==-1&&this.hashmails.push(e)},e.prototype.remove=function(e){var t=this.hashmails.indexOf(e);t!=-1&&this.hashmails.splice(t,1)},e.prototype.length=function(){return this.hashmails.length},e.prototype.contains=function(e){return this.hashmails.indexOf(e)!=-1},e.prototype.toString=function(){return this.hashmails.sort(),this.hashmails.join(",")},e.parse=function(t){return new e(t.split(","))},e.createFromIndexEntry=function(t){return e.createFromSource(t.source)},e.createFromSource=function(t){for(var n=new e,r=t.data.receivers,i=0;i<r.length;i++)n.add(r[i].hashmail);return n.add(t.data.sender.hashmail),n},e.createFromMessage=function(t){for(var n=new e,r=t.receivers,i=0;i<r.length;i++)n.add(r[i].user.hashmail);return n.add(t.sender.hashmail),n},e.createFromHashmails=function(t){return new e(t)},e}();n.ConversationId=r},{}],435:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Conversation"),i=e("../utils/collection/MutableCollection"),o=e("../utils/Event"),s=function(){function e(e,t){var n=this;this.mailClientApi=e,this.sourceCollection=t,this.map={};var o=[];this.sourceCollection.forEach(function(e){var t=n.mailClientApi.getConversationId(e),i=n.map[t];null==i&&(i=r.Conversation.create(t,n.mailClientApi.personsGetter,!1),n.map[t]=i,o.push(i)),i.add(e)}),this.mailClientApi.contactCollection.forEach(function(e){var t=e.getHashmail(),i=n.map[t];null==i&&(i=r.Conversation.create(t,n.mailClientApi.personsGetter,!1),n.map[t]=i,o.push(i))}),this.collection=new i.MutableCollection(o),this.bindedProcessEvent=this.processEvent.bind(this),this.sourceCollection.changeEvent.add(this.processEvents.bind(this),"multi"),this.mailClientApi.persons.changeEvent.add(this.onPersonChange.bind(this))}return e.prototype.getCollection=function(){return this.collection},e.prototype.processEvents=function(e){this.collection.changeEvent.hold(),o.Event.applyEvents(e,this.bindedProcessEvent),this.collection.reductEvents(),this.collection.changeEvent.release()},e.prototype.processEvent=function(e){if("add"==e.type||"remove"==e.type||"update"==e.type){var t=e.element,n=this.mailClientApi.getConversationId(t),i=this.map[n];null==i?"add"==e.type&&(i=r.Conversation.create(n,this.mailClientApi.personsGetter,!1),i.add(t),this.map[n]=i,this.collection.add(i)):"add"==e.type?(i.add(t),this.collection.updateElement(i)):"remove"==e.type?(i.remove(t),i.canBeRemoved()?(delete this.map[n],this.collection.remove(i)):this.collection.updateElement(i)):"update"==e.type&&(i.update(t),this.collection.updateElement(i))}else"clear"==e.type&&this.collection.clear()},e.prototype.onPersonChange=function(e){var t=this,n=[];this.collection.forEach(function(r){r.hasPerson(e)&&(r.canBeRemoved()?n.push(r):t.collection.updateElement(r))});for(var i=0;i<n.length;i++)delete this.map[n[i].id],this.collection.remove(n[i]);if(e.hasContact()&&!(e.getHashmail()in this.map)){var o=r.Conversation.create(e.getHashmail(),this.mailClientApi.personsGetter,!1);this.map[e.getHashmail()]=o,this.collection.add(o)}},e.prototype.addPredefined=function(e){var t=this.map[e];return null==t?(t=r.Conversation.create(e,this.mailClientApi.personsGetter,!0),this.map[e]=t,this.collection.add(t)):t.setPredefined(!0),t},e.prototype.getConversation=function(e){return this.map[e]},e.prototype.hasConversation=function(e){return e in this.map},e}();n.ConversationsCollection=s},{"../utils/Event":485,"../utils/collection/MutableCollection":501,"./Conversation":433}],436:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("privmx-exception"),o=i.Exception,s=function(e){function t(n,r,i){var o=e.call(this,i||(n in t.codes?t.codes[n].message:null),r)||this;return o.errorName=n,o.errorObject=t.codes[n],o}return r(t,e),t.is=function(e,n){return e instanceof t&&e.errorName==n},t.codes={HASHMAIL_NOT_SUPPORTED:{code:12289,message:"Hashmail is not supported"},MAX_FILE_SIZE_EXCEEDED:{code:12290,message:"Max file size exceeded"}},t}(o);n.DemoException=s},{"privmx-exception":266}],437:[function(e,t,n){"use strict";n.__esModule=!0;var r;!function(e){e[e.ALLOW=0]="ALLOW",e[e.DENY=1]="DENY"}(r=n.FilterMode||(n.FilterMode={}))},{}],438:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=function(){function e(){this.map={}}return e.prototype.register=function(e,t){if(this.map[e])throw new Error("Name in use");this.map[e]={service:null,fn:t}},e.prototype.get=function(e){var t=this;return r(null).then(function(){if(!t.map[e])throw new Error("Unknown service");var n=t.map[e];return n.service?n.service:(n.loadingPromise||(n.loadingPromise=r(null).then(n.fn).then(function(e){return n.service=e,e})["catch"](function(e){throw delete n.loadingPromise,e})),n.loadingPromise)})},e}();n.LazyLoader=i},{q:327}],439:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./MailClientApi"),i=e("./SinkIndexEntry"),o=e("q"),s=e("privfs-client"),a=function(){function e(e){this.storage=e,this.emailCache={},this.hashmailCache={},this.sourceCache={};for(var t in this.storage.map)this.applyUserChanges(this.storage.map[t])}return e.create=function(t,n,r){return o(null).then(function(){return t.getKeyValueFile(n,r)}).then(function(t){return new e(t)})},e.prototype.getUser=function(e){return this.storage.getValueByKey(e)},e.prototype.getLowUserByHashmail=function(e){return this.hashmailCache[e]},e.prototype.getLowUserByEmail=function(e){return this.emailCache[e]},e.prototype.getLowUserBySource=function(e){return this.sourceCache[e]},e.prototype.applyUserChanges=function(e){e.deleted?(delete this.emailCache[e.email],delete this.hashmailCache[e.username+"#"+e.host],delete this.sourceCache[e.source]):(this.emailCache[e.email]=e,this.hashmailCache[e.username+"#"+e.host]=e,this.sourceCache[e.source]=e)},e.prototype.addUser=function(e){var t=this;return o(null).then(function(){return t.storage.set(e.username,e).then(function(){return t.applyUserChanges(e),!0})})},e}();n.LowUserRegistry=a;var u=function(){function e(e,t,n){this.mca=e,this.mainSink=t,this.registry=n}return e.prototype.encryptByBip39=function(e,t){return s.core.PrivFsKeyLogin.getEncryptorFromBip39(e).encrypt(t)},e.prototype.generateIdentity=function(e){var t,n;return o(null).then(function(){return t=s.crypto.service.randomBytes(64),s.crypto.service.eccExtFromSeed(t)}).then(function(t){return n=t,s.crypto.service.deriveHardened(n,e)}).then(function(e){return{masterSeed:t,masterExtKey:n,identityExt:e,identityKey:e.getPrivateKey()}})},e.prototype.deleteLowUser=function(e){var t,n,r=this;return o().then(function(){return r.registry.getUser(e)}).then(function(e){if(t=e,null==t||t.deleted)throw new Error("User does not exists");return n=s.message.MessageSinkPriv.fromSerialized(t.sink?t.sink.wif:t.sinkWif,"","","public",null,null),r.mca.messages.sinkDelete(n)}).then(function(){return r.mca.srpSecure.request("deleteLowUser",{username:e})}).then(function(){return t.deleted=!0,r.registry.storage.set(e,t)}).then(function(){r.registry.applyUserChanges(t)})},e.getSink=function(e){return s.message.MessageSinkPriv.fromSerialized(e.wif,"","","public",null,null)},e.getLowUserEx=function(t){var n=e.getSink(t.sink),r=s.identity.Identity.fromSerialized({user:t.username,host:t.host},t.identity.wif,t.email);return{user:t,sink:n,identity:r,receiver:new s.message.MessageReceiver(n,r)}},e.getPrivDataEx=function(t,n){return{privData:n,identity:s.identity.Identity.fromSerialized(t,n.identity.wif,n.identity.name),sink:e.getSink(n.sink),receiver:s.identity.User.fromSerialized(n.receiver.hashmail,n.receiver.pub58,n.receiver.name)}},e.prototype.createLowUserWithMessage=function(t,n,r,a,u){var c=this;return o().then(function(){var e=null==u?"":u.getCfmId();return c.createLowUser(t,n,r,a,e)}).then(function(t){var n=e.getLowUserEx(t),r=new s.message.Message,o=u.getMessage();return r.msgId=o.msgId,r.createDate=o.createDate,r.title=o.title,r.text=u.getContentAsJson().text,r.setSender(n.identity),r.addReceiver(c.mca.getMeAsReceiver()),r.attachments=o.getAttachmentSources(c.mca.messages.storage,u.index.sink),c.mca.messages.messageCreate(r,null,i.SinkIndexEntry.getMessageTags(r),n.sink).thenResolve(t)})},e.prototype.createLowUser=function(e,t,n,a,u){var c,f,l,h,p,d,g,y,m,v=this;return o().then(function(){return c={source:u,username:null,host:v.mca.identity.host,password:e,hint:t,email:n,language:a,masterSeed:null,identity:null,recovery:null,sink:null,deleted:!1},v.mca.srpSecure.request("createLowUser",{host:c.host})}).then(function(e){return c.username=e,f=c.username+"#"+c.host,v.generateIdentity(r.MailClientApi.IDENTITY_INDEX)}).then(function(e){return l=e,c.masterSeed=l.masterSeed.toString("base64"),h=new s.identity.Identity(f,l.identityKey,c.email),c.identity={wif:h.privWif},m=[{type:s.types.core.AclType.WHITE_LIST,property:"senderPub58",list:[h.pub58]}],y=new s.message.MessageSinkPriv(s.crypto.serviceSync.eccPrivRandom(),"","","public",null,{lowUsers:[c.username],proxyTo:{defaultAcls:m,list:[v.mainSink.id]}}),c.sink={wif:y.privWif},v.mca.messages.storage.sinkCreate(y.id,y.acl,"",y.options)}).then(function(){return v.mainSink.addToProxyFrom({value:y.id,acls:m}),v.mca.messages.sinkSave(v.mainSink,v.mca.sinkEncryptor)}).then(function(){return s.crypto.service.bip39Generate(256)}).then(function(e){return p=e,c.recovery=p.entropy.toString("base64"),d={dataVersion:s.core.PrivFsSrp.DATA_VERSION,masterSeed:l.masterSeed.toString("base64"),identity:{wif:c.identity.wif,name:c.email},sink:{wif:c.sink.wif},recovery:p.entropy.toString("base64"),receiver:{hashmail:v.mca.identity.hashmail,name:v.mca.identity.name,pub58:v.mca.identity.pub58}},v.encryptByBip39(p,d)}).then(function(e){return g=e,v.mca.srpSecure.privFsSrp.initUser(c.username,c.password,d)}).then(function(e){var n=JSON.parse(e.loginData);return n.hint=t,e.loginData=JSON.stringify(n),v.mca.srpSecure.request("modifyLowUser",{username:c.username,activated:!0,identityKey:h.pub58,srpSalt:e.srpSalt.toString("hex"),srpVerifier:e.srpVerifier.toString("hex"),loginData:e.loginData,email:c.email,privData:e.privDataEnc.toString("base64"),language:c.language,dataVersion:s.core.PrivFsSrp.DATA_VERSION,notifier:{enabled:!0,email:c.email,tags:[i.SinkIndexEntry.getMessageTypeTag("mail")],ignoredDomains:[]},recoveryData:{pub:p.extKey.getPublicKey().toBase58DER(),data:g.toString("base64")}})}).then(function(){return v.registry.addUser(c)}).then(function(){return v.mca.addEmailToContacts(c.email)}).then(function(){return c})},e}();n.LowUserService=u},{"./MailClientApi":440,"./SinkIndexEntry":450,"privfs-client":204,q:327}],440:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("privfs-client"),r=e("q"),i=e("../utils/Model"),o=e("../utils/Map"),s=e("simplito-logger"),a=s.get("privfs-mail-client.mail.MailClientApi"),u=e("../utils/Event"),c=e("../utils/Events"),f=e("./Contact"),l=e("./SinkIndexEntry"),h=e("./SinkIndexStats"),p=e("./SinkIndexManager"),d=e("./MessageSenderVerifier"),g=e("../task/ParallelTaskStream"),y=e("tar-stream"),m=e("./UserPreferences"),v=e("../utils/collection/FilteredCollection"),b=e("../utils/collection/MutableCollection"),w=e("./Persons"),E=e("./ConversationsCollection"),_=e("./MessageTagger"),S=e("./Query"),k=e("simplito-lazybuffer"),C=k.Content,x=e("simplito-promise"),I=x.PromiseUtils,A=e("privmx-exception"),P=A.Exception,T=e("./ConversationId"),M=e("./MailFilter"),R=e("./FilterMode"),O=e("./LazyLoader"),B=e("./PkiCache"),D=e("../utils/SortTake"),N=e("../utils/ImageTypeDetector"),L=e("./LowUser"),F=e("../utils/Lang"),U=function(){function e(e,t,n){var r=this;this.settings=e,this.localeService=t,this.mailResourceLoader=n,this.personsGetter=function(e){return r.getPerson(e)},this.initLazyLoader(),this.init()}return e.getSrp=function(n){return t.core.PrivFsSrpManager.getHttpSrpExByHost(e.IDENTITY_INDEX,n)},e.prototype.i18n=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.localeService.i18n.apply(this.localeService,arguments)},e.prototype.initLazyLoader=function(){var t=this;this.lazyLoader=new O.LazyLoader,this.lazyLoader.register("storage",function(){return t.client.getFileSystemByIndexAndInit(e.MESSAGES_INDEX)}),this.lazyLoader.register("filesStorage",function(){return t.client.getFileSystemByIndexAndInit(e.FILES_INDEX)}),this.lazyLoader.register("containersStorage",function(){return t.client.getFileSystemByIndexAndInit(e.CONTAINERS_INDEX)})},e.prototype.getStorage=function(){return this.lazyLoader.get("storage")},e.prototype.getFilesStorage=function(){return this.lazyLoader.get("filesStorage")},e.prototype.getContainersStorage=function(){return this.lazyLoader.get("containersStorage")},e.prototype.init=function(){a.debug("init"),this.client=null,this.messages=null,this.identity=null,this.persons=null,this.tagStorage=null,this.mailFilter=null,this.pkiCache=null,this.contactCollection=null,this.messageCollectionsByHashmail=new o.Map,this.conversationCollection=null,this.srpSecure=null,this.usersCollection=new b.MutableCollection,this.settings&&this.settings.reset(),this.attachmentsCollectionMap={},this.mailsCollectionsMap={},this.events&&this.events.clear(),this.events=new c.Events,this.presenceModel&&this.presenceModel.changeEvent.clear(),this.presenceModel=new i.Model((!1)),this.messageSenderVerifier&&this.messageSenderVerifier.destroy(),this.messageSenderVerifier=new d.MessageSenderVerifier(this),this.messageTagger&&this.messageTagger.destroy(),this.messageTagger=new _.MessageTagger(this),this.sinkIndexManager&&this.sinkIndexManager.destroy(),this.sinkIndexManager=null,this.mailUnreadCountModel=new i.Model(0),this.containersUnreadCountModel=new i.Model(0),this.starredContactsPresenceModel=new i.Model({currentState:[],newCount:0}),this.taskStream&&this.taskStream.destroy(),this.taskStream=new g.ParallelTaskStream,clearInterval(this.publishPresenceInterval),clearInterval(this.checkPresenceInterval)},e.prototype.alternativeLogin=function(n,i){var o=this;return I.notify(function(o){return r(null).then(function(){return o("code.loadConfig"),t.core.PrivFsSrpManager.getKeyLoginByHost(e.IDENTITY_INDEX,n)}).then(function(e){return o("code.prepareSession"),e.login(i,!1)})}).then(function(e){return o.loginCore(e)})},e.prototype.login=function(n,i){var o,s=this;return I.notify(function(s){return r(null).then(function(){return s("code.loadConfig"),o=new t.identity.Hashmail(n),e.getSrp(o.host)}).then(function(e){return r(null).then(function(){return s("code.prepareSession"),e.login(o.user,o.host,i,!1,!1)}).fail(function(e){return e&&"Missing required signature"==e.message?(s("code.migration"),j.EncryptionSignature.perform(n,i)):r.reject(e)})})}).then(function(e){return s.loginCore(e)})},e.prototype.loginCore=function(n){var i=this;return I.notify(function(o){return r(null).then(function(){return o("code.initClient"),i.authData=n,i.srpSecure=n.srpSecure,i.gateway=i.srpSecure.gateway,i.identity=n.identity,n&&n.myData.presence&&(n.myData.presence.extra="all"),i.client=new t.core.Client(i.gateway,i.identity,n.masterExtKey),i.client.init()}).then(function(){return o("code.deriveKeys"),i.client.deriveKey(e.SETTINGS_ENCRYPTOR_INDEX)}).then(function(e){i.settings.encKey=e.getChainCode(),i.messages=i.client.getMessageManager()}).then(function(){return o("code.readingFiles"),i.getFileSystems()}).then(function(){return r.all([i.srpSecure.getUserConfig(),i.loadContainersSettings(),i.loadTags(),i.loadPki(),i.prepareSinkEncryptor(),i.loadContacts(),i.loadMailFilter()])}).then(function(e){return o("code.loadSinks"),i.userConfig=e[0],i.sinkIndexManager=new p.SinkIndexManager(i.settings,i.messages,i.taskStream,i.tagStorage,i.containersSettings,i.mailFilter),i.sinkIndexManager.changeEvent.add(i.onSinkIndexManagerChange.bind(i),"multi"),i.loadSinks()}).then(function(){if(!i.networkActivityIsPaused())return i.sinkIndexManager.startSinkPolling()}).then(function(){return o("code.loadUserPreferences"),i.loadUserPreferences()})})},e.prototype.getFileSystems=function(){return r.all([this.getStorage(),this.getFilesStorage(),this.getContainersStorage()])},e.getSinkEncryptor=function(n){return r(null).then(function(){return n.deriveKey(e.SINK_ENCRYPTOR_INDEX)}).then(function(e){return t.crypto.service.getObjectEncryptor(e.getChainCode())})},e.prototype.prepareSinkEncryptor=function(){var t=this;return r(null).then(function(){return e.getSinkEncryptor(t.client)}).then(function(e){t.sinkEncryptor=e})},e.prototype.loadUserPreferences=function(){var t=this;return this.getStorage().then(function(n){return a.debug("load preferences"),t.userPreferences=new m.UserPreferences(t.identity.hashmail,n,e.USER_PREFERENCES_FILENAME),t.userPreferences.changeEvent.add(t.onUserPreferencesChange.bind(t)),t.userPreferences.load()}).then(function(){var e=t.userPreferences.getValue("ui.lang");if(e!=t.localeService.currentLang)return t.userPreferences.set("ui.lang",t.localeService.currentLang,!0)})},e.prototype.onUserPreferencesChange=function(e){this.identity.name=this.userPreferences.data.profile.name,"save"==e&&this.isStatusPublishingEnabled()&&this.publishStatus(),this.publishUserEntry(),this.refreshIdentityContact()},e.prototype.register=function(n,i,o,s,u,c){var f,h,p,d=this,g=new e(null,this.localeService,this.mailResourceLoader);return I.notify(function(y){return r(null).then(function(){return y("code.loadConfig"),f=new t.identity.Hashmail(n),e.getSrp(f.host)}).then(function(e){return y("code.register"),h=e,h.register(f.user,f.host,i,o,g.localeService.currentLang,s,u,c)}).then(function(){return r(null).then(function(){return y("code.prepareSession"),h.login(f.user,f.host,i,!1,!1)}).then(function(e){return y("code.initClient"),g.authData=e,g.srpSecure=e.srpSecure,g.gateway=g.srpSecure.gateway,g.identity=e.identity,g.client=new t.core.Client(g.gateway,g.identity,e.masterExtKey),g.client.init()}).then(function(){y("code.createFiles"),g.messages=g.client.getMessageManager()}).then(function(){return y("code.createSinks"),g.client.deriveKey(e.SINK_ENCRYPTOR_INDEX)}).then(function(e){g.sinkEncryptor=t.crypto.service.getObjectEncryptor(e.getChainCode())}).then(function(){return r.all([g.messages.sinkGetAllMy(g.sinkEncryptor).then(function(e){return g.ensureRequiredSinks(e)}).then(function(e){g.sinks=e}),g.srpSecure.getInitData().then(function(e){p=e}),g.loadContacts(),g.loadMailFilter(),g.loadPki(),g.loadLowUserService()])}).then(function(){return g.loadUserPreferences()}).then(function(){var e={"ui.lang":g.localeService.currentLang};return g.authData.myData.raw.notificationsEntry&&g.authData.myData.raw.notificationsEntry.email&&(e["notifications.mails"]=!0,e["notifications.chats"]=!0,e["notifications.files"]=!0,e["notifications.enabled"]=!0,e["notifications.email"]=g.authData.myData.raw.notificationsEntry.email),g.userPreferences.setMany(e,!0)}).then(function(){return y("code.publishEntry"),g.publishUserEntry()}).then(function(){y("code.createInitData");var e={};return p.forEach(function(t){e[t.type]?e[t.type]++:e[t.type]=1}),r(null).then(function(){if(e.sendMail){var t=g.findFirstPublicInbox();return g.messages.sinkSetLastSeenSeq(t.id,e.sendMail)}})}).then(function(){return I.oneByOne(p,function(e,n){return r(null).then(function(){if("addContact"==n.type)return g.createContact(n.hashmail);if("addFile"==n.type){var e=n;return g.getFilesStorage().then(function(t){return t.createBuffer("/"+e.name,new Buffer(e.content,"base64"),e.mimetype)})}if("sendMail"==n.type){var i=n;return r(null).then(function(){return i.attachments&&0!=i.attachments.length?i.attachments:d.mailResourceLoader.getResourceSafe("welcomeMailPic").then(function(e){return e?[{name:e.name,mimetype:e.mimetype,content:e.content.toString("base64")}]:[]})}).then(function(e){var n=g.findFirstPublicInbox(),r=new t.message.MessageReceiver(n,g.identity),o=g.createMessage(r,i.subject,new Buffer(i.content,"base64").toString("utf8"));return o.contentType="html",e.forEach(function(e){o.addAttachment(new C(new Buffer(e.content,"base64"),e.mimetype,e.name).asLazyBuffer())}),g.messages.messagePost(o,l.SinkIndexEntry.getMessageTags(o))})}if("addSink"==n.type){var o=n;if("anonymous"==o.sinkType)return g.messages.sinkCreate(o.name,"","anonymous",{type:"form"},g.sinkEncryptor,o.options)}}).fail(function(e){a.error("Cannot perform init data task",n,e,e.stack)})})}).fail(function(e){a.error(e,e.stack)})}).then(function(){return f})})},e.prototype.cloneSrpSecure=function(){var e=this.srpSecure.gateway;return e.rpc.clone().then(function(n){var r=new t.gateway.RpcGateway(n,e.properties),i=new t.core.PrivFsSrp(r);return new t.core.PrivFsSrpSecure(r,i,null)})},e.prototype.generateInviteToken=function(){return this.srpSecure.invite()},e.prototype.refreshSinksRegistry=function(){var e={},n=this.lowUserService.registry.storage.map;for(var r in n){var i=n[r];if(i.sink){var o=t.crypto.ecc.PrivateKey.fromWIF(i.sink.wif);e[o.getPublicKey().toBase58DER()]=o}}this.sinkIndexManager.getAllSinksEx().forEach(function(t){e[t.id]=t.priv}),this.sinkIndexManager.indexes.forEach(function(n){n.sink.options.proxyFrom&&(n.sink.registry||(n.sink.registry={map:{}}),n.sink.options.proxyFrom.list.forEach(function(r){var i=t.core.Acl.getValue(r),o=e[i];o?n.sink.registry.map[i]={type:"ecies",priv:o}:a.warn("Cannot create sink registry entry in "+n.sink.id+" for "+i)}))})},e.prototype.loadSinks=function(){var e=this;return r(null).then(function(){return e.messages.sinkGetAllMy(e.sinkEncryptor)}).then(function(t){return e.ensureRequiredSinks(t)}).then(function(t){return e.sinkIndexManager.init(t)}).then(function(){return e.loadLowUserService()}).then(function(){return e.refreshSinksRegistry()})},e.prototype.onSinkIndexManagerChange=function(e){var t=this,n=!1;this.events.hold(),u.Event.applyEvents(e,function(e,r){"init"==e&&(n=!0),null!=r&&u.Event.applyEvents(r,function(r,i,o){if("save"!=r&&"new-stats"!=r){if("new-file-stats"==r)return void(n=!0);a.debug("onSinkIndexChange",r,i,o),"index-change"==e&&(null!=r&&r.indexOf("revert")!=-1&&t.events.trigger("revert-entry",r,o),"new"==r&&i.filteredEntries.contains(o)&&o.isMailMessage()&&t.events.trigger("new-entry",o),"load"==r?(i.entries.forEach(function(e){t.verifySender(e),t.tagEntry(e)}),i.systemEntries.forEach(function(e){t.tagEntry(e)})):"delete"!=r&&null!=o&&(t.verifySender(o),t.tagEntry(o),"pki-event"===o.source.data.type&&t.handlePkiEvent(o)))}})}),this.events.release();var r=this.sinkIndexManager.getCombinedStats();this.mailUnreadCountModel.setWithCheck(h.SinkIndexStats.getUnreadByType(r,"")+h.SinkIndexStats.getUnreadByType(r,"pki-event")),n&&(this.containersUnreadCountModel.setWithCheck(this.sinkIndexManager.fileStats.getUnreadCount()),this.events.trigger("containers-change"))},e.prototype.onFilteredDomainsListChange=function(){this.publishUserEntry()},e.prototype.ensureRequiredSinks=function(e){var t=this;return r(null).then(function(){e=e||[],a.debug("ensureRequiredSinks",e);var n=!1,i=!1,o=!1,s=!1;e.some(function(e){return"outbox"==e.extra.type?n=!0:"trash"==e.extra.type?i=!0:"inbox"==e.extra.type?o=!0:"contact"==e.extra.type&&(s=!0),n&&i&&o&&s});var u=[];return n||u.push(t.messages.sinkCreate("Outbox","","private",{type:"outbox"},t.sinkEncryptor,{})),i||u.push(t.messages.sinkCreate("Trash","","private",{type:"trash"},t.sinkEncryptor,{})),o||u.push(t.messages.sinkCreate("Inbox","","public",{type:"inbox"},t.sinkEncryptor,{})),s||u.push(t.messages.sinkCreate("Contact","","anonymous",{type:"contact"},t.sinkEncryptor,{verify:"email"})),a.debug("need to create "+u.length+" required sink(s)"),r.all(u)}).then(function(n){e=e.concat(n);var r=F.Lang.find(e,function(e){return"inbox"==e.extra.type}),i=F.Lang.find(e,function(e){return"contact"==e.extra.type});return t.createSinkProxy(i,r)}).then(function(){return e})},e.prototype.createSinkProxy=function(e,t){var n=this;return r().then(function(){var i=[];return e.hasInProxyTo(t.id)||(e.addToProxyTo(t.id),i.push(n.messages.sinkSave(e,n.sinkEncryptor))),t.hasInProxyFrom(e.id)||(t.addToProxyFrom(e.id),i.push(n.messages.sinkSave(t,n.sinkEncryptor))),r.all(i).then(function(){})})},e.prototype.ensureInbox=function(e){var t=this;return r(null).then(function(){e=e||[],a.debug("ensureInbox",e);var n=!1;if(e.some(function(e){if("inbox"==e.extra.type)return n=!0,!0}),!n)return t.messages.sinkCreate("Inbox","","public",{type:"inbox"},t.sinkEncryptor,{})}).then(function(t){return t&&e.push(t),e})},e.prototype.createSink=function(e,t,n,i,o){var s=this;return a.debug("createSink",arguments),r(null).then(function(){if(i=i||{},"string"!=typeof e||""==(e=e.trim()))throw new Error(s.i18n("api.createSink.error.invalidName"));return s.sinkIndexManager.indexes.forEach(function(t,n){var r=t.sink;if(r.name==e)throw new Error(s.i18n("api.createSink.error.nameExists"));if(r.extra.type==i.type&&("outbox"==r.extra.type||"trash"==r.extra.type))throw new Error(s.i18n("api.createSink.error.sinkExists"))}),s.messages.sinkCreate(e,t,n,i,s.sinkEncryptor,o||{})}).then(function(e){return s.sinkIndexManager.addSink(e).then(function(){return s.refreshSinksRegistry()}).thenResolve(e)})},e.prototype.createInbox=function(e,t,n){var i=this;return r(null).then(function(){var r={isPrivate:!!n,type:"inbox"};return i.createSink(e,t,"public",r)}).then(function(e){return e.extra.isPrivate||i.publishUserEntry(),e})},e.prototype.getSinkById=function(e){return this.sinkIndexManager.getSinkById(e)},e.prototype.getSinkIndexById=function(e){return this.sinkIndexManager.getIndexBySinkId(e)},e.prototype.createFolder=function(e){return a.debug("createFolder"),this.createSink(e,"","private",{type:"folder"})},e.prototype.createTrash=function(){return a.debug("createTrash"),this.createSink("Trash","","private",{type:"trash"})},e.prototype.createOutbox=function(){return a.debug("createOutbox"),this.createSink("Sent","","private",{type:"outbox"})},e.prototype.createSecureFormInbox=function(e,t,n){return a.debug("createSecureFormInbox"),this.createSink(e,"","anonymous",{type:"form",privfsClientInfo:t},n)},e.prototype.getAllSecureFormInboxes=function(){var e=this.sinks||this.sinkIndexManager.getAllSinks();return e.filter(function(e){return"anonymous"==e.acl&&"form"==e.extra.type})},e.prototype.deleteSecureFormInbox=function(e){var t=this,n=this.getSinkById(e);return this.messages.sinkDelete(n).then(function(){return t.sinkIndexManager.removeSink(n)})},e.prototype.getTrash=function(){return this.findFirstSinkByType("trash")},e.prototype.getOutbox=function(){return this.findFirstSinkByType("outbox")},e.prototype.findFirstPublicInbox=function(){return this.findFirstSinkByType("inbox","public")},e.prototype.findFirstSinkByType=function(e,t){for(var n=this.sinks||this.sinkIndexManager.getAllSinks(),r=0;r<n.length;r++){var i=n[r];if(i.extra.type==e&&(null==t||t==i.acl))return i}return null},e.prototype.sendSimpleMessage=function(e){return this.messages.messagePost(e,l.SinkIndexEntry.getMessageTags(e))},e.prototype.sendMessage=function(e,t){a.debug("sendMessage",e);var n,i,o,s=this;return r(null).then(function(){return n=s.getOutbox(),i={read:!0,verified:null,tagged:!0},s.messageSenderVerifier.verifyMessageCore2(e.sender,new Date).then(function(e){i.verified=e.verified}).fail(function(e){a.error("Error during verifying yourself ...",e)})}).then(function(){return l.SinkIndexEntry.getAllTags(s.tagStorage,e,i)}).then(function(r){return o=r,s.messages.messagePost(e,l.SinkIndexEntry.getMessageTags(e),{outbox:{sink:n,tags:o,flags:i},extra:t||""})}).then(function(t){a.debug("after messagePost");var r={message:e,info:t.results,errors:t.errors,nooneGetMsg:t.nooneGetMsg,full:t,outMessage:t.outboxMessage,outSink:n};if(r.nooneGetMsg||t.outboxError)throw new P("sendMessageError",r);var u=s.sinkIndexManager.getIndexBySink(n);if(u.addEntry(r.outMessage.source,i,o),a.debug("added to outbox"),r.errors>0)throw new P("sendMessageError",r);return r})},e.prototype.resendMessage=function(e){var t,n,i,o,s,a,u=this;return r(null).then(function(){var r=e.getMessage();if(r.sender.pub58!=u.identity.pub58)throw new Error(u.i18n("api.resendMessage.error.invalidSender"));
return r.hasNotSent()?(a=[],r.receivers.forEach(function(e){e.sent===!1&&a.push(e)}),t=u.messages.convertMessageToRaw(r,e.index.sink),t.setSender(u.identity),n=u.getOutbox(),i=e.data,l.SinkIndexEntry.getAllTags(u.tagStorage,t,i)):[]}).then(function(e){return o=e,u.messages.messageResend(t,l.SinkIndexEntry.getMessageTags(t),a,{outbox:{sink:n,tags:o,flags:i}})}).then(function(r){if(s={message:t,info:r.results,errors:r.errors,nooneGetMsg:r.nooneGetMsg,full:r,outMessage:r.outboxMessage,outSink:n},s.nooneGetMsg||r.outboxError)throw new P("sendMessageError",s);var a=u.sinkIndexManager.getIndexBySink(n);return a.addEntry(s.outMessage.source,i,o),a.deleteEntry(e.id)}).then(function(){if(s.errors>0)throw new P("sendMessageError",s);return s})},e.prototype.getMessagePostError=function(e){var n=this,r=function(e){if(a.error("Message post error",e,e.stack),t.core.ApiErrorCodes.isError(e))return t.core.ApiErrorCodes.is(e,"HOST_BLACKLISTED")?n.i18n("api.messagePostError.blacklist"):n.i18n("api.messagePostError.rpc",[e.data.error.code]);if(t.core.ApiErrorCodes.isConnectionError(e)){if(0===e.data.status)return n.i18n("api.messagePostError.connection");if(400==e.data.status&&"object"==typeof e.data.response)return e.data.response.msg}return n.i18n("api.messagePostError.unknown")};if("sendMessageError"==e.message){var i="";if(0==e.data.errors&&(i+=this.i18n("api.messagePostError.validPost")),1==e.data.info.length){if(e.data.errors>0){var o=e.data.info[0];i=this.i18n("api.messagePostError.send",[o.receiver.user,r(o.couse)])}}else{i=e.data.nooneGetMsg?this.i18n("api.messagePostError.sendMany.noone"):this.i18n("api.messagePostError.sendMany.some");for(var s in e.data.info){var o=e.data.info[s];o.success||(i+="\n"+o.receiver.user+" ("+r(o.couse)+")")}}return e.data.full.outboxError&&(i+="\n"+this.i18n("api.messagePostError.outboxError")),{savedToOutbox:!e.data.nooneGetMsg,msg:i}}return{savedToOutbox:!1,msg:this.i18n("api.messagePostError.general",[e])}},e.prototype.moveMessage=function(e,t){var n=this;return r(null).then(function(){var r=n.sinkIndexManager.getIndexBySink(e.sink),i=n.sinkIndexManager.getIndexBySink(t);if(null==r||null==i)throw new Error(n.i18n("api.error.indexNotFound"));return r.moveEntry(e.id,i)})},e.prototype.moveToTrash=function(e){return this.moveMessage(e,this.getTrash())},e.prototype.resolveHashmailEx=function(e,n){var i=this;return r(null).then(function(){return e=e instanceof t.identity.Hashmail?e:new t.identity.Hashmail(e),i.getLowUser(e.user,e.host)}).then(function(r){if(null==r)return i.resolveHashmail(e,n);var o=t.message.MessageSinkPriv.fromSerialized(r.sink.wif,"","","public",null,null),s=t.identity.Identity.fromSerialized(e,r.identity.wif,r.email),a=new t.message.MessageReceiver(o,s);return{data:{keystore:null,user:s,profile:{name:r.email,sinks:[o]}},receivers:[a]}})},e.prototype.resolveHashmail=function(e,n){var i=this;return r(null).then(function(){return e=e instanceof t.identity.Hashmail?e:new t.identity.Hashmail(e),i.srpSecure.getUserInfo(e.user,e.host,n?["info","image"]:["info"]).then(function(e){var n=[];if(null!=e.profile.sinks&&null!=e.profile.sinks)for(var r=0;r<e.profile.sinks.length;r++)n.push(new t.message.MessageReceiver(e.profile.sinks[r],e.user));return{data:e,receivers:n}})})},e.prototype.verifySender=function(e){return this.messageSenderVerifier.verify(e)},e.prototype.tagEntry=function(e){return this.messageTagger.tag(e)},e.prototype.createMessage=function(e,n,r){var i=Array.isArray(e)?e:[e],o=new t.message.Message;return o.setSender(this.identity),i.forEach(function(e){o.addReceiver(e)}),o.title=n,o.text=r,o},e.prototype.getSinkIndexEntry=function(e,t){var n=this;return r(null).then(function(){var r=n.sinkIndexManager.getIndexBySink(e),i=r.getEntry(t);if(null==i)throw new Error(n.i18n("api.error.entryNotFound"));return i})},e.prototype.getSinkIndexEntries=function(e,t){var n=this;return r(null).then(function(){var r=n.sinkIndexManager.getIndexBySink(e);return t.map(function(e){var t=r.getEntry(e);if(null==t)throw new Error(n.i18n("api.error.entryNotFound"));return t})})},e.prototype.getMessage=function(e,t){return this.getSinkIndexEntry(e,t).then(function(e){return e.getMessage()})},e.prototype.getMessages=function(e,t){return this.getSinkIndexEntries(e,t).then(function(e){return e.map(function(e){return e.getMessage()})})},e.prototype.deleteMessage=function(e,t){var n=this;return r(null).then(function(){if("trash"==e.sink.extra.type||t){var r=n.sinkIndexManager.getIndexBySink(e.sink);if(null==r)throw new Error(n.i18n("api.error.indexNotFound"));return r.deleteEntry(e.id)}return n.moveToTrash(e)})},e.prototype.emptyTrash=function(){var e=this;return r(null).then(function(){var t=e.sinkIndexManager.getIndexBySink(e.getTrash());if(null==t)throw new Error(e.i18n("api.error.indexNotFound"));return t.clear()})},e.prototype.getAttachmentContent=function(e,t){return this.messages.download(e.sink,e,t,!0)},e.prototype.getAttachmentDataUrl=function(e,t){var n=this;return r(null).then(function(){return t.cachedDataUrl?t.cachedDataUrl:r(null).then(function(){return n.getAttachmentContent(e,t)}).then(function(e){return t.cachedDataUrl=e.getDataUrl(),t.cachedDataUrl})})},e.prototype.holdChangeEvent=function(){this.sinkIndexManager.holdChangeEventDeep(),this.events.hold()},e.prototype.releaseChangeEvent=function(){this.sinkIndexManager.releaseChangeEventDeep(),this.events.release()},e.prototype.setMessageReadStatus=function(e,t){return this.updateMessageFlag(e,"read",t)},e.prototype.setMessagesReadStatus=function(e,t){var n=this;return r(null).then(function(){var r={};for(var i in e){var o=e[i];if(o.isRead()!=t){var s=o.index.sink.id;s in r||(r[s]={index:o.index,entries:[]}),r[s].entries.push(o)}}return n.holdChangeEvent(),I.oneByOne(r,function(e,r){return r.index.holdChangeEvent(),I.oneByOne(r.entries,function(e,r){return n.setMessageReadStatus(r,t)}).fin(function(){r.index.releaseChangeEvent()})}).fin(function(){n.releaseChangeEvent()})})},e.prototype.publishUserEntry=function(){var e=this;return r(null).then(function(){return a.debug("Publishing user entry..."),e.buildNotificationsEntry()}).then(function(t){var n=e.localeService.getLang(e.userPreferences?e.userPreferences.getValue("ui.lang"):""),r=e.sinkIndexManager?e.sinkIndexManager.getContactFormSink():null;return e.srpSecure.setUserPreferences(n,t,null==r?null:r.id)}).then(function(){var t=e.buildUserInfoProfile();if(!e.comparePkiProfiles(t,e.authData.myData.userInfo.profile))return r(null).then(function(){return e.srpSecure.setUserInfo(e.identity,t)}).then(function(){e.authData.myData.userInfo.profile=t})}).fail(function(e){return a.error(e,e.stack),r.reject(e)})},e.prototype.buildNotificationsEntry=function(){var e=this;return r(null).then(function(){var t=[];return e.userPreferences.getValue("notifications.mails",!1)&&(t.push(l.SinkIndexEntry.getMessageTypeTag("mail")),t.push(e.messages.tagService.getUnecryptedTag(l.SinkIndexEntry.getMessageTypeTag("form")))),e.userPreferences.getValue("notifications.chats",!1)&&t.push(l.SinkIndexEntry.getMessageTypeTag("chat-message")),e.userPreferences.getValue("notifications.files",!1)&&t.push(l.SinkIndexEntry.getMessageTypeTag("container-event")),e.messages.tagService.createTags(e.identity.pub,t)}).then(function(t){var n=e.mailFilter.getDeniedDomains();return{enabled:e.userPreferences.getValue("notifications.enabled",!1),email:e.userPreferences.getValue("notifications.email",""),tags:t,ignoredDomains:n}})},e.prototype.buildUserInfoProfile=function(){var e={};if(e.sinks=[],(this.sinks||this.sinkIndexManager.getAllSinks()).forEach(function(t){"inbox"!=t.extra.type||t.extra.isPrivate||e.sinks.push(t)}),this.userPreferences&&this.userPreferences.data.profile){e.name=this.userPreferences.data.profile.name||void 0,e.description=this.userPreferences.data.profile.description||void 0;var t=this.userPreferences.data.profile.image;e.image=t?N.ImageTypeDetector.extractBufferFromDatatUrl(t):void 0}return e},e.prototype.loadTags=function(){var n=this;return this.getStorage().then(function(n){return t.message.TagStorage.create(n,e.TAGS_FILENAME)}).then(function(e){n.tagStorage=e})},e.prototype.loadMailFilter=function(){var t=this;return this.getStorage().then(function(n){var r={};return r[t.identity.host]={mode:R.FilterMode.ALLOW},M.MailFilter.create(n,e.MAIL_FILTER_FILENAME,r)}).then(function(e){t.mailFilter=e,t.unknownDomainsCountModel=t.mailFilter.unknownDomains.count,t.unknownDomainsMessagesCountModel=t.mailFilter.unknownDomains.messagesCount,t.mailFilter.listChangeEvent.add(t.onFilteredDomainsListChange.bind(t))})},e.prototype.loadPki=function(){var n,i=this;return this.srpSecure.privmxPKI=new t.pki.PrivmxPKI(this.gateway,this.gateway.getHost()),r.all([this.client.getConfig(),this.loadPkiCache()]).then(function(t){var o=t[0];return n=o.maxCosigners,(n<=0||n>=e.MAX_COSIGNERS)&&(n=e.MAX_COSIGNERS),r(null).then(function(){return i.srpSecure.getPublishedCosigners()}).then(function(e){if(0==Object.keys(e).length)throw new Error("Empty cosigners list");return e}).fail(function(e){a.debug("Cannot load cosigners, fixing...",e,e?e.stack:null);var t={};return r(null).then(function(){return i.srpSecure.privFsSrp.getServerKeystoreWithoutCosigners()}).then(function(e){if(t[i.gateway.getHost()]=e,i.isAdmin()){var n={state:"ACTIVE",uuid:i.generateUUID(),hashmail:i.identity.hashmail,keystore:e};r.all([i.srpSecure.publishCosigners(i.identity.priv,t),i.srpSecure.setCosigner(i.gateway.getHost(),n)]).fail(function(e){a.error("Cannot publish cosigner",e,e?e.stack:null)})}return t})})}).then(function(e){i.trustedServers=new t.pki.CosignersProvider.CosignersProvider(e,n),i.srpSecure.privmxPKI=new t.pki.PrivmxPKI(i.gateway,i.gateway.getHost(),i.trustedServers,i.pkiCache,i.pkiCache)})},e.prototype.loadPkiCache=function(){var t=this;return this.getStorage().then(function(t){return B.PkiCache.create(t,e.PKI_CACHE_FILENAME,{})}).then(function(e){t.pkiCache=e})},e.prototype.loadContacts=function(){var t=this;return this.getStorage().then(function(n){return a.debug("Loading contacts..."),n.optReadJson(e.CONTACTS_FILENAME,{version:1,items:[]}).then(function(e){return t.contactCollection=new b.MutableCollection(f.Contact.deserializeMany(e.items)),t.contactCollection.version=e.version,t.persons=new w.Persons(t.contactCollection,t),t.contactCollection})})},e.prototype.saveContacts=function(){var t=this;return this.getStorage().then(function(n){return a.debug("Saving contacts..."),n.saveJson(e.CONTACTS_FILENAME,{version:t.contactCollection.version,items:f.Contact.serializeMany(t.contactCollection.list)}).then(function(){})})},e.prototype.convertProfile=function(e){return{name:e.name,description:e.description,image:null==e.image?null:N.ImageTypeDetector.createDataUrlFromBuffer(e.image)}},e.prototype.createContact=function(e){var t=this;return r(null).then(function(){var n=t.getContactByHashmail(e);return null!=n?n:t.resolveHashmail(e,!0).then(function(e){var n=new f.Contact;if(n.user=e.data.user,n.user.name=null,n.sinks=[],n.starred=!1,n.profile=t.convertProfile(e.data.profile),null!=e.data.profile.sinks)for(var r=0;r<e.data.profile.sinks.length;r++)n.sinks.push(e.data.profile.sinks[r]);return t.contactCollection.add(n),t.saveContacts().then(function(){return n})})})},e.prototype.createEmailContact=function(e){var t=this;return r().then(function(){var n=t.getContactByHashmail(e);return null!=n?n:(n=new f.Contact,n.type=f.ContactType.EMAIL,n.email=e,t.contactCollection.add(n),t.saveContacts().thenResolve(n))})},e.prototype.addEmailToContacts=function(e){return this.createEmailContact(e).then(function(){})},e.prototype.addToContacts=function(e,t,n){var i=this;a.debug("Adding to contacts...");var o=!1;return r().then(function(){var n=i.getContactByHashmail(e.hashmail);if(n){if(t){for(var r=null,s=0;s<n.sinks.length;s++)if(n.sinks[s].id==t.id){r=n.sinks[s];break}r||(n.sinks.push(t),i.contactCollection.updateElement(n),o=!0)}}else n=new f.Contact,n.user=e,n.sinks=[],n.starred=!1,n.profile={},t&&n.sinks.push(t),i.contactCollection.add(n),o=!0;return n}).then(function(e){return o?i.saveContacts().then(function(){return e}):e}).then(function(){n&&i.refreshContact(e.hashmail)})},e.prototype.refreshIdentityContact=function(){var e=this.buildUserInfoProfile();this.persons.updateIdentity(this.identity,e,this.compareProfiles.bind(this));var t=this.getPerson(this.identity.hashmail);if(t&&t.hasContact()){var n=t.getContact();n.user&&n.user.name&&n.user.name!=n.profile.name&&(n.user.name=n.profile.name,this.updateContact(n).fail(function(e){a.error("Error during updating identity contact",e)}))}},e.prototype.getPerson=function(e){var t=this.getLowUserByHashmail(e);return this.persons.get(t?t.email:e)},e.prototype.getPersonProxy=function(e){var t=this.getLowUserByHashmail(e.hashmail);return this.persons.getProxyEx(t?t.email:e.hashmail,e)},e.prototype.getContactByHashmail=function(e){return this.contactCollection.find(function(t){return t.getHashmail()==e})},e.prototype.getContactByPub58=function(e){return this.contactCollection.find(function(t){return t.user&&t.user.pub58==e})},e.prototype.deleteContact=function(e){return this.contactCollection.remove(e),this.saveContacts()},e.prototype.updateContact=function(e){var t=this;return this.saveContacts().then(function(){t.contactCollection.updateElement(e)})},e.prototype.hashmailInContacts=function(e){return null!=this.getContactByHashmail(e)},e.prototype.getMessagesByConversationId=function(e){var t=this;return r(null).then(function(){if(a.debug("getMessagesByConversationId",e),t.messageCollectionsByHashmail.has(e))return t.messageCollectionsByHashmail.get(e);var n=new v.FilteredCollection(t.sinkIndexManager.filteredMessagesCollection,function(n){return"trash"!=n.index.sink.extra.type&&e==t.getConversationId(n)});return t.messageCollectionsByHashmail.put(e,n),n})},e.prototype.refreshContact=function(e,t){var n=this;return r(null).then(function(){var r=n.getContactByHashmail(e);if(!r){if(t)return null;throw new Error(n.i18n("api.error.contactNotFound"))}if(!r.isEmail())return n.resolveHashmail(e,!0).then(function(e){var t=n.convertProfile(e.data.profile);if(!n.compareProfiles(r.profile,t))return r.profile=t,n.updateContact(r).then(function(){return r})})})},e.prototype.addUserToContactCore=function(e,t,n,i,o){if("anonymous"==e.user)return r(null);var s=this.getLowUserByUser(e);return null!=s?this.addEmailToContacts(s.email):n===!1||null==this.getContactByHashmail(e.hashmail)?this.addToContacts(e,t,i!==!1):o?this.refreshContact(e.hashmail).then(function(){}):void 0},e.prototype.addSenderToContacts=function(e,t,n){var r=e.getMessage();if(e.isContactFormMessage()){var i=e.getContactFormMessageSender();return this.addEmailToContacts(i)}return this.addUserToContactCore(r.sender,null,!0,t,n)},e.prototype.addReceiverToContacts=function(e,t){return this.addUserToContactCore(e.user,e.sink,!1,t)},e.prototype.addSenderAndReceiversToContacts=function(e){var t=this,n=e.getMessage();this.addSenderToContacts(e,!0,!0),n.receivers.forEach(function(e){t.addReceiverToContacts(e,!1)})},e.prototype.compareProfiles=function(e,t){return e.description==t.description&&e.image==t.image&&e.name==t.name},e.prototype.comparePkiProfiles=function(e,t){if(e.sinks!=t.sinks&&(null==e.sinks||null==t.sinks||e.sinks.length!=t.sinks.length))return!1;for(var n=0;n<e.sinks.length;n++)if(e.sinks[n].id!=t.sinks[n].id||e.sinks[n].name!=t.sinks[n].name||e.sinks[n].description!=t.sinks[n].description)return!1;return!!(e.image==t.image||null!=e.image&&null!=t.image&&e.image.equals(t.image))&&(e.name==t.name&&e.description==t.description)},e.prototype.getConversationId=function(e){var t=T.ConversationId.createFromIndexEntry(e);return 1==t.length()&&t.contains(this.identity.hashmail)||t.remove(this.identity.hashmail),t.toString()},e.prototype.getConversationCollectionObject=function(){if(null==this.conversationCollection){var e=new v.FilteredCollection(this.sinkIndexManager.filteredMessagesCollection,function(e){return"trash"!=e.index.sink.extra.type});this.conversationCollection=new E.ConversationsCollection(this,e)}return this.conversationCollection},e.prototype.getConversationCollection=function(){return this.getConversationCollectionObject().getCollection()},e.prototype.addPredefinedConversation=function(e){return this.getConversationCollectionObject().addPredefined(e)},e.prototype.getConversation=function(e){return this.getConversationCollectionObject().getConversation(e)},e.prototype.hasConversation=function(e){return this.getConversationCollectionObject().hasConversation(e)},e.prototype.shareContainer=function(e,t){var n,i,o,s=this;return this.getContainersStorage().then(function(t){return o=t,o.stat(e.path)}).then(function(a){if(n=a,!n.entry.isDirectory())throw new Error(s.i18n("api.error.cannotShareFile"));if(!n.meta.sharing||!n.meta.sharing.users||n.meta.sharing.users.indexOf(t)==-1)return r(null).then(function(){return s.resolveHashmail(t)}).then(function(e){if(!e.receivers.length)throw new Error(s.i18n("api.error.cannotShareContainerNoPublicSink"));return i=s.createMessage(e.receivers[0],"",JSON.stringify({did:n.entry.ref.did,url:n.entry.ref.url,path:"/",type:"share",data:{xpriv:n.entry.ref.extPriv58,name:n.entry.name}})),i.setType("container-event"),s.messages.messagePost(i,l.SinkIndexEntry.getMessageTags(i))}).then(function(){return o.updateMeta(e.path,function(e){e.sharing||(e.sharing={users:[],lastUpdated:null}),e.sharing.lastUpdated=(new Date).getTime(),e.sharing.users||(e.sharing.users=[s.identity.hashmail]),e.sharing.users.indexOf(t)==-1&&e.sharing.users.push(t)})}).then(function(){return s.containerChange(e,"share-add-user")})})},e.prototype.shareContainerToMany=function(e,t){var n=this;return I.oneByOne(t,function(t,r){return n.shareContainer(e,r)})},e.prototype.containerChange=function(e,t,n){return this.containerChangeEx(e,e.path,t,n)},e.prototype.containerChangeEx=function(e,t,n,i){var o,s,u,c,f=this,l=[];return this.getContainersStorage().then(function(h){if(c=h,e.tree.storage==c)return r(null).then(function(){return o=e.getNextAfterRoot().path,s=t.substring(o.length),c.stat(o)}).then(function(e){if(u=e,null!=u.meta.sharing&&0!=u.meta.sharing.users.length)return r(null).then(function(){return I.oneByOne(u.meta.sharing.users,function(e,t){if(t!=f.identity.hashmail)return r(null).then(function(){return f.resolveHashmail(t)}).then(function(e){e.receivers.length>0&&l.push(e.receivers[0])}).fail(function(e){a.debug("Cannot resolve hashmail "+t,e)})})}).then(function(){if(0!=l.length){var e=f.createMessage(l,"",JSON.stringify({did:u.entry.ref.did,url:u.entry.ref.url,path:s,type:n,data:i}));return e.setType("container-event"),f.sendMessage(e)}}).then(function(){})})})},e.prototype.handlePkiEvent=function(e){var n=this;return r(null).then(function(){if("pki-event"===e.source.data.type){var r=e.getContentAsJson();if(null!==r&&!e.isProcessed()&&!e.proceeding){e.proceeding=!0,a.debug("pki event",r);var i;switch(r.type){case"invite":var o={state:"INVITED",uuid:r.uuid,hashmail:r.hashmail,keystore:t.pki.Helper.decodeKeystore(r.keystore)},s=r.hashmail.split("#")[1];i=n.srpSecure.setCosigner(s,o);break;case"accepted":i=n.srpSecure.getCosigners().then(function(e){for(var t in e){var i=e[t];if(i.uuid===r.uuid&&"ACTIVE"!==i.state)return n.srpSecure.setCosigner(t,{state:"ACTIVE",hashmail:i.hashmail,keystore:i.keystore,uuid:i.uuid})}});break;case"removed":i=n.srpSecure.getCosigners().then(function(e){for(var t in e)if(e[t].uuid===r.uuid)return n.srpSecure.removeCosigner(t,r.uuid)});break;default:a.warn("Unexpected pki event type",r)}return null!==i?i.then(function(){return n.updateMessageFlag(e,"processed",!0)}):n.updateMessageFlag(e,"processed",!0)}}}).fail(function(e){a.error("Error during processing pki-event",e)})},e.prototype.handleContainerEvent=function(e){var n,i=this;return r(null).then(function(){if(!e.isRead()&&"container-event"==e.source.data.type){var r=e.getContentAsJson();if(null!=r){if(e.source.data.sender.pub58==i.identity.pub58)return i.setMessageReadStatus(e,!0);if("share-add-user"==r.type&&!e.isProcessed())return void i.events.trigger("container-share",r.url+r.did);if("share"==r.type&&!e.isProcessed()&&!e.proceeding){e.proceeding=!0,a.debug("share container event",r),n=t.fs.descriptor.ref.DescriptorRefWrite.fromExtKey(r.data.xpriv,r.url);var o,s=new t.fs.file.entry.Entry(r.data.name,"directory",n),u="/";return i.getContainersStorage().then(function(e){return o=e,o.list(u)}).then(function(e){var t=e.some(function(e){return e.ref.equals(n)});if(!t){var r=e.some(function(e){return e.name==s.name});return r&&(s.name+="-"+(new Date).getTime()),o.link(u,s)}}).then(function(){return e.proceeding=!1,i.updateMessageFlag(e,"processed",!0)}).then(function(){i.events.trigger("container-share",n.id)})}}}}).fail(function(e){return a.error(e,e.stack),r.reject(e)})},e.prototype.getContainerStatsEntry=function(e){var t=e.getNextAfterRoot();if(null==t)return null;var n=e.path.substring(t.path.length)||"/";return this.sinkIndexManager.fileStats.getFileStatsEntry(t.ref.id,n)},e.prototype.getContainerStats=function(e){var t=this.getContainerStatsEntry(e);return null==t?{unread:0,groups:[]}:{unread:t.getUnreadCount(),groups:t.getGroupedEntries()}},e.prototype.setContainerEventsReadStatus=function(e,t,n){var i=this;return r(null).then(function(){var r=i.getContainerStatsEntry(e);if(null!=r){var o=n?r.getEntriesRecursive():r.getEntries();return i.setMessagesReadStatus(o,t)}})},e.prototype.getContainerVisibility=function(e){return null==this.containersSettings||null==this.containersSettings[e.ref.id]||!!this.containersSettings[e.ref.id].visibility},e.prototype.setContainerVisibility=function(t,n){var r=this;return this.getContainersStorage().then(function(i){return t.ref.id in r.containersSettings||(r.containersSettings[t.ref.id]={visibility:null}),r.containersSettings[t.ref.id].visibility=n,r.sinkIndexManager.fileStats.updateContainersVisibility(r.containersSettings),r.containersUnreadCountModel.setWithCheck(r.sinkIndexManager.fileStats.getUnreadCount()),i.saveJson(e.CONTAINERS_SETTINGS_FILENAME,r.containersSettings)}).then(function(){r.events.trigger("containers-change","container-visibility",t,n)})},e.prototype.loadContainersSettings=function(){var t=this;return this.getContainersStorage().then(function(t){return t.optReadJson(e.CONTAINERS_SETTINGS_FILENAME,{})}).then(function(e){t.containersSettings=e})},e.prototype.isStatusPublishingEnabled=function(){return this.presenceModel.get()},e.prototype.enableStatusPublishing=function(){return a.debug("enableStatusPublishing"),this.presenceModel.set(!0),this.publishStatus()},e.prototype.disableStatusPublishing=function(){return a.debug("disableStatusPublishing"),this.presenceModel.set(!1),this.publishStatus()},e.prototype.publishStatus=function(){var e=this;return r(null).then(function(){a.debug("publishStatus");var t=e.isStatusPublishingEnabled()?e.userPreferences.getValue("presence.type","noone"):"noone";return e.publishStatusCore("",t)})},e.prototype.publishStatusCore=function(e,t){var n=this;return r(null).then(function(){if(a.debug("publishStatusCore",t),!n.publishingStatus){n.publishingStatus=!0;var r="contact"==t||"starred"==t?n.getContactsAcl("starred"==t):{type:t};return a.debug("publishStatusCore acl",r),n.srpSecure.setUserPresence(e,r,n.identity.priv)}}).fin(function(){n.publishingStatus=!1})},e.prototype.getContactsAcl=function(e){var t={type:"whitelist",pubs:[]};return this.contactCollection.forEach(function(n){n.isPrivmx()&&(0==e||n.isStarred())&&t.pubs.push(n.user.pub)}),t},e.prototype.refreshContactsPresence=function(e){var t=this;return r(null).then(function(){a.debug("refreshContactsPresence");var n=[];return t.contactCollection.forEach(function(e){n.push(e.user)}),t.srpSecure.getUsersPresence(n,t.identity.priv).then(function(r){for(var i=!1,o=0;o<n.length;o++){var s=n[o],a=null==r[s.hashmail]?null:r[s.hashmail].presence,u=t.getContactByHashmail(s.hashmail);if(null!=u){var c=t.presenceEquals(u.presence,a,e);u.presence=a,c||(i=!0,t.contactCollection.updateElement(u))}}i&&t.updateStarredContactsPresenceModel()})})},e.prototype.updateStarredContactsPresenceModel=function(){var e=this.starredContactsPresenceModel.get(),t=[],n=0;this.contactCollection.forEach(function(r){if(r.isStarred()){var i=r.getHashmail();r.presence&&(t.push(i),e.currentState.indexOf(i)==-1&&n++)}}),this.starredContactsPresenceModel.set({currentState:t,newCount:n})},e.prototype.presenceEquals=function(e,t,n){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null!=e&&null!=t){if(e.status!=t.status)return!1;if(n&&e.timestamp!=t.timestamp)return!1}return!0},e.prototype.publishPresenceLoop=function(){var e=this;return r(null).then(function(){e.isStatusPublishingEnabled()&&e.publishStatus(),e.publishPresenceInterval=setInterval(function(){e.networkActivityIsPaused()||(a.debug("publish presence",e.isStatusPublishingEnabled()),e.isStatusPublishingEnabled()&&e.publishStatus())},6e4)})},e.prototype.checkPresenceLoop=function(){var e=this;return r(null).then(function(){e.refreshContactsPresence(),e.checkPresenceInterval=setInterval(function(){e.networkActivityIsPaused()||e.refreshContactsPresence()},6e4)})},e.prototype.updateMessageFlagsEx=function(e,t){var n=this;return r(null).then(function(){var r=n.sinkIndexManager.getIndexBySink(e.sink);if(null==r)throw new Error(n.i18n("api.error.indexNotFound"));return r.updateEntry(e.id,t)})},e.prototype.updateMessageFlag=function(e,t,n){return this.updateMessageFlagsEx(e,function(e){return e=e||{},e[t]!==n&&(e[t]=n,e)})},e.prototype.updateMessageFlags=function(e,t){return this.updateMessageFlagsEx(e,function(e){e=e||{};for(var n=!1,r=0;r<t.length;r++)e[t[r].name]!==t[r].value&&(e[t[r].name]=t[r].value,n=!0);return!!n&&e})},e.prototype.getAttachmentsCollection=function(e){if(null==this.attachmentsCollectionMap[e.id]){var t=this.sinkIndexManager.getIndexBySink(e),n=new v.FilteredCollection(t.filteredEntries,function(e){return null!=e.source.data&&null!=e.source.data.attachments&&e.source.data.attachments.length>0}),r=function(e,t,n){return{entry:e,attachment:t,id:e.sink.id+"/"+e.source.serverId+"/"+n}},i=[];n.forEach(function(e){e.getMessage().attachments.forEach(function(t,n){i.push(r(e,t,n))})});var o=new b.MutableCollection(i);n.changeEvent.add(function(e){"add"==e.type?e.element.getMessage().attachments.forEach(function(t,n){o.add(r(e.element,t,n))}):"remove"==e.type?o.removeBy("entry",e.element):"clear"==e.type&&o.clear()}),this.attachmentsCollectionMap[e.id]=o}return this.attachmentsCollectionMap[e.id]},e.prototype.pollSinkIfNeeded=function(e){var t=this.sinkIndexManager.getIndexBySink(e);t.needUpdate&&this.sinkIndexManager.sinkPolling&&this.sinkIndexManager.sinkPolling.kick()},e.prototype.getMailsCollection=function(e){return null==this.mailsCollectionsMap[e.id]&&(this.mailsCollectionsMap[e.id]=new v.FilteredCollection(this.sinkIndexManager.getIndexBySink(e).filteredEntries,function(e){return!e.source.data.type||"pki-event"==e.source.data.type})),this.mailsCollectionsMap[e.id]},e.prototype.getSinksIndexCollection=function(){return this.sinkIndexManager.sinkIndexCollection},e.prototype.getLastMessageByType=function(e,t,n){var r=Array.isArray(t)?t:[t];return this.getMessagesByConversationId(e).then(function(t){var i;return t.forEach(function(t){if(!i||t.source.serverDate>i.source.serverDate){var o=t.source.data.type||"";r.indexOf(o)!==-1&&(!n||n&&t.source.data.sender.hashmail==e)&&(i=t)}}),i})},e.prototype.getLastMailMessage=function(e,t){return this.getLastMessageByType(e,["","pki-event"],t)},e.prototype.countMessagesByType=function(e,t){return this.getMessagesByConversationId(e).then(function(n){var r={};return n.forEach(function(n){var i=n.source.data.type||"";(!t||t&&n.source.data.sender.hashmail==e)&&(r[i]=r[i]?r[i]+1:1)}),r})},e.prototype.userHasStarredContacts=function(){var e=this.contactCollection.getEnumerable();return 0!=e.length&&e.some(function(e){return e.isStarred()})},e.prototype.getTheOldestMessages=function(e){var t=this;return r(null).then(function(){var n=[],r=t.sinkIndexManager.indexes.getEnumerable();for(var i in r)n.push({i:0,list:r[i].entries.getEnumerable()}),n.push({i:0,list:r[i].systemEntries.getEnumerable()});for(var o=[],s=0;s<e;s++){for(var a=null,u=null,c=0;c<n.length;c++){var f=n[c];if(!(f.i>=f.list.length)){var l=f.list[f.i];(null==a||l.source.serverDate<a.source.serverDate)&&(a=l,u=f)}}if(null==a)break;u.i++,o.push(a)}return o})},e.getStringUtf8Length=function(e){for(var t=e.length,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2,r>=56320&&r<=57343&&n--)}return t},e.safePathName=function(e){return e.replace(/[^a-z0-9]/gi,"_")},e.prototype.getSizeOfTheOldestMessages=function(t){var n=this;return r(null).then(function(){return n.getTheOldestMessages(t)}).then(function(t){var n=0;return t.forEach(function(t){n+=e.getStringUtf8Length(JSON.stringify(t.source)),t.source.data&&t.source.data.attachments&&t.source.data.attachments.forEach(function(e){n+=e.size})}),n})},e.prototype.exportMessages=function(t,n){var i=this,o=y.pack(),s=[];return r(null).then(function(){return i.getTheOldestMessages(t)}).then(function(t){var n=r.defer();return I.oneByOne(t,function(s,a){n.notify({current:s,count:t.length});var u=a.index.sink,c=u.id+(u.extra&&u.extra.type?"_"+e.safePathName(u.extra.type):"");if(o.entry({name:c+"/"+a.id+".msg"},JSON.stringify(a.source)),a.source.data&&a.source.data.attachments&&0!=a.source.data.attachments.length){var f=a.getMessage();return I.oneByOne(f.attachments,function(t,n){return r(null).then(function(){return i.getAttachmentContent(a,n)}).then(function(r){o.entry({name:c+"/"+a.id+"_"+t+"_"+e.safePathName(n.name)},r.buffer)})})}}).then(function(){o.finalize()}).fail(n.reject),o.on("data",function(e){s.push(e)}),o.on("end",n.resolve),n.promise}).then(function(){return new C(Buffer.concat(s),"application/x-tar",n)})},e.prototype.deleteMessages=function(e){var t=this;return r(null).then(function(){return t.holdChangeEvent(),t.getTheOldestMessages(e)}).then(function(e){return I.oneByOne(e,function(e,t){return t.index.deleteEntry(t.id)})}).fin(function(){t.releaseChangeEvent()})},e.prototype.getReceivers=function(e){var t=this;return r(null).then(function(){if(0==e.length)return[];var n=[];return e.forEach(function(e){var i=r(null).then(function(){return t.resolveHashmail(e)}).then(function(t){return t.receivers?t.receivers[0]:e}).fail(function(t){return e});n.push(i)}),r.all(n)})},e.prototype.getValidReceivers=function(e){var n=this;return r(null).then(function(){return n.getReceivers(e)}).then(function(e){var n=[];if(e.forEach(function(e){e instanceof t.message.MessageReceiver||n.push(""+e)}),n.length>0)throw new P("invalid-receivers",n);return e})},e.prototype.queryMessagesIds=function(e,t){var n=this,i="limit"in t?t.limit:-1,o="order"in t?t.order:"DESC",s="orderBy"in t?t.orderBy:"SEQ",a=new S.Query;if("date"in t&&a.and(S.Query.createDate(t.date)),"types"in t){var u=new S.Query;t.types.forEach(function(e){"string"==typeof e?u.or("type:"+e):u.or(S.Query.create("type:"+e.value,e.not))}),a.and(u)}if("conv"in t){var c=T.ConversationId.createFromHashmails(t.conv.concat(this.identity.hashmail));a.and("cnv:"+c)}return r(null).then(function(){if("read"in t)return r(null).then(function(){return n.tagStorage.getTag("read")}).then(function(e){a.and(S.Query.create("priv:"+e,!t.read))})}).then(function(){return n.messages.sinkQuery(e,a.query,i,{type:o,by:s})})},e.prototype.querySinkEntries=function(e,t){var n=this;return r(null).then(function(){return n.queryMessagesIds(e.id,t)}).then(function(t){return n.getSinkIndexEntries(e,t)})},e.prototype.queryMessages=function(e,t,n,i){var o=this;return r(null).then(function(){return o.queryMessagesIds(e.id,t)}).then(function(t){return o.messages.messageGet(e,t,n,i)})},e.prototype.isAdmin=function(){return null!=this.authData&&this.authData.myData.raw.isAdmin===!0},e.prototype.refreshUsersCollection=function(){var e=this;return r(null).then(function(){return e.srpSecure.getUsers();
}).then(function(t){e.usersCollection.clear(),e.usersCollection.addAll(t)})},e.prototype.removeUser=function(e){var t=this;return r(null).then(function(){return t.srpSecure.removeUser(e)}).then(function(){t.usersCollection.removeBy("username",e)})},e.prototype.changeUserDescription=function(e,t){return this.changeUserProperty(e,"description",t,"changeDescription")},e.prototype.changeUserIsAdmin=function(e,t){return this.changeUserProperty(e,"isAdmin",t,"changeIsAdmin")},e.prototype.changeUserEmail=function(e,t){return this.changeUserProperty(e,"email",t,"changeEmail",function(e){!e.activated&&e.notificationsEntry&&(e.notificationsEntry={enabled:!!t,email:t,tags:[]})})},e.prototype.changeUserPin=function(e,t){return this.changeUserProperty(e,"pin",t,"changePin",function(e){e.pinAttemptsCount=0})},e.prototype.changeUserProperty=function(e,t,n,i,o){var s=this;return r(null).then(function(){return s.srpSecure[i](e,n)}).then(function(){var r=s.usersCollection.getBy("username",e);r[t]=n,"function"==typeof o&&o(r),s.usersCollection.updateElement(r)})},e.prototype.isServerPluginEnabled=function(e){return null!=this.authData&&null!=this.authData.myData.raw.plugins&&this.authData.myData.raw.plugins.indexOf(e)!=-1},e.prototype.networkActivityIsPaused=function(){return"paused"===this.networkActivity},e.prototype.pauseNetworkActivity=function(){a.debug("pauseNetworkActivity"),this.networkActivity="paused",this.sinkIndexManager&&this.sinkIndexManager.stopSinkPolling()},e.prototype.restoreNetworkActivity=function(){a.debug("restoreNetworkActivity"),this.networkActivity=null,this.sinkIndexManager&&this.gateway&&this.gateway.isConnected()&&this.sinkIndexManager.startSinkPolling()},e.prototype.stopCommunication=function(){a.debug("stopCommunication"),this.sinkIndexManager.stopSinkPolling(),clearInterval(this.publishPresenceInterval),clearInterval(this.checkPresenceInterval)},e.prototype.getMessagesSummaryByDomain=function(){var e={};return this.sinkIndexManager.indexes.forEach(function(t){var n=function(t){var n=t.host;n in e||(e[n]={count:0,lastDate:0}),e[n].count++,t.source.serverDate>e[n].lastDate&&(e[n].lastDate=t.source.serverDate)};t.entries.forEach(n),t.systemEntries.forEach(n)}),e},e.prototype.getLastUnfilteredMessagesFromDomain=function(e,t){var n=new D.SortTake(t,function(e,t){return t.source.serverDate-e.source.serverDate});return this.sinkIndexManager.indexes.forEach(function(t){var r=function(t){t.host==e&&n.add(t)};t.entries.forEach(r),t.systemEntries.forEach(r)}),n.list},e.prototype.generateUUID=function(){var e=t.crypto.service.randomBits(128).toString("hex").match(/.{4}/g);return[e.slice(0,2).join(""),e.slice(2,5).join("-"),e.slice(5).join("")].join("-")},e.prototype.loadAllCosigners=function(){var e,t=this;return r.all([this.srpSecure.getCosigners(),this.srpSecure.getPublishedCosigners().fail(function(e){return a.debug("Error during reading published cosigners",e,e?e.stack:null),{}})]).then(function(n){var r=[],i=n[0];e=n[1];for(var o in e)o in i?"ACTIVE"!=i[o].state&&"DELETED"!=i[o].state&&(i[o].state="ACTIVE"):r.push({domain:o,keystore:e[o]});return I.oneByOne(r,function(e,n){return t.srpSecure.setCosigner(n.domain,{state:"ACTIVE",uuid:t.generateUUID(),hashmail:"unknown#"+n.domain,keystore:n.keystore}).then(function(e){i=e})}).then(function(){return i})}).then(function(t){return{adminCosigners:t,pkiCosigners:e}})},e.prototype.inviteCosigner=function(e){var t=this,n=e.split("#")[1];return r.all([this.srpSecure.privmxPKI.getServerKeyStore(),this.srpSecure.privmxPKI.getServerKeyStore({pkiOptions:{domain:n}}),this.resolveHashmail(e).fail(function(e){return r.reject({msg:"cannot-resolve-hasmail",couse:e})})]).then(function(i){var o=i[0].keystore,s=i[1].keystore,a=i[2];if(!a.receivers.length)throw new Error("Cannot send message to "+e);var u=t.generateUUID(),c={state:"PENDING",uuid:u,hashmail:e,keystore:s},f=t.createMessage(a.receivers[0],t.i18n("api.cosigners.invite.header"),JSON.stringify({hashmail:t.identity.hashmail,uuid:u,keystore:o.serialize().toString("base64"),content:t.i18n("api.cosigners.invite.content",[t.identity.hashmail]),type:"invite"}));return f.setType("pki-event"),t.srpSecure.setCosigner(n,c).then(function(e){return t.messages.messagePost(f,l.SinkIndexEntry.getMessageTags(f)).then(function(t){if(t.filter(function(e){return!e.success}).length>0)throw t;return e}).fail(function(e){return t.srpSecure.removeCosigner(n,u).then(function(){return r.reject(e)})})})})},e.prototype.acceptCosigner=function(e,t){var n=this,i={state:"ACTIVE",hashmail:t.hashmail,uuid:t.uuid,keystore:t.keystore};return r.all([this.resolveHashmail(t.hashmail),this.srpSecure.setCosigner(e,i)]).then(function(e){var r=e[0];if(!r.receivers.length)throw new Error("Cannot send message to "+t.hashmail);var i=n.createMessage(r.receivers[0],n.i18n("api.cosigners.accept.header"),JSON.stringify({uuid:t.uuid,content:n.i18n("api.cosigners.accept.content",[n.identity.hashmail]),type:"accepted"}));return i.setType("pki-event"),n.messages.messagePost(i,l.SinkIndexEntry.getMessageTags(i)).then(function(t){if(t.filter(function(e){return!e.success}).length>0)throw t;return e[1]})})},e.prototype.removeCosigner=function(e,t){if(""===t.hashmail)return this.srpSecure.removeCosigner(e,t.uuid);var n=this;return this.resolveHashmail(t.hashmail).then(function(e){if(!e.receivers.length)throw new Error("Cannot send message to "+t.hashmail);var r="";r="PENDING"===t.state?n.i18n("api.cosigners.canceled.content",[n.identity.hashmail]):"INVITED"===t.state?n.i18n("api.cosigners.rejected.content",[n.identity.hashmail]):n.i18n("api.cosigners.removed.content",[n.identity.hashmail]);var i=n.createMessage(e.receivers[0],n.i18n("api.cosigners.removed.header"),JSON.stringify({uuid:t.uuid,content:r,type:"removed"}));return i.setType("pki-event"),n.messages.messagePost(i,l.SinkIndexEntry.getMessageTags(i)).then(function(e){if(e.filter(function(e){return!e.success}).length>0)throw e})}).fail(function(e){a.error("Cannot send message about removing from web of trust",e,e?e.stack:null)}).then(function(){return n.srpSecure.removeCosigner(e,t.uuid)})},e.prototype.createSecureFormToken=function(e){return this.srpSecure.request("createSecureFormToken",{sid:e})},e.prototype.getForbiddenUsernames=function(){return this.srpSecure.request("getForbiddenUsernames",{})},e.prototype.removeAllMessagesByDomains=function(e){this.sinkIndexManager.indexes.forEach(function(t){var n=function(t){return e.indexOf(t.host)!=-1},r=function(e){var t=e.getMessage();if(n(t.sender))return!0;for(var r=0;r<t.receivers.length;r++)if(n(t.receivers[r].user))return!0},i=function(e){r(e)&&(a.debug("Deleting",e.id,e.getMessage().sender.hashmail),t.deleteEntry(e.id).fail(function(t){a.error("Cannot delete",e.id,t)}))};t.entries.forEach(i),t.systemEntries.forEach(i)})},e.prototype.removeAllMessagesByHashmails=function(e){this.sinkIndexManager.indexes.forEach(function(t){var n=function(t){return e.indexOf(t.hashmail)!=-1},r=function(e){var t=e.getMessage();if(n(t.sender))return!0;for(var r=0;r<t.receivers.length;r++)if(n(t.receivers[r].user))return!0},i=function(e){r(e)&&(a.debug("Deleting",e.id,e.getMessage().sender.hashmail),t.deleteEntry(e.id).fail(function(t){a.error("Cannot delete",e.id,t)}))};t.entries.forEach(i),t.systemEntries.forEach(i)})},e.prototype.loadLowUserService=function(){var e=this;return r().then(function(){return e.getStorage()}).then(function(e){return L.LowUserRegistry.create(e,"/low-users.json",{})}).then(function(t){e.lowUserService=new L.LowUserService(e,e.findFirstPublicInbox(),t)})},e.prototype.addLowUser=function(e,t,n,i,o){var s=this;return r().then(function(){return s.lowUserService.createLowUser(t,n,e,i,o)}).then(function(e){return s.refreshSinksRegistry(),e})},e.prototype.getLowUser=function(e,t){var n=this.lowUserService.registry.getUser(e);return null!=n&&n.host==t?n:null},e.prototype.getLowUserByUser=function(e){var n=this.getLowUser(e.user,e.host);if(n){var r=t.identity.Identity.fromSerialized(e.hashmail,n.identity.wif);return r.pub58==e.pub58?n:null}return null},e.prototype.getLowUserByEmail=function(e){return this.lowUserService.registry.getLowUserByEmail(e)},e.prototype.getLowUserByHashmail=function(e){return this.lowUserService.registry.getLowUserByHashmail(e)},e.prototype.getLowUserBySource=function(e){return this.lowUserService.registry.getLowUserBySource(e)},e.prototype.isLowUser=function(e){var n=this.getLowUser(e.user,e.host);if(n){var r=t.identity.Identity.fromSerialized(e.hashmail,n.identity.wif);return r.pub58==e.pub58}return!1},e.prototype.getMeAsReceiver=function(){return null==this.identityReceiver&&(this.identityReceiver=new t.message.MessageReceiver(this.findFirstPublicInbox(),this.identity)),this.identityReceiver},e.FILES_INDEX=0,e.MESSAGES_INDEX=1,e.IDENTITY_INDEX=2,e.CONTAINERS_INDEX=3,e.SETTINGS_ENCRYPTOR_INDEX=9,e.SINK_ENCRYPTOR_INDEX=25,e.CONTACTS_FILENAME="/contacts.json",e.TAGS_FILENAME="/tags.json",e.TRUSTED_SERVERS_FILENAME="/trusted-servers.json",e.USER_PREFERENCES_FILENAME="/user-preferences.json",e.CONTAINERS_SETTINGS_FILENAME="/.settings.json",e.MAIL_FILTER_FILENAME="/mail-filter.json",e.PKI_CACHE_FILENAME="/pki-cache.json",e.MAX_COSIGNERS=5,e}();n.MailClientApi=U;var j=e("../migration/EncryptionSignature")}).call(this,e("buffer").Buffer)},{"../migration/EncryptionSignature":465,"../task/ParallelTaskStream":479,"../utils/Event":485,"../utils/Events":486,"../utils/ImageTypeDetector":488,"../utils/Lang":489,"../utils/Map":490,"../utils/Model":491,"../utils/SortTake":496,"../utils/collection/FilteredCollection":499,"../utils/collection/MutableCollection":501,"./Contact":432,"./ConversationId":434,"./ConversationsCollection":435,"./FilterMode":437,"./LazyLoader":438,"./LowUser":439,"./MailFilter":441,"./MessageSenderVerifier":442,"./MessageTagger":443,"./Persons":446,"./PkiCache":447,"./Query":448,"./SinkIndexEntry":450,"./SinkIndexManager":451,"./SinkIndexStats":452,"./UserPreferences":455,buffer:590,"privfs-client":204,"privmx-exception":266,q:327,"simplito-lazybuffer":352,"simplito-logger":357,"simplito-promise":370,"tar-stream":378}],441:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../utils/collection/FilteredCollection"),i=e("../utils/collection/MergedCollection"),o=e("./FilterMode"),s=e("../utils/Model"),a=e("../utils/Event"),u=e("q"),c=function(){function e(){this.collectionsByDomain={},this.collections=[]}return e.prototype.getFilteredCollection=function(e,t){return new r.FilteredCollection(e,function(e){return e.host==t})},e.prototype.addDomain=function(e){var t=this;if(!(e in this.collectionsByDomain)){var n=new i.MergedCollection;this.collections.forEach(function(r){n.addCollection(t.getFilteredCollection(r,e))}),this.collectionsByDomain[e]=n}},e.prototype.addCollection=function(e){this.collections.push(e);for(var t in this.collectionsByDomain)this.collectionsByDomain[t].addCollection(this.getFilteredCollection(e,t))},e}();n.DomainsCollections=c;var f=function(){function e(e){this.domainsCollections=e,this.count=new s.Model(0),this.messagesCount=new s.Model(0),this.domains={},this.refreshCoreBinded=this.refreshCore.bind(this)}return e.prototype.refresh=function(){clearInterval(this.refreshIntervalId),this.refreshIntervalId=setTimeout(this.refreshCoreBinded,10)},e.prototype.refreshCore=function(){var e=0;for(var t in this.domainsCollections.collectionsByDomain)t in this.domains&&(e+=this.domainsCollections.collectionsByDomain[t].size());this.messagesCount.setWithCheck(e)},e.prototype.reset=function(){this.count.set(0),this.messagesCount.set(0),this.domains={},this.refresh()},e.prototype.addDomain=function(e){e in this.domains||(this.domains[e]=!0,this.count.setWithCheck(this.count.get()+1)),this.held||this.refresh()},e.prototype.hold=function(){this.held=!0,this.count.changeEvent.hold(),this.messagesCount.changeEvent.hold()},e.prototype.trigger=function(){this.count.changeEvent.trigger(),this.messagesCount.changeEvent.trigger()},e.prototype.release=function(){this.held=!1,this.refresh(),this.count.changeEvent.release(),this.messagesCount.changeEvent.release()},e}();n.UnknownDomains=f;var l=function(){function e(e){this.storage=e,this.filteredCollections=[],this.domainsCollections=new c,this.unknownDomains=new f(this.domainsCollections),this.listChangeEvent=new a.Event,this.refreshFilter(this.storage.getAll())}return e.create=function(t,n,r){return u(null).then(function(){return t.getKeyValueFile(n,r)}).then(function(t){return new e(t)})},e.prototype.registerCollection=function(e){this.domainsCollections.addCollection(e),this.unknownDomains.hold();var t=new r.FilteredCollection(e,this.currentFilter.bindedFilter);return this.filteredCollections.push(t),this.unknownDomains.trigger(),this.unknownDomains.release(),t},e.prototype.refreshFilter=function(e){this.unknownDomains.reset(),this.currentFilter=new h(e,this),this.unknownDomains.hold();for(var t=0;t<this.filteredCollections.length;t++)this.filteredCollections[t].setFilter(this.currentFilter.bindedFilter);this.unknownDomains.trigger(),this.unknownDomains.release()},e.prototype.setDomain=function(e,t){var n=this;return u(null).then(function(){var r=n.storage.setAtCopy(e,{mode:t});return n.refreshFilter(r),n.storage.replaceData(r)}).then(function(){n.listChangeEvent.trigger("add",e,t)}).fail(function(e){return n.refreshFilter(n.storage.getAll()),u.reject(e)})},e.prototype.removeDomain=function(e){var t=this;return u(null).then(function(){var n=t.storage.removeAtCopy(e);return t.refreshFilter(n),t.storage.replaceData(n)}).then(function(){t.listChangeEvent.trigger("remove",e)}).fail(function(e){return t.refreshFilter(t.storage.getAll()),u.reject(e)})},e.prototype.getDeniedDomains=function(){var e=[],t=this.storage.getAll();for(var n in t)t[n].mode==o.FilterMode.DENY&&e.push(n);return e},e.prototype.denyUnknownDomains=function(){if(0==this.unknownDomains.count.get())return u(null);var e=this;return u(null).then(function(){var t=e.storage.getAll(),n=e.unknownDomains.domains;for(var r in n)t[r]={mode:o.FilterMode.DENY};return e.refreshFilter(t),e.storage.replaceData(t)}).then(function(){e.listChangeEvent.trigger("rebuild")}).fail(function(t){return e.refreshFilter(e.storage.getAll()),u.reject(t)})},e}();n.MailFilter=l;var h=function(){function e(e,t){this.domains=e,this.mailFilter=t,this.bindedFilter=this.filter.bind(this)}return e.prototype.filter=function(e){var t=e.host;return this.mailFilter.domainsCollections.addDomain(t),t in this.domains?this.domains[t].mode==o.FilterMode.ALLOW:(this.mailFilter.unknownDomains.addDomain(t),!1)},e}();n.TheFilter=h},{"../utils/Event":485,"../utils/Model":491,"../utils/collection/FilteredCollection":499,"../utils/collection/MergedCollection":500,"./FilterMode":437,q:327}],442:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("simplito-logger"),o=i.get("privfs-mail-client.mail.MessageSenderVierfier"),s=e("simplito-promise"),a=s.PromiseUtils,u=e("./SinkIndexEntry"),c=u.SinkIndexEntry.VerifyStatus,f=function(){function e(e){this.mailClientApi=e,this.queue=[],this.isRunning=!1}return e.prototype.destroy=function(){this.destroyed=!0,this.queue=[],this.isRunning=!1},e.prototype.getVerifyInfo=function(e){var t=this;return r().then(function(){return e.hasSavedVerifiedInformation()?t.mailClientApi.srpSecure.getKeyStoreFetch(e.data.verified.fetchId):e.verified?e.verified.fetch:null})},e.prototype.verify=function(e){var t=this;if(this.destroyed)throw new Error("Cannot use destroyed instance");e.needToRefreshVerified()&&(o.debug("Updating verified flag for",e.id,e),this.queue.push(e),this.isRunning||(this.isRunning=!0,a.queue(this.queue,function(e){var n=e.getMessage();n.sender.pub58;if(e.needToRefreshVerified())return r(null).then(function(){return t.verifyMessageCore(e)}).then(function(n){if(!t.destroyed)return n.error||!u.SinkIndexEntry.isStatusValidToSave(n.verified.status)?void(e.verified={status:n.verified.status,fetch:n.fetch}):(o.debug("Saving verified flag for",e.id,n.verified,e),n.verified.status==c.OK&&t.mailClientApi.addSenderToContacts(e,!0,!1),t.mailClientApi.updateMessageFlag(e,"verified",n.verified).fail(function(e){o.error("Cannot save verfied flag",e)}))}).fail(function(t){o.error("Unexpected error during processing",e.id,e,t)})}).fail(function(e){o.error("Unexpected error",e)}).fin(function(){t.isRunning=!1})))},e.prototype.verifyMessageCore=function(e,t){var n=e.getMessage();return this.verifyMessageCore2(n.sender,n.serverDate,t)},e.prototype.verifyMessageCore2=function(e,t,n){var i=this;return"anonymous"==e.user||this.mailClientApi.isLowUser(e)?r({anonymous:!0,verified:{status:c.OK,fetchId:""}}):r(null).then(function(){return i.mailClientApi.srpSecure.privmxPKI.getKeyStore(i.mailClientApi.srpSecure.getUserKeystoreName(e.user,e.host),{pkiOptions:{domain:e.host},cacheLoad:n!==!0}).fail(function(e){return e&&"invalid-tree-signature"==e.errorType?(e.pkiResult.error=!0,e.pkiResult):e&&"invalid-server-keystore"==e.errorType?(e.result.error=!0,e.result.errorType="invalid-server-keystore",e.result):r.reject(e)})}).then(function(n){var r=null;if("invalid-server-keystore"==n.errorType)r=c.INVALID_SERVER_KEYSTORE;else if(0==n.result.status)if(null==n.keystore)r=c.KEY_DOESNT_EXISTS;else{var o=t?Math.floor(t.getTime()/1e3):0,s=i.mailClientApi.srpSecure.getPrimaryKeyFromKeystoreAtTime(n.keystore,o);r=s.toBase58DER()==e.pub58?c.OK:c.INVALID_KEY}else 1==n.result.status?r=c.INVALID_SIGNATURE:2==n.result.status?r=c.INVALID_NET_STATE:3==n.result.status&&(r=c.NO_QUORUM);return{fetch:n,verified:{status:r,fetchId:n.fetchId},error:n.error}})},e.prototype.renewMessageVerify=function(e,t){var n=this;return r(null).then(function(){return n.verifyMessageCore(e,t)}).then(function(t){var r=t.verified;return!t.error&&u.SinkIndexEntry.isStatusValidToSave(t.verified.status)||(e.verified={status:t.verified.status,fetch:t.fetch},r=null),n.mailClientApi.updateMessageFlag(e,"verified",r).thenResolve(t)})},e.prototype.scheduleRetry=function(e){var t=3e4,n=this;n.destroyed||setTimeout(function(){n.destroyed||n.verify(e)},t)},e}();n.MessageSenderVerifier=f},{"./SinkIndexEntry":450,q:327,"simplito-logger":357,"simplito-promise":370}],443:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("simplito-logger"),o=i.get("privfs-mail-client.mail.MessageTagger"),s=e("simplito-promise"),a=s.PromiseUtils,u=function(){function e(e){this.mailClientApi=e,this.queue=[],this.isRunning=!1}return e.prototype.destroy=function(){this.destroyed=!0,this.queue=[],this.isRunning=!1},e.prototype.tag=function(e){var t=this;if(this.destroyed)throw new Error("Cannot use destroyed instance");e.isTagged()||(o.debug("Tagging",e.id,e),this.queue.push(e),this.isRunning||(this.isRunning=!0,a.queue(this.queue,function(e){if(!e.isTagged())return o.debug("Tagging core",e.id,e),r(null).then(function(){return t.mailClientApi.updateMessageFlag(e,"tagged",!0)}).fail(function(e){o.error("Cannot save tag",e)})}).then(function(){t.isRunning=!1}).fail(function(e){o.error("Unexpected error",e)})))},e}();n.MessageTagger=u},{q:327,"simplito-logger":357,"simplito-promise":370}],444:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../utils/Bracket"),i=function(){function e(e,t){this.hashmail=e,this.hashmailIsEmail=this.hashmail.indexOf("@")!=-1,this.setContact(t)}return e.fromContact=function(t){return new e(t.getHashmail(),t)},e.prototype.hasContact=function(){return null!=this.contact},e.prototype.getContact=function(){return this.contact},e.prototype.updateContact=function(){this.lastUpdate=new Date},e.prototype.setContact=function(e){if(null!=e&&e.isEmail()!=this.hashmailIsEmail)throw new Error("Inconsistent contact type");this.contact=e,this.lastUpdate=new Date},e.prototype.getHashmail=function(){return this.hashmail},e.prototype.getName=function(e){return this.contact&&this.contact.hasName()?this.contact.getDisplayName():e||this.hashmail},e.prototype.getNameWithHashmail=function(e){return this.contact?this.contact.getDisplayNameWithHashmail(e):this.hashmail},e.prototype.getNameWithHashmailA=function(e){return this.getNameWithHashmail(r.Bracket.Angle)},e.prototype.hasDescription=function(){return null!=this.contact&&null!=this.contact.profile&&!!this.contact.profile.description},e.prototype.getDescription=function(){return this.hasDescription()?this.contact.profile.description:""},e.prototype.hasAvatar=function(){return null!=this.contact&&null!=this.contact.profile&&!!this.contact.profile.image},e.prototype.getAvatar=function(){return this.hasAvatar()?this.contact.profile.image:""},e.prototype.isStarred=function(){return null!=this.contact&&this.contact.isStarred()},e.prototype.isPresent=function(){return null!=this.contact&&null!=this.contact.presence},e.prototype.isEmail=function(){return this.hashmailIsEmail},e.prototype.getLastUpdate=function(){return this.lastUpdate},e.prototype.isAnonymous=function(){return 0==this.hashmail.indexOf("anonymous#")},e}();n.Person=i},{"../utils/Bracket":483}],445:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./Person"),o=function(e){function t(t,n){var r=e.call(this,t.hashmail,t.contact)||this;return r.user=n,r}return r(t,e),t.prototype.getName=function(){return e.prototype.getName.call(this,null==this.user?null:this.user.name)},t}(i.Person);n.PersonProxy=o},{"./Person":444}],446:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Person"),i=e("./PersonProxy"),o=e("./Contact"),s=e("../utils/Event"),a=function(){function e(e,t){var n=this;this.contactCollection=e,this.mailClientApi=t,this.changeEvent=new s.Event,this.map={},this.contactCollection.forEach(function(e){n.map[e.getHashmail()]=r.Person.fromContact(e)}),this.contactCollection.changeEvent.add(this.onContactCollectionChange.bind(this))}return e.prototype.onContactCollectionChange=function(e){if("add"==e.type){var t=this.get(e.element.getHashmail());t.setContact(e.element),this.changeEvent.trigger(t)}else if("remove"==e.type){var t=this.get(e.element.getHashmail());if(t.setContact(null),e.element.getHashmail()==this.mailClientApi.identity.hashmail){var n=this.mailClientApi.buildUserInfoProfile();this.updateIdentity(this.mailClientApi.identity,n,function(){return!0})}this.changeEvent.trigger(t)}else if("update"==e.type){var t=this.get(e.element.getHashmail());t.updateContact(),this.changeEvent.trigger(t)}},e.prototype.updateIdentity=function(e,t,n){var r=this.get(e.hashmail),i=this.mailClientApi.convertProfile(t);if(r.hasContact())n(r.getContact().profile,i)||(r.getContact().profile=i,r.updateContact(),this.changeEvent.trigger(r));else{var s=new o.Contact;s.user=e,s.sinks=t.sinks,s.profile=i,s.starred=!1,r.setContact(s),this.changeEvent.trigger(r)}},e.prototype.get=function(e){return e in this.map||(this.map[e]=new r.Person(e)),this.map[e]},e.prototype.getProxy=function(e){return this.getProxyEx(e.hashmail,e)},e.prototype.getProxyEx=function(e,t){return new i.PersonProxy(this.get(e),t)},e}();n.Persons=a},{"../utils/Event":485,"./Contact":432,"./Person":444,"./PersonProxy":445}],447:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("q"),r=e("privfs-client"),i=function(){function e(e){this.storage=e,this.encoder=new r.pki.StaticPair}return e.create=function(n,r,i){return t(null).then(function(){return n.getKeyValueFile(r,i)}).then(function(t){return new e(t)})},e.prototype.load=function(e){var n=this;return t(null).then(function(){var t=n.storage.getValueByKey(e);if(null==t)return null;var r=n.encoder.decode(new Buffer(t,"base64"));return r})},e.prototype.save=function(e,n){var r=this;return t(null).then(function(){var t=new Buffer(r.encoder.encode(n).toBinary(),"binary").toString("base64");return r.storage.set(e,t).thenResolve(!0)})},e}();n.PkiCache=i}).call(this,e("buffer").Buffer)},{buffer:590,"privfs-client":204,q:327}],448:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){}return e.create=function(e,t){return t?{operand:"NOT",value:e}:e},e.createDate=function(e){return{operand:"DATE",relation:e.relation,value:e.value.getTime()}},e.prototype.and=function(t){return t instanceof e?t.query&&(t=t.query):t&&(this.query=this.query?{operand:"AND",left:this.query,right:t}:t),this},e.prototype.or=function(t){return t instanceof e?t.query&&(t=t.query):t&&(this.query=this.query?{operand:"OR",left:this.query,right:t}:t),this},e}();n.Query=r},{}],449:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("../utils/collection/MutableCollection"),o=e("../utils/Event"),s=e("simplito-logger"),a=s.get("privfs-mail-client.mail.SinkIndex"),u=e("privfs-client"),c=e("simplito-utils"),f=e("./SinkIndexEntry"),l=e("./SinkIndexStats"),h=e("simplito-promise"),p=h.PromiseUtils,d=e("./filestats/FileStatsToCollectionBinder"),g=function(){function e(e,t){this.sink=e,this.sinkIndexManager=t,this.storageKey="idx-"+this.sink.id,this.entries=new i.MutableCollection,this.entries.index=this,this.filteredEntries=t.mailFilter.registerCollection(this.entries),this.filteredEntries.index=this,this.systemEntries=new i.MutableCollection,this.systemEntries.index=this,this.filteredSystemEntries=t.mailFilter.registerCollection(this.systemEntries),this.filteredSystemEntries.index=this,this.cursor=new u.message.MessageSinkCursor(this.sink,0,0),this.stats=new l.SinkIndexStats(this.filteredEntries),this.stats.changeEvent.add(this.onStatsChange.bind(this)),this.fileStats=new d.FileStatsToCollectionBinder(this.sinkIndexManager.fileStats,this.systemEntries),this.fileStats.changeEvent.add(this.onFileStatsChange.bind(this)),this.changeEvent=new o.Event}return e.prototype.load=function(){var e=this;return r(null).then(function(){return a.debug("load sink index",e.storageKey),e.sinkIndexManager.storage.get(e.storageKey)}).then(function(t){return e.cursor.seq=null==t?0:t.seq,e.cursor.modSeq=null==t?0:t.modSeq,e.loadEntries()})},e.prototype.loadEntries=function(){var e=this;return r(null).then(function(){for(var t=[],n=[],i=[],o=1;o<=e.cursor.seq;o++){var s=e.sinkIndexManager.storage.get(e.getEntryStorageKeyById(o));i.push(s)}return r.all(i).then(function(r){r.forEach(function(r){if(r){var i=f.SinkIndexEntry.create(r,e);i.isSystemEntry()?n.push(i):t.push(i)}})}).then(function(){e.entries.clear(),e.entries.addAll(t),e.systemEntries.clear(),e.systemEntries.addAll(n),e.changeEvent.trigger("load",e)})})},e.prototype.getEntry=function(e){var t=this.systemEntries.find(function(t){return t.id==e});return t||(t=this.entries.find(function(t){return t.id==e})),t},e.prototype.process=function(e){var t=this;return this.needUpdate=!1,r(null).then(function(){return a.debug("process poll",e,t),t.holdChangeEvent(),e.msg.forEach(function(e){e.error&&a.warn("Cannot process message, error during decoding.",t,e)}),p.oneByOne(e.meta,function(n,r){if(!(null==r||r.modSeq<=t.cursor.modSeq)){if(r.error)return void a.warn("Cannot process meta, error during decoding.",t,r);var i=t.getEntry(r.msgId);if(r.deleted){if(null==i)return;return t.deleteFromStorage(i).then(function(){t.removeFromEntries(i,!0)})}if(null==i){var o=null;for(var s in e.msg)if(e.msg[s]&&e.msg[s].serverId==r.msgId){o=e.msg[s];break}if(null==o)return void a.warn("Cannot process meta because there isn't a corresponding message in index.",t,r);var u=new f.SinkIndexEntry(o.source,r.data,r.tags,t);return t.saveInStorage(u).then(function(){t.addToEntries(u,!0)})}return i.data=r.data,t.saveInStorage(i).then(function(){t.updateInEntries(i,!0)})}}).then(function(){if(!(t.cursor.modSeq>=e.modSeq))return t.cursor.seq=e.seq,t.cursor.modSeq=e.modSeq,t.save().then(function(){t.changeEvent.trigger("save",t)})}).fin(function(){t.releaseChangeEvent()})})},e.prototype.updateEntry=function(e,t){var n=this;return r(null).then(function(){var i=n.getEntry(e);if(null==i)throw new Error("Entry not found");return i.updateQueue.add(function(){var i=n.getEntry(e);if(null!=i){var o=c.simpleDeepClone(i.data),s=c.simpleDeepClone(i.data),u=c.simpleDeepClone(i.tags);return r(null).then(function(){return t(o)}).then(function(t){if(t!==!1)return a.debug("updateEntry",e,i,n),r(null).then(function(){return f.SinkIndexEntry.getAllTagsFromSource(n.sinkIndexManager.tagStorage,i.source,t)}).then(function(e){return n.sinkIndexManager.updatesQueue.addUpdateTask(i.sink.id,i.id,s,t,u,e,function(){return i.data=t,i.tags=e,n.saveInStorage(i).then(function(){n.updateInEntries(i,!0)})})})})}})})},e.prototype.revertUpdateEntry=function(e,t,n){var i=this;return r(null).then(function(){a.debug("revertUpdateEntry",e,t,i);var r=i.getEntry(e);return null==r?void a.warn("Cannot revert update, there isn't entry in index",e,t,i):(r.data=t,r.tags=n,i.saveInStorage(r).then(function(){i.updateInEntries(r,!1),i.changeEvent.trigger("update-revert",i,r)}))})},e.prototype.deleteEntry=function(e){var t=this;return r(null).then(function(){a.debug("deleteEntry",e,t);var n=t.getEntry(e);if(null==n)throw new Error("Entry not found");return t.sinkIndexManager.updatesQueue.addDeleteTask(n.sink.id,n.id,n.source,n.data,n.tags,function(){return t.deleteFromStorage(n).then(function(){t.removeFromEntries(n,!0)})})})},e.prototype.revertDeleteEntry=function(e,t,n,i){var o=this;return r(null).then(function(){a.debug("revertDeleteEntry",e,t,n,o);var r=o.getEntry(e);return null!=r?void a.warn("Cannot revert delete, there is still entry in index",e,t,n,o):(r=new f.SinkIndexEntry(t,n,i,o),o.saveInStorage(r).then(function(){o.addToEntries(r,!1),o.changeEvent.trigger("delete-revert",o,r)}))})},e.prototype.moveEntry=function(e,t){var n=this;return r(null).then(function(){a.debug("moveEntry",e,n);var r=n.getEntry(e);if(null==r)throw new Error("Entry not found");return t.needUpdate=!0,n.sinkIndexManager.updatesQueue.addMoveTask(r.sink.id,r.id,r.source,r.data,r.tags,t.sink.id,function(){return n.deleteFromStorage(r).then(function(){n.removeFromEntries(r,!1),n.changeEvent.trigger("move",n,r)})})})},e.prototype.revertMoveEntry=function(e,t,n,i){var o=this;return r(null).then(function(){a.debug("revertMoveEntry",e,t,n,o);var r=o.getEntry(e);return null!=r?void a.warn("Cannot revert move, there is still entry in index",e,t,n,o):(r=new f.SinkIndexEntry(t,n,i,o),o.saveInStorage(r).then(function(){o.addToEntries(r,!1),o.changeEvent.trigger("move-revert",o,r)}))})},e.prototype.deleteOldEntry=function(e){var t=this;return r(null).then(function(){a.debug("deleteOldEntries",e,t);var n=t.getEntry(e);if(null!=n)return t.deleteFromStorage(n).then(function(){t.removeFromEntries(n,!0)})})},e.prototype.clear=function(){var e=this;return r(null).then(function(){a.debug("clear",e);var t=[];return e.entries.forEach(function(e){t.push({id:e.id,source:e.source,data:e.data,tags:e.tags})}),e.sinkIndexManager.updatesQueue.addDeleteBulkTask(e.sink.id,t,function(){return p.oneByOne(e.entries.getEnumerable(),function(t,n){return e.deleteFromStorage(n)}).then(function(){e.entries.clear(),e.changeEvent.trigger("clear",e)})})})},e.prototype.revertDeleteBulk=function(e){var t=this;return r(null).then(function(){return a.debug("revertDeleteBulk",e,t),p.oneByOne(e,function(e,n){var r=t.getEntry(n.id);return null!=r?void a.warn("Cannot revert delete (from bulk), there is still entry in index",n,t):(r=new f.SinkIndexEntry(n.source,n.data,n.tags,t),t.saveInStorage(r).then(function(){t.addToEntries(r,!1)}))}).then(function(){t.changeEvent.trigger("delete-bulk-revert",t)})})},e.prototype.addEntry=function(e,t,n){var i=this;return r(null).then(function(){a.debug("addEntry",e,t,n,i);var r=i.getEntry(e.serverId);return null==r?(r=new f.SinkIndexEntry(e,t,n,i),i.saveInStorage(r).then(function(){i.addToEntries(r,!0)})):(r.data=t,i.saveInStorage(r).then(function(){i.updateInEntries(r,!0)}))})},e.prototype.addToEntries=function(e,t){e.isSystemEntry()?this.systemEntries.add(e):this.entries.add(e),t&&this.changeEvent.trigger("new",this,e);
},e.prototype.updateInEntries=function(e,t){e.isSystemEntry()?this.systemEntries.updateElement(e):this.entries.updateElement(e),t&&this.changeEvent.trigger("update",this,e)},e.prototype.removeFromEntries=function(e,t){e.isSystemEntry()?this.systemEntries.remove(e):this.entries.remove(e),t&&this.changeEvent.trigger("delete",this,e)},e.prototype.deleteFromStorage=function(e){var t=this;return r(null).then(function(){return t.sinkIndexManager.storage.remove(t.getEntryStorageKey(e))})},e.prototype.saveInStorage=function(e){var t=this;return r(null).then(function(){return t.sinkIndexManager.storage.set(t.getEntryStorageKey(e),e.serializeCore())})},e.prototype.save=function(){var e=this;return r(null).then(function(){a.debug("saving index",e);var t={seq:e.cursor.seq,modSeq:e.cursor.modSeq};return e.sinkIndexManager.storage.set(e.storageKey,t)})},e.prototype.getEntryStorageKey=function(e){return this.getEntryStorageKeyById(e.source.serverId)},e.prototype.getEntryStorageKeyById=function(e){return this.storageKey+"/m/"+e},e.prototype.getStats=function(){return this.stats.getStats()},e.prototype.getUnreadByType=function(e){return l.SinkIndexStats.getUnreadByType(this.stats.getStats(),e)},e.prototype.holdChangeEvent=function(){this.changeEvent.hold(),this.entries.changeEvent.hold(),this.systemEntries.changeEvent.hold()},e.prototype.releaseChangeEvent=function(){this.changeEvent.release(),this.entries.changeEvent.release(),this.systemEntries.changeEvent.release()},e.prototype.onStatsChange=function(){this.sinkIndexManager.sinkIndexCollection.updateElement(this),this.changeEvent.trigger("new-stats")},e.prototype.onFileStatsChange=function(){this.changeEvent.trigger("new-file-stats")},e.sinkIndexComparator=function(t,n){return e.sinkComparator(t.sink,n.sink)},e.sinkComparator=function(e,t){if(e.extra.type==t.extra.type){if("inbox"==e.extra.type){if(e.extra.isPrivate&&!t.extra.isPrivate)return 1;if(!e.extra.isPrivate&&t.extra.isPrivate)return-1}return e.name.localeCompare(t.name)}return"inbox"==e.extra.type?-1:"inbox"==t.extra.type?1:"folder"==e.extra.type?-1:"folder"==t.extra.type?1:"outbox"==e.extra.type?-1:"outbox"==t.extra.type?1:"form"==e.extra.type?-1:"form"==t.extra.type?1:void 0},e}();n.SinkIndex=g},{"../utils/Event":485,"../utils/collection/MutableCollection":501,"./SinkIndexEntry":450,"./SinkIndexStats":452,"./filestats/FileStatsToCollectionBinder":458,"privfs-client":204,q:327,"simplito-logger":357,"simplito-promise":370,"simplito-utils":373}],450:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("privfs-client"),i=e("simplito-promise"),o=i.PromiseQueue,s=i.PromiseUtils,a=e("simplito-utils"),u=e("q"),c=e("./ConversationId"),f=function(){function e(e,t,n,r){var i=this;this.source=e,this.data=t,this.tags=n||[],this.index=r,this.updateQueue=new o,this.proceeding=!1,Object.defineProperty(this,"id",{get:function(){return i.source.serverId},enumerable:!0}),Object.defineProperty(this,"sink",{get:function(){return i.index.sink},enumerable:!0}),a.defineLazyReadOnlyProperty(this,"host",function(){return i.message?i.message.sender.host:i.source.data.sender.hashmail.split("#")[1]})}return e.prototype.getMessage=function(){return null==this.message&&(this.message=r.message.Message.deserializeFromSourceWithoutCheckingSignature(this.source),this.message.sink=this.sink),this.message},e.prototype.getContentAsJson=function(){if("undefined"==typeof this.contentAsJson)try{this.contentAsJson=JSON.parse(this.source.data.text)}catch(e){this.contentAsJson=null}return this.contentAsJson},e.prototype.isRead=function(){return this.data&&this.data.read},e.prototype.isProcessed=function(){return this.data&&this.data.processed},e.prototype.isTagged=function(){return this.data&&this.data.tagged},e.prototype.hasVerifiedInformation=function(){return this.hasSavedVerifiedInformation()||null!=this.verified},e.prototype.hasSavedVerifiedInformation=function(){return this.data&&"object"==typeof this.data.verified&&null!=this.data.verified},e.prototype.needToRefreshVerified=function(){return!(null!=this.verified||this.hasSavedVerifiedInformation()&&e.isStatusValidToSave(this.data.verified.status))},e.isStatusValidToSave=function(t){return t==e.VerifyStatus.OK||t==e.VerifyStatus.INVALID_KEY||t==e.VerifyStatus.KEY_DOESNT_EXISTS},e.prototype.getVerifiedStatus=function(){return this.hasSavedVerifiedInformation()?this.data.verified.status:this.verified?this.verified.status:null},e.prototype.serialize=function(){return JSON.stringify(this.serializeCore())},e.prototype.serializeCore=function(){return{s:this.source,d:this.data,t:this.tags}},e.prototype.isSystemEntry=function(){return"container-event"==this.source.data.type||"trusted-servers-event"==this.source.data.type},e.prototype.isMailMessage=function(){return null==this.source.data.type||""==this.source.data.type},e.prototype.isChatMessage=function(){return"chat-message"==this.source.data.type},e.prototype.isContainerEvent=function(){return"container-event"==this.source.data.type},e.parse=function(t,n){var r=JSON.parse(t);return e.create(r,n)},e.create=function(t,n){return new e(t.s,t.d,t.t,n)},e.getMessageTypeTag=function(e){return"type:"+e},e.getMessageTags=function(t){return["cnv:"+c.ConversationId.createFromMessage(t),e.getMessageTypeTag(t.type||"mail")]},e.getMessageTagsFromSource=function(t){return["cnv:"+c.ConversationId.createFromSource(t),e.getMessageTypeTag(t.data.type||"mail")]},e.getFlagTags=function(e,t){var n=[];return s.oneByOne(t,function(t,r){if(r&&"read"==t)return u(null).then(function(){return e.getTag(t)}).then(function(e){n.push("priv:"+e)})}).thenResolve(n)},e.getAllTags=function(t,n,r){return u(null).then(function(){return e.getFlagTags(t,r)}).then(function(t){return t.concat(e.getMessageTags(n))})},e.getAllTagsFromSource=function(t,n,r){return u(null).then(function(){return e.getFlagTags(t,r)}).then(function(t){return t.concat(e.getMessageTagsFromSource(n))})},e.prototype.getMessageTags=function(){return e.getMessageTagsFromSource(this.source)},e.prototype.getAllTags=function(){var t=this;return u(null).then(function(){return e.getFlagTags(t.index.sinkIndexManager.tagStorage,t.data)}).then(function(e){return e.concat(t.getMessageTags())})},e.prototype.getCfmId=function(){return"cfm:"+this.source.data.sid+":"+this.source.data.msgId},e.prototype.isContactFormMessage=function(){var e=this.index.sinkIndexManager.getContactFormSink();return null!=e&&this.getOriginalSinkId()==e.id},e.prototype.getContactFormMessageSender=function(){if(this.isContactFormMessage()){var e=this.getContentAsJson();if(e&&e.email)return e.email}return null},e.prototype.getOriginalSinkId=function(){return this.source.data.sid},e.prototype.getOriginalSink=function(){return this.index.sinkIndexManager.getSinkById(this.getOriginalSinkId())},e.prototype.getOriginalSinkType=function(){var e=this.getOriginalSink();return e&&e.extra?e.extra.type:null},e.VerifyStatus={OK:0,INVALID_KEY:1,KEY_DOESNT_EXISTS:2,INVALID_SIGNATURE:3,INVALID_NET_STATE:4,NO_QUORUM:5,INVALID_SERVER_KEYSTORE:6},e}();n.SinkIndexEntry=f},{"./ConversationId":434,"privfs-client":204,q:327,"simplito-promise":370,"simplito-utils":373}],451:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("simplito-logger"),o=i.get("privfs-mail-client.mail.SinkIndexManager"),s=e("../utils/Map"),a=e("../utils/collection/MergedCollection"),u=e("../utils/collection/MutableCollection"),c=e("../utils/Event"),f=e("./SinkIndex"),l=e("./SinkIndexStats"),h=e("./SinkIndexEntry"),p=e("./UpdatesQueue"),d=e("./SinkPolling"),g=e("./filestats/FileStats"),y=e("simplito-promise"),m=y.PromiseUtils,v=e("../utils/Lang"),b=function(){function e(e,t,n,r,i,o){this.storage=e,this.messageManager=t,this.taskStream=n,this.tagStorage=r,this.indexes=new s.Map,this.sinkIndexCollection=new u.MutableCollection,this.filteredMessagesCollection=new a.MergedCollection,this.changeEvent=new c.Event,this.onIndexChangeBinded=this.onIndexChange.bind(this),this.updatesQueue=new p.UpdatesQueue(this),this.fileStats=new g.FileStats(i),this.mailFilter=o,this.additionalSinks=[]}return e.prototype.init=function(e){var t=this;return r(null).then(function(){o.debug("init");var n=[];return e.forEach(function(e){if("inbox"!=e.extra.type&&"outbox"!=e.extra.type&&"form"!=e.extra.type&&"trash"!=e.extra.type)return void t.additionalSinks.push(e);var r=new f.SinkIndex(e,t);r.changeEvent.add(t.onIndexChangeBinded,"multi"),t.indexes.put(e.id,r),t.sinkIndexCollection.add(r),t.filteredMessagesCollection.addCollection(r.filteredEntries),n.push(r.load())}),r.all(n)}).then(function(){t.fileStats.build()}).then(function(){return t.updatesQueue.load()}).then(function(){o.debug("init completed"),t.changeEvent.trigger("init")})},e.prototype.destroy=function(){this.stopSinkPolling()},e.prototype.addSink=function(e){var t=new f.SinkIndex(e,this);return t.changeEvent.add(this.onIndexChangeBinded,"multi"),this.indexes.put(e.id,t),this.sinkIndexCollection.add(t),this.filteredMessagesCollection.addCollection(t.filteredEntries),t.load()},e.prototype.removeSink=function(e){var t=this;return r(null).then(function(){var n=t.getIndexBySink(e);n&&(n.changeEvent.remove(t.onIndexChangeBinded),t.indexes.remove(e.id),t.sinkIndexCollection.remove(n),t.filteredMessagesCollection.removeCollection(n.filteredEntries))})},e.prototype.onIndexChange=function(e){this.changeEvent.trigger("index-change",e)},e.prototype.getAllCursors=function(){var e=this.indexes.getEnumerable();return Object.keys(e).map(function(t){return e[t].cursor})},e.prototype.getAllSinksEx=function(){return this.additionalSinks.concat(this.getAllSinks())},e.prototype.getAllSinks=function(){var e=this.indexes.getEnumerable();return Object.keys(e).map(function(t){return e[t].sink})},e.prototype.getAllIndexesBySinkType=function(e){return this.getAllIndexesAsList().filter(function(t){return t.sink.extra.type==e})},e.prototype.getAllIndexes=function(){return this.indexes.getEnumerable()},e.prototype.getIndexBySinkId=function(e){return this.indexes.get(e)},e.prototype.getSinkById=function(e){var t=this.getIndexBySinkId(e);return null==t?null:t.sink},e.prototype.getIndexBySink=function(e){return this.getIndexBySinkId(e.id)},e.prototype.getAllIndexesAsList=function(){return this.indexes.getValues()},e.prototype.updateIndexes=function(e){var t=this;return r(null).then(function(){return o.debug("updateIndexes",e),t.holdChangeEvent(),m.oneByOne(e,function(e,n){o.debug("sink id",e);var r=t.getIndexBySinkId(e);return null==r?void o.debug("index not found!",e):r.process(n)}).fin(function(){t.releaseChangeEvent()})})},e.prototype.holdChangeEvent=function(){this.changeEvent.hold()},e.prototype.releaseChangeEvent=function(){this.changeEvent.release()},e.prototype.holdChangeEventDeep=function(){this.holdChangeEvent();for(var e in this.indexes.getEnumerable())this.indexes.get(e).holdChangeEvent()},e.prototype.releaseChangeEventDeep=function(){for(var e in this.indexes.getEnumerable())this.indexes.get(e).releaseChangeEvent();this.releaseChangeEvent()},e.prototype.getIndexEntryFromHandler=function(e){if(e instanceof h.SinkIndexEntry)return e;var t=this.getIndexBySink(e.sink);return null==t?null:t.getEntry(e.id)},e.prototype.getCursorBySink=function(e){return this.getCursorBySinkId(e.id)},e.prototype.getCursorBySinkId=function(e){var t=this.getIndexBySinkId(e);return null==t?null:t.cursor},e.prototype.startSinkPolling=function(){this.sinkPolling||(this.sinkPolling=new d.SinkPolling(this,(!0)))},e.prototype.stopSinkPolling=function(){this.sinkPolling&&(this.sinkPolling.destroy(),delete this.sinkPolling)},e.prototype.getCombinedStats=function(){var e=l.SinkIndexStats.getEmpty();return this.indexes.forEach(function(t){l.SinkIndexStats.addStats(e,t.getStats())}),e},e.prototype.getContactFormSink=function(){return null==this.contactFormSink&&(this.contactFormSink={value:v.Lang.find(this.getAllSinksEx(),function(e){return"contact"==e.extra.type})}),this.contactFormSink.value},e}();n.SinkIndexManager=b},{"../utils/Event":485,"../utils/Lang":489,"../utils/Map":490,"../utils/collection/MergedCollection":500,"../utils/collection/MutableCollection":501,"./SinkIndex":449,"./SinkIndexEntry":450,"./SinkIndexStats":452,"./SinkPolling":453,"./UpdatesQueue":454,"./filestats/FileStats":456,q:327,"simplito-logger":357,"simplito-promise":370}],452:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../utils/Event"),i=function(){function e(e){this.collection=e,this.bindedEvent=this.onEvents.bind(this),this.collection.changeEvent.add(this.bindedEvent,"multi"),this.changeEvent=new r.Event}return e.prototype.destroy=function(){this.collection.changeEvent.remove(this.bindedEvent,"multi"),this.changeEvent.clear()},e.prototype.onEvents=function(e){this.recalculateStats()},e.prototype.recalculateStats=function(){var t=e.getEmpty();this.collection.forEach(function(e){var n=e.source.data.type||"";t.byType[n]||(t.byType[n]={unread:0}),e.isRead()||(t.unread++,t.byType[n].unread++)}),e.compareStats(this.stats,t)||(this.stats=t,this.changeEvent.trigger())},e.compareStats=function(e,t){if(null==e||null==t)return!1;if(e.unread!=t.unread)return!1;for(var n in e.byType)if(!(n in t.byType)||e.byType[n].unread!=t.byType[n].unread)return!1;for(var n in t.byType)if(!(n in e.byType)||e.byType[n].unread!=t.byType[n].unread)return!1;return!0},e.addStats=function(e,t){e.unread+=t.unread;for(var n in t.byType)n in e.byType?e.byType[n].unread+=t.byType[n].unread:e.byType[n]={unread:t.byType[n].unread}},e.getEmpty=function(){return{unread:0,byType:{}}},e.getUnreadByType=function(e,t){return e&&e.byType&&t in e.byType?e.byType[t].unread:0},e.prototype.getStats=function(){return null==this.stats&&this.recalculateStats(),this.stats},e}();n.SinkIndexStats=i},{"../utils/Event":485}],453:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("simplito-logger"),o=i.get("privfs-mail-client.mail.SinkPolling"),s=e("simplito-promise"),a=s.PromiseUtils,u=function(){function e(e,t){var n=this;this.sinkIndexManager=e,this.guardian={value:!0};var i=!1;a.infinity(this.guardian,function(){var e;return r.Promise(function(e){n.resolve=e,null!=n.delay?(n.timeoutHandle=setTimeout(n.kick.bind(n),n.delay),n.delay=null):t&&!i&&(i=!0,n.kick())}).then(function(){if(n.guardian.value){var t=n.sinkIndexManager.getAllCursors();return o.debug("Polling sinks...",t),e=n.sinkIndexManager.taskStream.createDeferedTask("sink-polling",t),n.sinkIndexManager.messageManager.sinkPoll(t,!1,!0)}}).then(function(t){if(n.guardian.value)return e.progress("process"),o.debug("Handling sinks polling result",t),n.delay=t.delay,n.sinkIndexManager.updateIndexes(t.sinks).then(function(){o.debug("handlePollSinksResult success")}).fin(function(){if(n.guardian.value)return n.sinkIndexManager.updatesQueue.run().fail(function(e){o.debug("UpdatesQueue error",e,e.stack)})})}).then(function(){e&&e.endWithSuccess()}).fail(function(t){o.error("Poll was interrupted -",t,t.stack),e&&e.endWithError(),n.delay=5e3})})}return e.prototype.kick=function(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null),this.resolve&&(this.resolve(null),this.resolve=null)},e.prototype.destroy=function(){this.guardian.value=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle),this.timeoutHandle=null,this.resolve=null},e}();n.SinkPolling=u},{q:327,"simplito-logger":357,"simplito-promise":370}],454:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=e("simplito-logger"),o=i.get("privfs-mail-client.mail.UpdatesQueue"),s=e("privfs-client"),a=e("simplito-utils"),u=e("simplito-promise"),c=u.PromiseUtils,f=function(){function e(e){this.sinkIndexManager=e,this.queue=[],this.storageKey="updates-queue"}return e.prototype.load=function(){var e=this;return r(null).then(function(){return o.debug("load",e.storageKey),e.sinkIndexManager.storage.get(e.storageKey)}).then(function(t){t&&t.forEach(function(t){e.queue.push({status:"new",type:t.type,sinkId:t.sinkId,destSinkId:t.destSinkId,msgId:t.msgId,newData:t.newData,oldData:t.oldData,newTags:t.newTags,oldTags:t.oldTags,oldSource:t.oldSource,messages:t.messages})})}).then(function(){o.debug("loaded",e.queue)})},e.prototype.save=function(){var e=this;return r(null).then(function(){o.debug("save");var t=[];return e.queue=e.queue.filter(function(e){return"done"!=e.status}),e.queue.forEach(function(e){t.push({type:e.type,sinkId:e.sinkId,destSinkId:e.destSinkId,msgId:e.msgId,newData:e.newData,oldData:e.oldData,newTags:e.newTags,oldTags:e.oldTags,oldSource:e.oldSource,messages:e.messages})}),e.sinkIndexManager.storage.set(e.storageKey,t)})},e.prototype.findExistingTask=function(e,t){for(var n in this.queue){var r=this.queue[n];if(r.sinkId==e&&r.msgId==t)return r}return null},e.prototype.revertTask=function(e,t){return null==t?e.status="done":(e.status="new",e.type=t.type,e.sinkId=t.sinkId,e.msgId=t.msgId,e.newData=t.newData,e.oldData=t.oldData,e.newTags=t.newTags,e.oldTags=t.oldTags,e.oldSource=t.oldSource,e.destSinkId=t.destSinkId,e.messages=t.messages),this.save()},e.prototype.addUpdateTask=function(e,t,n,i,s,u,c){var f=this;return r(null).then(function(){o.debug("addUpdateTask",e,t,n,i,s,u);var r=f.findExistingTask(e,t),l=a.simpleDeepClone(r);if(null==r)r={status:null,type:"update",sinkId:e,msgId:t,oldData:n,oldTags:s},f.queue.push(r);else if("delete"==r.type||"move"==r.type)return void o.warn("Cannot change task type to 'update'",r,e,t,n,i,s,u);return r.newData=i,r.newTags=u,r.status="addding",f.save().then(c).fail(function(){return f.revertTask(r,l)}).then(function(){r.status="new",f.run()})})},e.prototype.addDeleteTask=function(e,t,n,i,s,u){var c=this;return r(null).then(function(){o.debug("addDeleteTask",e,t,n,i,s);var r=c.findExistingTask(e,t),f=a.simpleDeepClone(r);return null==r&&(r={status:null,type:null,sinkId:e,msgId:t,oldData:i,oldTags:s},c.queue.push(r)),r.type="delete",r.oldSource=n,r.status="addding",c.save().then(u).fail(function(){return c.revertTask(r,f)}).then(function(){r.status="new",c.run()})})},e.prototype.addMoveTask=function(e,t,n,i,s,u,c){var f=this;return r(null).then(function(){o.debug("addMoveTask",e,t,n,i,s,u);var r=f.findExistingTask(e,t),l=a.simpleDeepClone(r);if(null==r)r={status:null,type:null,sinkId:e,msgId:t,oldData:i,oldTags:s},f.queue.push(r);else if("delete"==r.type)return void o.warn("Cannot change task type to 'move'",r,e,t,n,i,s,u);return r.type="move",r.newData=i,r.newTags=s,r.oldSource=n,r.destSinkId=u,r.status="addding",f.save().then(c).fail(function(){return f.revertTask(r,l)}).then(function(){r.status="new",f.run()})})},e.prototype.addDeleteBulkTask=function(e,t,n){var i=this;return r(null).then(function(){o.debug("addDeleteBulkTask",e,t);var r={sinkId:e,type:"deleteBulk",messages:t,status:"addding"};return i.queue.push(r),i.save().then(n).fail(function(){return i.revertTask(r)}).then(function(){r.status="new",i.run()})})},e.prototype.run=function(){var e=this;return r(null).then(function(){if(o.debug("run",e.queue.length),!e.running&&0!=e.queue.length)return e.running=!0,c.oneByOne(e.queue,function(t,n){if("new"==n.status){o.debug("Running task",n);var r=e.sinkIndexManager.getIndexBySinkId(n.sinkId);if(null==r)return o.warn("Cannot find index for task",n),void(n.status="done");if(n.status="processing","update"==n.type)return e.sinkIndexManager.messageManager.messageModify(r.cursor,n.msgId,n.newData,n.newTags,!0).then(function(){return n.status="done",o.debug("Task success",n),r.save()}).fail(function(e){return s.core.ApiErrorCodes.is(e,"INVALID_MOD_SEQ")?(o.debug("Task fail - INVALID_MOD_SEQ",n),void(n.status="new")):s.core.ApiErrorCodes.is(e,"MESSAGE_DOESNT_EXISTS")?(o.debug("Task fail - MESSAGE_DOESNT_EXISTS",n),n.status="done",r.deleteOldEntry(n.msgId)):(o.error("Task fail - rollback change",n,e,e.stack),n.status="done",r.revertUpdateEntry(n.msgId,n.oldData,n.oldTags))}).fail(function(e){o.error("Task unexpected error",n,e,e.stack)});if("move"==n.type){var i=e.sinkIndexManager.getSinkById(n.destSinkId);if(null==i)return o.warn("Cannot find destination index for task - rollback change",n),n.status="done",r.revertMoveEntry(n.msgId,n.oldSource,n.oldData,n.oldTags);var a=s.message.Message.deserializeFromSourceWithoutCheckingSignature(n.oldSource);return e.sinkIndexManager.messageManager.messageMove(a,n.newData,n.newTags,r.cursor,i,!0).then(function(){return n.status="done",o.debug("Task success",n),r.save()}).fail(function(e){return s.core.ApiErrorCodes.is(e,"INVALID_MOD_SEQ")?(o.debug("Task fail - INVALID_MOD_SEQ",n),void(n.status="new")):s.core.ApiErrorCodes.is(e,"MESSAGE_DOESNT_EXISTS")?(o.debug("Task fail - MESSAGE_DOESNT_EXISTS",n),n.status="done",r.deleteOldEntry(n.msgId)):(o.error("Task fail - rollback change",n,e,e.stack),n.status="done",r.revertMoveEntry(n.msgId,n.oldSource,n.oldData,n.oldTags))}).fail(function(e){o.error("Task unexpected error",n,e,e.stack)})}if("delete"==n.type)return e.sinkIndexManager.messageManager.messageDelete(r.cursor,n.msgId,!0).then(function(){return n.status="done",o.debug("Task success",n),r.save()}).fail(function(e){return s.core.ApiErrorCodes.is(e,"INVALID_MOD_SEQ")?(o.debug("Task fail - INVALID_MOD_SEQ",n),void(n.status="new")):s.core.ApiErrorCodes.is(e,"MESSAGE_DOESNT_EXISTS")?(o.debug("Task fail - MESSAGE_DOESNT_EXISTS",n),n.status="done",r.deleteOldEntry(n.msgId)):(o.error("Task fail - rollback change",n,e,e.stack),n.status="done",r.revertDeleteEntry(n.msgId,n.oldSource,n.oldData,n.oldTags))}).fail(function(e){o.error("Task unexpected error",n,e,e.stack)});if("deleteBulk"==n.type){var u=[];for(var t in n.messages)u.push(n.messages[t].id);return e.sinkIndexManager.messageManager.messageDelete(r.cursor,u,!0).then(function(){return n.status="done",o.debug("Task success",n),r.save()}).fail(function(e){return s.core.ApiErrorCodes.is(e,"INVALID_MOD_SEQ")?(o.debug("Task fail - INVALID_MOD_SEQ",n),void(n.status="new")):(o.error("Task fail - rollback change",n,e,e.stack),n.status="done",r.revertDeleteBulk(n.messages))}).fail(function(e){o.error("Task unexpected error",n,e,e.stack)})}o.warn("Invalid task type",n),n.status="done"}})["finally"](function(){e.save(),e.running=!1})})},e}();n.UpdatesQueue=f},{"privfs-client":204,q:327,"simplito-logger":357,"simplito-promise":370,"simplito-utils":373}],455:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../utils/Event"),i=e("simplito-logger"),o=i.get("privfs-mail-client.mail.UserPreferences"),s=e("simplito-promise"),a=s.PromiseUtils,u=e("simplito-utils"),c=e("q"),f=e("lodash.get"),l=e("lodash.set"),h=function(){function e(e,t,n){this.hashmail=e,this.storage=t,this.fileName=n,this.changeEvent=new r.Event}return e.prototype.load=function(){var t=this;return c(null).then(function(){return o.debug("load"),t.storage.optReadJson(t.fileName,e.DEFAULTS)}).then(function(e){t.data=e||{},o.debug("loaded",t.data),t.changeEvent.trigger("load")})},e.prototype.save=function(e){var t=this,n=e||this.data;return a.notify(function(e){return o.debug("save"),e("Saving user preferences"),t.storage.saveJson(t.fileName,n)}).then(function(){t.data=n,o.debug("saved",t.data),t.changeEvent.trigger("save")})},e.prototype.set=function(e,t,n){var r=this;return c(null).then(function(){if(o.debug("set",e,t,n),l(r.data,e,t),n)return r.save()})},e.prototype.setMany=function(e,t){var n=this;return c(null).then(function(){o.debug("setMany",e,t);for(var r in e)l(n.data,r,e[r]);if(t)return n.save()})},e.prototype.get=function(e,t){var n=this;return c(null).then(function(){return o.debug("get",e,t),n.getValue(e,t)})},e.prototype.getValue=function(e,t){return f(this.data,e,t)},e.prototype.getMany=function(e){var t=this;return c(null).then(function(){o.debug("getMany",e);var n={};if(Array.isArray(e))e.forEach(function(e){n[e]=f(t.data,e)});else for(var r in e)n[r]=f(t.data,r,e[r]);return n})},e.prototype.update=function(e){var t=this;return c(null).then(function(){o.debug("update");var n=t.data?u.simpleDeepClone(t.data):{};return e(n)}).then(function(e){if(e)return t.save(e)})},e.DEFAULTS={version:1,ui:{windowTitleBarButtonsPosition:"right",audio:!1,seenFirstLoginInfo:!1},profile:{name:"",image:"",description:""},notifications:{enabled:!1,email:"",mails:!0,chats:!0,files:!0},presence:{autoPresenceAfterLogin:!1,dontAskAboutPresenceType:!1,type:"noone",whitelist:[]}},e}();n.UserPreferences=h},{"../utils/Event":485,"lodash.get":131,"lodash.set":132,q:327,"simplito-logger":357,"simplito-promise":370,"simplito-utils":373}],456:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./FileStatsEntry"),i=function(){function e(e){this.built=!1,this.loadedEntries=[],this.entries={},this.visibilityMap=e||{}}return e.prototype.build=function(){this.loadedEntries.sort(function(e,t){return e.source.serverDate-t.source.serverDate}),this.built=!0;for(var e in this.loadedEntries)this.addIndexEntry(this.loadedEntries[e])},e.prototype.getIdAndPath=function(t){if("container-event"!=t.source.data.type)return null;var n=t.getContentAsJson();if(null==n||null==n.url||null==n.did||null==n.path)return null;var r=e.parsePath(n.path);return null==r?null:{id:n.url+n.did,path:r}},e.prototype.addIndexEntry=function(e){if(!this.built)return void this.loadedEntries.push(e);var t=this.getIdAndPath(e);if(null!=t){if(this.unread=null,!(t.id in this.entries)){var n=new r.FileStatsEntry("",e);n.id=t.id,n.visible=null==this.visibilityMap[t.id]||!!this.visibilityMap[t.id].visibility,this.entries[t.id]=n}this.entries[t.id].addIndexEntry(e,t.path)}},e.prototype.updateIndexEntry=function(e){if(this.built){var t=e.sink.id+"/"+e.id;t in r.FileStatsEntry.EntriesMap&&r.FileStatsEntry.EntriesMap[t].resetCounters(),this.unread=null}},e.prototype.deleteIndexEntry=function(e){if(!this.built){var t=this.loadedEntries.indexOf(e);return void(t!=-1&&this.loadedEntries.splice(t,1))}var n=this.getIdAndPath(e);null!=n&&n.id in this.entries&&(this.unread=null,this.entries[n.id].deleteIndexEntry(e,n.path))},e.prototype.getFileStatsEntry=function(t,n){if(!(t in this.entries))return null;var r=e.parsePath(n);return null==r?null:this.entries[t].getFileStatsEntry(r)},e.prototype.updateContainersVisibility=function(e){this.unread=null,this.visibilityMap=e||{};for(var t in this.entries)this.entries[t].visible=null==this.visibilityMap[t]||!!this.visibilityMap[t].visibility},e.prototype.getUnreadCount=function(){if(null==this.unread){this.unread=0;for(var e in this.entries){var t=this.entries[e];this.unread+=t.visible?t.getUnreadCount():0}}return this.unread},e.parsePath=function(e){if("string"!=typeof e)return null;var t=e.split("/");if(1==t.length||""!=t[0])return null;for(var n=""==t[t.length-1]?t.slice(1,t.length-1):t.slice(1),r=0;r<n.length;r++)if(""==n[r])return null;return n},e}();n.FileStats=i},{"./FileStatsEntry":457}],457:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(t,n){this.name=t,this.entries=[],this.children={},e.EntriesMap[n.sink.id+"/"+n.id]=this}return e.prototype.generateDeletedName=function(){return[".trash",Math.random().toString(36).replace(/[^a-z]+/g,""),(new Date).getTime(),Math.random().toString(36).replace(/[^a-z]+/g,"")].join("-")},e.prototype.addIndexEntry=function(t,n){if(0==n.length)this.resetCounters(),this.insertIndexEntry(t);else{var r=n.shift();if(r in this.children){if(e.EntriesMap[t.sink.id+"/"+t.id]=this.children[r],"remove-file"===t.contentAsJson.type){var i=this.generateDeletedName();this.children[i]=this.children[r],delete this.children[r],r=i}}else if("rename-file"===t.contentAsJson.type){var o=t.contentAsJson.data;this.children[o]?(this.children[r]=this.children[o],this.children[r].name=r,delete this.children[o],e.EntriesMap[t.sink.id+"/"+t.id]=this.children[r]):(this.children[r]=new e(r,t),this.children[r].parent=this)}else this.children[r]=new e(r,t),this.children[r].parent=this;this.children[r].addIndexEntry(t,n)}},e.prototype.resetCounters=function(e){e?(this.unread=null,this.groupedEntries=null,this.entriesRecursive=null,this.childrenUnread=null):(this.unread=null,this.groupedEntries=null,this.entriesRecursive=null,this.currentUnread=null,this.currentGroupedEntries=null),this.parent&&this.parent.resetCounters(!0)},e.prototype.deleteIndexEntry=function(e,t){if(0==t.length)this.unread=null,this.groupedEntries=null,this.entriesRecursive=null,this.currentUnread=null,this.currentGroupedEntries=null,this.removeIndexEntry(e);else{this.unread=null,this.groupedEntries=null,this.entriesRecursive=null,this.childrenUnread=null;var n=t.shift();n in this.children&&this.children[n].deleteIndexEntry(e,t)}},e.prototype.getFileStatsEntry=function(e){if(0==e.length)return this;var t=e.shift();return t in this.children?this.children[t].getFileStatsEntry(e):null},e.prototype.insertIndexEntry=function(e){for(var t=e.source.serverDate,n=0;n<this.entries.length;n++){if(e==this.entries[n])return;if(t<this.entries[n].source.serverDate)return void this.entries.splice(n,0,e)}this.entries.push(e)},e.prototype.removeIndexEntry=function(e){for(var t=0;t<this.entries.length;t++)e==this.entries[t]&&this.entries.splice(t,1)},e.prototype.getCurrentGroupedEntries=function(){var e=18e5;if(null==this.currentGroupedEntries){var t=null;this.currentGroupedEntries=[];for(var n=0;n<this.entries.length;n++){var r=this.entries[n],i=r.getContentAsJson(),o=null==t?0:Math.abs(r.source.serverDate-t.date.getTime());null!=t&&"edit"==t.type&&"edit"==i.type&&t.sender==r.source.data.sender.hashmail&&o<e?(t.entries.push(r),t.unread+=r.isRead()?0:1,t.date=new Date(r.source.serverDate)):(t={type:i.type,path:i.path,sender:r.source.data.sender.hashmail,date:new Date(r.source.serverDate),unread:r.isRead()?0:1,entries:[r]},this.currentGroupedEntries.push(t))}}return this.currentGroupedEntries},e.prototype.getGroupedEntries=function(){if(null==this.groupedEntries){var e=this.getCurrentGroupedEntries(),t=[];for(var n in this.children)t.push(this.children[n].getGroupedEntries());this.groupedEntries=e.concat.apply(e,t),this.groupedEntries.sort(function(e,t){return e.date.getTime()-t.date.getTime()})}return this.groupedEntries},e.prototype.getCurrentUnreadCount=function(){if(null==this.currentUnread){this.currentUnread=0;for(var e=this.getCurrentGroupedEntries(),t=0;t<e.length;t++)this.currentUnread+=e[t].unread>0?1:0}return this.currentUnread},e.prototype.getChildrenUnreadCount=function(){if(null==this.childrenUnread){this.childrenUnread=0;for(var e in this.children)this.childrenUnread+=this.children[e].getUnreadCount()}return this.childrenUnread},e.prototype.getUnreadCount=function(){return null==this.unread&&(this.unread=this.getCurrentUnreadCount()+this.getChildrenUnreadCount()),this.unread},e.prototype.getEntries=function(){return this.entries},e.prototype.getEntriesRecursive=function(){if(null==this.entriesRecursive){var e=[];for(var t in this.children)e.push(this.children[t].getEntriesRecursive());this.entriesRecursive=this.entries.concat.apply(this.entries,e),this.entriesRecursive.sort(function(e,t){return e.source.serverDate-t.source.serverDate})}return this.entriesRecursive},e.EntriesMap={},e}();n.FileStatsEntry=r},{}],458:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../utils/Event"),i=function(){function e(e,t){this.fileStats=e,this.collection=t,this.onChangeEventBinded=this.onChangeEvent.bind(this),this.bindedEvent=this.onChangeEvents.bind(this),this.collection.changeEvent.add(this.bindedEvent,"multi"),this.changeEvent=new r.Event}return e.prototype.destroy=function(){this.collection.changeEvent.remove(this.bindedEvent,"multi"),this.changeEvent.clear()},e.prototype.onChangeEvents=function(e){r.Event.applyEvents(e,this.onChangeEventBinded),this.changeEvent.trigger()},e.prototype.onChangeEvent=function(e){"add"==e.type?this.fileStats.addIndexEntry(e.element):"remove"==e.type?this.fileStats.deleteIndexEntry(e.element):"update"==e.type&&this.fileStats.updateIndexEntry(e.element)},e}();n.FileStatsToCollectionBinder=i},{"../../utils/Event":485}],459:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){
function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("q"),o=e("privfs-client"),s=e("simplito-utils"),a=e("simplito-promise"),u=a.PromiseUtils,c=e("./Entry"),f=function(e){function t(t,n,r,i,o){var s=e.call(this,"directory",t,n,r,i,o)||this;return s.opened=!1,s.loaded=!1,s.onChangeBinded=function(){s.reload().then(s.tree.triggerBinded)},s.tree.storage.addDirectoryOnChangeCallback(s.path,s.onChangeBinded),s}return r(t,e),t.prototype.isRoot=function(){return this==this.tree.root},t.prototype.openDeep=function(e){var t=this;return this.open(null==e||e>=0).then(function(){return u.settle(t.entries,function(t,n){if(n.isDirectory())return n.openDeep(null==e?null:e-1)}).then(function(){})})},t.prototype.reloadDeep=function(){var e=this;return i(null).then(function(){if(e.loaded)return e.reload().then(function(){return u.oneByOne(e.entries,function(e,t){if(t.isDirectory())return t.reloadDeep()})})})},t.prototype.readMeta=function(){var e=this;return this.tree.storage.stat(this.path).then(function(t){e.meta=t.meta})},t.prototype.getDirectoriesCount=function(){if(null==this.entries)return null;var e=0;for(var t in this.entries)e+=this.entries[t].isDirectory()?1:0;return e},t.prototype.getFilesCount=function(){if(null==this.entries)return null;var e=0;for(var t in this.entries)e+=this.entries[t].isFile()?1:0;return e},t.prototype.open=function(e){var t=this;return this.load().then(function(){return e!==!1&&(t.opened=!0),t})},t.prototype.close=function(){var e=this;return i(null).then(function(){return e.opened=!1,e})},t.prototype.toggle=function(){return(this.opened?this.close():this.open()).then(this.tree.triggerBinded)},t.prototype.resolvePath=function(e,t){return s.endsWith(e,"/")?e+t:e+"/"+t},t.prototype.load=function(){var e=this;return i(null).then(function(){return e.loaded?e:e.tree.storage.list(e.path).then(function(n){var r=n.slice(0);r.sort(e.dirEntriesComparer);var i=[];for(var o in r){var s=r[o],a=e.getEntry(s.name);null!=a&&a.ref.equals(s.ref)&&("file"==s.type&&a instanceof l.File||"directory"==s.type&&a instanceof t)?i.push(a):"directory"==s.type?i.push(new t(e.tree,e,s.ref,e.resolvePath(e.path,s.name),s.name)):i.push(new l.File(e.tree,e,s.ref,e.resolvePath(e.path,s.name),s.name))}return e.entries=i,e.loaded=!0,e})})},t.prototype.reload=function(){return this.loaded=!1,this.load()},t.prototype.dirEntriesComparer=function(e,t){if(e.type!=t.type)return"directory"==e.type?-1:1;var n=e.name.toLowerCase().localeCompare(t.name.toLowerCase());return 0!=n?n:e.name.localeCompare(t.name)},t.prototype.addDirectory=function(e){var n=this,r=this.resolvePath(this.path,e);return this.tree.storage.mkdir(r).then(function(i){var o=n.getEntry(e);return null==o?n.insert(new t(n.tree,n,i,r,e)):o})},t.prototype.addFile=function(e,t){var n=this,r=this.resolvePath(this.path,e);return this.tree.storage.createText(r,"",t).fail(function(e){return n.revertCreate(r,e).thenResolve(null)}).then(function(t){var i=n.getEntry(e);return null==i?n.insert(new l.File(n.tree,n,t,r,e)):i})},t.prototype.addTextFile=function(e,t,n){var r=this,i=this.resolvePath(this.path,e);return this.tree.storage.createText(i,t,n).fail(function(e){return r.revertCreate(i,e).thenResolve(null)}).then(function(t){var n=r.getEntry(e);return null==n?r.insert(new l.File(r.tree,r,t,i,e)):n})},t.prototype.addJsonFile=function(e,t,n){var r=this,i=this.resolvePath(this.path,e);return this.tree.storage.createJson(i,t,n).fail(function(e){return r.revertCreate(i,e).thenResolve(null)}).then(function(t){var n=r.getEntry(e);return null==n?r.insert(new l.File(r.tree,r,t,i,e)):n})},t.prototype.addLazyBuffer=function(e){for(var t=this,n=e.getName(),r=n.lastIndexOf("."),i=r==-1?"":n.substring(r),o=r==-1?n:n.substring(0,r),s=1;null!=this.getEntry(n);)n=o+"("+s+")"+i,s++;var a=this.resolvePath(this.path,n);return this.tree.storage.createLazyBuffer(a,e).fail(function(e){return t.revertCreate(a,e).thenResolve(null)}).then(function(e){var r=t.getEntry(n);return null==r?t.insert(new l.File(t.tree,t,e,a,n)):r})},t.prototype.revertCreate=function(e,t){var n=this.tree.storage;return i(null).then(function(){if(!o.exception.PrivFsException.is(t,"FILE_ALREADY_EXISTS")&&!o.exception.PrivFsException.is(t,"NAME_IN_USE"))return n.remove(e)}).fin(function(){return i.reject(t)})},t.prototype.insert=function(e){if(this.loaded){for(var t=0;t<this.entries.length;t++)if(this.dirEntriesComparer(e,this.entries[t])<0)return this.entries.splice(t,0,e),e;this.entries.push(e)}return e},t.prototype.getEntry=function(e){for(var t in this.entries){var n=this.entries[t];if(n.name==e)return n}return null},t.prototype.sort=function(){this.entries.sort(this.dirEntriesComparer)},t.prototype.getEntryByRefId=function(e){if(this.ref.id===e)return this;for(var t,n=[].concat(this.entries||[]);n.length;){if(t=n.shift(),t.ref.id===e)return t;t.isDirectory()&&t.entries&&(n=n.concat(t.entries))}},t}(c.Entry);n.Directory=f;var l=e("./File")},{"./Entry":460,"./File":461,"privfs-client":204,q:327,"simplito-promise":370,"simplito-utils":373}],460:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e,t,n,r,i,o){this.type=e,this.tree=t,this.parent=n,this.ref=r,this.path=i,this.name=o}return e.prototype.getNextAfterRoot=function(){for(var e=this;;){if(null==e.parent)return null;if(e.parent==this.tree.root)return e;e=e.parent}},e.prototype.isActive=function(){return this==this.tree.active},e.prototype.remove=function(){return this.tree.storage.remove(this.path)},e.prototype.unlink=function(){return this.tree.storage.unlink(this.path)},e.prototype.rename=function(e){var t=this;return this.tree.storage.rename(this.path,e).then(function(){t.name=e,t.path=t.parent.resolvePath(t.parent.path,e),t.parent.sort()})},e.prototype.stat=function(e){return this.tree.storage.stat(this.path,e)},e.prototype.isDirectory=function(){return this instanceof o.Directory},e.prototype.isFile=function(){return this instanceof i.File},e}();n.Entry=r;var i=e("./File"),o=e("./Directory")},{"./Directory":459,"./File":461}],461:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("q"),o=e("privfs-client"),s=e("simplito-utils"),a=e("./Path"),u=e("simplito-logger"),c=e("./Entry"),f=u.get("privfs-mail-client.mail.filetree.File"),l=function(e){function t(t,n,r,i,o){var s=e.call(this,"file",t,n,r,i,o)||this,u=a.Path.splitFileName(o);return s.fileName=u.name,s.ext=u.ext,s.extl=u.extl,s}return r(t,e),t.prototype.rename=function(t){var n=this;return t&&this.hasTextExt()&&(t=s.endsWith(t.toLowerCase(),this.extl)?t:t+this.extl),e.prototype.rename.call(this,t).then(function(){var e=a.Path.splitFileName(t);n.fileName=e.name,n.ext=e.ext,n.extl=e.extl})},t.prototype.open=function(e){return this.tree.storage.open(this.path,e)},t.prototype.openContent=function(){return this.tree.storage.readContent(this.path)},t.prototype.openDataUrl=function(){return this.openContent().then(function(e){return e.getDataUrl()})},t.prototype.openText=function(){return this.tree.storage.readText(this.path)},t.prototype.openJson=function(){return this.tree.storage.readJson(this.path)},t.prototype.saveText=function(e,t){return this.tree.storage.saveText(this.path,e,t)},t.prototype.saveJson=function(e,t){return this.tree.storage.saveJson(this.path,e,t)},t.prototype.lock=function(e){var t,n=this;return i(null).then(function(){if(null!=n.lockHandle){if(n.lockHandle!=e)throw new Error("locked-by-another-process");return n.lockHandle}return n.tree.storage.open(n.path,o.fs.file.Mode.WRITE_ONLY)}).then(function(e){return t=e,t.lock()}).then(function(){return n.lockHandle=t,t})},t.prototype.release=function(e){var t=this;return i(null).then(function(){if(null==t.lockHandle&&f.warn("Releasing with lock id, when there is any lock"),t.lockHandle!=e)throw new Error("locked-by-another-process");return t.lockHandle.release()}).then(function(){t.lockHandle=null})},t.prototype.hasImageExt=function(){return a.Path.imageExt.indexOf(this.extl)!=-1},t.prototype.hasTextExt=function(){return a.Path.textExt.indexOf(this.extl)!=-1},t}(c.Entry);n.File=l},{"./Entry":460,"./Path":462,"privfs-client":204,q:327,"simplito-logger":357,"simplito-utils":373}],462:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){}return e.splitFileName=function(e){var t=e.lastIndexOf("."),n=t==-1?e:e.substring(0,t),r=t==-1?"":e.substring(t),i=r.toLowerCase();return{original:e,name:n,ext:r,extl:i}},e.parsePath=function(t){for(var n=t.split("/"),r=this.splitFileName(n[n.length-1]),i={name:r,path:t,parts:n,isImgExt:e.imageExt.indexOf(r.extl)!=-1,isTextExt:e.textExt.indexOf(r.extl)!=-1,formatted:1==n.length?"/":""},o=1;o<n.length-1;o++)i.formatted+=n[o]+"/";return n.length>1&&(i.formatted+=i.isImgExt||i.isTextExt?i.name.name:i.name.original),i},e.ext={STX:".stx",SSS:".sss",SMM:".smm",STT:".stt"},e.textExt=[e.ext.STX,e.ext.SSS,e.ext.SMM,e.ext.STT],e.imageExt=[".gif",".png",".ico",".bmp",".dib",".tiff",".tif",".jpg",".jpeg",".jpe",".jif",".jfif",".jfi"],e}();n.Path=r},{}],463:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-utils"),i=e("../../utils/Event"),o=function(){function e(e,t,n){this.storage=e,this.root=new s.Directory(this,null,this.storage.rootRef,t,n),this.changeEvent=new i.Event,this.triggerBinded=this.changeEvent.trigger.bind(this.changeEvent)}return e.prototype.find=function(e){if(e=e.trim(),e==this.root.path)return this.root;if(!r.startsWith(e,this.root.path))return null;e=e.substring(this.root.path.length),r.endsWith(e,"/")&&(e=e.substring(0,e.length-1));for(var t=e.split("/"),n=this.root,i=0;i<t.length;i++){var o=n.getEntry(t[i]);if(null==o||i!=t.length-1&&"directory"!=o.type)return null;n=o}return n},e.prototype.openDeep=function(e){return this.root.openDeep(e)},e.prototype.setActive=function(e){this.active=e},e.prototype.getEntryByRefId=function(e){return this.root.getEntryByRefId(e)},e}();n.Tree=o;var s=e("./Directory")},{"../../utils/Event":485,"./Directory":459,"simplito-utils":373}],464:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Tree");n.Tree=r.Tree;var i=e("./Directory");n.Directory=i.Directory;var o=e("./File");n.File=o.File;var s=e("./Entry");n.Entry=s.Entry},{"./Directory":459,"./Entry":460,"./File":461,"./Tree":463}],465:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var t=e("privfs-client"),r=e("simplito-promise"),i=r.PromiseUtils,o=e("q"),s=e("simplito-logger"),a=s.get("privfs-mail-client.migration.EncryptionSignature"),u=function(){function e(){}return e.perform=function(e,n){var r,s,u,f,l,h,p,d;return t.crypto.service.privmxSetErrorOnMissingSignature(!1),o(null).then(function(){return a.debug("Initialization"),r=new t.identity.Hashmail(e),c.MailClientApi.getSrp(r.host)}).then(function(e){return a.debug("Login"),e.privFsSrp.basicLogin(r.user,r.host,n,!0)}).then(function(e){return a.debug("Get priv data"),s=e.srpSecure,u=e.encryptor,e.srpSecure.getPrivData(u)}).then(function(e){return a.debug("Init identity"),f=e,f.dataVersion=t.core.PrivFsSrp.DATA_VERSION,t.core.PrivFsSrpEx.loginLastStep(s,f,c.MailClientApi.IDENTITY_INDEX)}).then(function(e){return a.debug("Init client"),l=e,h=new t.core.Client(s.gateway,l.identity,l.masterExtKey),h.init()}).then(function(){return a.debug("Get sink encryptor"),p=h.getMessageManager(),c.MailClientApi.getSinkEncryptor(h)}).then(function(e){return a.debug("Get my sinks"),d=e,p.sinkGetAllMy(d)}).then(function(e){return i.oneByOne(e,function(e,t){return a.debug("Perform sink",t.id),o(null).then(function(){return a.debug("  Get messages list"),p.sinkInfo(t.id,!0)}).then(function(e){return a.debug("  Get messages meta"),0==e.mids.length?{}:p.messageGet(t,e.mids,"META",!0)}).then(function(e){return o(null).then(function(){a.debug("  Encrypt messages meta");var n=[];for(var r in e){var i=o(e[r]).then(function(e){return p.encryptFlags(e.meta.data,t).then(function(t){e.flagsEnc=t})});n.push(i)}return o.all(n)}).then(function(){a.debug("  Save messages meta");var n=[];for(var r in e){var i=s.request("messageReplaceFlags",{sid:t.id,mid:parseInt(r),flags:e[r].flagsEnc});n.push(i)}return o.all(n)})}).then(function(){return a.debug("  Save sink"),p.sinkSave(t,d)})})}).then(function(){return o(null).then(function(){return a.debug("  Encrypt priv data"),u.encrypt(f)}).then(function(e){if(f.recovery){var n;return o(null).then(function(){return a.debug("  Decode recovery"),t.crypto.service.bip39FromEntropy(new Buffer(f.recovery,"base64"))}).then(function(e){return a.debug("  Encrypt priv data by recovery"),n=e,t.core.PrivFsKeyLogin.getEncryptorFromBip39(n).encrypt(f)}).then(function(r){return a.debug("  Save priv data and recovery"),s.request("setRecoveryData",{privData:e.toString("base64"),recoveryData:{pub:n.extKey.getPublicKey().toBase58DER(),data:r.toString("base64")},dataVersion:t.core.PrivFsSrp.DATA_VERSION})})}return a.debug("  Save priv data"),s.request("setPrivData",{privData:e.toString("base64"),dataVersion:t.core.PrivFsSrp.DATA_VERSION})})}).then(function(){return l}).fin(function(){t.crypto.service.privmxSetErrorOnMissingSignature(!0)})},e}();n.EncryptionSignature=u;var c=e("../mail/MailClientApi")}).call(this,e("buffer").Buffer)},{"../mail/MailClientApi":440,buffer:590,"privfs-client":204,q:327,"simplito-logger":357,"simplito-promise":370}],466:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../mail/SinkIndexEntry"),i=e("../mail/LowUser"),o=e("../app/browser/FileUtils");n.FileUtils=o.FileUtils;var s=e("../utils/Lang");n.Lang=s.Lang;var a=e("q");n.Q=a;var u=e("privfs-client");n.privfs=u;var c=e("../utils/ImageTypeDetector");n.ImageTypeDetector=c.ImageTypeDetector;var f=e("simplito-promise");n.PromiseUtils=f.PromiseUtils;var l=e("simplito-logger"),h="webLiteRequire"in window?webLiteRequire("web-lite"):null,p=h?h.$:null,d=function(){function e(){this.query=this.parseQueryString(window.location.search);var e=function(e){return"DEBUG"==e||"ERROR"==e||"INFO"==e||"OFF"==e||"WARN"==e},t=!!this.query.devmode,n=t?"WARN":"ERROR";e(this.query.loglevel)&&(n=this.query.loglevel),l.setLevel(l[n]),t&&l.get("privfs-client.gateway.RpcGateway").setLevel(l.DEBUG)}return e.prototype.parseQueryString=function(e){if(!e)return{};e=0==e.indexOf("?")?e.substring(1):e;var t=e.split("&"),n={};for(var r in t)if(t[r].indexOf("=")==-1)n[t[r]]=!0;else{var i=t[r].split("=");n[i[0]]=window.decodeURIComponent(i[1])}return n},e.prototype.login=function(e,t){var n;return a(null).then(function(){return n=new u.identity.Hashmail(e),u.core.PrivFsSrpManager.getHttpSrpByHost(n.host)}).then(function(e){return e.login(n.user,n.host,t,!1,!0)}).then(function(e){return g.create(n,e.privData,e.srpSecure)})},e.prototype.openAttachment=function(){return o.FileUtils.openFile().then(function(e){return u.message.MessageAttachment.create(e)})},e.prototype.openAttachments=function(){return o.FileUtils.openFiles().then(function(e){return s.Lang.map(e,function(e){return u.message.MessageAttachment.create(e)})})},e}();n.TalkPageApp=d;var g=function(){function e(e,t,n,r,i,o,s,a){this.hashmail=e,this.privData=t,this.srpSecure=n,this.identity=r,this.sink=i,this.receiver=o,this.client=s,this.messageManager=a}return e.create=function(t,n,r){var o=i.LowUserService.getPrivDataEx(t,n),s=new u.core.Client(r.gateway,o.identity,null);return a().then(function(){return s.init()}).then(function(){var i={user:o.receiver,name:o.receiver.name||o.receiver.hashmail,hashmail:o.receiver.hashmail,image:null},a=new e(t,n,r,o.identity,o.sink,i,s,s.getMessageManager());return r.getUserInfo(o.receiver.user,o.receiver.host,!0).then(function(e){e.profile.name&&(i.name=e.profile.name),e.profile.image&&(i.image=c.ImageTypeDetector.createDataUrlFromBuffer(e.profile.image))}).fail(function(e){console.log("Fetching pki profile error",e)}).thenResolve(a)})},e.prototype.createMessage=function(e,t,n){var r=new u.message.Message;return r.setSender(this.identity),r.addReceiver(new u.message.MessageReceiver(this.sink,this.receiver.user)),r.title=e,r.text=t,n.forEach(function(e){r.addAttachment(e)}),r},e.prototype.sendMessage=function(e,t,n){return this.postMessage(this.createMessage(e,t,n))},e.prototype.postMessage=function(e){var t=this;return a().then(function(){return t.messageManager.messagePost(e,r.SinkIndexEntry.getMessageTags(e))}).then(function(e){return e&&1==e.length?e[0].success?void 0:a.reject(e[0]):a.reject(e)})},e.prototype.getMessages=function(e){var t,n=this;return a().then(function(){return n.messageManager.sinkInfo(n.sink.id,!0)}).then(function(r){return t=new u.message.MessageSinkCursor(n.sink,r.seq,r.modSeq),null!=e&&e==r.seq?null:n.messageManager.messageGet(n.sink,r.mids,"DATA_AND_META",!1)}).then(function(e){return{messages:e,cursor:t}})},e}();n.TalkPageAppSession=g;var y=function(){function e(e){var t=this;this.$ele=e,u.core.PrivFsRpcManagerClass.SERVICE_DISCOVERY_JSON_MODE="https:"===window.location.protocol?u.serviceDiscovery.JsonMode.HTTPS_ONLY:u.serviceDiscovery.JsonMode.HTTP_ONLY,this.app=new d,this.attachmentId=0,this.attachments={},this.manager=new h.Manager,this.manager.helper=new h.ViewHelper(this.manager),this.manager.helper.i18n=this.i18n.bind(this),this.msgTemplate=this.manager.createTemplateFromHtmlElement(this.$ele.find("#msg-template")),this.attachmentTemplate=this.manager.createTemplateFromHtmlElement(this.$ele.find("#attachment-template")),this.msgLoadingTemplate=this.manager.createTemplateFromHtmlElement(this.$ele.find("#msg-loading-template")),this.alertTemplate=this.manager.createTemplateFromHtmlElement(this.$ele.find("#alert-template")),this.momentService=h.MomentService.create(),this.momentService.setLang(LANG),this.messagesSortAsc=!1,this.$loginPage=this.$ele.find(".lg-login-page"),this.$messagePage=this.$ele.find(".lg-message-page"),this.$newMessagePage=this.$ele.find(".lg-new-message-page"),this.$pmxButtons=this.$ele.find(".pmxbuttons"),this.$ele.on("click",".lg-close-alert",this.onCloseAlertClick.bind(this)),this.$loginPage.find(".lg-login-btn").click(this.onLoginClick.bind(this)),this.$loginPage.find("input").keydown(this.onLoginInput.bind(this)),this.$loginPage.find(".pass-trigger").click(this.onPassTrigger.bind(this)),this.$loginPage.find(".pass-hint-content").click(this.onPassContentClick.bind(this)),this.$pmxButtons.find(".lg-refresh-btn").click(this.onRefreshClick.bind(this)),this.$pmxButtons.find(".lg-new-msg-btn").click(this.onNewMsgBtnClick.bind(this)),this.$pmxButtons.find(".lg-file-filter").click(this.onFileFilterClick.bind(this)),this.$newMessagePage.find(".lg-add-attachments-btn").click(this.onAddAttachmentClick.bind(this)),this.$newMessagePage.find(".lg-send-btn").click(this.onSendClick.bind(this)),this.$newMessagePage.find(".lg-close-btn").click(this.onCloseBtnClick.bind(this)),this.$newMessagePage.find(".lg-show-messages").click(this.onShowMessagesClick.bind(this)),this.$newMessagePage.on("click",".lg-attachment-delete",this.onDeleteAttachmentClick.bind(this)),this.$messagePage.on("click",".lg-msg-attachment-download",this.onMsgDownloadAttachmentClick.bind(this)),this.$messagePage.change(".lg-msg-sort-type",this.onSortTypeChange.bind(this)),this.$messagePage.on("click",".message-quote-toggle",this.onMessageQuoteToggleClick.bind(this)),this.$messagePage.on("click","a",this.onAhrefClick.bind(this)),this.$messagePage.on("click",".lg-content-toggle",this.onPostConentToggleClick.bind(this)),this.$ele.find(".footer").append("<span>"+(new Date).getFullYear()+"</span>"),setTimeout(function(){t.$loginPage.find("input").focus(),t.resetNewMsgForm()},100)}return e.init=function(){p(document).ready(function(){window.app=new e(p("body"))})},e.prototype.i18n=function(e){return e in I18N_DATA?I18N_DATA[e]:e},e.prototype.onPassTrigger=function(){this.$loginPage.find(".pass-trigger").addClass("hide"),this.$loginPage.find(".pass-hint-content").removeClass("hide")},e.prototype.onPassContentClick=function(){this.$loginPage.find(".pass-trigger").removeClass("hide"),this.$loginPage.find(".pass-hint-content").addClass("hide")},e.prototype.onAhrefClick=function(e){var t=p(e.target).closest("a"),n=t.attr("href");if(0==n.indexOf("mailto:"))return e.preventDefault(),!1},e.prototype.customAlert=function(e){var t=this.alertTemplate.renderToJQ(e);this.$ele.append(t)},e.prototype.onCloseAlertClick=function(e){p(e.target).closest(".alert-modal").remove()},e.prototype.onLoginInput=function(e){13==e.keyCode&&this.onLoginClick()},e.prototype.onLoginClick=function(){var e=this,t=this.$loginPage.find(".lg-password").val(),n=this.$loginPage.find(".lg-error");if(!t)return void n.removeClass("hide").text(this.i18n("login.password.required"));var r=this.$loginPage.find("button, input, textarea"),i=this.$loginPage.find(".lg-login-btn");return r.prop("disabled",!0),n.addClass("hide"),i.prepend('<i class="fa fa-spin fa-circle-o-notch"></i>'),a().then(function(){return e.app.login(HASHMAIL,t)}).then(function(t){e.$loginPage.addClass("hide"),e.$pmxButtons.removeClass("hide"),e.$messagePage.removeClass("hide"),i.find("i").remove(),e.session=t,e.renderMessages(!1),e.messagesCheck();var n=e.session.receiver.hashmail;e.session.receiver.name&&(n="<b>"+e.manager.helper.escapeHtml(e.session.receiver.name)+"</b> <span class='hashmail'>&lt;"+e.session.receiver.hashmail+"&gt;</span>"),e.$newMessagePage.find(".lg-receiver-avatar").attr("src",e.session.receiver.image?e.session.receiver.image:DEFAULT_AVATAR_URL),e.$newMessagePage.find(".lg-receiver-name").html(n)}).fail(function(t){console.log("Login error",t),r.prop("disabled",!1),i.find("i").remove();var o=e.i18n("login.error.unknown");u.core.ApiErrorCodes.isEx(t,"DIFFERENT_M1")?o=e.i18n("login.error.invalid"):u.core.ApiErrorCodes.isEx(t,"USER_DOESNT_EXIST")?o=e.i18n("login.error.invalid"):u.core.ApiErrorCodes.isEx(t,"INVALID_VERIFER")&&(o=e.i18n("login.error.invalid")),n.removeClass("hide").text(o)})},e.prototype.getMsgModel=function(e){var t=e.data.sender.pub58==this.session.identity.pub58,n=e.data.sender.pub58==this.session.receiver.user.pub58;return{id:e.meta.msgId,avatar:t?DEFAULT_EMAIL_URL:n&&this.session.receiver.image?this.session.receiver.image:DEFAULT_AVATAR_URL,name:t?this.i18n("messages.you"):n?this.session.receiver.name:e.data.sender.name,address:t?this.session.identity.name:n?this.session.receiver.hashmail:e.data.sender.hashmail,ago:this.momentService.timeAgo(e.data.createDate),date:e.data.createDate,text:e.data.text,contentType:e.data.contentType,attachments:e.data.attachments}},e.prototype.onFileFilterClick=function(){this.showOnlyWithAttachment=!this.showOnlyWithAttachment,this.$ele.toggleClass("lg-show-all-msg",!this.showOnlyWithAttachment),this.refreshFilesFilterButton(),this.renderNewMessages(),this.renderOldMessages()},e.prototype.refreshFilesFilterButton=function(){var e=this.$messagePage.find(".lg-file-filter");this.showOnlyWithAttachment?e.html(this.i18n("messages.buttons.files.showAll")):this.attachmentsCount?e.html(this.i18n("messages.buttons.files.short")+" ("+this.attachmentsCount+")"):e.html(this.i18n("messages.buttons.files")),e.prop("disabled",!this.showOnlyWithAttachment&&!this.attachmentsCount)},e.prototype.onRefreshClick=function(){this.renderMessages(!1)},e.prototype.messagesCheck=function(){var e=this;setTimeout(function(){e.renderMessages(!0),e.messagesCheck()},1e4)},e.prototype.renderMessages=function(e){var t=this,n=this.$messagePage.find(".lg-load-messages"),r=this.$messagePage.find(".lg-old-messages"),i=this.$messagePage.find(".lg-new-messages");return e!==!0&&(n.html(this.msgLoadingTemplate.renderToJQ()).removeClass("hide"),r.addClass("hide"),i.addClass("hide")),this.session.getMessages(e===!0&&this.lastCursor?this.lastCursor.seq:null).then(function(o){if(e!==!0||null!=o.messages){t.lastCursor=o.cursor,t.messages=o.messages,t.currentTitle=t.messages.length>0?t.messages[0].data.title:"<no-title>",t.$messagePage.find(".lg-title").text(t.currentTitle),t.$newMessagePage.find(".lg-title").text(t.currentTitle),window.document.title=t.currentTitle+" -- "+t.i18n("title2");var s=t.messages.filter(function(e){return!e.meta.data||!e.meta.data.read});f.PromiseUtils.oneByOne(s,function(e,n){var r=n.meta.data||{};return r.read=!0,t.session.messageManager.messageModify(o.cursor,n.meta.msgId,r,n.meta.tags,!0)}).fail(function(e){console.log("Error during changing messages flags",e)}),t.newMessages=s.filter(function(e){return e.data.sender.pub58!=t.session.identity.pub58}),t.renderNewMessages(),t.oldMessages=t.messages.filter(function(e){return e.data.sender.pub58==t.session.identity.pub58||e.meta.data&&1==e.meta.data.read}),t.renderOldMessages(),n.html("").addClass("hide"),0==t.newMessages.length?r.removeClass("hide"):(r.removeClass("hide"),i.removeClass("hide")),r.find(".section-label").html(0==t.newMessages.length?t.i18n("messages.messages"):t.i18n("messages.previous")),t.attachmentsCount=0,t.messages.forEach(function(e){t.attachmentsCount+=e.data.attachments.length}),t.refreshFilesFilterButton()}}).fail(function(o){n.html("").addClass("hide"),r.removeClass("hide"),i.removeClass("hide"),console.log("Read messages error",o),e!==!0&&t.customAlert(t.i18n("messages.error.read"))})},e.prototype.renderMsg=function(e){var t=this,n=this.msgTemplate.renderToJQ(e);return n.find("a.linkified[href^='mailto:']").each(function(e,n){p("<span>"+t.manager.helper.escapeHtml(p(n).text())+"</span>").insertAfter(n),p(n).remove()}),n},e.prototype.renderNewMessages=function(){var e=this;this.newMessages.sort(function(e,t){return t.data.createDate.getTime()-e.data.createDate.getTime()});var t=this.$messagePage.find(".lg-new-messages-list");t.html(""),this.$messagePage.find(".lg-new-messages-counter").text(this.newMessages.length),this.newMessages.forEach(function(n){var r=e.getMsgModel(n);e.showOnlyWithAttachment&&0==r.attachments.length||t.append(e.renderMsg(r))})},e.prototype.renderOldMessages=function(){var e=this;this.oldMessages.sort(function(t,n){return(e.messagesSortAsc?-1:1)*(n.data.createDate.getTime()-t.data.createDate.getTime())});var t=this.$messagePage.find(".lg-old-messages-list");t.html(""),this.$messagePage.find(".lg-messages-counter").text(this.oldMessages.length),this.oldMessages.forEach(function(n){var r=e.getMsgModel(n);e.showOnlyWithAttachment&&0==r.attachments.length||t.append(e.renderMsg(r))})},e.prototype.onSortTypeChange=function(){this.messagesSortAsc="asc"==this.$messagePage.find(".lg-msg-sort-type").val(),this.renderOldMessages()},e.prototype.onMessageQuoteToggleClick=function(e){var t=p(e.target).closest(".message-quote-toggle"),n=t.next().is(":visible");t.find("span").html(this.i18n(n?"core.toggleQuote":"core.hideQuote")),t.find("i").attr("class",n?"fa fa-caret-right":"fa fa-caret-down"),t.next().toggle()},e.prototype.onPostConentToggleClick=function(e){var t=p(e.target).closest(".lg-content-toggle"),n=t.next().hasClass("lg-visible");t.find("span").html(this.i18n(n?"core.showContent":"core.hideContent")),t.find("i").attr("class",n?"fa fa-caret-right":"fa fa-caret-down"),t.next().toggleClass("lg-visible",!n)},e.prototype.onMsgDownloadAttachmentClick=function(e){var t=this,n=p(e.target).closest(".lg-msg-attachment"),r=n.data("msg-id"),i=n.data("att-index"),u=s.Lang.find(this.messages,function(e){return e.meta.msgId==r});if(null!=u){var c=u.data.attachments[i];if(null!=c){var f=n.find(".att-loading");0==f.length&&(f=p('<div class="att-loading"><i class="fa fa-spin fa-circle-o-notch"></i></div>'),n.append(f)),a().then(function(){return t.session.messageManager.download(t.session.sink,{id:r},c,!0)}).then(function(e){return f.remove(),o.FileUtils.saveContent(e)}).fail(function(e){console.log("Download attachment error",e),f.remove(),t.customAlert(t.i18n("messages.error.downloadAttachment"))})}}},e.prototype.onAddAttachmentClick=function(){var e=this;this.app.openAttachments().then(function(t){var n=e.$newMessagePage.find(".lg-attachments");t.forEach(function(t){var r=e.attachmentId++;e.attachments[r]=t,n.append(e.attachmentTemplate.renderToJQ({id:r,name:t.name,icon:0==t.mimeType.indexOf("image/")?"fa-file-image-o":"fa-file-o"}))}),e.$newMessagePage.find(".lg-attachments-empty").toggleClass("hide",s.Lang.getValues(e.attachments).length>0)}).fail(function(e){return console.log("Error during adding attachment",e)})},e.prototype.onDeleteAttachmentClick=function(e){var t=p(e.target).closest(".lg-attachment"),n=t.data("id");delete this.attachments[n],t.remove(),this.$newMessagePage.find(".lg-attachments-empty").toggleClass("hide",s.Lang.getValues(this.attachments).length>0)},e.prototype.onNewMsgBtnClick=function(){this.$messagePage.addClass("hide"),this.$newMessagePage.removeClass("hide")},e.prototype.onCloseBtnClick=function(){this.$messagePage.find(".lg-new-msg-btn").removeClass("lg-continue-mode"),this.$messagePage.removeClass("hide"),this.$newMessagePage.addClass("hide"),this.resetNewMsgForm()},e.prototype.onShowMessagesClick=function(){this.$messagePage.find(".lg-new-msg-btn").addClass("lg-continue-mode"),this.$messagePage.removeClass("hide"),this.$newMessagePage.addClass("hide")},e.prototype.resetNewMsgForm=function(){this.$newMessagePage.find(".lg-text").val(""),this.attachments={},this.$newMessagePage.find(".lg-attachments .lg-attachment").remove(),this.$newMessagePage.find(".lg-attachments-empty").removeClass("hide")},e.prototype.onSendClick=function(){var e=this,t=this.$newMessagePage.find(".lg-text").val(),n=this.$newMessagePage.find(".lg-error"),r=this.$newMessagePage.find("button, input, textarea"),i=this.$newMessagePage.find(".lg-send-btn");return i.addClass("sending").prepend('<i class="fa fa-spin fa-circle-o-notch"></i>'),r.prop("disabled",!0),n.addClass("hide"),a().then(function(){var n=e.currentTitle&&0==e.currentTitle.indexOf("Re:")?e.currentTitle:"Re: "+e.currentTitle;return e.session.sendMessage(n,t,s.Lang.getValues(e.attachments))}).then(function(){r.prop("disabled",!1),i.removeClass("sending").find("> i").remove(),e.$messagePage.find(".lg-new-msg-btn").removeClass("lg-continue-mode"),e.$messagePage.removeClass("hide"),e.$newMessagePage.addClass("hide"),e.resetNewMsgForm(),e.renderMessages(!1)}).fail(function(t){console.log("Send message error",t),r.prop("disabled",!1),i.removeClass("sending").find("> i").remove(),e.customAlert(e.i18n("newMessage.error"))})},e}();n.View=y},{"../app/browser/FileUtils":401,"../mail/LowUser":439,"../mail/SinkIndexEntry":450,"../utils/ImageTypeDetector":488,"../utils/Lang":489,"privfs-client":204,q:327,"simplito-logger":357,"simplito-promise":370}],467:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=function(){function e(e){this.mailClientApi=e,this.srpSecure=e.srpSecure}return e.prototype.getCustomSrpSecure=function(){var e=this;return r(null).then(function(){return e.customSrpSecure?e.customSrpSecure.gateway.rpc.connection.broken?(delete e.customSrpSecure,r.delay(500).then(function(){return e.getCustomSrpSecure()})):e.customSrpSecure:e.mailClientApi.cloneSrpSecure().then(function(t){return e.tickets&&Object.keys(e.tickets).length?t.gateway.rpc.connection.tickets=e.tickets:e.tickets=t.gateway.rpc.connection.tickets,e.customSrpSecure=t,t})})},e.prototype.updaterCheckPackVersionStatus=function(){return this.srpSecure.request("updaterCheckPackVersionStatus",{})},e.prototype.updaterInitUpdate=function(e){return this.srpSecure.request("updaterInitUpdate",{version:e})},e.prototype.updaterGetUpdateStatus=function(e){return this.getCustomSrpSecure().then(function(t){return t.request("updaterGetUpdateStatus",{updateID:e},{timeout:3e4})})},e.prototype.updaterStartUpdate=function(e){return this.srpSecure.request("updaterStartUpdate",{updateID:e},{timeout:12e4,sendAlone:!0})},e.prototype.updaterGetInstalledPackInfo=function(){return this.srpSecure.request("updaterGetInstalledPackInfo",{})},e.prototype.updaterGetUpdateVersionDetails=function(e){
return this.srpSecure.request("updaterGetUpdateVersionDetails",{version:e})},e.prototype.updaterSetLastSeenUpdate=function(e){return this.srpSecure.request("updaterSetLastSeenUpdate",{version:e})},e}();n.UpdaterApi=i},{q:327}],468:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./template/noAdmin.html"),i=function(){function e(){}return e.synchronizeUserConfig=function(e){e.update={};var t=e.mailClientApi.userConfig;t.pack&&(e.update.customUpdatesChannel=t.pack.customUpdatesChannel,e.update.updatesChannel=t.pack.updatesChannel,e.update.currentVersion=t.pack.version,e.update.currentVersionDisplay=t.pack.displayVersion,e.update.currentVersionMajor=t.pack.majorVersion,e.update.currentVersionBuildId=t.pack.buildId),t.lastUpdate&&t.lastUpdate.availableUpdate&&(e.update.newVersion=t.lastUpdate.availableUpdate.version,e.update.newVersionDisplay=t.lastUpdate.availableUpdate.displayVersion,e.update.newVersionMajor=t.lastUpdate.availableUpdate.majorVersion,e.update.newVersionBuildId=t.lastUpdate.availableUpdate.buildId,e.update.info=t.lastUpdate.availableUpdate.info,e.update.sha1=t.lastUpdate.availableUpdate.sha1,e.update.seenByAdmin=t.lastUpdate.availableUpdate.version==t.lastSeenUpdate),t.lastUpdate&&t.lastUpdate.info&&(e.update.currentInfo=t.lastUpdate.info.info),e.update.available=t.pack&&t.lastUpdate&&t.lastUpdate.availableUpdate&&t.lastUpdate.availableUpdate.version!=t.pack.version,e.update.infoToDisplay=e.update.available?e.update.info:e.update.currentInfo,e.update.upToData=!e.update.available&&null!=t.pack&&null!=t.lastUpdate},e.updateInfo=function(t,n){var r=t.mailClientApi.userConfig;return n.error?void(n.pack&&(r.pack=n.pack,e.synchronizeUserConfig(t))):(r.pack=n.pack,r.lastUpdate=n.update,r.lastSeenUpdate=n.update&&n.update.availableUpdate?n.update.availableUpdate.version:n.pack.version,e.synchronizeUserConfig(t),t.update.seenByMe=!0,void e.removeIndicator())},e.initUpdaterInfo=function(t){e.synchronizeUserConfig(t),t.update.available&&!t.update.seenByAdmin&&t.getSettings().get("plugin-updater-indicator").then(function(n){if(t.update.seenByMe=n==t.update.newVersion,!t.update.seenByMe&&t.initializer){var r=t.initializer.handler.jquery,i=r('<span style="color: #94ef01; cursor: pointer; margin-left: 10px;"><i class="fa fa-wrench" style="margin-right: 3px;"></i> '+t.localeService.i18n("index.update.text")+"</span>");r("#opened-windows-bar .version").append(i),i.click(function(){e.showUpdate(t)}),e.$indicator=i}}).fail(function(e){console.log("Error during checking update indicator",e)})},e.removeIndicator=function(){e.$indicator&&(e.$indicator.remove(),e.$indicator=null)},e.showUpdate=function(t){return e.removeIndicator(),t.mailClientApi.isAdmin()?void t.openAdmin("plugin-updater"):(t.msgBox.alertEx({bodyStyle:"background-color: #292929; color: #fff",ok:{btnClass:"btn-default"},messageAsTemplateFunc:function(e,n,i){return r.func(t,n,i)}}),t.getSettings().set("plugin-updater-indicator",t.update.newVersion))},e}();n.UpdaterInfo=i},{"./template/noAdmin.html":470}],469:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../../utils/PluginsRegistry"),i=e("../../../window/admin/AdminWindowController"),o=e("../../../window/login/register/RegisterController"),s=e("../window/admin/updater/UpdaterController"),a=e("../window/login/register/RegisterControllerExt"),u=e("../../../window/about/AboutWindowController"),c=e("../window/about/AboutWindowControllerExt"),f=e("../../../window/admin/sysInfo/SysInfoController"),l=e("../window/admin/SysInfoControllerExt"),h=e("./UpdaterInfo");r.PluginsRegistry.register(i.AdminWindowController,"updater",{createComponents:function(e){e.registerNamedComponent("plugin-updater-updater",new s.UpdaterController(e))}}),r.PluginsRegistry.register(o.RegisterController,"updater",{createComponents:function(e){e.registerNamedComponent("plugin-updater-register",new a.RegisterControllerExt(e))}}),r.PluginsRegistry.register(u.AboutWindowController,"updater",{createComponents:function(e){e.registerNamedComponent("plugin-updater-about",new c.AboutWindowControllerExt(e))}}),r.PluginsRegistry.register(f.SysInfoController,"updater",{createComponents:function(e){e.registerNamedComponent("plugin-updater-sysinfo",new l.SysInfoControllerExt(e))}}),r.PluginsRegistry.events.on("after-login",function(e){h.UpdaterInfo.initUpdaterInfo(e)}),n.plugin={name:"updater"}},{"../../../utils/PluginsRegistry":493,"../../../window/about/AboutWindowController":515,"../../../window/admin/AdminWindowController":516,"../../../window/admin/sysInfo/SysInfoController":520,"../../../window/login/register/RegisterController":539,"../window/about/AboutWindowControllerExt":471,"../window/admin/SysInfoControllerExt":472,"../window/admin/updater/UpdaterController":473,"../window/login/register/RegisterControllerExt":475,"./UpdaterInfo":468}],470:[function(e,t,n){"use strict";n.__esModule=!0,n.func=function(e,t,n){var r="",i=function(e){r+=e};return i('<div style="font-size: 14px;">\n    <div style="margin-bottom: 20px">\n        '),i(n.escapeHtml(n.i18n("window.admin.updater.statsu.available"))),i('\n    </div>\n    <div style="margin-bottom: 20px">\n        '),e.update.info&&(i('\n            <div style="margin-bottom: 20px">\n                '),i(n.safeHtml2(e.update.info)),i("\n            </div>\n        ")),i("\n        <div>\n            "),i(n.escapeHtml(n.i18n("window.admin.updater.infoLink"))),i('\n            <a href="https://privmx.com/versions" target="_blank" rel="noopener noreferrer">https://privmx.com/versions</a>\n        </div>\n    </div>\n    <div>\n        '),i(n.escapeHtml(n.i18n("index.update.noAdmin"))),i("\n    </div>\n</div>\n"),r}},{}],471:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../../../window/base/WindowComponentController"),o=e("../../app/UpdaterApi"),s=e("../../app/UpdaterInfo"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.updaterPluginEnabled=n.app.mailClientApi.isServerPluginEnabled("updater"),n.updaterPluginEnabled&&(t.openWindowOptions.height=530),n}return r(t,e),t.prototype.onViewReady=function(){var e=this;if(this.updaterPluginEnabled){var t=new o.UpdaterApi(this.app.mailClientApi);t.updaterGetInstalledPackInfo().then(function(t){t||(t={client:e.app.getVersion().str,server:null,version:null,displayVersion:null,majorVersion:null,buildId:null,customUpdatesChannel:null,updatesChannel:null});var n={pack:t,update:e.app.update};e.callViewMethod("render",n)})}},t.prototype.onViewShowUpdate=function(){s.UpdaterInfo.showUpdate(this.app)},t}(i.WindowComponentController);n.AboutWindowControllerExt=a},{"../../../../window/base/WindowComponentController":529,"../../app/UpdaterApi":467,"../../app/UpdaterInfo":468}],472:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../../../component/base/ComponentController"),o=e("../../app/UpdaterApi"),s=function(e){function t(t){var n=e.call(this)||this;return n.updaterApi=new o.UpdaterApi(t.app.mailClientApi),n.updaterPluginEnabled=t.app.mailClientApi.isServerPluginEnabled("updater"),t.modelTransformer=n.extendModel.bind(n),n}return r(t,e),t.prototype.extendModel=function(e){return this.updaterPluginEnabled?this.updaterApi.updaterGetInstalledPackInfo().then(function(t){return t&&(e.config.packVersion=t.displayVersion,e.config.clientVersion=t.client,e.config.serverVersion=t.server),e}):e},t}(i.ComponentController);n.SysInfoControllerExt=s},{"../../../../component/base/ComponentController":421,"../../app/UpdaterApi":467}],473:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../../../../window/base/WindowComponentController"),o=e("../../../app/UpdaterApi"),s=e("../../../app/UpdaterInfo"),a=e("q"),u=e("./template/error.html"),c=function(e){function t(t){var n=e.call(this,t)||this;return n.confirmEx=n.windowController.confirmEx.bind(n.windowController),n.updaterApi=new o.UpdaterApi(n.app.mailClientApi),n.updaterPluginEnabled=n.app.mailClientApi.isServerPluginEnabled("updater"),n.updaterPluginEnabled&&n.windowController.registerTab("plugin-updater",n),n}return r(t,e),t.prototype.getModel=function(){return{updaterPluginEnabled:this.updaterPluginEnabled,updateAvailable:this.app.update.available}},t.prototype.prepare=function(){var e=this;s.UpdaterInfo.removeIndicator(),this.app.update.available&&!this.app.update.seenByAdmin&&this.updaterApi.updaterSetLastSeenUpdate(this.app.update.newVersion).then(function(){e.app.mailClientApi.userConfig.lastSeenUpdate=e.app.update.newVersion}).fail(function(t){e.logError(t)});var t={info:this.app.update,error:null==this.app.update};this.callViewMethod("renderPanelContent",t)},t.prototype.onViewCheckPackVersionStatus=function(){var e=this;this.addTaskEx(this.i18n("checking pack version status"),!0,function(){return a(null).then(function(){return e.updaterApi.updaterCheckPackVersionStatus()}).then(function(t){s.UpdaterInfo.updateInfo(e.app,t),e.app.update.available?e.callViewMethod("refreshMenuEntry",!0):t.error||e.callViewMethod("refreshMenuEntry",!1);var n={info:e.app.update,error:null!=t.error};e.callViewMethod("renderPanelContent",n)}).fail(function(t){e.logError(t);var n={info:e.app.update,error:!0};e.callViewMethod("renderPanelContent",n)})})},t.prototype.onViewStartUpdate=function(){var e=this;this.confirmEx({message:this.i18n("window.admin.updater.startUpdate.info"),width:450,processing:"yes",yes:{label:this.i18n("window.admin.updater.startUpdate.yes")},no:{label:this.i18n("window.admin.updater.startUpdate.no")},onClose:function(t){return"yes"==t.result&&e.app.update.available?(t.startProcessing(),void e.updaterApi.updaterInitUpdate(e.app.update.newVersion).then(function(t){t.error?e.windowController.alertEx({width:700,height:400,messageAsTemplateFunc:function(e,n,r){return u.func(t.error,n,r)}}):window.location.href=t.updaterUrl}).fail(function(t){e.onError(t)}).fin(function(){t.stopProcessing()})):void t.close()}})},t}(i.WindowComponentController);n.UpdaterController=c},{"../../../../../window/base/WindowComponentController":529,"../../../app/UpdaterApi":467,"../../../app/UpdaterInfo":468,"./template/error.html":474,q:327}],474:[function(e,t,n){"use strict";n.__esModule=!0,n.func=function(e,t,n){var r="",i=function(e){r+=e};return i('<div id="update-error" class="selectable">\n<h3>Cannot initialize update</h3>\n<strong>'),i(n.escapeHtml(e.name)),i("</strong>\n"),e.data&&(i("\n  <pre>"),i(n.escapeHtml(JSON.stringify(e.data,null,2))),i("</pre>\n")),i("\n"),e.lastPhpError&&(i('\n  <p class="small">Last PHP error:</p>\n  <pre>'),i(n.escapeHtml(JSON.stringify(e.lastPhpError,null,2))),i("</pre>\n")),i("\n</div>\n"),r}},{}],475:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../../../../component/base/ComponentController"),o=function(e){function t(t){var n=e.call(this)||this;return t.model.noTerms=!0,n}return r(t,e),t}(i.ComponentController);n.RegisterControllerExt=o},{"../../../../../component/base/ComponentController":421}],476:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./Task"),o=e("q"),s=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r)||this;return o.func=i,o}return r(t,e),t.prototype.start=function(){var e=this;this.startDate=new Date,o(null).then(function(){return e.func()}).progress(function(t){e.currentProgress=t,e.defered.notify(t)}).then(function(t){e.result=!0,e.resultData=t,e.defered.resolve(t)}).fail(function(t){e.result=!1,e.resultData=t,e.defered.reject(t)})},t}(i.Task);n.AutoTask=s},{"./Task":481,q:327}],477:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./Task"),o=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.startDate=i.createDate,i}return r(t,e),t.prototype.progress=function(e){this.isFinished()||(this.currentProgress=e,this.defered.notify(e))},t.prototype.endWithSuccess=function(e){this.isFinished()||(this.result=!0,this.resultData=e,this.defered.resolve(e))},t.prototype.endWithError=function(e){this.isFinished()||(this.result=!1,this.resultData=e,this.defered.reject(e))},t}(i.Task);n.DeferedTask=o},{"./Task":481}],478:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./TaskStream"),o=function(e){function t(){var t=e.call(this)||this;return t.streams=[],t.onChildStreamEventBinded=t.onChildStreamEvent.bind(t),t}return r(t,e),t.prototype.getCurrentTasks=function(){for(var e=[],t=0;t<this.streams.length;t++)e.push(this.streams[t].getCurrentTasks());return Array.prototype.concat.apply([],e)},t.prototype.addStream=function(e){this.streams.push(e),e.changeEvent.add(this.onChildStreamEventBinded),this.changeEvent.trigger("new-stream")},t.prototype.onChildStreamEvent=function(){this.changeEvent.trigger.apply(this.changeEvent,arguments)},t}(i.TaskStream);n.MultiTaskStream=o},{"./TaskStream":482}],479:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./TaskStream"),o=e("./DeferedTask"),s=e("./AutoTask"),a=function(e){function t(){var t=e.call(this)||this;return t.lastTaskId=0,t}return r(t,e),t.prototype.createDeferedTask=function(e,t){var n=new o.DeferedTask((++this.lastTaskId),e,t);return this.addTask(n),n},t.prototype.createAutoTask=function(e,t,n){var r=new s.AutoTask((++this.lastTaskId),e,t,n);return this.addTask(r),r.start(),r},t.prototype.addTask=function(e){this.currentTasks.push(e),this.changeEvent.trigger("new-task",e),e.getPromise().progress(this.onTaskProgress.bind(this,e)).then(this.onTaskSuccess.bind(this,e)).fail(this.onTaskFail.bind(this,e))},t.prototype.onTaskProgress=function(e,t){this.changeEvent.trigger("task-progress",e,t)},t.prototype.onTaskSuccess=function(e,t){this.removeTask(e),this.changeEvent.trigger("task-success",e,t)},t.prototype.onTaskFail=function(e,t){this.removeTask(e),this.changeEvent.trigger("task-failure",e,t)},t.prototype.removeTask=function(e){for(var t=0;t<this.currentTasks.length;t++)if(e==this.currentTasks[t])return void this.currentTasks.splice(t,1)},t.prototype.destroy=function(){this.currentTasks=[],this.changeEvent.clear()},t}(i.TaskStream);n.ParallelTaskStream=a},{"./AutoTask":476,"./DeferedTask":477,"./TaskStream":482}],480:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./TaskStream"),o=e("./AutoTask"),s=function(e){function t(){var t=e.call(this)||this;return delete t.currentTasks,t.lastTaskId=0,t.tasks=[],t}return r(t,e),t.prototype.getCurrentTasks=function(){return this.currentTask?[this.currentTask]:[]},t.prototype.createTask=function(e,t,n){var r=new o.AutoTask((++this.lastTaskId),e,t,n);return null==this.currentTask?(this.currentTask=r,this.startCurrentTask()):this.tasks.push(r),r},t.prototype.startCurrentTask=function(){null!=this.currentTask&&(this.currentTask.start(),this.currentTask.getPromise().progress(this.onTaskProgress.bind(this,this.currentTask)).then(this.onTaskSuccess.bind(this,this.currentTask)).fail(this.onTaskFail.bind(this,this.currentTask)),this.changeEvent.trigger("new-task",this.currentTask))},t.prototype.onTaskProgress=function(e,t){this.changeEvent.trigger("task-progress",e,t)},t.prototype.onTaskSuccess=function(e,t){this.chooseNextTask(),this.changeEvent.trigger("task-success",e,t),this.startCurrentTask()},t.prototype.onTaskFail=function(e,t){this.chooseNextTask(),this.changeEvent.trigger("task-failure",e,t),this.startCurrentTask()},t.prototype.chooseNextTask=function(){if(0==this.tasks.length)this.currentTask=null;else{var e=this.tasks.shift();e.startDate=new Date,this.currentTask=e}},t.prototype.destroy=function(){this.tasks=[],this.currentTask=null,this.changeEvent.clear()},t}(i.TaskStream);n.SyncTaskStream=s},{"./AutoTask":476,"./TaskStream":482}],481:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=function(){function e(e,t,n){this.id=e,this.name=t,this.data=n,this.finished=!1,this.createDate=new Date,this.defered=r.defer()}return e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e.prototype.getData=function(){return this.data},e.prototype.getCreateDate=function(){return this.createDate},e.prototype.getStartDate=function(){return this.startDate},e.prototype.getCurrentProgress=function(){return this.currentProgress},e.prototype.isFinished=function(){return this.finished},e.prototype.getResult=function(){return this.result},e.prototype.getResultData=function(){return this.resultData},e.prototype.getPromise=function(){return this.defered.promise},e}();n.Task=i},{q:327}],482:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../utils/Event"),i=function(){function e(){this.changeEvent=new r.Event,this.currentTasks=[]}return e.prototype.getCurrentTasks=function(){return this.currentTasks},e}();n.TaskStream=i},{"../utils/Event":485}],483:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){}return e.getChars=function(t){return t&&t!=e.Curly?t==e.Angle?{open:"<",close:">"}:t==e.Lenticular?{open:"[",close:"]"}:void 0:{open:"(",close:")"}},e.Curly=1,e.Angle=2,e.Lenticular=3,e}();n.Bracket=r},{}],484:[function(e,t,n){(function(Buffer){"use strict";var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var r=e("./PromiseMap"),i=e("q"),o=e("privfs-client"),s=e("simplito-logger"),a=s.get("privfs-mail-client.utils.EncryptedPromiseMap"),u=function(e){function n(t,n){var r=e.call(this)||this;return r.encKey=t,r.keyHashMap={},r.map=n,r}return t(n,e),n.prototype.reset=function(){var e=this;return i(null).then(function(){e.encKey=null,e.keyHashMap={}})},n.prototype.hashKey=function(e){var t=this;return i(null).then(function(){if(e in t.keyHashMap)return t.keyHashMap[e];var n=new Buffer(e,"utf8");return o.crypto.service.hmacSha256(t.encKey,n).then(function(n){var r=n.toString("binary");return t.keyHashMap[e]=r,r})})},n.prototype.get=function(e){var t=this;return a.debug("get",e),this.hashKey(e).then(function(e){return t.map.getItem(e)}).then(function(n){if(!n)return null;if(null==t.encKey)throw new Error("Cannot decrypt! Encryption key is not present");var r=new Buffer(n,"binary");return o.crypto.service.ctDecrypt(r,t.encKey).then(function(t){var n=JSON.parse(t.toString("utf8"));return a.debug("get result",e,n),n})})},n.prototype.set=function(e,t){var n=this;return a.debug("set",e,t),this.hashKey(e).then(function(e){if(null==n.encKey)throw new Error("Cannot encrypt! Encryption key is not present");var r=new Buffer(JSON.stringify(t),"utf8");return o.crypto.service.ctAes256CbcPkcs7WithRandomIv(r,n.encKey).then(function(t){return n.map.setItem(e,t.toString("binary"))})})},n.prototype.remove=function(e){var t=this;return a.debug("remove",e),this.hashKey(e).then(function(e){return t.map.removeItem(e)})},n}(r.PromiseMap);n.EncryptedPromiseMap=u}).call(this,e("buffer").Buffer)},{"./PromiseMap":494,buffer:590,"privfs-client":204,q:327,"simplito-logger":357}],485:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-logger"),i=r.get("privfs-mail-client.utils.Event"),o=function(){function e(){this.callbacksSingle=[],this.callbacksMulti=[],this.events=[]}return e.prototype.add=function(e,t){if("undefined"==typeof t||"single"==t)this.callbacksSingle.push(e);else{if("multi"!=t)throw new Error("Invalid type '"+t+"'");this.callbacksMulti.push(e)}},e.prototype.remove=function(e,t){if("undefined"==typeof t||"both"==t||"single"==t)for(var n=0;n<this.callbacksSingle.length;n++)this.callbacksSingle[n]==e&&this.callbacksSingle.splice(n,1);if("undefined"==typeof t||"both"==t||"multi"==t)for(var n=0;n<this.callbacksMulti.length;n++)this.callbacksMulti[n]==e&&this.callbacksMulti.splice(n,1)},e.prototype.clear=function(){this.callbacksSingle=[],this.callbacksMulti=[]},e.prototype.hold=function(){this.locked=!0},e.prototype.release=function(){this.locked=!1,this.call()},e.prototype.trigger=function(e,t,n){this.events.push(arguments),this.call()},e.prototype.call=function(){this.locked||this.callCore()},e.prototype.callCore=function(){if(!this.locked&&0!=this.events.length){i.debug("Publishing events",this.events.length,this.events);for(var e=0;e<this.callbacksSingle.length;e++)for(var t=0;t<this.events.length;t++)try{this.callbacksSingle[e].apply(null,this.events[t])}catch(n){i.error(n,n.stack)}for(var e=0;e<this.callbacksMulti.length;e++)try{this.callbacksMulti[e].call(null,this.events)}catch(n){i.error(n,n.stack)}this.events=[]}},e.applyEvents=function(e,t,n){for(var r=0;r<e.length;r++)t.apply(n,e[r])},e}();n.Event=o},{"simplito-logger":357}],486:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Event"),i=function(){function e(){this.map={}}return e.prototype.on=function(e,t,n){if("string"!=typeof e)throw new Error("Invalid name");e in this.map||(this.map[e]=new r.Event),this.map[e].add(t,n)},e.prototype.off=function(e,t,n){if("string"!=typeof e)throw new Error("Invalid name");e in this.map&&this.map[e].remove(t,n)},e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if("string"!=typeof e)throw new Error("Invalid name");e in this.map||(this.map[e]=new r.Event);var i=this.map[e];i.trigger.apply(i,Array.prototype.slice.call(arguments,1))},e.prototype.clear=function(){for(var e in this.map)this.map[e].clear()},e.prototype.hold=function(){for(var e in this.map)this.map[e].hold()},e.prototype.release=function(){for(var e in this.map)this.map[e].release()},e}();n.Events=i},{"./Event":485}],487:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("linkifyjs/html"),i=function(){function e(){}return e.prototype.escapeHtml=function(t){if(null==t)return"";var n="string"==typeof t?t:t.toString();return n.replace(/[&<>"'`=\/]/g,function(t){return e.entityMap[t]})},e.prototype.escapeHtmlLight=function(t){if(null==t)return"";var n="string"==typeof t?t:t.toString();return n.replace(/[&<>"'`=]/g,function(t){return e.entityMap[t]})},e.prototype.text=function(e){var t=this.escapeHtml(e);return this.nl2br(t)},e.prototype.pad=function(e,t,n,r){var i=e.toString();if(i.length>=t)return i;n=n||" ";for(var o=t-i.length,s="",a=0;a<o;a++)s+=n;return"right"==r?i+s:s+i},e.prototype.dateWithHourLocal=function(e){var t="object"==typeof e?e:new Date(parseInt(e));return t.getFullYear()+"-"+this.pad(t.getMonth()+1,2,"0")+"-"+this.pad(t.getDate(),2,"0")+" "+this.pad(t.getHours(),2,"0")+":"+this.pad(t.getMinutes(),2,"0")+"."+this.pad(t.getSeconds(),2,"0")},e.prototype.linkify=function(e,t,n,i){var o;o=i?e.replace(/<br(\s)*(\/)*(\s)*>/gi,"\n"):e,t||(o=this.escapeHtml(e)),n=n||"",o=r(o,{attributes:{rel:"noopener noreferrer","data-window-opener":"true",title:n}});var s=/(^|\s+)(\w+#[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)*)/gim;return o=o.replace(s,'$1<span class="link linkify" data-window-opener="true" title="'+n+'" data-url="hashmailto:$2">$2</span>'),o=this.nl2br(o)},e.prototype.nl2br=function(e){return e.replace(/(\r\n|\n\r|\r|\n)/g,"<br>")},e.prototype.bytesSize=function(e){var t=1024,n=Math.log(e)/Math.log(t)|0,r=e/Math.pow(t,n);return r=Math.floor(100*r)/100,r+" "+(0==n?"":"KMGTPEZY"[n-1])+"B"},e.prototype.truncate=function(e,t,n){if(n=n||"...",e)return e.length>t?e.slice(0,t)+n:e},e.entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},e}();n.Formatter=i},{"linkifyjs/html":112}],488:[function(e,t,n){(function(Buffer){"use strict";n.__esModule=!0;var e=function(){function e(){}return e.check=function(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},e.detect=function(t){return e.check([255,216,255],t)?{ext:"jpg",mime:"image/jpeg"}:e.check([137,80,78,71,13,10,26,10],t)?{ext:"png",mime:"image/png"}:e.check([71,73,70],t)?{ext:"gif",mime:"image/gif"}:e.check([73,73,42,0],t)||e.check([77,77,0,42],t)?{ext:"tif",mime:"image/tiff"}:e.check([66,77],t)?{ext:"bmp",mime:"image/bmp"}:null},e.extractBufferFromDatatUrl=function(e){var t=e.indexOf(",");return new Buffer(e.substring(t+1),"base64")},e.createDataUrlFromBuffer=function(t){var n=e.detect(t);return"data:"+(null==n?"image/jpeg":n.mime)+";base64,"+t.toString("base64")},e.getFirstBytesFromBase64=function(e,t){var n=4*(Math.floor(t/3)+(t%3==0?0:1));return new Buffer(e.substr(0,n),"base64")},e.createDataUrlFromBase64=function(t){var n=e.getFirstBytesFromBase64(t,e.MAGIC_HEADER_MAX_LENGTH),r=e.detect(n);return"data:"+(null==r?"image/jpeg":r.mime)+";base64,"+t},e.MAGIC_HEADER_MAX_LENGTH=8,e}();n.ImageTypeDetector=e}).call(this,e("buffer").Buffer)},{buffer:590}],489:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){}return e.map=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r,e));return n},e.find=function(t,n){var r=e.indexOf(t,n);return r==-1?null:t[r]},e.findAll=function(e,t){for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n},e.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return n;return-1},e.findByProperty=function(t,n,r){var i=e.indexOfByProperty(t,n,r);return i==-1?null:t[i]},e.indexOfByProperty=function(e,t,n){for(var r=0;r<e.length;r++)if(e[r][t]===n)return r;return-1},e.containsFunc=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1},e.contains=function(e,t){return e.indexOf(t)!=-1},e.forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)},e.startsWith=function(e,t,n){return"function"==typeof e.startsWith?e.startsWith(t,n):(n=n||0,e.indexOf(t,n)===n)},e.endsWith=function(e,t,n){if("function"==typeof e.endsWith)return e.endsWith(t,n);var r=e;("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n>r.length)&&(n=r.length),n-=t.length;var i=r.indexOf(t,n);return i!==-1&&i===n},e.insertSort=function(e,t,n){for(var r=0;r<e.length;r++)if(n(e[r],t)>0)return void e.splice(r,0,t);e.push(t)},e.addKeys=function(e,t){for(var n in t)e[n]=t[n]},e.extendPrototype=function(t,n){e.addKeys(t.prototype,n.prototype)},e.getValues=function(e){var t=[];for(var n in e)t.push(e[n]);return t},e.getEntries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},e.shallowCopy=function(e){var t={};for(var n in e)t[n]=e[n];return t},e}();n.Lang=r},{}],490:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){this.map={}}return e.prototype.put=function(e,t){this.map[e]=t},e.prototype.get=function(e){return this.map[e]},e.prototype.has=function(e){return e in this.map},e.prototype.forEach=function(e){for(var t in this.map)e(this.map[t],t)},e.prototype.find=function(e){for(var t in this.map){var n=this.map[t];if(e(t,n))return n}return null},e.prototype.getEnumerable=function(){return this.map},e.prototype.getKeys=function(){var e=[];for(var t in this.map)e.push(t);return e},e.prototype.getValues=function(){var e=[];for(var t in this.map)e.push(this.map[t]);return e},e.prototype.each=function(e){for(var t in this.map)e(t,this.map[t])},e.prototype.clear=function(){this.map={}},e.prototype.remove=function(e){delete this.map[e]},e}();n.Map=r},{}],491:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Event"),i=function(){function e(e){this.data=e,this.changeEvent=new r.Event}return e.prototype.set=function(e){this.data=e,this.changeEvent.trigger("set",e)},e.prototype.setWithCheck=function(e){this.data!=e&&this.set(e)},e.prototype.get=function(){return this.data},e.prototype.trigger=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.changeEvent.trigger.apply(this.changeEvent,arguments)},e}();n.Model=i},{"./Event":485}],492:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(){this.id=0,this.map={}}return e.prototype.add=function(e){return this.map[++this.id]=e,this.id},e.prototype.get=function(e){return this.map[e]},e}();n.ObjectMapClass=r,n.ObjectMap=new r},{}],493:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Events"),i=[],o=function(){function e(){this.buckets={},this.events=new r.Events}return e.prototype.getBucketKey=function(e){var t=i.indexOf(e);return t!=-1?t:(i.push(e),i.length-1)},e.prototype.register=function(e,t,n){var r=this.getBucketKey(e);if(this.buckets[r]||(this.buckets[r]=[]),this.findPlugin(e,t))throw new Error("Name ("+t+") already taken");this.buckets[r].push({name:t,plugin:n})},e.prototype.findPlugin=function(e,t){var n=this.getBucketKey(e),r=this.buckets[n];if(r)for(var i=0,o=r.length;i<o;i++)if(r[i].name===t)return r[i].plugin},e.prototype.getPlugins=function(e){var t=this.getBucketKey(e),n=this.buckets[t]||[];return n.map(function(e){return e.plugin})},e.prototype.createComponents=function(e,t){var n=this.getPlugins(e);n.length&&n.forEach(function(e){e.createComponents(t)})},e}();n.PluginsRegistryClass=o,n.PluginsRegistry=new o},{"./Events":486}],494:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("privmx-exception"),i=r.UnsupportedOperationException,o=function(){function e(){}return e.prototype.get=function(e){throw new i},e.prototype.set=function(e,t){throw new i},e.prototype.remove=function(e){throw new i},e}();n.PromiseMap=o},{"privmx-exception":266}],495:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-promise"),i=r.PromiseUtils,o=function(){function e(t,n,r,i){if(this.name=t,this.defaultValue=n,this.storage=r,this.subSettings={},i)for(var o in i){
var s=i[o];this.subSettings[o]=new e(this.name+"."+o,s.defaultValue,this.storage,s.subs)}}return e.prototype.create=function(e){return this.subSettings[e]},e.prototype.init=function(){var e=this;return this.storage.get(this.name).then(function(t){return e.currentValue=t,i.oneByOne(e.subSettings,function(e,t){return t.init()})})},e.prototype.setDefault=function(e){return this.defaultValue=e,this},e.prototype.get=function(e){if(null==this.currentValue)return this.defaultValue;if("undefined"==typeof e||"string"==e)return this.currentValue;if("boolean"==e)return"true"==this.currentValue;if("int"==e)return parseInt(this.currentValue);if("float"==e)return parseFloat(this.currentValue);if("object"==e)return JSON.parse(this.currentValue);throw new Error("Invalid type")},e.prototype.set=function(e){if(isNaN(e)&&"string"!=typeof e){if("object"!=typeof e)throw new Error("Invalid type");this.currentValue=JSON.stringify(e)}else this.currentValue=e.toString();return null==this.setPromise?this.setPromise=this.setCore():this.newValueToSet=!0,this.setPromise},e.prototype.setCore=function(){var e=this;return this.storage.set(this.name,this.currentValue).then(function(){return e.newValueToSet?(e.newValueToSet=!1,e.setCore()):void(e.setPromise=null)})},e.prototype.objectGet=function(e){var t=this.get("object")||this.defaultValue;return t[e]},e.prototype.objectSet=function(e,t){var n=this.get("object")||{};return n[e]=t,this.set(n)},e}();n.Settings=o},{"simplito-promise":370}],496:[function(e,t,n){"use strict";n.__esModule=!0;var r=function(){function e(e,t){this.count=e,this.comparator=t,this.list=[]}return e.prototype.add=function(e){if(0==this.list.length)return void this.list.push(e);for(var t=this.list.length-1;t>=0;t--)this.comparator(e,this.list[t])<0?(t+1<this.count&&(this.list[t+1]=this.list[t]),this.list[t]=e):t==this.list.length-1&&this.list.length<this.count&&this.list.push(e)},e}();n.SortTake=r},{}],497:[function(e,t,n){"use strict";function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r}function i(){var e="forcedIndexedDB";return o.getDriver(e)["catch"](function(){return o.getDriver(o.INDEXEDDB).then(function(t){var n=r({},t,{_driver:e});return o.defineDriver(n)})})}n.__esModule=!0;var o=e("localforage"),s=e("simplito-logger"),a=s.get("privfs-mail-client.utils.WebStorage"),u=e("q"),c=function(){function e(){i().then(function(e){o.config({name:"privmx",driver:["forcedIndexedDB",o.LOCALSTORAGE]})}),this.lf=o}return e.prototype.getStorageType=function(){var e=o.driver();switch(e){case"asyncStorage":return"IndexedDB";case"forcedIndexedDB":return"IndexedDB";case"localStorageWrapper":return"LocalStorage";case"webSQLStorage":return"WebSQL"}},e.prototype.getItem=function(e){return u(1).then(function(){return a.debug("getItem",e),o.getItem(e)})},e.prototype.setItem=function(e,t){return u(null).then(function(){return a.debug("setItem",e,t),o.setItem(e,t)})},e.prototype.removeItem=function(e){return u(null).then(function(){return a.debug("removeItem",e),o.removeItem(e)})},e.prototype.clear=function(){return u(null).then(function(){return a.debug("clear"),o.clear()})},e.prototype.length=function(){return u(null).then(function(){return a.debug("length"),o.length()})},e.prototype.key=function(e){return u(null).then(function(){return a.debug("key"),o.key(e)})},e.prototype.keys=function(){return u(null).then(function(){return a.debug("keys"),o.keys()})},e.prototype.iterate=function(e){return u(null).then(function(){return a.debug("iterate"),o.iterate(e)})},e}();n.WebStorage=c},{localforage:130,q:327,"simplito-logger":357}],498:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../Event"),i=function(){function e(e){this.list=e?[].concat(e):[],this.changeEvent=new r.Event,this.changeId=0}return e.prototype.get=function(e){return this.list[e]},e.prototype.getFirst=function(){return this.list.length>0?this.list[0]:null},e.prototype.getLast=function(){return this.list.length>0?this.list[this.list.length-1]:null},e.prototype.getBy=function(e,t){for(var n=0;n<this.list.length;n++)if(this.list[n][e]==t)return this.list[n];return null},e.prototype.getAllBy=function(e,t){for(var n=[],r=0;r<this.list.length;r++)this.list[r][e]==t&&n.push(this.list[r]);return n},e.prototype.find=function(e){for(var t=0;t<this.list.length;t++)if(e(this.list[t],t))return this.list[t];return null},e.prototype.findAll=function(e){for(var t=[],n=0;n<this.list.length;n++)e(this.list[n],n)&&t.push(this.list[n]);return t},e.prototype.countBy=function(e,t){return this.getAllBy(e,t).length},e.prototype.indexOf=function(e){return this.list.indexOf(e)},e.prototype.contains=function(e){return this.list.indexOf(e)!=-1},e.prototype.getEnumerable=function(){return this.list},e.prototype.forEach=function(e){this.list.forEach(function(t,n,r){return e(t,n)})},e.prototype.size=function(){return this.list.length},e.prototype.isEmpty=function(){return 0==this.list.length},e.prototype.getListCopy=function(){return this.list.slice(0,this.list.length)},e.prototype.reductEvents=function(){var e=this.changeEvent.events;if(!(e.length<=1)){for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r],o=i[0];if("add"==o.type)t.length<o.index&&(t.length=o.index),t.splice(o.index,0,{created:!0,event:i});else if("remove"==o.type){if(o.index<t.length){var s=t.splice(o.index,1);if(s[0]&&!s[0].created){var a=n.indexOf(s[0].event);a!=-1&&n.splice(a,1)}}}else if("update"==o.type){if(t[o.index])continue;t[o.index]={created:!1,event:i}}else if("clear"==o.type)n=[],t=[];else if("reorganize"==o.type){var u=t;t=[];for(var c=0;c<o.indicies.length;c++)t[c]=u[o.indicies[c]]}else if("move"==o.type){t.length<o.oldIndex&&(t.length=o.oldIndex),t.length<o.newIndex&&(t.length=o.newIndex);var s=t.splice(o.oldIndex,1);t.splice(o.newIndex,0,s[0])}else"rebuild"==o.type&&(n=[],t=[]);n.push(i)}this.changeEvent.events=n}},e.prototype.destroy=function(){this.changeEvent.clear()},e}();n.BaseCollection=i},{"../Event":485}],499:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./ProxyCollection"),o=function(e){function t(t,n){var r=e.call(this,!1)||this;return r.filter=n,r.setCollectionSafe(t),r}return r(t,e),t.prototype.rebuild=function(){var e=this.collection.getEnumerable();this.list=[],this.indexMap=[];for(var t=0;t<e.length;t++)this.filter(e[t])?(this.indexMap[t]=this.list.length,this.list.push(e[t])):this.indexMap[t]=null;this.changeEvent.trigger({type:"rebuild",changeId:++this.changeId})},t.prototype.onChangeEvent=function(e){if(!(e.changeId<=this.collectionChangeId))if("add"==e.type)if(this.filter(e.element)){for(var t=null,n=e.index;n<this.indexMap.length;n++)null!=this.indexMap[n]&&(null==t&&(t=this.indexMap[n]),this.indexMap[n]++);if(null==t)for(var n=e.index;n>=0;n--)if(null!=this.indexMap[n]){t=this.indexMap[n]+1;break}null==t&&(t=0),this.indexMap.splice(e.index,0,t),this.list.splice(t,0,e.element),this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:t,element:e.element})}else this.indexMap.splice(e.index,0,null);else if("remove"==e.type){var t=this.indexMap[e.index];if(null==t)this.indexMap.splice(e.index,1);else{this.list.splice(t,1),this.indexMap.splice(e.index,1);for(var n=e.index;n<this.indexMap.length;n++)null!=this.indexMap[n]&&this.indexMap[n]--;this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:t,element:e.element})}}else if("update"==e.type){var r=null!=this.indexMap[e.index],i=this.filter(e.element);r==i?r&&this.changeEvent.trigger({type:"update",changeId:++this.changeId,index:this.indexMap[e.index],element:e.element}):i?this.onChangeEvent({type:"add",changeId:++this.changeId,index:e.index,element:e.element}):this.onChangeEvent({type:"remove",changeId:++this.changeId,index:e.index,element:e.element})}else if("clear"==e.type)this.list=[],this.indexMap=[],this.triggerProxyEvent(e);else if("reorganize"==e.type){var o=this.list,s=this.indexMap,a=[];this.list=[],this.indexMap=[];for(var n=0;n<e.indicies.length;n++){var u=s[e.indicies[n]];null==u?this.indexMap[n]=null:(this.indexMap[n]=this.list.length,a.push(u),this.list.push(o[u]))}this.changeEvent.trigger({type:"reorganize",changeId:++this.changeId,indicies:a})}else if("move"==e.type){var t=this.indexMap[e.oldIndex];if(null==t)this.indexMap.splice(e.oldIndex,1),this.indexMap.splice(e.newIndex,0,null);else{this.indexMap.splice(e.oldIndex,1),this.indexMap.splice(e.newIndex,0,1);for(var c=0,n=0;n<this.indexMap.length;n++)null!=this.indexMap[n]&&(this.indexMap[n]=c,c++);var f=this.indexMap[e.newIndex];this.list.splice(t,1),this.list.splice(f,0,e.element),this.changeEvent.trigger({type:"move",changeId:++this.changeId,oldIndex:t,newIndex:f,element:e.element})}}else"rebuild"==e.type?this.rebuild():console.log("Unknown event type: "+e.type)},t.prototype.setFilter=function(e){this.filter=e,this.refresh()},t.prototype.refresh=function(){this.changeEvent.hold();var e=this.collection.getEnumerable();this.list=[];for(var t=0;t<e.length;t++){var n=e[t],r=null!=this.indexMap[t],i=this.list.length;this.filter(n)?(this.indexMap[t]=i,this.list.push(n),r||this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:i,element:n})):(this.indexMap[t]=null,r&&this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:i,element:n}))}this.changeEvent.release()},t}(i.ProxyCollection);n.FilteredCollection=o},{"./ProxyCollection":502}],500:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./BaseCollection"),o=e("../Event"),s=e("../Lang"),a=function(e){function t(){var t=e.call(this)||this;return t.collections=[],t}return r(t,e),t.prototype.addCollection=function(e){var t=e.getEnumerable(),n=this.collections.length,r=this.onChangeEvents.bind(this,n);this.collections.push({length:t.length,collection:e,collectionChangeId:e.changeId,event:r}),e.changeEvent.add(r,"multi"),this.list=this.list.concat(t);var i=this.getCollectionStartIndex(n);this.changeEvent.hold();for(var o=0;o<t.length;o++)this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:i+o,element:t[o]});this.changeEvent.release()},t.prototype.removeCollection=function(e){var t=s.Lang.indexOf(this.collections,function(t){return null!=t&&t.collection==e});if(t!=-1){var n=this.collections[t];this.collections[t]=null,e.changeEvent.remove(n.event,"multi");var r=e.getEnumerable();this.changeEvent.hold();for(var i=0;i<this.list.length;){var o=this.list[i];r.indexOf(o)!=-1?(this.list.splice(i,1),this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:i,element:o})):i++}this.changeEvent.release()}},t.prototype.destroy=function(){this.collections.forEach(function(e){null!=e&&e.collection.changeEvent.remove(e.event)}),i.BaseCollection.prototype.destroy.call(this)},t.prototype.getCollectionStartIndex=function(e){for(var t=0,n=0;n<e;n++)null!=this.collections[n]&&(t+=this.collections[n].length);return t},t.prototype.onChangeEvents=function(e,t){this.changeEvent.hold(),o.Event.applyEvents(t,this.onChangeEvent.bind(this,e)),this.changeEvent.release()},t.prototype.onChangeEvent=function(e,t){if(!(t.changeId<=this.collections[e].collectionChangeId)){var n=this.getCollectionStartIndex(e),r=n+(null==t.index?0:t.index);if("add"==t.type)this.list.splice(r,0,t.element),this.collections[e].length++,this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:r,element:t.element});else if("remove"==t.type)this.list.splice(r,1),this.collections[e].length--,this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:r,element:t.element});else if("clear"==t.type){var i=this.list.splice(r,this.collections[e].length);this.collections[e].length=0;for(var o=i.length;o>=0;o--)this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:r+o,element:i[o]})}else if("update"==t.type)this.changeEvent.trigger({type:"update",changeId:++this.changeId,index:r,element:t.element});else if("rebuild"==t.type){for(var i=this.list.splice(r,this.collections[e].length),o=i.length;o>=0;o--)this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:r+o,element:i[o]});var s=this.collections[e].collection.getEnumerable();this.list.splice.apply(this.list,[].concat([r,0],s));for(var o=0;o<s.length;o++)this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:r+o,element:s[o]})}else console.log("Unknown event type: "+t.type)}},t}(i.BaseCollection);n.MergedCollection=a},{"../Event":485,"../Lang":489,"./BaseCollection":498}],501:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./BaseCollection"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.changeId=0,n}return r(t,e),t.prototype.add=function(e){this.addAt(this.list.length,e)},t.prototype.addAt=function(e,t){this.list.length<e&&(this.list.length=e),this.list.splice(e,0,t),this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:e,element:t})},t.prototype.addAll=function(e){this.addAllAt(this.list.length,e)},t.prototype.addAllAt=function(e,t){for(var n=[e,0],r=0;r<t.length;r++)n.push(t[r]);this.list.splice.apply(this.list,n);var i=this.changeId+1;this.changeId+=t.length;for(var r=0;r<t.length;r++)this.changeEvent.trigger({type:"add",changeId:i+r,index:e+r,element:t[r]})},t.prototype.remove=function(e){for(var t=0;t<this.list.length;t++)if(this.list[t]==e){this.list.splice(t,1);this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:t,element:e})}},t.prototype.removeAt=function(e){var t=this.list.splice(e,1);this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:e,element:t[0]})},t.prototype.removeBy=function(e,t){for(var n=0;n<this.list.length;)if(this.list[n][e]==t){var r=this.list.splice(n,1);this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:n,element:r[0]})}else n++},t.prototype.clear=function(){this.list=[],this.changeEvent.trigger({type:"clear",changeId:++this.changeId})},t.prototype.rebuild=function(e){this.list=[].concat(e),this.changeEvent.trigger({type:"rebuild",changeId:++this.changeId})},t.prototype.updateElement=function(e){var t=this.indexOf(e);t!=-1&&this.changeEvent.trigger({type:"update",changeId:++this.changeId,index:t,element:e})},t.prototype.updateBy=function(e,t,n){for(var r=0;r<this.list.length;r++){var i=this.list[r];if(i[e]==t){for(var o in n)i[o]=n[o];this.changeEvent.trigger({type:"update",changeId:++this.changeId,index:r,element:i})}}},t.prototype.move=function(e,t){var n=this.list.indexOf(e);n!=-1&&(this.list.splice(n,1),this.list.length<t&&(this.list.length=t),this.list.splice(t,0,e),this.changeEvent.trigger({type:"move",changeId:++this.changeId,oldIndex:n,newIndex:t}))},t}(i.BaseCollection);n.MutableCollection=o},{"./BaseCollection":498}],502:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./BaseCollection"),o=e("../Event"),s=e("../Lang"),a=function(e){function t(t){var n=e.call(this)||this;return n.bindedOnChangeEvent=n.onChangeEvent.bind(n),t!==!1&&n.setCollectionSafe(t),n}return r(t,e),t.prototype.setCollectionSafe=function(e){null==e?this.setEmptyCollection():this.setCollection(e)},t.prototype.setEmptyCollection=function(){this.setCollection(new i.BaseCollection)},t.prototype.setCollection=function(e){this.unbind(),this.collection=e,this.collectionChangeId=e.changeId,this.bindedEvents=this.onChangeEvents.bind(this),this.collection.changeEvent.add(this.bindedEvents,"multi"),this.rebuild()},t.prototype.unbind=function(){null!=this.bindedEvents&&this.collection.changeEvent.remove(this.bindedEvents,"multi")},t.prototype.destroy=function(){this.unbind(),e.prototype.destroy.call(this)},t.prototype.rebuild=function(){this.list=[].concat(this.collection.getEnumerable()),this.changeEvent.trigger({type:"rebuild",changeId:++this.changeId})},t.prototype.onChangeEvents=function(e){this.changeEvent.hold(),o.Event.applyEvents(e,this.bindedOnChangeEvent),this.changeEvent.release()},t.prototype.onChangeEvent=function(e){if(!(e.changeId<=this.collectionChangeId)){if("add"==e.type)this.list.splice(e.index,0,e.element);else if("remove"==e.type)this.list.splice(e.index,1);else if("clear"==e.type)this.list=[];else if("reorganize"==e.type){var t=this.list;this.list=[];for(var n=0;n<e.indicies.length;n++)this.list[n]=t[e.indicies[n]]}else if("move"==e.type)this.list.splice(e.oldIndex,1),this.list.splice(e.newIndex,0,e.element);else if("rebuild"==e.type)return void this.rebuild();this.triggerProxyEvent(e)}},t.prototype.triggerProxyEvent=function(e){var t=s.Lang.shallowCopy(e);t.changeId=++this.changeId,this.changeEvent.trigger(t)},t}(i.BaseCollection);n.ProxyCollection=a},{"../Event":485,"../Lang":489,"./BaseCollection":498}],503:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./ProxyCollection"),o=function(e){function t(t,n){var r=e.call(this,!1)||this;return r.sorter=n,r.setCollectionSafe(t),r}return r(t,e),t.prototype.rebuild=function(){for(var e=this,t=this.collection.getEnumerable(),n=[],r=0;r<t.length;r++)n[r]=r;n.sort(function(n,r){return e.sorter(t[n],t[r])}),this.list=[],this.indexMap=[];for(var r=0;r<n.length;r++)this.list[r]=t[n[r]],this.indexMap[n[r]]=r;this.changeEvent.trigger({type:"rebuild",changeId:++this.changeId})},t.prototype.onChangeEvent=function(e){if(!(e.changeId<=this.collectionChangeId))if("add"==e.type){for(var t=this.list.length,n=0;n<this.list.length;n++)if(this.sorter(e.element,this.list[n])<0){t=n;break}this.list.splice(t,0,e.element);for(var n=0;n<this.indexMap.length;n++)this.indexMap[n]>=t&&this.indexMap[n]++;this.indexMap.splice(e.index,0,t),this.changeEvent.trigger({type:"add",changeId:++this.changeId,index:t,element:e.element})}else if("remove"==e.type){var t=this.indexMap[e.index];this.list.splice(t,1),this.indexMap.splice(e.index,1);for(var n=0;n<this.indexMap.length;n++)this.indexMap[n]>t&&this.indexMap[n]--;this.changeEvent.trigger({type:"remove",changeId:++this.changeId,index:t,element:e.element})}else if("update"==e.type){var t=this.indexMap[e.index];if(this.changeEvent.trigger({type:"update",changeId:++this.changeId,index:t,element:e.element}),t>0&&this.sorter(this.list[t-1],this.list[t])>0||t<this.list.length-1&&this.sorter(this.list[t],this.list[t+1])>0){this.list.splice(t,1),this.indexMap.splice(e.index,1);for(var n=0;n<this.indexMap.length;n++)this.indexMap[n]>t&&this.indexMap[n]--;for(var r=this.list.length,n=0;n<this.list.length;n++)if(this.sorter(e.element,this.list[n])<0){r=n;break}this.list.splice(r,0,e.element);for(var n=0;n<this.indexMap.length;n++)this.indexMap[n]>=r&&this.indexMap[n]++;this.indexMap.splice(e.index,0,r),this.changeEvent.trigger({type:"move",changeId:++this.changeId,oldIndex:t,newIndex:r,element:e.element})}}else"clear"==e.type?(this.list=[],this.indexMap=[],this.triggerProxyEvent(e)):"rebuild"==e.type?this.rebuild():console.log("Unknown event type: "+e.type)},t.prototype.setSorter=function(e){this.sorter=e,this.refresh()},t.prototype.refresh=function(){for(var e=this,t=this.indexMap,n=this.collection.getEnumerable(),r=[],i=0;i<n.length;i++)r[i]=i;r.sort(function(t,r){return e.sorter(n[t],n[r])}),this.list=[],this.indexMap=[];for(var i=0;i<r.length;i++)this.list[i]=n[r[i]],this.indexMap[r[i]]=i;for(var o=[],i=0;i<t.length;i++){this.indexMap[i];o[i]=t[r[i]]}this.changeEvent.trigger({type:"reorganize",changeId:++this.changeId,indicies:o})},t.getPropertyGetter=function(e){return"function"==typeof e?e:function(t){return t[e]}},t.nullableDateComparator=function(e,n,r){var i=t.getPropertyGetter(e),o="desc"==n?-1:1;return function(e,t){var n=i(e),s=i(t);if(null==n&&null==s)return r(e,t);if(null==n)return-1;if(null==s)return 1;var a=n.getTime(),u=s.getTime(),c=a-u;return o*c}},t.dateComparator=function(e,n){var r=t.getPropertyGetter(e),i="desc"==n?-1:1;return function(e,t){var n=r(e).getTime(),o=r(t).getTime(),s=n-o;return i*s}},t.stringComparator=function(e,n){var r=t.getPropertyGetter(e),i="desc"==n?-1:1;return function(e,t){var n=r(e),o=r(t),s=n.localeCompare(o);return i*s}},t.stringNumericComparator=function(e,n){var r=t.getPropertyGetter(e),i="desc"==n?-1:1;return function(e,t){var n=r(e),o=r(t);if(n.length!=o.length)return n.length-o.length;var s=n.localeCompare(o);return i*s}},t.stringNullableNumericComparator=function(e,n,r){var i=t.getPropertyGetter(e),o="desc"==n?-1:1;return function(e,t){var n=i(e),s=i(t);if(null==n&&null==s)return r(e,t);if(null==n)return-1;if(null==s)return 1;if(n.length!=s.length)return n.length-s.length;var a=n.localeCompare(s);return o*a}},t.numericComparator=function(e,n){var r=t.getPropertyGetter(e),i="desc"==n?-1:1;return function(e,t){var n=r(e),o=r(t),s=n-o;return i*s}},t}(i.ProxyCollection);n.SortedCollection=o},{"./ProxyCollection":502}],504:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./ProxyCollection"),o=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.onChangeEvent=function(t){if(null!=this.active)if("add"==t.type)t.index<=this.active.index&&this.active.index++;else if("remove"==t.type)if(t.index==this.active.index){var n=this.active;this.active=null,this.changeEvent.trigger({type:"active",changeId:++this.changeId,oldActive:n,newActive:this.active,causeType:t.type})}else t.index<this.active.index&&this.active.index--;else if("clear"==t.type){var n=this.active;this.active=null,this.changeEvent.trigger({type:"active",changeId:++this.changeId,oldActive:n,newActive:this.active,causeType:t.type})}else if("reorganize"==t.type)this.active.index=t.indicies.indexOf(this.active.index);else if("move"==t.type)t.oldIndex==this.active.index&&(this.active.index=t.newIndex);else if("rebuild"==t.type){var n=this.active;this.active=null,this.changeEvent.trigger({type:"active",changeId:++this.changeId,oldActive:n,newActive:this.active,causeType:t.type})}e.prototype.onChangeEvent.call(this,t)},t.prototype.getActive=function(){return null==this.active?null:this.active.obj},t.prototype.setActive=function(e){if(!(null==this.active&&null==e||null!=this.active&&this.active.obj==e)){var t=this.active,n=this.indexOf(e);this.active=n==-1?null:{index:n,obj:e},this.changeEvent.trigger({type:"active",changeId:++this.changeId,oldActive:t,newActive:this.active})}},t.prototype.isActive=function(e){return null!=this.active&&this.active.obj==e},t}(i.ProxyCollection);n.WithActiveCollection=o},{"./ProxyCollection":502}],505:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q"),i=r.Promise,o=e("simplito-logger"),s=o.get("privfs-mail-client.webutils.AudioPlayer"),a=window.AudioContext||window.webkitAudioContext,u=function(){function e(){this.sounds={},this.enabled=!1,this.playingSourceCount=0}return e.prototype.add=function(e,t){s.debug("add",e,t),this.sounds[e]=t},e.prototype.prepare=function(e,t){var n=this;return i(function(r,i){s.debug("prepare",e,t);var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.onload=function(){n.context.decodeAudioData(o.response,function(t){s.debug("decoded",e),n.buffers[e]=t,r(null)},i)},o.send()})},e.prototype.getBuffer=function(e){var t=this;return r(null).then(function(){if(s.debug("getBuffer",e),!t.buffers[e]){if(!t.sounds[e])throw new Error("Unknown id");return t.prepare(e,t.sounds[e])}}).then(function(){return t.buffers[e]})},e.prototype.play=function(e){var t=this;return this.enabled?(s.debug("play",e),void this.getBuffer(e).then(function(e){var n=t.context.createBufferSource();n.buffer=e,n.connect(t.context.destination),"suspended"==t.context.state&&t.context.resume(),t.playingSourceCount++,n.start(0),n.onended=function(){t.playingSourceCount--,0==t.playingSourceCount&&t.context.suspend()}})):void s.debug("play - skipped",e)},e.prototype.enable=function(){var e=this;return r(null).then(function(){e.enabled||(s.debug("enabling"),e.context=new a,e.context.onstatechange=function(){e.context&&s.debug("audio context state change:",e.context.state)},e.context.suspend(),e.buffers={},e.enabled=!0)})},e.prototype.disable=function(){var e=this;return r(null).then(function(){e.enabled&&(s.debug("disabling"),e.context.close(),setTimeout(function(){delete e.context,delete e.buffers,s.debug("deleting audio context and buffers")},1),e.enabled=!1)})},e}();n.AudioPlayer=u},{q:327,"simplito-logger":357}],506:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../utils/Model"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(i.Model);n.ModelWithToggle=o;var s=function(){function e(e){this.model=new o(this.isInFullscreenMode()),this.model.toggle=this.toggleFullscreenMode.bind(this),setInterval(this.onInterval.bind(this),e||250)}return e.prototype.onInterval=function(){this.model.setWithCheck(this.isInFullscreenMode())},e.prototype.isInFullscreenMode=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)},e.prototype.toggleFullscreenMode=function(){this.isInFullscreenMode()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},e.prototype.getFullscreenModel=function(){return this.model},e}();n.FullscreenClass=s,n.Fullscreen=new s},{"../utils/Model":491}],507:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-logger"),i=r.get("privfs-mail-client.webutils.ScreenCover"),o=function(){function e(e){this.options=e,this.onEventBinded=this.onEvent.bind(this),this.onTimeoutBinded=this.onTimeout.bind(this),this.options.$cover.on("click",this.onCoverClick.bind(this))}return e.prototype.start=function(){i.debug("start"),this.onEvent(),this.onTimeout()},e.prototype.onEvent=function(){this.lastEventDate=new Date},e.prototype.onTimeout=function(){var e=(new Date).getTime()-this.lastEventDate.getTime();if(e>this.options.timeout)this.options.$cover.show().focus(),this.options.$toCover.addClass("covered");else{clearTimeout(this.timeoutId);var t=this.options.timeout-e;t>this.options.timeoutCheck&&(t=this.options.timeoutCheck),this.timeoutId=setTimeout(this.onTimeoutBinded,t)}},e.prototype.onCoverClick=function(){this.options.$cover.hide(),this.options.$toCover.removeClass("covered"),this.onEvent(),this.onTimeout()},e}();n.ScreenCover=o},{"simplito-logger":357}],508:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("is_js"),i=e("../utils/Lang"),o=e("./Window"),s=function(){function e(){}return e.open=function(e){if(i.Lang.startsWith(e,"mailto:")||r.ie()){var t=o.window.open(e);t.opener=null}else{var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},e}();n.UrlOpener=s},{"../utils/Lang":489,"./Window":510,is_js:105}],509:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-logger"),i=r.get("privfs-mail-client.webutils.WebMonitor");i.setLevel(i.WARN);var o=function(){function e(e,t){this.name=e,this.data=t}return e}();n.WebMonitorEvent=o;var s=function(){function e(){this.currentNetworkStatus=navigator.onLine?"online":"offline",this.listeners={}}return e.prototype.addEventListener=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.trigger=function(e,t){i.debug("trigger",e,t);var n=new o(e,t);this.listeners[e]&&this.listeners[e].forEach(function(e){e(n)}),this.listeners["*"]&&this.listeners["*"].forEach(function(e){e(n)})},e.prototype.start=function(){window.addEventListener("online",this.updateNetworkStatus.bind(this,"online")),window.addEventListener("offline",this.updateNetworkStatus.bind(this,"offline")),this.intervalId=setInterval(this.loop.bind(this),2500),this.loop()},e.prototype.loop=function(){this.trigger("loop");var t=(new Date).getTime();this.lastLoopTime&&t-this.lastLoopTime>e.MAX_SCRIPT_EXECUTION_PAUSE_TIME&&this.trigger("wakeup"),this.lastLoopTime=t},e.prototype.updateNetworkStatus=function(e){this.currentNetworkStatus!==e&&(this.currentNetworkStatus=e,this.trigger("network-status-change",e))},e.prototype.getNetworkStatus=function(){return this.currentNetworkStatus},e.MAX_SCRIPT_EXECUTION_PAUSE_TIME=1e4,e}();n.WebMonitor=s},{"simplito-logger":357}],510:[function(e,t,n){"use strict";n.__esModule=!0;var r="undefined"==typeof window?{}:window;n.window=r},{}],511:[function(require,module,exports){"use strict";exports.__esModule=!0;var Compiler=function(){function Compiler(){}return Compiler.compile=function(e,t){var n=0,r="",i=function(e,t,n){0!=e.length&&(r+=t?1==n?"write("+e+");":2==n?"write(Helper.escapeHtml("+e+"));":3==n?"write(Helper.text("+e+"));":e:'write("'+e.replace(/\"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'");')},o=function(t,r,s){for(;n<e.length;){var a=e.indexOf("{{",n),u=e.indexOf("}}",n);if(a!=-1&&a<u){i(e.substring(n,a),t,s),n=a+2;var c=0;0==t&&"#"==e.substr(n,1)?(c=1,n++):0==t&&"@"==e.substr(n,1)?(c=2,n++):0==t&&"$"==e.substr(n,1)&&(c=3,n++),o(!t,!0,c)}else{if(r&&u!=-1){i(e.substring(n,u),t,s),n=u+2;break}i(e.substring(n),t,s),n=e.length}}};return o(!1,!1,0),(t?"module.exports = ":"")+'(function(model, context, Helper) {\n    var result = "";\n    var write = function(str) { result += str; };\n    '+r+"\n    return result;\n})"},Compiler.compileWithCheck=function(str,asCommonModule){var code=Compiler.compile(str,asCommonModule);
return eval(code),code},Compiler.eval=function(str){return eval(Compiler.compile(str))},Compiler}();exports.Compiler=Compiler},{}],512:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../utils/Formatter"),o=function(e){function t(t){var n=e.call(this)||this;return n.manager=t,n}return r(t,e),t.prototype.registerTemplate=function(e,t){this.manager.registerTemplate(e,t)},t.prototype.createTemplate=function(e,t){return this.manager.createTemplate(e,t)},t.prototype.render=function(e,t,n,r){return this.manager.render(e,t,n,r)},t.prototype.renderToJQ=function(e,t,n,r){return this.manager.renderToJQ(e,t,n,r)},t}(i.Formatter);n.Helper=o},{"../../utils/Formatter":487}],513:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("simplito-logger"),i=r.get("privfs-mail-client.webutils.template.Manager"),o=e("./Helper"),s=e("./Template"),a=e("./Compiler"),u=function(){function e(){this.compiled={},this.helper=new o.Helper(this)}return e.prototype.compile=function(e){return a.Compiler.eval(e)},e.prototype.registerTemplate=function(e,t){this.compiled[e]=t},e.prototype.get=function(e){var t=this.compiled[e];return null==t?null:new s.Template(e,this.compiled[e],this.helper)},e.prototype.createTemplate=function(e,t){return new s.Template(null,e,t||this.helper)},e.prototype.getTemplate=function(e,t){i.debug("getTemplate",e);var n=this.compiled[e];return null==n?null:new s.Template(e,this.compiled[e],t||this.helper)},e.prototype.getTemplateWithCheck=function(e,t){var n=this.getTemplate(e,t);if(null==n)throw new Error("Cannot find template with name '"+e+"'");return n},e.prototype.createTemplateFromHtmlElement=function(e){return new s.Template(null,this.compile(e.html()),this.helper)},e.prototype.renderToJQFromHtmlElement=function(e,t,n,r){return this.createTemplateFromHtmlElement(e).renderToJQ(t,n,r)},e.prototype.render=function(e,t,n,r){return i.debug("render",e,t),this.getTemplateWithCheck(e).render(t,n,r)},e.prototype.renderToJQ=function(e,t,n,r){return i.debug("renderToJQ",e,t),this.getTemplateWithCheck(e).renderToJQ(t,n,r)},e}();n.ManagerClass=u,n.Manager=new u},{"./Compiler":511,"./Helper":512,"./Template":514,"simplito-logger":357}],514:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("jquery"),i=function(){function e(e,t,n){this.id=e,this.template=t,this.helper=n}return e.prototype.render=function(e,t,n){return this.template(e,t,n||this.helper)},e.prototype.renderToJQ=function(t,n,i){var o=this.render(t,n,i);if(e.SUPPORT_TEMPLATE){var s=document.createElement("template");return s.innerHTML=o.trim(),r(s.content.children||s.content.childNodes)}if(e.CREATE_FROM_FRAGMENT){var a=document.createDocumentFragment(),u=document.createElement("body"),c=null;for(u.innerHTML=o;c=u.firstElementChild;)a.appendChild(c);return r(a.children||a.childNodes)}return r(o.trim())},e.SUPPORT_TEMPLATE="undefined"!=typeof document&&"content"in document.createElement("template"),e.CREATE_FROM_FRAGMENT=!0,e}();n.Template=i},{jquery:111}],515:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("../../utils/PluginsRegistry"),a=function(e){function n(n){var i=e.call(this,n,t,r)||this;return i.openWindowOptions.position="center",i.openWindowOptions.width=600,i.openWindowOptions.height=430,i.openWindowOptions.title=i.i18n("window.about.title"),i.openWindowOptions.icon="icon ico-question-mark",i.openWindowOptions.resizable=!1,i.loadPlugins(),i}return i(n,e),n.prototype.getModel=function(){return{version:this.app.getVersion().str}},n.prototype.loadPlugins=function(){s.PluginsRegistry.createComponents(n,this)},n.prototype.onViewClose=function(){this.close()},n}(o.BaseWindowController);n.AboutWindowController=a}).call(this,"/app/out/window/about/AboutWindowController.js","/app/out/window/about")},{"../../utils/PluginsRegistry":493,"../base/BaseWindowController":527}],516:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("./TabsControllers"),a=e("q"),u=e("./../../utils/PluginsRegistry"),c=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.openWindowOptions.position="center",o.openWindowOptions.width=990,o.openWindowOptions.height=620,o.openWindowOptions.title=o.i18n("window.admin.title"),o.openWindowOptions.icon="icon fa fa-server",o.tabs={},s.TabsControllers.forEach(function(e){o.registerTab(e.tabName,new e(o))}),o.loadPlugins(),o.active=i||s.TabsControllers[0].tabName,o}return i(n,e),n.prototype.reopenWithParams=function(e){e&&this.active!=e&&this.onViewChoose(e)},n.prototype.registerTab=function(e,t){this.tabs[e]=this.registerComponent(t)},n.prototype.loadPlugins=function(){u.PluginsRegistry.createComponents(n,this)},n.prototype.onViewLoad=function(){this.onViewChoose(this.active)},n.prototype.onViewChoose=function(e){var t=this;this.loadingTab=e,this.callViewMethod("loadingTab",e),this.addTaskEx(this.i18n(""),!0,function(){return a(null).then(function(){return t.tabs[e].prepare()}).then(function(){e==t.loadingTab&&(t.active=e,t.callViewMethod("activateTab",e))})})},n}(o.BaseWindowController);n.AdminWindowController=c}).call(this,"/app/out/window/admin/AdminWindowController.js","/app/out/window/admin")},{"../base/BaseWindowController":527,"./../../utils/PluginsRegistry":493,"./TabsControllers":517,q:327}],517:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./sysInfo/SysInfoController"),i=e("./initdata/InitDataController"),o=e("./sysmsg/SysMsgController"),s=e("./trusted/TrustedController"),a=e("./users/UsersController"),u=e("./blacklist/BlacklistController");n.TabsControllers=[r.SysInfoController,i.InitDataController,o.SysMsgController,s.TrustedController,a.UsersController,u.BlacklistController]},{"./blacklist/BlacklistController":518,"./initdata/InitDataController":519,"./sysInfo/SysInfoController":520,"./sysmsg/SysMsgController":521,"./trusted/TrustedController":522,"./users/UsersController":523}],518:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("../../../component/ext-list/ExtListController"),a=e("../../../utils/collection/MutableCollection"),u=e("../../../utils/collection/SortedCollection"),c=e("../../../utils/Lang"),f=function(e){function t(t){var n=e.call(this,t)||this;return n.blacklistBase=new a.MutableCollection,n.sorted=new u.SortedCollection(n.blacklistBase,function(e,t){if(e.data.mode!=t.data.mode){if("SUGGEST"==e.data.mode)return-1;if("SUGGEST"==t.data.mode)return 1}return e.domain.localeCompare(t.domain)}),n.blacklist=n.registerComponent(new s.ExtListController(n.sorted)),n.registerChangeEvent(n.blacklistBase.changeEvent,n.onCollectionChange,"multi"),n.checkBlacklist(),n}return r(t,e),t.prototype.getModel=function(){return{todo:this.todo}},t.prototype.onViewAddDomain=function(){var e=this,t=this.windowController;this.addTaskEx("",!0,function(){var n={message:e.i18n("window.admin.blacklist.addRule.header"),input:{placeholder:e.i18n("window.admin.blacklist.addRule.domain.placeholder")},bodyClass:"admin-alert",width:500,ok:{label:e.i18n("window.admin.blacklist.addRule.confirm")}};return t.promptEx(n).then(function(n){if("ok"==n.result&&n.value)return o(null).then(function(){var r=n.value,i="DENY";return e.app.mailClientApi.srpSecure.setBlacklistEntry(r,i).then(function(){var t=e.blacklistBase.find(function(e){return e.domain==r}),n={mode:i,username:e.app.mailClientApi.identity.user,time:Math.floor((new Date).getTime()/1e3)};null==t?e.blacklistBase.add({domain:r,data:{mode:i,history:[n],count:1,last:n}}):(t.data.mode=i,t.data.history.push(n),null==t.data.last&&(t.data.count=1,t.data.last=n),e.blacklistBase.updateElement(t))}).fail(function(n){t.onErrorCustom(e.i18n("window.admin.blacklist.addRule.error.invalid"),n)})})})})},t.prototype.onViewSetDomain=function(e,t,n){var r=this;this.addTaskExWithProgress(this.i18n(""),!0,e,function(){return r.app.mailClientApi.srpSecure.setBlacklistEntry(t,n).then(function(){var e=r.blacklistBase.find(function(e){return e.domain==t});if(null==e){var i={mode:n,username:r.app.mailClientApi.identity.user,time:Math.floor((new Date).getTime()/1e3)};r.blacklistBase.add({domain:t,data:{mode:n,history:[i],count:1,last:i}})}else e.data.mode=n,r.blacklistBase.updateElement(e)})})},t.prototype.onViewDeleteDomain=function(e,t){var n=this;this.addTaskExWithProgress(this.i18n(""),!0,e,function(){return n.windowController.confirm().then(function(e){if("yes"==e.result)return o(null).then(function(){return n.app.mailClientApi.srpSecure.deleteBlacklistEntry(t)}).then(function(){n.blacklistBase.removeBy("domain",t)})})})},t.prototype.prepare=function(){var e=this;return o(null).then(function(){return e.app.mailClientApi.srpSecure.getBlacklist()}).then(function(t){var n=[],r=function(){var e=t[i],r={domain:i,data:{mode:e.mode,history:e.history,count:0,last:null}};"DELETED"!=e.mode&&(e.history.sort(function(e,t){return e.time-t.time}),e.history.forEach(function(e){"DELETED"==e.mode?(r.data.last=null,r.data.count=0):null!=r.data.last&&"SUGGEST"!=e.mode||(r.data.last=e,r.data.count++)}),n.push(r))};for(var i in t)r();e.blacklistBase.rebuild(n),e.callViewMethod("refreshContent")})},t.prototype.checkBlacklist=function(){var e=this;this.app.mailClientApi.srpSecure.getBlacklist().then(function(t){e.todo=c.Lang.containsFunc(c.Lang.getValues(t),function(e){return"SUGGEST"==e.mode}),e.callViewMethod("refreshToDo",e.todo)})},t.prototype.onCollectionChange=function(){this.todo=null!=this.blacklistBase.find(function(e){return"SUGGEST"==e.data.mode}),this.callViewMethod("refreshToDo",this.todo)},t.tabName="blacklist",t}(i.WindowComponentController);n.BlacklistController=f},{"../../../component/ext-list/ExtListController":425,"../../../utils/Lang":489,"../../../utils/collection/MutableCollection":501,"../../../utils/collection/SortedCollection":503,"../../base/WindowComponentController":529,q:327}],519:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("../../../utils/Lang"),s=e("q"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.alert=n.windowController.alert.bind(n.windowController),n}return r(t,e),t.prototype.onViewSaveInitData=function(e){var t=this;this.addTaskEx("",!0,function(){return s(null).then(function(){return t.app.mailClientApi.srpSecure.setInitData(e)}).then(function(){t.callViewMethod("onInitDataSave",!0),t.alert(t.i18n("window.admin.initdata.save.success"))}).fail(function(e){t.onErrorCustom(t.i18n("window.admin.initdata.save.error"),e),t.callViewMethod("onInitDataSave",!1)})})},t.prototype.onViewShowAlert=function(e){this.alert(e)},t.prototype.onViewConfirmLangRemoval=function(e){var t=this;this.windowController.confirm().then(function(n){"yes"==n.result&&t.callViewMethod("callEditor","removeLang",[e])})},t.prototype.prepare=function(){var e=this;return s(null).then(function(){return e.app.mailClientApi.srpSecure.getFullInitData()}).then(function(t){t&&t.defaultLang&&(t.defaultLang in t.langs||(t.langs[t.defaultLang]=[]),o.Lang.containsFunc(t.langs[t.defaultLang],function(e){return"sendMail"==e.type})||t.langs[t.defaultLang].push({type:"sendMail",subject:"",content:"",attachments:[]})),e.callViewMethod("refreshContent",t)})},t.tabName="initdata",t}(i.WindowComponentController);n.InitDataController=a},{"../../../utils/Lang":489,"../../base/WindowComponentController":529,q:327}],520:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("../../../utils/PluginsRegistry"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.loadPlugins(),n}return r(t,e),t.prototype.loadPlugins=function(){s.PluginsRegistry.createComponents(t,this)},t.prototype.prepare=function(){var e,t=this;return o(null).then(function(){return t.app.mailClientApi.srpSecure.getConfigEx()}).then(function(n){return e=n,e.clientVersion=t.app.getVersion().ver,e.serviceDiscoveryUrl=e.instanceUrl.replace(/server\/{0,1}$/,"privmx-configuration.json"),t.app.mailClientApi.refreshUsersCollection()}).then(function(){var n={currentUsers:t.app.mailClientApi.usersCollection.size(),config:e};return"function"==typeof t.modelTransformer?t.modelTransformer(n):n}).then(function(e){t.callViewMethod("renderContent",e)})},t.tabName="sysinfo",t}(i.WindowComponentController);n.SysInfoController=a},{"../../../utils/PluginsRegistry":493,"../../base/WindowComponentController":529,q:327}],521:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("simplito-promise"),a=s.PromiseUtils,u=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.onViewSendSysMsg=function(e,t,n){var r=this,i=[];this.addTaskExWithProgress(this.i18n(""),!0,e,function(e){return o(null).then(function(){return r.app.mailClientApi.refreshUsersCollection()}).then(function(){var s=r.app.mailClientApi.usersCollection.getListCopy();return a.oneByOne(s,function(a,u){return e({type:"mail-info",i:a,size:s.length,username:u.username}),u.activated?u.cachedPkiEntry&&u.cachedPkiEntry.sinks&&0!=u.cachedPkiEntry.sinks.length?o(null).then(function(){return r.app.mailClientApi.resolveHashmail(u.username+"#"+r.app.mailClientApi.identity.host)}).then(function(e){if(!e||!e.receivers||0==e.receivers.length)throw"no-sink";var i=r.app.mailClientApi.createMessage(e.receivers[0],t,n);return r.app.mailClientApi.sendSimpleMessage(i)}).then(function(e){e[0].success?i.push({username:u.username,status:"ok"}):(r.logError(e[0].couse),i.push({username:u.username,status:"error"}))}).fail(function(e){r.logError(e),i.push({username:u.username,status:"error"})}):i.push({username:u.username,status:"no-sink"}):i.push({username:u.username,status:"no-activated"})})}).then(function(){r.callViewMethod("showSendSysMsgResults",i)})})},t.prototype.prepare=function(){},t.tabName="sysmsg",t}(i.WindowComponentController);n.SysMsgController=u},{"../../base/WindowComponentController":529,q:327,"simplito-promise":370}],522:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("../../../component/ext-list/ExtListController"),a=e("../../../component/auto-refresh/AutoRefreshController"),u=e("../../../utils/collection/MutableCollection"),c=e("privfs-client"),f=function(e){function t(t){var n=e.call(this,t)||this;return n.api=n.app.mailClientApi,n.entriesBase=new u.MutableCollection,n.entries=n.registerComponent(new s.ExtListController(n.entriesBase)),n.entriesSize=n.registerComponent(new a.AutoRefreshController({model:n.entriesBase,isCollectionSize:!0})),n.loadCosigners(),n}return r(t,e),t.prototype.getModel=function(){return{hasEntriesToPublish:this.hasEntriesToPublish}},t.prototype.onViewAddDomain=function(){var e=this,t=this.windowController;t.promptEx({title:this.i18n("window.admin.trusted.add.title"),message:this.i18n("window.admin.trusted.add.header"),info:this.i18n("window.admin.trusted.add.info"),input:{placeholder:this.i18n("window.admin.trusted.add.domain.placeholder")},processing:"ok",bodyClass:"admin-alert",width:500,ok:{label:this.i18n("window.admin.trusted.add.confirm")},onClose:function(n){if("ok"!=n.result)return void n.close();if(n.value){var r=n.value,i=r.split("#")[1];if(e.entriesBase.getBy("domain",i))return void t.alert(e.i18n("window.admin.trusted.add.error.exist"));n.startProcessing(),e.api.inviteCosigner(r).then(function(t){e.setCosigners(t),e.callViewMethod("afterAddDomain",i)}).then(function(){n.close()}).fail(function(n){var r="Error";r=n&&"cannot-resolve-hasmail"==n.msg?c.core.ApiErrorCodes.is(n.couse,"USER_DOESNT_EXIST")||n.couse&&"user-does-not-exists"==n.couse.message?e.i18n("window.admin.trusted.add.error.userNotFound"):n.couse&&n.couse.msg&&0==n.couse.msg.indexOf("Cannot resolve endpoint for")?e.i18n("window.admin.trusted.add.error.incompatible"):e.i18n("window.admin.trusted.add.error.cannotResolveHashmail"):e.i18n("window.admin.trusted.add.error.incompatible"),t.onErrorCustom(r,n)}).fin(function(){n.stopProcessing()})}}})},t.prototype.onViewDeleteDomain=function(e,t){var n=this,r=this.windowController;this.addTaskExWithProgress(this.i18n(""),!0,e,function(){if(t!=n.app.getDefaultHost())return r.confirm().then(function(e){if("yes"==e.result)return n.api.removeCosigner(t,n.entriesBase.getBy("domain",t)).then(function(e){n.setCosigners(e),n.callViewMethod("afterRemoveDomain",t)})})})},t.prototype.onViewAcceptDomain=function(e,t){var n=this;this.addTaskExWithProgress(this.i18n(""),!0,e,function(){return n.api.acceptCosigner(t,n.entriesBase.getBy("domain",t)).then(function(e){n.setCosigners(e)})})},t.prototype.onViewPublish=function(e){var t=this,n={};this.entriesBase.forEach(function(e){"ACTIVE"===e.state&&(n[e.domain]=e.keystore)}),this.addTaskExWithProgress(this.i18n(""),!0,e,function(){return o(null).then(function(){return t.verify(n)}).then(function(e){return e.valid?o(null).then(function(){return t.api.srpSecure.publishCosigners(t.api.identity.priv,n)}).then(function(){t.published=n,t.api.trustedServers.cosigners=n,t.setCosigners(t.original),t.windowController.alert(t.i18n("window.admin.trusted.summary"))}):void t.windowController.alert(t.i18n("window.admin.trusted.verifyError"))})})},t.prototype.onViewRefreshDomains=function(e){var t=this;this.addTaskExWithProgress("",!0,e,function(){return t.loadCosigners()})},t.prototype.loadCosigners=function(){var e=this;return o(null).then(function(){return e.api.loadAllCosigners()}).then(function(t){return e.published=t.pkiCosigners,e.setCosigners(t.adminCosigners)})},t.prototype.setCosigners=function(e){this.original=e,this.entriesBase.clear(),this.hasEntriesToPublish=!1;for(var t in e){var n=e[t];n.domain=t,n.fingerprint=n.keystore.getPrimaryKey().keyPair.getFingerprint().toString("hex"),n.published=t in this.published,n.toPublish=!n.published&&"ACTIVE"==n.state||n.published&&"DELETED"==n.state,n.toPublish&&(this.hasEntriesToPublish=!0),("DELETED"!=n.state||n.published)&&this.entriesBase.add(n)}this.callViewMethod("refreshToPublish",this.hasEntriesToPublish)},t.prototype.prepare=function(){return this.loadCosigners()},t.prototype.hasMissing=function(e){for(var t=0;t<e.cosigners.length;t++)if(0!=e.cosigners[t].status)return!0;return!1},t.prototype.verify=function(e){var t=this,n={valid:!0,domains:{}},r={},i=[];for(var s in e)i.push(s);return o.all(i.map(function(i){return t.app.mailClientApi.srpSecure.privmxPKI.getServerKeyStore({pkiOptions:{domain:i,noCache:!0},treeOptions:{cosigners:e},cacheLoad:!1,cacheSave:!1,fetchSave:!1}).then(function(e){r[i]=e,t.hasMissing(e.result)?(n.domains[i]=!1,n.valid=!1):n.domains[i]=!0}).fail(function(e){r[i]=e,n.domains[i]=!1,n.valid=!1})})).then(function(){return t.windowController.getLogger().info("Trusted verify",n,r),n})},t.tabName="trusted",t}(i.WindowComponentController);n.TrustedController=f},{"../../../component/auto-refresh/AutoRefreshController":420,"../../../component/ext-list/ExtListController":425,"../../../utils/collection/MutableCollection":501,"../../base/WindowComponentController":529,"privfs-client":204,q:327}],523:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("../../../component/ext-list/ExtListController"),s=e("../../../component/auto-refresh/AutoRefreshController"),a=e("./../../../utils/collection/SortedCollection"),u=e("../../adminadduser/AdminAddUserWindowController"),c=e("../../adminedituser/AdminEditUserWindowController"),f=function(e){function t(t){var n=e.call(this,t)||this;return n.alert=n.windowController.alert.bind(n.windowController),n.promptEx=n.windowController.promptEx.bind(n.windowController),n.confirm=n.windowController.confirm.bind(n.windowController),n.usersCollection=new a.SortedCollection(n.app.mailClientApi.usersCollection,a.SortedCollection.stringNullableNumericComparator("lastLoginDate","desc",a.SortedCollection.stringComparator("username"))),n.users=n.registerComponent(new o.ExtListController(n.usersCollection)),n.usersSize=n.registerComponent(new s.AutoRefreshController({model:n.usersCollection,isCollectionSize:!0})),n.currentUsername=n.windowController.app.mailClientApi.identity.user,n}return r(t,e),t.prototype.onViewRefreshUsers=function(e){var t=this;this.addTaskExWithProgress("",!0,e,function(){return t.app.mailClientApi.refreshUsersCollection()})},t.prototype.onViewAddUser=function(){this.windowController.openChildWindow(new u.AdminAddUserWindowController(this.windowController))},t.prototype.onViewRemoveUser=function(e,t){var n=this;this.confirm().then(function(r){"yes"==r.result&&n.addTaskExWithProgress(n.i18n(""),!0,e,function(){return n.app.mailClientApi.removeUser(t)})})},t.prototype.onViewEditUser=function(e){this.windowController.openChildWindow(new c.AdminEditUserWindowController(this.windowController,e))},t.prototype.prepare=function(){return this.app.mailClientApi.refreshUsersCollection()},t.tabName="users",t}(i.WindowComponentController);n.UsersController=f},{"../../../component/auto-refresh/AutoRefreshController":420,"../../../component/ext-list/ExtListController":425,"../../adminadduser/AdminAddUserWindowController":524,"../../adminedituser/AdminEditUserWindowController":525,"../../base/WindowComponentController":529,"./../../../utils/collection/SortedCollection":503}],524:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("privfs-client"),a=e("q"),u=function(e){function n(n){var i=e.call(this,n,t,r)||this;return i.openWindowOptions.position="center",i.openWindowOptions.width=800,i.openWindowOptions.height=565,i.openWindowOptions.title=i.i18n("window.adminAddUser.title"),i.openWindowOptions.icon="icon fa fa-user-plus",i}return i(n,e),n.prototype.onViewAddUser=function(e){var t=this,n=this.app.mailClientApi;this.addTaskEx("",!0,function(){return a(null).then(function(){if(!e.email&&(e.notificationEnabled||e.sendActivationLink))throw"__no_email__";return n.getForbiddenUsernames().then(function(t){if(t.indexOf(e.username)!==-1)throw"__forbidden_username__";return n.srpSecure.getConfigEx()})}).then(function(r){var i=r.defaultInvitationLinkPattern;return e.username&&(i=i.replace("{token}","{token}&u="+e.username)),n.srpSecure.addUserWithToken(n.identity.user,e.username,e.email,e.description,e.sendActivationLink,e.notificationEnabled,t.app.localeService.currentLang,i)}).then(function(r){var i="";r.linkSent==s.core.LinkSentStatus.ERROR?i=t.i18n("window.admin.userAdd.info.unknownError",e.email):r.linkSent==s.core.LinkSentStatus.INVALID_CONFIG?i=t.i18n("window.admin.userAdd.info.invalidConfigError",e.email):r.linkSent==s.core.LinkSentStatus.NOT_WANTED?i=t.i18n("window.admin.userAdd.info.send"):r.linkSent==s.core.LinkSentStatus.SENT&&(i=t.i18n("window.admin.userAdd.info.sent",e.email)),t.promptEx({message:t.i18n("window.admin.userAdd.info")+" "+i,info:t.i18n("window.admin.userAdd.info2"),height:265,width:600,input:{value:r.link,multiline:!0,readonly:!0,continous:!0,height:83},cancel:{visible:!1}}).then(function(){n.refreshUsersCollection(),t.close()})}).fail(function(n){return t.callViewMethod("unlockForm"),s.core.ApiErrorCodes.is(n,"USER_ALREADY_EXISTS")?t.alert(t.i18n("window.admin.userAdd.error.userAlreadyExists")):s.core.ApiErrorCodes.is(n,"INVALID_EMAIL")?t.alert(e.notificationEnabled||e.sendActivationLink?t.i18n("window.admin.userAdd.error.invalidEmailOptions"):t.i18n("window.admin.userAdd.error.invalidEmail")):"__forbidden_username__"===n||s.core.ApiErrorCodes.is(n,"INVALID_USERNAME")?t.alert(t.i18n("window.admin.userAdd.error.invalidUsername")):"__no_email__"===n?t.alert(t.i18n("window.admin.userAdd.error.invalidEmailOptions")):a.reject(n)})})},n.prototype.onViewClose=function(){this.close()},n}(o.BaseWindowController);n.AdminAddUserWindowController=u}).call(this,"/app/out/window/adminadduser/AdminAddUserWindowController.js","/app/out/window/adminadduser")},{"../base/BaseWindowController":527,"privfs-client":204,q:327}],525:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("privfs-client"),a=e("q"),u=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.openWindowOptions.position="center",o.openWindowOptions.width=800,o.openWindowOptions.height=575,o.openWindowOptions.title=o.i18n("window.adminEditUser.title",i),o.openWindowOptions.icon="icon fa fa-user",o.username=i,o}return i(n,e),n.prototype.init=function(){var e=this;return this.app.mailClientApi.srpSecure.sinkGetAllByUser(this.username).then(function(t){t&&t.length?e.secureFormsCount=t.filter(function(e){return"anonymous"==e.acl}).length:e.secureFormsCount=0})},n.prototype.getModel=function(){return{user:this.app.mailClientApi.usersCollection.getBy("username",this.username),currentUsername:this.app.mailClientApi.identity.user,secureFormsCount:this.secureFormsCount,contactFormLink:this.app.mailClientApi.userConfig.userContactFormUrl+"?"+this.username}},n.prototype.onViewSaveChanges=function(e){var t=this,n=this.app.mailClientApi,r=this.app.mailClientApi.usersCollection.getBy("username",this.username);this.addTaskEx("",!0,function(){var i=[];if(r.isAdmin!=e.admin&&r.activated&&t.username!=t.app.mailClientApi.identity.user){if(!r.cachedPkiEntry||!r.cachedPkiEntry.primaryKey)throw new Error("Cannot change admin flag for not activated user");i.push(n.srpSecure.changeIsAdmin(n.identity.priv,t.username,e.admin,s.crypto.ecc.PublicKey.fromBase58DER(r.cachedPkiEntry.primaryKey)))}return e.contactFormEnabled="true"===e.contactFormEnabled,e.secureFormsEnabled="true"===e.secureFormsEnabled,delete e.admin,i.push(n.srpSecure.changeUserData(t.username,e)),a.all(i).then(function(){n.refreshUsersCollection(),t.username==t.app.mailClientApi.identity.user&&(t.app.mailClientApi.authData.myData.raw.contactFormEnabled=e.contactFormEnabled,t.app.mailClientApi.authData.myData.raw.secureFormsEnabled=e.secureFormsEnabled),t.callViewMethod("unlockSaveButton")}).fail(function(e){return t.callViewMethod("unlockSaveButton"),a.reject(e)})})},n.prototype.onViewRemoveUser=function(){var e=this;this.confirm().then(function(t){"yes"==t.result&&e.addTaskEx("",!0,function(){return e.app.mailClientApi.removeUser(e.username)}).then(function(){e.close(!0)})})},n.prototype.onViewClose=function(){this.close()},n}(o.BaseWindowController);n.AdminEditUserWindowController=u}).call(this,"/app/out/window/adminedituser/AdminEditUserWindowController.js","/app/out/window/adminedituser")},{"../base/BaseWindowController":527,"privfs-client":204,q:327}],526:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("./BaseWindowController"),o=e("../../component/nav-bar/NavBarController"),s=function(e){function t(t,n,r,i,s){var a=e.call(this,t,n,r,i)||this;return a.navBar=a.registerComponent(new o.NavBarController(s,t)),a.openWindowOptions.showLoadingScreen=!0,a}return r(t,e),t}(i.BaseWindowController);n.BaseAppWindowController=s},{"../../component/nav-bar/NavBarController":427,"./BaseWindowController":527}],527:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../component/base/ComponentController"),o=e("../../component/status-bar/StatusBarController"),s=e("../../component/channel/ProgressController"),a=e("q"),u=e("./../../task/SyncTaskStream"),c=e("./../../utils/Settings"),f=e("simplito-logger"),l=f.get("privfs-mail-client"),h=e("./BaseWindowPath"),p=e("./../../utils/ObjectMap"),d=e("privfs-client"),g=e("../../mail/DemoException"),y=e("../../app/common/MsgBox"),m=e("../../utils/Lang"),v=e("../../utils/Formatter"),b=e("../../mail/filetree/File"),w=2097152,E=function(t){function n(e,n,r,i,s){var a=t.call(this)||this;return a.id=p.ObjectMap.add(a),a.reflect=new h.BaseWindowPath(n,r),a.parentWindow=e,a.childWindows=[],a.app=a.parentWindow.app,a.openWindowOptions={},s?a.taskStream=s:(a.taskStream=new u.SyncTaskStream,a.statusBar=a.registerComponent(new o.StatusBarController(a.taskStream))),
a.errorCallback=a.onError.bind(a),a.logErrorCallback=a.logError.bind(a),null!=i&&(a.settings=new c.Settings(a.reflect.controllerName,i.defaultValue,i.isPublic?a.app.getDefaultSettings():a.app.getSettings(),i.subs)),a.isReady=!1,a.readyDeferreds=[],a}return r(n,t),n.prototype.checkConnectionLost=function(e){return!d.core.ApiErrorCodes.isConnectionError(e)||(this.app.connectionStatusChecker.onConnectionLost(),!1)},n.prototype.getLogger=function(){return l.get(this.reflect.qualifiedName)},n.prototype.logError=function(e){this.getLogger().error(e,null==e?null:e.stack)},n.prototype.onError=function(e){if(this.logError(e),this.checkConnectionLost(e))return this.alert(this.prepareErrorMessage(e))},n.prototype.onErrorCustom=function(e,t){if(this.logError(t),this.checkConnectionLost(t))return this.alert(e)},n.prototype.errorAlert=function(e,t){return this.checkConnectionLost(t)?this.alert(e):a({result:"ok"})},n.prototype.prepareErrorMessage=function(e,t){var n={code:0,message:""};if("function"==typeof t){var r=t(n);if(r)return this.i18n("core.error",[r.code,r.message])}if(d.core.ApiErrorCodes.isConnectionError(e))d.core.ApiErrorCodes.isError(e)?n.code=e.data.error.code:n.code=20480,n.message=this.i18n("core.error.serverNotResponding");else if(d.core.ApiErrorCodes.isOrCouse(e,"MAX_COUNT_OF_BLOCKS_EXCEEDED"))n.code=d.core.ApiErrorCodes.codes.MAX_COUNT_OF_BLOCKS_EXCEEDED.code,n.message=this.i18n("core.error.maxFileSizeExceeded");else if(d.core.ApiErrorCodes.isError(e))n.code=e.data.error.code,n.message=e.data.error.message||e.msg;else if(g.DemoException.is(e,"HASHMAIL_NOT_SUPPORTED"))n.code=e.errorObject.code,n.message=this.i18n("core.demo.hashmailNotSupported",e.data);else{if(g.DemoException.is(e,"MAX_FILE_SIZE_EXCEEDED")){n.code=e.errorObject.code;var i=this.app.getMaxFileSizeLimit();if(i){var o=new v.Formatter;return this.i18n("core.error.maxFileSizeExceeded.detailed",o.bytesSize(i))}return this.i18n("core.error.maxFileSizeExceeded")}e.errorObject?(n.code=e.errorObject.code,n.message=e.errorObject.message):e.data&&e.data.error?(n.code=e.data.error.code,n.message=e.data.error.message||e.msg):(n.code=20481,n.message=e.message||e.msg||e||"")}return this.i18n("core.error",[n.code,n.message])},n.prototype.init=function(){},n.prototype.initStart=function(){var e=this;return a(null).then(function(){return e.init()}).then(function(){for(;e.readyDeferreds.length;)e.readyDeferreds.shift().resolve();e.isReady=!0})},n.prototype.whenReady=function(){if(this.isReady)return a(null);var e=a.defer();return this.readyDeferreds.push(e),e.promise},n.prototype.open=function(){if(this.networkIsDown())return this.showOfflineError(),void this.close(!0);var e="."+this.reflect.windowPath;this.nwin=this.app.openWindow(e,this.openWindowOptions,this.id,this.parentWindow),this.nwin.on("close",this.onNwinClose.bind(this)),this.nwin.on("loaded",this.onNwinLoad.bind(this)),this.nwin.on("initialized",this.onNwinInitialized.bind(this)),this.nwin.on("resize",this.onNwinResize.bind(this)),this.nwin.on("focus",this.onNwinFocus.bind(this))},n.prototype.openDocked=function(e,t){if(this.networkIsDown())return this.showOfflineError(),void this.close(!0);var n=this.reflect.windowPathRelative;this.nwin=e.createDockedWindow(t,n,this.openWindowOptions,this.id),this.nwin.on("close",this.onNwinClose.bind(this)),this.nwin.on("loaded",this.onNwinLoad.bind(this)),this.nwin.on("initialized",this.onNwinInitialized.bind(this)),this.nwin.on("resize",this.onNwinResize.bind(this)),this.nwin.on("focus",this.onNwinFocus.bind(this))},n.prototype.onNwinLoad=function(){var e=this;return a(null).then(function(){if(e.settings)return e.settings.init()}).then(function(){return e.initStart()}).then(function(){return e.nwin.start()}).fail(this.errorCallback)},n.prototype.onNwinInitialized=function(){var e=this;return a(null).then(function(){return e.nwin.isDocked()&&e.parentWindow.onDockedLoad(e),e.nwin.hideLoadingScreen()}).fail(this.errorCallback)},n.prototype.onDockedLoad=function(){},n.prototype.onNwinResize=function(e){this.callViewMethod("setSize",e)},n.prototype.onNwinClose=function(){this.close()},n.prototype.onNwinFocus=function(){this.callViewMethod("focus")},n.prototype.setTitle=function(e){null==this.nwin?this.openWindowOptions.title=e:this.nwin.setTitle(e)},n.prototype.onClose=function(){this.destroy(),this.nwin.close(!0),this.parentWindow.onChildWindowClose(this)},n.prototype.close=function(e){var t=this;return a(null).then(function(){return t.beforeClose(e)}).then(function(){var e=[];return t.childWindows.forEach(function(t){e.push(t.close())}),a.all(e)}).then(function(){return t.afterChildWindowsClose(e)}).then(function(){return t.onClose()})},n.prototype.beforeClose=function(e){},n.prototype.afterChildWindowsClose=function(e){},n.prototype.openChildWindow=function(e){return this.childWindows.push(e),e.open(),e},n.prototype.onChildWindowClose=function(e){var t=this.childWindows.indexOf(e);t>-1&&this.childWindows.splice(t,1)},n.prototype.getChilWindowParent=function(){return this},n.prototype.onViewFocus=function(){var e=this.getClosestNotDockedController();e&&e.nwin&&e.nwin.focus()},n.prototype.onViewInvite=function(){var e=this;if(!this.app.isInviteFriendEnabled())return void this.alert(this.i18n("window.base.invitation.disabled"));var t=this;a(null).then(function(){return t.app.mailClientApi.generateInviteToken()}).then(function(t){return e.app.getTokenRegistrationUrl(t)}).then(function(n){return t.promptEx({message:e.i18n("window.base.invitation.prompt.text"),input:{value:n,readonly:!0,multiline:!0}})}).fail(this.errorCallback)},n.prototype.onViewOpenUrl=function(e){this.app.openUrl(e)},n.prototype.onViewToogleDevTools=function(){var e=this.getClosestNotDockedController();e&&e.nwin&&this.app.isElectronApp()&&e.nwin.toogleDevTools()},n.prototype.setBackgroundModeOn=function(){return!this.isInBackgroundMode()&&(this.backgroundMode=!0,!0)},n.prototype.setBackgroundModeOff=function(){return!!this.isInBackgroundMode()&&(this.backgroundMode=!1,!0)},n.prototype.isInBackgroundMode=function(){return this.backgroundMode===!0},n.prototype.addTask=function(e,t,n){return this.taskStream.createTask(e,{blockUI:t},n).getPromise()},n.prototype.addTaskEx=function(e,t,n){return this.addTask(e,t,n).fail(this.errorCallback)},n.prototype.addTaskExWithProgress=function(e,t,n,r){var i=new s.ProgressController(this,n);return this.addTask(e,t,function(){return a(null).then(function(){return i.start(),r(i.progress.bind(i))}).progress(function(e){i.progress(e)}).fin(function(){i.finish()})}).fail(this.errorCallback)},n.prototype.sendMail=function(e){return this.app.sendMail(e)},n.prototype.sendBlankMail=function(){return this.app.sendBlankMail()},n.prototype.sendMailTo=function(e){return this.app.sendMailTo(e)},n.prototype.getClosestNotDockedController=function(){return this.nwin?this.nwin.isDocked()?this.parentWindow&&this.parentWindow.getClosestNotDockedController?this.parentWindow.getClosestNotDockedController():null:this:null},n.prototype.logout=function(){return this.app.logout()},n.prototype.togglePresence=function(){if(this.networkIsDown())return void this.showOfflineError();var e=this;this.addTaskEx(this.i18n("window.base.task.togglePresence.text"),!0,function(){return e.app.mailClientApi.isStatusPublishingEnabled()?e.app.mailClientApi.disableStatusPublishing():e.app.mailClientApi.userPreferences.getValue("presence.dontAskAboutPresenceType",!1)?e.app.mailClientApi.enableStatusPublishing():void e.app.openPresenceSettings()})},n.prototype.downloadAttachment=function(t,n){if(this.networkIsDown())return this.showOfflineError(),a(null);var r=this;if(n.size<w)return this.addTaskEx(this.i18n("window.base.task.downloadAttachment.text"),!1,function(){return r.app.downloadAttachment(t,n)});var i=e("../download-attachment/DownloadAttachmentWindowController").DownloadAttachmentWindowController,o=new i(this,t,n);return this.addTaskEx(this.i18n("window.base.task.downloadAttachment.text"),!1,function(){return r.openChildWindow(o),o.whenReady().then(function(){var e=r.app.downloadAttachment(t,n);return e.progress(function(e){o.setDownloadProgress(e.percent)}),e.then(function(){o.close(!0)}),e["catch"](function(){o.close(!0)}),e})})},n.prototype.i18n=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.app.localeService.i18n.apply(this.app.localeService,arguments)},n.prototype.deleteMessage=function(e){if(this.networkIsDown())return this.showOfflineError(),a(null);var t=this;return this.addTask(this.i18n("window.main.task.deleteMessage.text"),!0,function(){return a(null).then(function(){return"trash"==e.sink.extra.type?t.confirm(t.i18n("window.main.task.deleteMessage.confirm.text")):{result:"yes"}}).then(function(n){return"yes"==n.result&&a(null).then(function(){return t.app.mailClientApi.deleteMessage(e)}).then(function(){return t.app.playAudio("message-deleted"),!0})}).fail(t.onErrorCustom.bind(t,t.i18n("window.message.error.deleteMessage")))})},n.prototype.networkIsDown=function(){return this.app.networkIsDown()},n.prototype.showOfflineError=function(){return this.app.showOfflineError()},n.prototype.setWindowIcon=function(e){e instanceof b.File?".stx"==e.extl||".stt"==e.extl?this.nwin.setIcon("icon fa fa-font"):".smm"==e.extl?this.nwin.setIcon("icon fa fa-sitemap"):".sss"==e.extl?this.nwin.setIcon("icon fa fa-table"):e.hasImageExt&&e.hasImageExt()?this.nwin.setIcon("icon fa fa-file-image-o"):this.nwin.setIcon("icon fa fa-file"):this.nwin.setIcon(null)},n.prototype.reopenWithParams=function(e){},n}(i.ComponentController);n.BaseWindowController=E,m.Lang.extendPrototype(E,y.MsgBox)},{"../../app/common/MsgBox":414,"../../component/base/ComponentController":421,"../../component/channel/ProgressController":424,"../../component/status-bar/StatusBarController":431,"../../mail/DemoException":436,"../../mail/filetree/File":461,"../../utils/Formatter":487,"../../utils/Lang":489,"../download-attachment/DownloadAttachmentWindowController":532,"./../../task/SyncTaskStream":480,"./../../utils/ObjectMap":492,"./../../utils/Settings":495,"./BaseWindowPath":528,"privfs-client":204,q:327,"simplito-logger":357}],528:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("path"),i=e("privmx-exception"),o=i.IllegalArgumentException,s=e("simplito-utils"),a=function(){function e(e,t){if("string"!=typeof e)throw new o("controllerPath",e);if("string"!=typeof t)throw new o("dirPath",t);e=e.replace("/app/out/","/"),t=t.replace("/app/out/","/"),Object.defineProperty(this,"controllerPath",{value:e.replace(/\\/g,"/"),enumerable:!0}),Object.defineProperty(this,"dirPath",{value:t.replace(/\\/g,"/"),enumerable:!0}),s.defineLazyReadOnlyProperty(this,"controllerFilename",function(){return r.basename(this.controllerPath)}),s.defineLazyReadOnlyProperty(this,"controllerName",function(){return this.controllerFilename.replace(".js","")}),s.defineLazyReadOnlyProperty(this,"viewPath",function(){return this.dirPath+"/"+this.viewFilename}),s.defineLazyReadOnlyProperty(this,"viewFilename",function(){return this.viewName+".js"}),s.defineLazyReadOnlyProperty(this,"viewName",function(){return this.controllerName.replace("Controller","View")}),s.defineLazyReadOnlyProperty(this,"windowPathRelative",function(){return"../"+this.dirName+"/"+this.windowFilename}),s.defineLazyReadOnlyProperty(this,"windowPath",function(){return this.dirPath+"/"+this.windowFilename}),s.defineLazyReadOnlyProperty(this,"windowFilename",function(){return this.windowName+".html"}),s.defineLazyReadOnlyProperty(this,"windowName",function(){return this.controllerName.replace("Controller","")}),s.defineLazyReadOnlyProperty(this,"dirName",function(){return r.basename(this.dirPath)}),s.defineLazyReadOnlyProperty(this,"name",function(){return this.windowName.replace("Window","")}),s.defineLazyReadOnlyProperty(this,"qualifiedName",function(){return"window."+this.dirName+"."+this.controllerName})}return e}();n.BaseWindowPath=a},{path:648,"privmx-exception":266,"simplito-utils":373}],529:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../component/base/ComponentController"),o=function(e){function t(t){var n=e.call(this)||this;return n.windowController=t,n.app=n.windowController.app,n.errorCallback=n.windowController.errorCallback,n.logErrorCallback=n.windowController.logErrorCallback,n.logError=n.windowController.logError.bind(n.windowController),n.onError=n.windowController.onError.bind(n.windowController),n.onErrorCustom=n.windowController.onErrorCustom.bind(n.windowController),n.prepareErrorMessage=n.windowController.prepareErrorMessage.bind(n.windowController),n.addTask=n.windowController.addTask.bind(n.windowController),n.addTaskEx=n.windowController.addTaskEx.bind(n.windowController),n.addTaskExWithProgress=n.windowController.addTaskExWithProgress.bind(n.windowController),n.i18n=n.windowController.i18n.bind(n.windowController),n.onViewOpenUrl=n.windowController.onViewOpenUrl.bind(n.windowController),n}return r(t,e),t}(i.ComponentController);n.WindowComponentController=o},{"../../component/base/ComponentController":421}],530:[function(e,t,n){(function(Buffer,t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("./../base/BaseWindowController"),s=e("../emailpassword/EmailPasswordWindowController"),a=e("privfs-client"),u=e("simplito-utils"),c=e("q"),f=e("simplito-promise"),l=f.PromiseUtils,h=e("../../mail/DemoException"),p=e("../../mail/SinkIndexEntry"),d=e("../../utils/Lang"),g=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.openWindowOptions={toolbar:!1,maximized:!1,show:!1,position:"center",minWidth:500,minHeight:315,width:800,height:565,resizable:!0,title:o.i18n("window.compose.title.emptySubject"),icon:"icon ico-letter"},o.options=i,o.sendingMessage=!1,o.attachments=[],o.registerChangeEvent(o.app.mailClientApi.contactCollection.changeEvent,o.onContactChange,"multi"),o}return i(n,e),n.prototype.getModel=function(){var e=this,t=this.options,n={contacts:this.app.mailClientApi.contactCollection.list,text:"",subject:"",receivers:[],attachments:this.attachments},r=this.app.mailClientApi.userPreferences.getValue("mail.signature"),i=r?"\n"+r:"";if("predefined"==t.type)t.receivers&&(n.receivers=t.receivers),t.title&&(n.subject=t.title),n.text=(t.text||"")+i;else if("reply"==t.type||"reply-to-all"==t.type){n.subject=u.startsWith(t.message.title,"Re: ")?t.message.title:"Re: "+t.message.title;var o="string"==typeof t.text?t.text:this.getMessageDisplayText(t.indexEntry,t.message);if(n.text=this.getMessageQuot(t.indexEntry,t.message,o)+i,"reply"==t.type){var s=t.indexEntry.getContactFormMessageSender()||t.message.sender.hashmail;n.receivers=[s]}else"reply-to-all"==t.type&&(t.message.receivers.forEach(function(e){e!=t.message.mainReceiver&&n.receivers.push(e)}),t.message.mainReceiver&&n.receivers.push(t.message.sender.hashmail))}else if("forward"==t.type){n.subject="Fwd: "+t.message.title;var a="\n\n-------- "+this.i18n("window.compose.forward.content.separator.text")+" --------\n";a+=this.i18n("window.compose.forward.content.subject.label")+": "+t.message.title+"\n",a+=this.i18n("window.compose.forward.content.date.label")+": "+t.message.createDate+"\n",a+=this.i18n("window.compose.forward.content.from.label")+": "+t.message.sender.hashmail+"\n",a+=this.i18n("window.compose.forward.content.to.label")+": ",t.message.receivers.forEach(function(e,t){a+=(0==t?"":", ")+e.user.hashmail}),a+="\n\n"+this.getMessageDisplayText(t.indexEntry,t.message),n.text=a,this.addPredefinedAttachments(t.indexEntry,t.message.attachments)}else"blank"==t.type&&(n.text=i);return n.receivers&&(n.receivers=n.receivers.map(function(t){var n="string"==typeof t?t:t.user.hashmail,r=e.app.mailClientApi.getLowUserByHashmail(n);return r?r.email:t})),n},n.prototype.onViewSubjectChange=function(e){this.setTitle(e?this.i18n("window.compose.title",[e]):this.i18n("window.compose.title.emptySubject"))},n.prototype.onViewSend=function(e,t,r){var i=this;if(this.sendingMessage)return void this.alert(this.i18n("window.compose.error.messageAlreadySending"));if(0==r.length)return void this.alert(this.i18n("window.compose.error.missingRecipients"));if(t.length>n.MAX_MSG_TEXT_SIZE)return void this.alert(this.i18n("window.compose.error.messageTextTooLarge",[n.MAX_MSG_TEXT_SIZE]));var o=d.Lang.findAll(r,function(e){return"string"==typeof e&&e.indexOf("@")!=-1});if(o.length>0&&r.length>1)return void this.alert(this.i18n("window.compose.error.emailMultipleReceivers"));var u=null;if(o.length>0){if(u=o[0],!this.isValidEmail(u))return void this.alert(this.i18n("window.compose.error.invalidEmail"));var c=function(n,r){var o,s=null==r?"":r.getCfmId();i.addTaskEx(i.i18n("window.compose.task.sendMessage.text"),!0,function(){return i.app.mailClientApi.addLowUser(n.email,n.password,n.hint,n.lang,s).then(function(e){var t=a.message.MessageSinkPriv.fromSerialized(e.sink.wif,"","","public",null,null),n=a.identity.Identity.fromSerialized({user:e.username,host:e.host},e.identity.wif,e.email);if(o=new a.message.MessageReceiver(t,n),null!=r){var s=new a.message.Message,u=r.getMessage();return s.msgId=u.msgId,s.createDate=u.createDate,s.title=u.title,s.text=r.getContentAsJson().text,s.setSender(n),s.addReceiver(i.app.mailClientApi.getMeAsReceiver()),s.attachments=u.getAttachmentSources(i.app.mailClientApi.messages.storage,r.index.sink),i.app.mailClientApi.messages.messageCreate(s,null,p.SinkIndexEntry.getMessageTags(s),t)}}).then(function(){i.theSend(e,t,[o],!0,n.lang)})})},f=function(e,t){i.openChildWindow(new s.EmailPasswordWindowController(i,e)).getPromise().then(function(e){"ok"==e.result&&c(e.value,t)})},l=function(e,t){var n=null==e?{email:u,password:"",hint:"",lang:i.app.localeService.currentLang}:{email:u,password:e.password,hint:e.hint,lang:e.language};return f(n,t)};if("reply"==this.options.type&&this.options.indexEntry.isContactFormMessage()){var h=this.app.mailClientApi.getLowUserBySource(this.options.indexEntry.getCfmId());if(h){var g=a.message.MessageSinkPriv.fromSerialized(h.sink.wif,"","","public",null,null),y=a.identity.Identity.fromSerialized({user:h.username,host:h.host},h.identity.wif,h.email),m=new a.message.MessageReceiver(g,y);this.theSend(e,t,[m],!0,h.language)}else{var v=this.options.indexEntry.getContentAsJson();v&&v.password?c({email:u,password:v.password,hint:"",lang:this.app.localeService.currentLang},this.options.indexEntry):l(null,this.options.indexEntry)}}else if("reply"==this.options.type){var h=this.app.mailClientApi.getLowUserByHashmail(this.options.message.sender.hashmail);if(h.email==u){var g=a.message.MessageSinkPriv.fromSerialized(h.sink.wif,"","","public",null,null),y=a.identity.Identity.fromSerialized({user:h.username,host:h.host},h.identity.wif,h.email),m=new a.message.MessageReceiver(g,y);this.theSend(e,t,[m],!0,h.language)}else{var y=this.app.mailClientApi.getLowUserByEmail(u);l(y,null)}}else{var y=this.app.mailClientApi.getLowUserByEmail(u);l(y,null)}}else this.theSend(e,t,r)},n.prototype.theSend=function(e,t,n,r,i){var o,s=this;this.addTask(this.i18n("window.compose.task.sendMessage.text"),!0,function(){var u=[];return s.sendingMessage=!0,l.collect(n,function(e,t){return t instanceof a.message.MessageReceiver?t:c(null).then(function(){if(o=t,s.app.isDemo()&&!s.app.isSupportedHashmail(o))throw new h.DemoException("HASHMAIL_NOT_SUPPORTED",o);return s.app.mailClientApi.resolveHashmailEx(o)}).then(function(t){return 1==t.receivers.length?t.receivers[0]:void u.push({index:parseInt(e),hashmail:o,receivers:t.receivers})})}).then(function(n){if(o=null,u.length>0){for(var a=0;a<u.length;a++){var f=u[a];if(0==f.receivers.length)return void s.alert(s.i18n("window.compose.error.resolve",[f.hashmail]))}return void s.callViewMethod("showMultipleReceivers",u)}null==r&&n.forEach(function(e){s.app.mailClientApi.isLowUser(e.user)&&(r=!0)});var h;return c(null).then(function(){return s.app.mailClientApi.createMessage(n,e,t)}).then(function(e){return h=e,h.contentType="html",s.getEncryptedMessageText(h)}).then(function(e){return s.callViewMethod("setEncryptedMessageText",e),null!=s.options.indexEntry&&("reply"!=s.options.type&&"reply-to-all"!=s.options.type||(h.inReplyTo=s.options.indexEntry.getMessage().msgId),"forward"==s.options.type&&(h.forwarded=s.options.indexEntry.getMessage().msgId)),s.attachments.forEach(function(e){h.addAttachment(e)}),c(null).delay(500)}).then(function(){s.attachments.length&&s.callViewMethod("showAttachmentsInfobox");var e="";return r&&(e=JSON.stringify({from:h.sender.getDisplayName(null),subject:h.title,body:s.i18n("reply"==s.options.type?"window.compose.emailBodyReply."+i:"window.compose.emailBodyNew."+i),lang:i})),s.app.mailClientApi.sendMessage(h,e)}).then(function(e){if(s.attachments.length&&s.callViewMethod("hideAttachmentsInfobox"),null!=s.options.indexEntry){var t=[];"reply"!=s.options.type&&"reply-to-all"!=s.options.type||t.push({name:"replied",value:!0}),"forward"==s.options.type&&t.push({name:"forwarded",value:!0}),t.length>0&&s.app.mailClientApi.updateMessageFlags(s.options.indexEntry,t)}return s.app.playAudio("message-sent"),l.oneByOne(n,function(e,t){return s.app.mailClientApi.addReceiverToContacts(t)})}).then(function(){s.close(!0)})})}).fail(function(e){if(null!=o){var t=s.prepareErrorMessage(e);return(a.core.ApiErrorCodes.is(e,"USER_DOESNT_EXIST")||e&&"user-does-not-exists"==e.message)&&(t=s.i18n("window.compose.error.userNotFound",[o])),a.core.ApiErrorCodes.is(e,"INTERNAL_ERROR")&&(t=s.i18n("window.compose.error.internal",[o])),null!=e&&"Invalid parameter"==e.message&&(t=o.indexOf("@")!=-1?s.i18n("window.compose.error.email",[o]):s.i18n("window.compose.error.hashmail",[o])),e&&"invalid-server-keystore"==e.errorType&&(t=s.i18n("window.compose.error.invalidServerHashmail",[o])),s.onErrorCustom(t,e)}s.logError(e);var n=s.app.mailClientApi.getMessagePostError(e);return c(null).then(function(){return s.errorAlert(n.msg,e)}).then(function(){n.savedToOutbox?s.close(!0):(s.callViewMethod("unsetEncryptedMessageText"),s.callViewMethod("hideAttachmentsInfobox"))})}).fin(function(){s.sendingMessage=!1})},n.prototype.onViewAddAttachments=function(){var e=this;this.app.openFiles().then(function(t){var n=[];return l.oneByOne(t,function(e,t){var r=a.message.MessageAttachment.create(t);n.push(r)}).then(function(){var t=e.attachments.concat(n);if(e.app.hasMaxFileSizeLimit()){for(var r=0,i=0;i<t.length;i++)r+=t[i].size;if(r>e.app.getMaxFileSizeLimit())throw new h.DemoException("MAX_FILE_SIZE_EXCEEDED")}e.attachments=t,e.callViewMethod("renderAttachments",e.attachments)})}).fail(this.errorCallback)},n.prototype.onViewDeleteAttachment=function(e){e!=-1&&(this.attachments.splice(e,1),this.callViewMethod("renderAttachments",this.attachments))},n.prototype.sinkSelect=function(e,t,n){var r=this;this.addTaskEx(this.i18n("window.compose.task.resolveHashmail.text"),!0,function(){return c(null).then(function(){return r.app.mailClientApi.resolveHashmail(t)}).then(function(t){for(var i in t.receivers)if(t.receivers[i].sink.id==n.id)return void r.callViewMethod("toggleInput",e,t.receivers[i]);var o=a.message.MessageSink.fromSerialized(n.id,n.name,n.description),s=new a.message.MessageReceiver(o,t.data.user);r.callViewMethod("toggleInput",e,s)})})},n.prototype.getMessageDisplayText=function(e,t){var n=e.getOriginalSinkType();if("pki-event"==t.type)try{return JSON.parse(t.text).content}catch(r){}else if("form"==n)try{var i=JSON.parse(t.text),o="";for(var s in i)o+=s+": "+i[s]+"\n";return o}catch(r){}else if(e.isContactFormMessage())try{return JSON.parse(t.text).text}catch(r){}return t.text},n.prototype.getMessageQuot=function(e,t,n){n=n.replace(/<br\s*\/?>/gim,"\n");var r="> "+n.split("\n").join("\n> "),i=this.app.localeService.longDate(t.createDate),o=e.getContactFormMessageSender();if(!o){var s=this.app.mailClientApi.getLowUserByHashmail(t.sender.hashmail);o=s?s.email:t.sender.hashmail}var a=this.i18n("window.compose.quote.text",[i,o]),u=["\n\n",a,"\n",r];return u.join("")},n.prototype.addPredefinedAttachments=function(e,t){var n=this;return this.attachments=[],l.oneByOne(t,function(t,r){return c(null).then(function(){return n.app.mailClientApi.getAttachmentContent(e,r)}).then(function(e){var t=a.message.MessageAttachment.create(e.asLazyBuffer());n.attachments.push(t)})}).then(function(){n.callViewMethod("renderAttachments",n.attachments)}).fail(this.errorCallback)},n.prototype.getEncryptedMessageText=function(e){var t=e.receivers[0];return c(null).then(function(){return e.serialize(t,[],e.sender.pub58)}).then(function(n){var r={data:n.data,signature:n.signature},i=new Buffer(JSON.stringify(r),"utf8");return a.crypto.service.eciesEncrypt(e.sender.priv,t.sink.pub,i)}).then(function(e){return e.toString("base64")})},n.prototype.afterChildWindowsClose=function(e){var t=this,n=c.defer();return c(null).then(function(){return e?{result:"yes"}:t.sendingMessage?t.confirm(t.i18n("window.compose.confirm.close.sending.text")):c(null).then(function(){return t.retrieveFromView("formIsDirty")}).then(function(e){return e?t.confirmEx({message:t.i18n("window.compose.confirm.close.dirty.text"),yes:{faIcon:"trash",btnClass:"btn-warning",label:t.i18n("window.compose.confirm.close.dirty.confirm")},no:{faIcon:"",btnClass:"btn-default",label:t.i18n("core.button.cancel.label")}}):{result:"yes"}})}).then(function(e){"yes"==e.result?n.resolve():n.reject(null)}),n.promise},n.prototype.onContactChange=function(){this.callViewMethod("updateContactList",this.app.mailClientApi.contactCollection.list)},n.prototype.isValidEmail=function(e){var t=e.split("@");return 2==t.length&&t[0].length>0&&t[0].trim()==t[0]&&t[1].length>0&&t[1].trim()==t[1]},n.MAX_MSG_TEXT_SIZE=1e5,n}(o.BaseWindowController);n.ComposeWindowController=g}).call(this,e("buffer").Buffer,"/app/out/window/compose/ComposeWindowController.js","/app/out/window/compose")},{"../../mail/DemoException":436,"../../mail/SinkIndexEntry":450,"../../utils/Lang":489,"../emailpassword/EmailPasswordWindowController":534,"./../base/BaseWindowController":527,buffer:590,"privfs-client":204,q:327,"simplito-promise":370,"simplito-utils":373}],531:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("../main/MainWindowController"),a=e("../../task/MultiTaskStream"),u=e("../../component/status-bar-main/StatusBarMainController"),c=e("../../component/auto-refresh/AutoRefreshController"),f=function(e){function n(n){var i=e.call(this,n,t,r)||this;return i.openWindowOptions.maximized=!0,i.openWindowOptions.width=1e3,i.openWindowOptions.height=600,i.openWindowOptions.fullscreen=!0,i.openWindowOptions.cssClass="app-window",i.openWindowOptions.title="PrivMX",i.openWindowOptions.showLoadingScreen=!0,i.mainTaskStream=new a.MultiTaskStream,i.mainTaskStream.addStream(i.taskStream),i.mainTaskStream.addStream(i.app.mailClientApi.taskStream),i.app.isElectronApp()&&(i.statusBarMain=new u.StatusBarMainController(i.mainTaskStream,i.app.localeService)),i.windows={},i.processedHistoryKeys={},i.app.isAutoUpdateSupport()&&(i.autoUpdateStatus=i.registerComponent(new c.AutoRefreshController({model:i.app.getAutoUpdateStatusModel()}))),i}return i(n,e),n.prototype.getModel=function(){return{showStatusBar:null!=this.statusBarMain,showAutoUpdateStatus:null!=this.autoUpdateStatus}},n.prototype.onViewLoad=function(){this.switchToMail()},n.prototype.redirectTo=function(e,t,n){this.app.setContainerWindowHistoryEntry({pathname:e,state:t},n)},n.prototype.switchToMail=function(){this.redirectTo("/mail")},n.prototype.switchTo=function(e,t,n){if(null==this.windows[e]){if(this.networkIsDown())return this.showOfflineError(),void this.app.goBack();this.windows[e]=new n(this),this.mainTaskStream.addStream(this.windows[e].taskStream),this.windows[e].openDocked(this.nwin,t);var r=this.windows[e].nwin;this.callViewMethod("openIframe",r.id,r.url)}this.active!=this.windows[e]&&(null!=this.active&&"function"==typeof this.active.setBackgroundModeOn&&this.active.setBackgroundModeOn(),null!=this.windows[e]&&"function"==typeof this.windows[e].setBackgroundModeOff&&this.windows[e].setBackgroundModeOff(),this.active=this.windows[e],this.callViewMethod("showIframe",t))},n.prototype.onDockedLoad=function(){this.callViewMethod("hideLoading")},n.prototype.onHistoryChange=function(e){this.switchTo("mail",2,s.MainWindowController)},n.prototype.afterChildWindowsClose=function(){this.app.logout()},n}(o.BaseWindowController);n.ContainerWindowController=f}).call(this,"/app/out/window/container/ContainerWindowController.js","/app/out/window/container")},{"../../component/auto-refresh/AutoRefreshController":420,"../../component/status-bar-main/StatusBarMainController":429,"../../task/MultiTaskStream":478,"../base/BaseWindowController":527,"../main/MainWindowController":540}],532:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=function(e){function n(n,i,o){var s=e.call(this,n,t,r)||this;return s.message=i,s.attachment=o,s.openWindowOptions.position="center",s.openWindowOptions.width=500,s.openWindowOptions.height=230,s.openWindowOptions.resizable=!1,s.openWindowOptions.minimizable=!0,s.openWindowOptions.title=s.i18n("window.downloadAttachment.title",[o.name]),s}return i(n,e),n.prototype.getModel=function(){return{attachment:this.attachment}},n.prototype.setDownloadProgress=function(e){this.callViewMethod("setDownloadProgress",e)},n.prototype.onNwinClose=function(){},n}(o.BaseWindowController);n.DownloadAttachmentWindowController=s}).call(this,"/app/out/window/download-attachment/DownloadAttachmentWindowController.js","/app/out/window/download-attachment")},{"../base/BaseWindowController":527}],533:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.model=i,o.openWindowOptions.position="center-always",o.openWindowOptions.width=550,o.openWindowOptions.height=300,o.openWindowOptions.modal=!0,o.openWindowOptions.widget=!1,o.openWindowOptions.draggable=!1,o.openWindowOptions.resizable=!1,o.openWindowOptions.title=o.i18n("window.emailinfo.title"),o}return i(n,e),n.prototype.getModel=function(){return this.model},n.prototype.onViewAction=function(e){this.close()},n}(o.BaseWindowController);n.EmailInfoWindowController=s}).call(this,"/app/out/window/emailinfo/EmailInfoWindowController.js","/app/out/window/emailinfo")},{"../base/BaseWindowController":527}],534:[function(e,t,n){(function(t,r){
"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("q"),a=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.model=i,o.openWindowOptions.position="center-always",o.openWindowOptions.width=650,o.openWindowOptions.height=430,o.openWindowOptions.modal=!0,o.openWindowOptions.widget=!1,o.openWindowOptions.draggable=!1,o.openWindowOptions.resizable=!1,o.openWindowOptions.title=o.i18n("window.emailpassword.title"),o.deferred=s.defer(),o}return i(n,e),n.prototype.getModel=function(){return this.model},n.prototype.onViewAction=function(e,t){this.result=e,this.value=t,"ok"!=this.result||this.value&&this.value.password&&!(this.value.password.length<3)?this.closeCore():this.alert(this.i18n("window.emailpassword.invalidPassword"))},n.prototype.onViewEscape=function(){this.close()},n.prototype.close=function(e){this.result="close",this.value=null,this.closeCore()},n.prototype.closeCore=function(){var e=this;"result"in this||(this.result="close",this.value=null);var t=this;return s(null).then(function(){return o.BaseWindowController.prototype.close.call(t)}).then(function(){t.deferred.resolve({result:e.result,value:e.value})})},n.prototype.getPromise=function(){return this.deferred.promise},n}(o.BaseWindowController);n.EmailPasswordWindowController=a}).call(this,"/app/out/window/emailpassword/EmailPasswordWindowController.js","/app/out/window/emailpassword")},{"../base/BaseWindowController":527,q:327}],535:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("privfs-client"),a=e("privmx-exception"),u=e("../../mail/filetree"),c=e("q"),f=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;if(i.entry instanceof u.File)o.name=i.entry.name,o.file=i.entry,o.icon="icon fa fa-file-image-o";else{if(!(i.entry instanceof s.message.MessageAttachment))throw new a.IllegalArgumentException("Options.entry",i.entry);o.name=i.entry.name,o.attachment=i.entry,o.message=i.message,o.icon="icon ico-attach"}return o.style=i.style,o.docked=!!i.docked,o.docked?(o.openWindowOptions.widget=!1,o.openWindowOptions.decoration=!1):o.openWindowOptions={toolbar:!1,maximized:!1,show:!1,position:"center",minWidth:350,minHeight:215,width:"66%",height:"75%",resizable:!0,title:o.name,icon:o.icon},o}return i(n,e),n.prototype.getModel=function(){return{style:this.style,docked:this.docked}},n.prototype.onViewLoad=function(){var e=this;this.addTaskEx(this.i18n("window.image.task.load.text"),!0,function(){return c(null).then(function(){return e.file?(e.app.mailClientApi.setContainerEventsReadStatus(e.file,!0,!1),e.file.openDataUrl()):e.attachment?e.app.mailClientApi.getAttachmentDataUrl(e.message,e.attachment):void 0}).progress(function(t){e.callViewMethod("setProgress",t)}).then(function(t){e.callViewMethod("setImage",t)})})},n.prototype.onViewDetectImageSize=function(e,t){this.size={width:e,height:t},this.refreshTitle()},n.prototype.onViewClose=function(){this.close()},n.prototype.hasOpenedEntry=function(e){return this.file==e},n.prototype.canBeQuietlyClosed=function(){return!0},n.prototype.refreshName=function(){null!=this.file&&(this.name=this.file.name,this.refreshTitle())},n.prototype.refreshTitle=function(){this.setTitle(this.size?this.name+" ("+this.size.width+"x"+this.size.height+")":this.name)},n}(o.BaseWindowController);n.ImageWindowController=f}).call(this,"/app/out/window/image/ImageWindowController.js","/app/out/window/image")},{"../../mail/filetree":464,"../base/BaseWindowController":527,"privfs-client":204,"privmx-exception":266,q:327}],536:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("./../base/BaseWindowController"),s=e("./login/LoginController"),a=e("./alternativeLogin/AlternativeLoginController"),u=e("./register/RegisterController"),c=function(e){function n(n){var i=e.call(this,n,t,r,{isPublic:!0,defaultValue:{"remember-hashmail":0,"remember-password":0}})||this;i.token=i.app.getToken(),i.app.isElectronApp()?(i.openWindowOptions.width=640,i.openWindowOptions.height=480,i.openWindowOptions.decoration=!1,i.openWindowOptions.position="center-always",i.openWindowOptions.title="PrivMX"):i.app.isWebApp()&&(i.openWindowOptions.fullscreen=!0,i.openWindowOptions.cssClass="app-window"),i.openWindowOptions.showLoadingScreen=!0,i.login=new s.LoginController(i),i.alternativeLogin=new a.AlternativeLoginController(i);var o={token:i.token,adminRegistration:i.app.getAdminRegistration(),predefinedUsername:i.app.getPredefinedUsername(),domain:i.app.getRegisterDomain(),originalUrl:i.app.getOriginalUrl()};return i.register=new u.RegisterController(i,o),i}return i(n,e),n.prototype.getModel=function(){return{active:this.token?"register":"login"}},n.prototype.onViewChangeLang=function(e){this.app.changeLang(e)},n.prototype.afterRegister=function(){this.login.reinit(),this.callViewMethod("setActive","login")},n.prototype.openLogin=function(){this.login.reinit(),this.callViewMethod("setActive","login")},n.prototype.openAlternativeLogin=function(){this.callViewMethod("setActive","alternativeLogin")},n}(o.BaseWindowController);n.LoginWindowController=c}).call(this,"/app/out/window/login/LoginWindowController.js","/app/out/window/login")},{"./../base/BaseWindowController":527,"./alternativeLogin/AlternativeLoginController":537,"./login/LoginController":538,"./register/RegisterController":539}],537:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("privfs-client"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.alert=n.windowController.alert.bind(n.windowController),n}return r(t,e),t.prototype.getModel=function(){return{host:this.app.getDefaultHost()}},t.prototype.onViewLogin=function(e){var t=this;if(!e)return void this.alert(this.i18n("window.login.submit.error.emptyWords")).then(function(){return t.callViewMethod("showError",null)});var n=this;this.addTaskEx(this.i18n("window.login.task.alternativeLogin.text"),!0,function(){return o(null).then(function(){return n.app.mailClientApi.alternativeLogin(n.app.getDefaultHost(),e)}).then(function(){return n.app.onLogin()}).fail(function(e){n.logError(e);var t=n.prepareErrorMessage(e,function(t){return s.core.ApiErrorCodes.is(e,"USER_DOESNT_EXIST")?(t.code=e.data.error.code,t.message=n.i18n("window.login.submitAlternativeLogin.error.invalidWords"),t):s.core.ApiErrorCodes.is(e,"LOGIN_BLOCKED")?(t.code=e.data.error.code,t.message=n.i18n("window.login.submit.error.loginBlocked"),t):"AssertionError: Invalid mnemonic"==e||"AssertionError: Invalid mnemonic checksum"==e||s.core.ApiErrorCodes.is(e,"INVALID_SIGNATURE")?(t.message=n.i18n("window.login.submitAlternativeLogin.error.invalidWords"),s.core.ApiErrorCodes.is(e,"INVALID_SIGNATURE")?t.code=e.data.error.code:t.code=36864,t):void 0});n.callViewMethod("showError",t)})})},t.prototype.onViewOpenLogin=function(){this.windowController.openLogin()},t}(i.WindowComponentController);n.AlternativeLoginController=a},{"../../base/WindowComponentController":529,"privfs-client":204,q:327}],538:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("privfs-client"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.settings=n.windowController.settings,n.alert=n.windowController.alert.bind(n.windowController),n.confirmEx=n.windowController.confirmEx.bind(n.windowController),n}return r(t,e),t.prototype.getModel=function(){return{host:this.app.getDefaultHost(),remember:this.getRemeberModel()}},t.prototype.onViewHashmailChange=function(e){this.settings.objectGet("remember-hashmail")&&this.settings.objectSet("remember-hashmail-value",e)},t.prototype.onViewHashmailRememberChange=function(e){this.settings.objectSet("remember-hashmail",e),e||(this.settings.objectSet("remember-hashmail-value",""),this.settings.objectSet("remember-password",!1),this.settings.objectSet("remember-password-value","")),this.callViewMethod("refreshRemember",this.getRemeberModel())},t.prototype.onViewPasswordRememberChange=function(e){var t=this;e?this.showRememberPasswordWarning().then(function(e){"yes"==e.result?t.settings.objectSet("remember-password",!0):(t.settings.objectSet("remember-password",!1),t.settings.objectSet("remember-password-value","")),t.callViewMethod("refreshRemember",t.getRemeberModel())}):(this.settings.objectSet("remember-password",!1),this.settings.objectSet("remember-password-value",""),this.callViewMethod("refreshRemember",this.getRemeberModel()))},t.prototype.onViewLogin=function(e,t){if(!e)return void this.alert(this.i18n("window.login.submit.error.emptyHashmail")).then(this.callViewMethod.bind(this,"showError",null));if(e.indexOf("@")!=-1)return this.callViewMethod("showError",this.i18n("window.login.submit.error.notUseAtSign"));if(e.indexOf("#")==-1&&(e+="#"+this.app.getDefaultHost()),!this.app.isSupportedHashmail(e))return void this.alert(this.i18n("window.login.submit.error.unsupportedHashmail",[this.app.getSupportedHosts().join(", ")])).then(this.callViewMethod.bind(this,"showError",null));if(!t)return void this.alert(this.i18n("window.login.submit.error.emptyPassword")).then(this.callViewMethod.bind(this,"showError",null));var n=this;this.addTaskEx(this.i18n("window.login.task.login.text"),!0,function(){return o(null).then(function(){return n.app.mailClientApi.login(e,t)}).then(function(){return n.settings.objectGet("remember-hashmail")&&n.settings.objectSet("remember-hashmail-value",e),n.settings.objectGet("remember-password")&&n.settings.objectSet("remember-password-value",t),n.app.onLogin()}).fail(function(e){n.logError(e);var t="";t=e&&e.msg&&"string"==typeof e.msg&&0==e.msg.indexOf("Failed assert ALLOW_WITH_MAINTENANCE")?n.i18n("window.login.submit.error.maintenance"):s.core.ApiErrorCodes.isEx(e,"DIFFERENT_M1")?n.i18n("window.login.submit.error.invalidPassword"):s.core.ApiErrorCodes.isEx(e,"USER_DOESNT_EXIST")?n.i18n("window.login.submit.error.invalidPassword"):s.core.ApiErrorCodes.isEx(e,"INVALID_VERIFER")?n.i18n("window.login.submit.error.invalidPassword"):s.core.ApiErrorCodes.isEx(e,"LOGIN_BLOCKED")?n.i18n("window.login.submit.error.loginBlocked"):n.prepareErrorMessage(e),n.callViewMethod("showError",t)})})},t.prototype.onViewOpenAlternativeLogin=function(){this.windowController.openAlternativeLogin()},t.prototype.getRemeberModel=function(){return{hashmail:{value:this.settings.objectGet("remember-hashmail-value")||"",checked:!!this.settings.objectGet("remember-hashmail")},password:{value:this.settings.objectGet("remember-password-value")||"",checked:!!this.settings.objectGet("remember-password")}}},t.prototype.showRememberPasswordWarning=function(){return this.confirmEx({width:710,height:200,message:this.i18n("window.login.rememberPasswordWarning.text"),focusOn:"no",yes:{label:this.i18n("window.login.rememberPasswordWarning.yes.text"),btnClass:"btn-default"},no:{label:this.i18n("window.login.rememberPasswordWarning.no.text"),btnClass:"btn-success"}})},t.prototype.reinit=function(){this.callViewMethod("reinit",this.getRemeberModel())},t}(i.WindowComponentController);n.LoginController=a},{"../../base/WindowComponentController":529,"privfs-client":204,q:327}],539:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../../base/WindowComponentController"),o=e("q"),s=e("privfs-client"),a=e("../../../utils/PluginsRegistry"),u=function(e){function t(t,n){var r=e.call(this,t)||this;return r.model=n,r.settings=r.windowController.settings,r.alert=r.windowController.alert.bind(r.windowController),r.loadPlugins(),r}return r(t,e),t.prototype.getModel=function(){return this.model},t.prototype.loadPlugins=function(){a.PluginsRegistry.createComponents(t,this)},t.prototype.onViewRegister=function(e,t,n,r,i,a,u,c){if(!e)return void this.alert(this.i18n("window.login.submit.error.emptyHashmail")).then(this.callViewMethod.bind(this,"showError",null));if(e.indexOf("#")==-1&&(e+="#"+this.app.getDefaultHost()),!this.app.isSupportedHashmail(e))return void this.alert(this.i18n("window.login.submit.error.unsupportedHashmail",[this.app.getSupportedHosts().join(", ")])).then(this.callViewMethod.bind(this,"showError",null));if(!t)return void this.alert(this.i18n("window.login.submit.error.emptyPassword")).then(this.callViewMethod.bind(this,"showError",null));if(t!==n)return void this.alert(this.i18n("window.login.submitRegister.error.passwordsMismatch")).then(this.callViewMethod.bind(this,"showError",null));if(!this.model.noTerms&&!u)return void this.alert(this.i18n("window.login.submitRegister.error.termsRequired")).then(this.callViewMethod.bind(this,"showError",null));var f=this;this.addTaskEx(this.i18n("window.login.task.register.text"),!0,function(){return o(null).then(function(){return f.app.mailClientApi.register(e,t,r,i,a,c)}).then(function(){return o(null).then(function(){return f.app.markTokenAsUsed(a),f.alert(f.i18n("window.login.submitRegister.confirm"))}).then(function(){f.settings.objectSet("remember-hashmail",!0),f.settings.objectSet("remember-hashmail-value",e),f.settings.objectSet("remember-password",!1),f.settings.objectSet("remember-password",""),f.windowController.afterRegister()})}).fail(function(e){f.logError(e);var t=f.prepareErrorMessage(e,function(t){return s.core.ApiErrorCodes.is(e,"INVALID_USERNAME")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.invalidUsername"),t):s.core.ApiErrorCodes.is(e,"INVALID_HOST")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.invalidHost"),t):s.core.ApiErrorCodes.is(e,"USER_ALREADY_EXISTS")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.userAlreadyExists"),t):s.core.ApiErrorCodes.is(e,"MAX_PIN_ATTEMPTS_EXCEEDED")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.maxPinAttemptsExceeded"),t):s.core.ApiErrorCodes.is(e,"INVALID_PIN")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.invalidPin"),t):s.core.ApiErrorCodes.is(e,"OPEN_REGISTRATION_DISABLED")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.openRegistrationDisabled"),t):s.core.ApiErrorCodes.is(e,"INVALID_TOKEN")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.invalidToken"),t):s.core.ApiErrorCodes.is(e,"INVALID_EMAIL")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.invalidEmail"),t):s.core.ApiErrorCodes.is(e,"FORBIDDEN_USERNAME")?(t.code=e.data.error.code,t.message=f.i18n("window.login.submitRegister.error.forbiddenUsername"),t):void 0});f.callViewMethod("showError",t)})})},t}(i.WindowComponentController);n.RegisterController=u},{"../../../utils/PluginsRegistry":493,"../../base/WindowComponentController":529,"privfs-client":204,q:327}],540:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("./../base/BaseAppWindowController"),s=e("./../../utils/collection/WithActiveCollection"),a=e("./../../utils/collection/SortedCollection"),u=e("../../component/splitter/SplitterController"),c=e("../../component/ext-list/ExtListController"),f=e("./MessagesTableController"),l=e("../../mail/SinkIndex"),h=e("q"),p=function(e){function n(n){var i=e.call(this,n,t,r,{isPublic:!1,subs:{"splitter-vertical":{defaultValue:250},"splitter-horizontal":{defaultValue:200},"message-list-column-subject":{defaultValue:1},"message-list-column-sender":{defaultValue:1},"message-list-column-receiver":{defaultValue:1},"message-list-column-date":{defaultValue:1},"messages-sorter":{defaultValue:{key:"date",order:"desc"}}}},"mail")||this;return i.openWindowOptions.fullscreen=!0,i.openWindowOptions.cssClass="app-window",i.openWindowOptions.title=i.i18n("window.main.title"),i}return i(n,e),n.prototype.init=function(){if(!this.componentsCreated){this.componentsCreated=!0;var e=this.registerComponent(new a.SortedCollection(this.app.mailClientApi.getSinksIndexCollection(),l.SinkIndex.sinkIndexComparator));this.sinkCollection=this.registerComponent(new s.WithActiveCollection(e)),this.sinks=this.registerComponent(new c.ExtListController(this.sinkCollection)),this.attachmentsCollection=this.registerComponent(new a.SortedCollection(null,function(e,t){return t.entry.source.serverDate-e.entry.source.serverDate})),this.attachments=this.registerComponent(new c.ExtListController(this.attachmentsCollection)),this.messageTable=this.registerComponent(new f.MessagesTableController(this)),this.verticalSplitter=this.registerComponent(new u.SplitterController(this.settings.create("splitter-vertical"))),this.registerChangeEvent(this.sinkCollection.changeEvent,this.onSinkCollectionChange.bind(this))}},n.prototype.onViewLoad=function(){var e=this.sinkCollection.find(function(e){return"inbox"==e.sink.extra.type});this.setActive(e.sink.id)},n.prototype.onViewNewMessage=function(){this.sendBlankMail()},n.prototype.onViewChooseSink=function(e){var t=this.sinkCollection.getActive();null!=t&&t.sink.id==e||this.setActive(e)},n.prototype.onViewOpenAttachment=function(e){var t=this.attachmentsCollection.find(function(t){return t.id==e});this.downloadAttachment(t.entry,t.attachment)},n.prototype.setActive=function(e){var t=this;this.addTaskEx(this.i18n("window.main.task.activateSink.text"),!0,function(){return h(null).then(function(){var n=t.app.mailClientApi.getSinkIndexById(e);t.app.mailClientApi.pollSinkIfNeeded(n.sink);var r=t.app.mailClientApi.getMailsCollection(n.sink),i=t.app.mailClientApi.getAttachmentsCollection(n.sink);t.sinkCollection.setActive(n),t.messageTable.setCollection(r),t.attachmentsCollection.setCollection(i),t.callViewMethod("setAttachmentsSubtitle",n.sink)}).fail(t.onErrorCustom.bind(t,t.i18n("window.main.error.openSink")))})},n.prototype.onSinkCollectionChange=function(e){var t=this.sinkCollection.getActive();t&&(t.entries.size()?this.callViewMethod("hideEmptySinkInfo"):this.callViewMethod("showEmptySinkInfo"))},n}(o.BaseAppWindowController);n.MainWindowController=p}).call(this,"/app/out/window/main/MainWindowController.js","/app/out/window/main")},{"../../component/ext-list/ExtListController":425,"../../component/splitter/SplitterController":428,"../../mail/SinkIndex":449,"./../../utils/collection/SortedCollection":503,"./../../utils/collection/WithActiveCollection":504,"./../base/BaseAppWindowController":526,"./MessagesTableController":541,q:327}],541:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var i=e("../base/WindowComponentController"),o=e("../message/MessageWindowController"),s=e("../../component/splitter/SplitterController"),a=e("../../component/ext-table/ExtTableController"),u=e("../../utils/collection/SortedCollection"),c=e("./../../utils/collection/WithActiveCollection"),f=e("q"),l=function(e){function t(t){var n=e.call(this,t)||this;return n.messageCollection=n.registerComponent(new u.SortedCollection(null,function(){return 0})),n.messageCollectionForTable=n.registerComponent(new c.WithActiveCollection(n.messageCollection)),n.registerChangeEvent(n.messageCollectionForTable.changeEvent,n.onMessageCollectionChange),n.messagePreview=n.registerComponent(new o.MessageWindowController(n.windowController,(!0))),n.registerChangeEvent(n.app.mailClientApi.persons.changeEvent,n.onPersonChange),n.horizontalSplitter=n.registerComponent(new s.SplitterController(n.windowController.settings.create("splitter-horizontal"))),n.messagesListExtTable=n.registerComponent(new a.ExtTableController([{type:"fixed",value:90},{type:"flex",min:.1,value:n.windowController.settings.create("message-list-column-subject")},{type:"flex",min:.1,value:n.windowController.settings.create("message-list-column-sender")},{type:"flex",min:.1,value:n.windowController.settings.create("message-list-column-receiver")},{type:"flex",min:.1,value:n.windowController.settings.create("message-list-column-date")}],n.messageCollectionForTable)),n.initSorter(),n}return r(t,e),t.prototype.onViewLoad=function(){null==this.messagePreview.nwin&&this.messagePreview.openDocked(this.windowController.nwin,1),this.callViewMethod("openIframe",this.messagePreview.nwin.id,this.messagePreview.nwin.url),this.callViewMethod("scrollToTop"),this.callViewMethod("updateSorter",this.sorter.key,this.sorter.order)},t.prototype.onViewOpenMessage=function(e){this.openMessage(e)},t.prototype.onViewOpenMessageWindow=function(e){var t=this;this.addTaskEx(this.i18n("window.main.task.openMessage.text"),!1,function(){return f(null).then(function(){var n=t.getActiveMessageEntryById(e),r=new o.MessageWindowController(t.windowController);r.setIndexEntry(n),t.windowController.openChildWindow(r)}).fail(t.onErrorCustom.bind(t,t.i18n("window.main.error.openMessage")))})},t.prototype.onViewSetMessageReadStatus=function(e,t){var n=this;this.addTaskEx(this.i18n("window.main.task.updateMessage.text"),!0,function(){var r=n.getActiveMessageEntryById(e);return n.app.mailClientApi.setMessageReadStatus(r,t)})},t.prototype.onViewSetSorter=function(e,t){this.sortMessages(e,t)},t.prototype.setCollection=function(e){this.messageCollection.setCollection(e),this.callViewMethod("scrollToTop")},t.prototype.getFirstMailMessageEntry=function(){return this.messageCollectionForTable.find(function(e){return!0})},t.prototype.getActiveMessageEntryById=function(e){return this.messageCollectionForTable.find(function(t){return null!=t.source&&t.source.serverId==e})},t.prototype.openLastMessage=function(){var e=this;return f(null).then(function(){var t=e.getFirstMailMessageEntry();return t?e.openMessage(t.id):e.messagePreview.setIndexEntry(null)})},t.prototype.openMessage=function(e){var t=this;return this.addTaskEx(this.i18n("window.main.task.openMessage.text"),!1,function(){return f(null).then(function(){var n=t.getActiveMessageEntryById(e);t.messageCollectionForTable.setActive(n),t.messagePreview.setIndexEntry(n),t.messageCollection.collection.lastActiveEntryId=e}).fail(t.onErrorCustom.bind(t,t.i18n("window.main.error.openMessage")))})},t.prototype.onMessageCollectionChange=function(e){if(this.messageCollectionForTable.isEmpty())return void this.messagePreview.setIndexEntry(null);if("active"==e.type&&null!=e.oldActive&&null==e.newActive&&"rebuild"!=e.causeType){if(null!=this.messageCollectionForTable.getActive())return;for(var t=e.oldActive.index,n=this.messageCollectionForTable.getEnumerable(),r=t;r<n.length;r++){var i=n[r];if(null!=i)return this.openMessage(i.id)}for(var r=t-1;r>=0;r--){var i=n[r];if(null!=i)return this.openMessage(i.id)}}else if("rebuild"==e.type&&null==this.messageCollectionForTable.getActive()){var o=this.messageCollection.collection.lastActiveEntryId,i=this.getActiveMessageEntryById(o);return i?this.openMessage(i.id):this.openLastMessage()}},t.prototype.onPersonChange=function(e){this.callViewMethod("refreshPerson",e)},t.prototype.initSorter=function(){this.sorterSettings=this.windowController.settings.create("messages-sorter"),this.sorter=this.sorterSettings.get("object"),this.sortMessages(this.sorter.key,this.sorter.order)},t.prototype.sortMessages=function(e,t){var n,r=this;switch(e){case"receivers":n=function(e){return e.data.receivers.map(function(e){return r.app.mailClientApi.getPerson(e.hashmail).getName()}).join(", ")};break;case"sender":n=function(e){return r.app.mailClientApi.getPerson(e.data.sender.hashmail).getName()};break;case"date":n=function(e){return e.serverDate};break;case"attachment":n=function(e){return e.data.attachments.length>0};break;default:n=function(t){return t.data[e]}}var i=function(e,r){var i,o,s=0;return i=n(e.source),o=n(r.source),"string"==typeof i&&(i=i.toLowerCase()),"string"==typeof o&&(o=o.toLowerCase()),i>o?s=1:i<o&&(s=-1),0!=s&&"desc"==t&&(s*=-1),s};this.messageCollection.setSorter(i),this.sorter={key:e,order:t},this.sorterSettings.set(this.sorter),this.callViewMethod("updateSorter",e,t)},t}(i.WindowComponentController);n.MessagesTableController=l},{"../../component/ext-table/ExtTableController":426,"../../component/splitter/SplitterController":428,"../../utils/collection/SortedCollection":503,"../base/WindowComponentController":529,"../message/MessageWindowController":542,"./../../utils/collection/WithActiveCollection":504,q:327}],542:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("./../base/BaseWindowController"),s=e("../source/SourceWindowController"),a=e("../emailinfo/EmailInfoWindowController"),u=e("../../mail/SinkIndex"),c=e("privfs-client"),f=e("q"),l=function(e){function n(n,i){var o=e.call(this,n,t,r,null,i?n.taskStream:null)||this;return o.docked=i,o.docked?(o.openWindowOptions.widget=!1,o.openWindowOptions.decoration=!1):o.openWindowOptions={toolbar:!1,maximized:!1,show:!1,position:"center",minWidth:500,minHeight:315,width:1e3,height:565,resizable:!0,icon:"icon ico-letter"},o.registerChangeEvent(o.app.mailClientApi.persons.changeEvent,o.onPersonsChange,"multi"),o}return i(n,e),n.prototype.getModel=function(){return{showStatusBar:!this.docked}},n.prototype.onViewLoad=function(){null!=this.indexEntry&&this.callViewMethod("readyToRenderMessage")},n.prototype.onViewSendMessage=function(e,t,n){if(null!=this.indexEntry){var r=this.indexEntry.getMessage();if("sender"==e){if(this.indexEntry.isContactFormMessage()){var i=this.indexEntry.getContactFormMessageSender();if(i)return void this.sendMailTo(i)}return void this.sendMailTo(r.sender.hashmail)}if("receiver"==e){for(var o in r.receivers){var s=r.receivers[o];if(s.user.hashmail==t&&s.sink.id==n){var a=this.app.mailClientApi.getContactByHashmail(t);if(null!=a){for(var o in a.sinks){var u=a.sinks[o];if(n==u.id)return void this.sendMailTo(new c.message.MessageReceiver(u,a.user))}return void this.sendMailTo(new c.message.MessageReceiver(s.sink,a.user))}return void this.sendMailTo(s)}}this.sendMailTo(t)}}},n.prototype.onViewDownloadAttachment=function(e){null!=this.indexEntry&&this.downloadAttachment(this.indexEntry,this.indexEntry.getMessage().attachments[e])},n.prototype.onViewReplyToAll=function(e){this.sendMailByType("reply-to-all",e)},n.prototype.onViewReply=function(e){this.sendMailByType("reply",e)},n.prototype.onViewForward=function(e){this.sendMailByType("forward",e)},n.prototype.onViewMove=function(){var e=this,t=this.app.mailClientApi.sinkIndexManager.getAllSinks(),n=[];t.forEach(function(t){e.indexEntry&&e.indexEntry.index.sink!=t&&n.push(t)}),n.sort(u.SinkIndex.sinkComparator),this.callViewMethod("showMoveToDialog",n)},n.prototype.onViewMoveTo=function(e){if(null!=this.indexEntry){if(this.networkIsDown())return void this.showOfflineError();var t=this;this.addTaskEx("",!0,function(){return f(null).then(function(){var n=t.app.mailClientApi.sinkIndexManager.getSinkById(e);return t.app.mailClientApi.moveMessage(t.indexEntry,n)}).then(function(){t.docked||t.close(!0)})})}},n.prototype.onViewDelete=function(){if(null!=this.indexEntry){if(this.networkIsDown())return void this.showOfflineError();var e=this;f(null).then(function(){return e.deleteMessage(e.indexEntry)}).then(function(t){t&&!e.docked&&e.close(!0)})}},n.prototype.onViewShowSource=function(){null!=this.indexEntry&&this.openChildWindow(new s.SourceWindowController(this,this.indexEntry))},n.prototype.onViewResendMessage=function(){if(null!=this.indexEntry){var e=this;this.addTaskEx(this.i18n("window.message.task.resendMessage.text"),!0,function(){return f(null).then(function(){return e.app.mailClientApi.resendMessage(e.indexEntry)}).then(function(){e.docked||e.close(!0)}).fail(function(t){var n=e.app.mailClientApi.getMessagePostError(t);e.onErrorCustom(n.msg,t)})})}},n.prototype.onViewAddContact=function(e,t,n){var r=this;if(null!=this.indexEntry){if(this.networkIsDown())return void this.showOfflineError();var i=this,o=this.indexEntry.getMessage();this.addTaskEx(this.i18n("window.message.task.addToContacts.text"),!0,function(){return f(null).then(function(){if("sender"==e)return i.app.mailClientApi.addSenderToContacts(r.indexEntry,!0,!0);if("receiver"==e)for(var s in o.receivers){var a=o.receivers[s];if(a.user.hashmail==t&&a.sink.id==n)return i.app.mailClientApi.addReceiverToContacts(a,!0)}}).fail(i.onErrorCustom.bind(i,i.i18n("window.message.addContact.failure")))})}},n.prototype.onViewShowVerifyInfo=function(){this.refreshVerifyInfo()},n.prototype.onViewRefreshVerifyInfo=function(){this.refreshVerifyInfo(!0)},n.prototype.onViewShowInfo=function(){var e,t=this.getLowUserInfo();if(null!=t){if(t.lowUser){var n=this.app.mailClientApi.userConfig.talkUrl+"?"+t.lowUser.username;e={password:t.lowUser.password,link:n,hint:t.lowUser.hint}}else e=t.password?{password:t.password}:{};this.openChildWindow(new a.EmailInfoWindowController(this,e))}},n.prototype.getLowUserInfo=function(){var e=this.indexEntry.getMessage();if(this.indexEntry.isContactFormMessage()){var t=this.app.mailClientApi.getLowUserBySource(this.indexEntry.getCfmId());if(null==t){var n=this.indexEntry.getContentAsJson();return n&&n.password?{password:n.password}:{}}return{lowUser:t}}if(this.app.mailClientApi.isLowUser(e.sender)){var r=e.sender;return{lowUser:this.app.mailClientApi.getLowUser(r.user,r.host)}}if(1==e.receivers.length&&this.app.mailClientApi.isLowUser(e.receivers[0].user)){var r=e.receivers[0].user;return{lowUser:this.app.mailClientApi.getLowUser(r.user,r.host)}}return null;
},n.prototype.onPersonsChange=function(){null!=this.indexEntry&&this.callViewMethod("renderHeader",this.indexEntry)},n.prototype.sendMailByType=function(e,t){null!=this.indexEntry&&this.sendMail({type:e,indexEntry:this.indexEntry,message:this.indexEntry.getMessage(),text:t})},n.prototype.setIndexEntry=function(e){this.indexEntry!=e&&(this.onSinkIndexChangeHandler&&this.unregisterChangeEvent(this.onSinkIndexChangeHandler),this.indexEntry=e,this.verifyInfo=null,null==this.indexEntry?this.setTitle(""):(this.app.mailClientApi.setMessageReadStatus(this.indexEntry,!0),this.app.mailClientApi.addSenderAndReceiversToContacts(this.indexEntry),this.setTitle(this.indexEntry.getMessage().title),this.onSinkIndexChangeHandler=this.registerChangeEvent(this.indexEntry.index.entries.changeEvent,this.onSinkIndexChange)),this.callViewMethod("readyToRenderMessage"))},n.prototype.onSinkIndexChange=function(e){e.element==this.indexEntry&&(this.callViewMethod("refreshVerifyInfo",this.indexEntry),this.refreshVerifyInfo())},n.prototype.refreshVerifyInfo=function(e){var t=this,n=this.indexEntry;if(null==n&&this.callViewMethod("refreshVerifyInfoDialog","no-message"),n.hasVerifiedInformation()){if("anonymous"==n.getMessage().sender.user||this.app.mailClientApi.isLowUser(n.getMessage().sender))return void this.callViewMethod("refreshVerifyInfoDialog","anonymous");this.callViewMethod("refreshVerifyInfoDialog","loading"),f(null).then(function(){return e?t.app.mailClientApi.messageSenderVerifier.renewMessageVerify(n,null!=t.verifyInfo).then(function(e){return e.fetch}):t.app.mailClientApi.messageSenderVerifier.getVerifyInfo(n)}).then(function(e){n==t.indexEntry&&(t.verifyInfo=e,null==e?t.callViewMethod("refreshVerifyInfoDialog","fetch-error"):t.callViewMethod("refreshVerifyInfoDialog",{verifyInfo:e,indexEntry:t.indexEntry}))}).fail(function(e){t.callViewMethod("refreshVerifyInfoDialog","fetch-error"),t.logError(e)})}else this.callViewMethod("refreshVerifyInfoDialog","no-verified")},n.prototype.onViewReadyToRenderMessage=function(){var e=this,t=this.indexEntry?this.indexEntry.getMessage():null;this.callViewMethod("renderMessage",this.indexEntry),t&&t.attachments.forEach(function(n,r){0==n.mimeType.indexOf("image/")&&f(null).then(function(){return e.app.mailClientApi.getAttachmentDataUrl(e.indexEntry,n)}).progress(function(n){e.callViewMethod("setImageProgress",t.msgId,r,n)}).then(function(n){e.callViewMethod("setImageDataUrl",t.msgId,r,n)}).fail(e.errorCallback)})},n}(o.BaseWindowController);n.MessageWindowController=l}).call(this,"/app/out/window/message/MessageWindowController.js","/app/out/window/message")},{"../../mail/SinkIndex":449,"../emailinfo/EmailInfoWindowController":533,"../source/SourceWindowController":546,"./../base/BaseWindowController":527,"privfs-client":204,q:327}],543:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("simplito-utils"),a=e("q"),u=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.options=s.fillByDefaults(i,{width:400,height:215,closeResult:"close",message:"",title:"PrivMX",focusOn:"",btnSize:"",bodyClass:"",ok:{visible:!1,label:o.i18n("core.button.ok.label"),faIcon:"check",btnClass:"btn-default",action:{type:"close",result:"ok"}},yes:{visible:!1,label:o.i18n("core.button.yes.label"),faIcon:"check",btnClass:"btn-default",action:{type:"close",result:"yes"}},no:{visible:!1,label:o.i18n("core.button.no.label"),faIcon:"times",btnClass:"btn-default",action:{type:"close",result:"no"}},cancel:{visible:!1,label:o.i18n("core.button.cancel.label"),faIcon:"ban",btnClass:"btn-default",action:{type:"close",result:"cancel"}},input:{visible:!1,multiline:!1,continous:!1,type:"text",readonly:!1,placeholder:"",value:"",height:62,action:{type:"close",result:"input"}},processing:"bottom"}),o.openWindowOptions.position="center-always",o.openWindowOptions.width=o.options.width,o.openWindowOptions.height=o.options.height,o.openWindowOptions.modal=!0,o.openWindowOptions.widget=!1,o.openWindowOptions.draggable=!1,o.openWindowOptions.resizable=!1,o.openWindowOptions.title=o.options.title,o.deferred=a.defer(),o}return i(n,e),n.prototype.getModel=function(){return this.options},n.prototype.onViewAction=function(e){var t=this,n=this.options[e];this.result=n.action.result,this.options.onClose?this.retrieveFromView("getValue").then(function(e){t.options.onClose({result:t.result,value:e,close:o.BaseWindowController.prototype.close.bind(t),startProcessing:t.startProcessing.bind(t),updateProcessing:t.updateProcessing.bind(t),stopProcessing:t.stopProcessing.bind(t),showInputError:t.showInputError.bind(t),hideInputError:t.hideInputError.bind(t)})}):"close"==n.action.type?this.closeCore():"hideAndClose"==n.action.type&&setTimeout(function(){t.nwin.minimize(),setTimeout(t.closeCore.bind(t),n.action.timeout)},100)},n.prototype.onViewEscape=function(){this.close()},n.prototype.startProcessing=function(e){this.preventClose=!0,this.callViewMethod("showProcessing",e)},n.prototype.updateProcessing=function(e){this.callViewMethod("updateProcessing",e)},n.prototype.stopProcessing=function(){this.preventClose=!1,this.callViewMethod("hideProcessing")},n.prototype.showInputError=function(e){this.callViewMethod("showInputError",e)},n.prototype.hideInputError=function(){this.callViewMethod("hideInputError")},n.prototype.close=function(e){var t=this;this.preventClose||(this.result=this.options.closeResult,this.options.onClose?this.retrieveFromView("getValue").then(function(e){t.options.onClose({result:t.result,value:e,close:o.BaseWindowController.prototype.close.bind(t),startProcessing:t.startProcessing.bind(t),updateProcessing:t.updateProcessing.bind(t),stopProcessing:t.stopProcessing.bind(t),showInputError:t.showInputError.bind(t),hideInputError:t.hideInputError.bind(t)})}):this.closeCore())},n.prototype.closeCore=function(){"result"in this||(this.result=this.options.closeResult);var e,t=this;return a(null).then(function(){return t.retrieveFromView("getValue")}).then(function(n){return e=n,o.BaseWindowController.prototype.close.call(t)}).then(function(){t.deferred.resolve({result:t.result,value:e})})},n.prototype.getPromise=function(){return this.deferred.promise},n}(o.BaseWindowController);n.MsgBoxWindowController=u}).call(this,"/app/out/window/msgbox/MsgBoxWindowController.js","/app/out/window/msgbox")},{"../base/BaseWindowController":527,q:327,"simplito-utils":373}],544:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("privfs-client"),a=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.openWindowOptions.position="center",o.openWindowOptions.width=800,o.openWindowOptions.height=600,o.openWindowOptions.title=o.i18n("window.secureFormDev.title"),o.sinkID=i.sid,o.host=o.app.mailClientApi.client.identity.host,o}return i(n,e),n.prototype.init=function(){var e=this;return s.core.PrivFsSrpManager.discoverHostConfiguration(this.host).then(function(t){e.clientUrl=t.defaultEndpoint+"/secure-form/assets.php?f=privmx-client"})},n.prototype.getModel=function(){return{sinkID:this.sinkID,clientUrl:this.clientUrl,host:this.host}},n.prototype.onViewOpenFormTest=function(){this.parentWindow.openFormTest(this.sinkID)},n}(o.BaseWindowController);n.SecureFormDevWindowController=a}).call(this,"/app/out/window/secureformdev/SecureFormDevWindowController.js","/app/out/window/secureformdev")},{"../base/BaseWindowController":527,"privfs-client":204}],545:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=e("q"),a=e("privfs-client"),u=e("simplito-promise"),c=u.PromiseUtils,f=e("../../component/ext-list/ExtListController"),l=e("../../utils/collection/MutableCollection"),h=e("../../utils/collection/SortedCollection"),p=e("../secureformdev/SecureFormDevWindowController"),d=e("../../mail/FilterMode"),g=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.openWindowOptions.position="center",o.openWindowOptions.width=950,o.openWindowOptions.height=575,o.openWindowOptions.title=o.i18n("window.settings.title"),o.openWindowOptions.icon="icon ico-settings",o.userPreferences=o.app.mailClientApi.userPreferences,o.currentSection=i||"public-profile",o.whitelistBase=new l.MutableCollection,o.whitelistSorted=new h.SortedCollection(o.whitelistBase,function(e,t){if(e.newOne!=t.newOne){if(e.newOne)return-1;if(t.newOne)return 1}return e.domain.localeCompare(t.domain)}),o.whitelist=o.registerComponent(new f.ExtListController(o.whitelistSorted)),o}return i(n,e),n.prototype.init=function(){var e=this,t=this.app.mailClientApi.client.identity.host;return a.core.PrivFsSrpManager.discoverHostConfiguration(t).then(function(t){e.hostConfiguration=t})},n.prototype.getModel=function(){return{supportsSecureForms:this.app.supportsSecureForms()&&this.app.mailClientApi.authData.myData.raw.secureFormsEnabled,currentSection:this.currentSection}},n.prototype.onViewOpenSecureFormDev=function(e){this.openChildWindow(new p.SecureFormDevWindowController(this,{sid:e}))},n.prototype.onViewOpenSysInfoSection=function(){var e=this;this.addTaskEx("",!0,function(){var t={browser:e.app.getBrowser(),storageType:e.app.mailClientApi.settings.map.getStorageType(),screenResolution:e.app.getScreenResolution(),messagesCount:e.countMessages(),storageUsage:0};return s(null).then(function(){return e.calculateStorageUsage()}).then(function(n){t.storageUsage=n,e.currentSection="sysinfo",e.callViewMethod("renderSysInfoSection",t)})})},n.prototype.onViewOpenPublicProfileSection=function(){this.currentSection="public-profile";var e={profile:this.userPreferences.data.profile,hashmail:this.app.mailClientApi.identity.hashmail,testMode:this.app.isTestMode()};this.callViewMethod("renderPublicProfileSection",e)},n.prototype.onViewOpenChangePasswordSection=function(){this.currentSection="change-password",this.callViewMethod("renderChangePasswordSection")},n.prototype.onViewOpenInterfaceSection=function(){this.currentSection="interface";var e={ui:this.userPreferences.data.ui};this.callViewMethod("renderInterfaceSection",e)},n.prototype.onViewOpenMailSection=function(){this.currentSection="mail";var e={mail:this.userPreferences.data.mail};this.callViewMethod("renderMailSection",e)},n.prototype.onViewOpenWhitelistSection=function(){var e=[],t=this.app.mailClientApi.getMessagesSummaryByDomain(),n=this.app.mailClientApi.mailFilter.unknownDomains.domains;for(var r in n){var i=t[r];e.push({domain:r,count:i?i.count:0,lastDate:i?i.lastDate:null,data:{mode:d.FilterMode.DENY},newOne:!0})}var o=this.app.mailClientApi.mailFilter.storage.getAll();for(var r in o){var i=t[r];e.push({domain:r,count:i?i.count:0,lastDate:i?i.lastDate:null,data:o[r]})}this.whitelistBase.rebuild(e),this.app.mailClientApi.mailFilter.denyUnknownDomains(),this.currentSection="whitelist",this.callViewMethod("renderWhitelistSection")},n.prototype.onViewOpenAccountSection=function(){this.currentSection="account",this.callViewMethod("renderAccountSection")},n.prototype.onViewOpenSecureFormsSection=function(){this.currentSection="secure-forms",this.callViewMethod("renderSecureFormsSection",this.getSecureFormsModel())},n.prototype.onViewOpenContactFormSection=function(){this.currentSection="contact-form",this.callViewMethod("renderContactFormSection",{activated:this.app.mailClientApi.authData.myData.raw.contactFormEnabled,verifyEmail:"email"==this.app.mailClientApi.sinkIndexManager.getContactFormSink().options.verify})},n.prototype.onViewShowSecretIdWords=function(){var e=this;this.promptEx({message:this.i18n("window.settings.section.alternativeLogin.enterPassword"),height:170,ok:{label:this.i18n("window.settings.section.alternativeLogin.show"),faIcon:"eye"},input:{type:"password",placeholder:this.i18n("window.settings.section.alternativeLogin.enterPassword")},processing:"ok",onClose:function(t){return"ok"!=t.result?void t.close():t.value?(t.hideInputError(),t.startProcessing(""),s(null).then(function(){return e.app.mailClientApi.srpSecure.getRecoveryInfo(t.value)}).then(function(n){t.close(),e.promptEx({message:e.i18n("window.settings.section.alternativeLogin.yourSecretIdWords"),info:e.i18n("window.settings.section.alternativeLogin.info"),height:230,width:600,input:{value:n.mnemonic,readonly:!0,multiline:!0,height:65},cancel:{visible:!1}})}).fail(function(n){a.core.ApiErrorCodes.is(n,"DIFFERENT_M1")||"Connection Broken (processMessage - got ALERT: Different M1)"==n?t.showInputError(e.i18n("window.settings.section.alternativeLogin.invalidPassword")):e.onError(n)}).fin(function(){t.stopProcessing()})):void t.showInputError(e.i18n("window.login.submit.error.emptyPassword"))}})},n.prototype.onViewOpenNotificationsSection=function(){this.currentSection="notifications",this.callViewMethod("renderNotificationsSection",this.userPreferences.getValue("notifications",{enabled:!1,email:"",mails:!0,chats:!0,files:!0}))},n.prototype.onViewSave=function(e){var t=this;this.addTaskEx("",!0,function(){return s(null).then(function(){return t.userPreferences.setMany(e,!0)}).fin(function(){s.delay(500).then(function(){t.callViewMethod("clearSaveButtonState")})})})},n.prototype.onViewChangePassword=function(e,t,n,r,i){var o=this;this.addTaskEx("",!0,function(){return t?n&&n==r?s(null).then(function(){return"oldPassword"==e?o.app.mailClientApi.srpSecure.changePasswordByOldPassword(t,n,i):"secretIdWords"==e?o.app.mailClientApi.srpSecure.changePasswordByRecovery(t,n,i):void 0}).fail(function(e){var t=o.prepareErrorMessage(e,function(t){return a.core.ApiErrorCodes.is(e,"DIFFERENT_M1")||"Connection Broken (processMessage - got ALERT: Different M1)"==e?(t.message=o.i18n("window.login.submit.error.invalidPassword"),a.core.ApiErrorCodes.is(e,"DIFFERENT_M1")?t.code=e.data.error.code:t.code=65536,t):a.exception.PrivFsException.is(e,"INVALID_VERIFER")?(t.code=e.errorObject.code,t.message=o.i18n("window.login.submit.error.invalidPassword"),t):void 0});o.onErrorCustom(t,e)}):o.alert(o.i18n("window.login.submitRegister.error.passwordsMismatch")):o.alert(o.i18n("window.login.submit.error.emptyPassword"))}).fin(function(){s.delay(500).then(function(){o.callViewMethod("clearChangePasswordForm")})})},n.prototype.onViewClearCacheAndLogout=function(){var e=this;s(null).then(function(){return e.confirm()}).then(function(t){if("yes"==t.result)return s(null).then(function(){return e.app.storage.clear()}).then(function(){e.logout()})})},n.prototype.onViewWhitelistSetDomainMode=function(e,t){var n=this,r=this.whitelistBase.getBy("domain",e).data.mode;this.addTaskEx("",!0,function(){return s(null).then(function(){return n.whitelistBase.updateBy("domain",e,{data:{mode:t}}),n.app.mailClientApi.mailFilter.setDomain(e,t)}).fail(function(t){return n.whitelistBase.updateBy("domain",e,{data:{mode:r}}),s.reject(t)})})},n.prototype.onViewWhitelistDeleteDomain=function(e){var t=this;this.addTaskEx("",!0,function(){return s(null).then(function(){return t.app.mailClientApi.mailFilter.removeDomain(e)}).then(function(){t.whitelistBase.updateBy("domain",e,{data:{mode:d.FilterMode.DENY}})})})},n.prototype.onViewWhitelistSuggestBlacklist=function(e){var t=this;this.confirmEx({messageAsTemplateFunc:function(){return t.i18n("window.settings.section.whitelist.report.confirm.msg","<b>"+e+"</b>")},yes:{label:this.i18n("window.settings.section.whitelist.report.confirm.yes")}}).then(function(n){"yes"==n.result&&t.addTaskEx("",!0,function(){return s(null).then(function(){return t.app.mailClientApi.srpSecure.suggestBlacklistEntry(e)}).then(function(){t.alert(t.i18n("window.settings.section.whitelist.report.success"))})})})},n.prototype.onViewWhitelistShowLastMessages=function(e,t){var n=this.app.mailClientApi.getLastUnfilteredMessagesFromDomain(e,t);this.callViewMethod("whitelistShowLastMessages",e,n)},n.prototype.onViewCreateSecureForm=function(){var e=this,t=this.app.mailClientApi;this.addTaskEx("",!0,function(){var n={message:e.i18n("window.settings.section.secureForms.create.prompt.text"),ok:{label:e.i18n("window.settings.section.secureForms.create.prompt.confirm")},input:{placeholder:e.i18n("window.settings.section.secureForms.create.prompt.placeholder",e.app.getDefaultHost())}};return e.promptEx(n).then(function(n){if("ok"==n.result&&n.value)return s(null).then(function(){return t.createSecureFormInbox(n.value)}).then(function(){e.callViewMethod("renderSecureFormsSection",e.getSecureFormsModel())})})})},n.prototype.onViewShowSecureFormTest=function(e){this.openFormTest(e)},n.prototype.onViewDeleteSecureForm=function(e){var t=this,n=this.app.mailClientApi;this.addTaskEx("",!0,function(){return t.confirm(t.i18n("window.settings.section.secureForms.delete.question")).then(function(r){if("yes"==r.result)return s(null).then(function(){return n.deleteSecureFormInbox(e)}).then(function(){t.callViewMethod("renderSecureFormsSection",t.getSecureFormsModel())})})})},n.prototype.onViewSwitchActivateContactForm=function(e){var t=this,n=this.app.mailClientApi;this.addTaskEx("",!0,function(){return n.srpSecure.setContactFormEnabled(e).then(function(){n.authData.myData.raw.contactFormEnabled=e,t.callViewMethod("setActivateContactForm",e)})})},n.prototype.onViewSwitchVerifyEmailContactForm=function(e){var t=this,n=this.app.mailClientApi;this.addTaskEx("",!0,function(){var r=n.sinkIndexManager.getContactFormSink();return e?r.options.verify="email":delete r.options.verify,n.messages.sinkSave(r,n.sinkEncryptor).then(function(){t.callViewMethod("setVerifyEmailContactForm",e)})})},n.prototype.countMessages=function(){var e=0;return this.app.mailClientApi.sinkIndexManager.indexes.forEach(function(t){e+=t.entries.size()+t.systemEntries.size()}),e},n.prototype.calculateStorageUsage=function(){var e=this,t=0;return s(null).then(function(){var n=[],r=e.app.mailClientApi.sinkIndexManager.storage;return e.app.mailClientApi.sinkIndexManager.indexes.forEach(function(e){[e.entries,e.systemEntries].forEach(function(t){t.forEach(function(t){var r=e.getEntryStorageKey(t);n.push(r)})})}),c.oneByOne(n,function(e,n){return s(null).then(function(){return r.hashKey(n)}).then(function(e){return t+=e.length,r.map.getItem(e)}).then(function(e){t+=e.length})})}).then(function(){return t})},n.prototype.calculateTotalStorageUsage=function(){var e=this,t=0;return s(null).then(function(){var n=e.app.mailClientApi.sinkIndexManager.storage.map;return n.iterate(function(e,n){t+=e.length+n.length})}).then(function(){return t})},n.prototype.reopenWithParams=function(e){e&&this.currentSection!=e&&this.callViewMethod("loadSection",e)},n.prototype.getSecureFormsModel=function(){var e=this.app.mailClientApi,t={forms:[]};return t.forms=e.getAllSecureFormInboxes().map(function(t){var n=e.sinkIndexManager.getIndexBySinkId(t.id),r=n.getStats();return{id:t.id,name:t.name,removable:t.options.removable,stats:{total:n.entries.size(),unread:r.unread}}}),t},n.prototype.openFormTest=function(e){var t=this;this.app.mailClientApi.createSecureFormToken(e).then(function(e){var n=t.hostConfiguration.defaultEndpoint+"/secure-form/example.php?token="+e+"&lang="+t.app.localeService.currentLang;t.alertEx({message:t.i18n("window.settings.section.secureForms.testInfo"),ok:{link:{attrs:{href:n,target:"_blank"}}}})})["catch"](function(e){t.onError(e)})},n}(o.BaseWindowController);n.SettingsWindowController=g}).call(this,"/app/out/window/settings/SettingsWindowController.js","/app/out/window/settings")},{"../../component/ext-list/ExtListController":425,"../../mail/FilterMode":437,"../../utils/collection/MutableCollection":501,"../../utils/collection/SortedCollection":503,"../base/BaseWindowController":527,"../secureformdev/SecureFormDevWindowController":544,"privfs-client":204,q:327,"simplito-promise":370}],546:[function(e,t,n){(function(t,r){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();n.__esModule=!0;var o=e("../base/BaseWindowController"),s=function(e){function n(n,i){var o=e.call(this,n,t,r)||this;return o.message=i,o.openWindowOptions.position="center",o.openWindowOptions.width=800,o.openWindowOptions.height=565,o.openWindowOptions.title=o.i18n("window.source.title",[o.message.id]),o.openWindowOptions.icon="icon ico-source",o}return i(n,e),n.prototype.getModel=function(){return{source:JSON.stringify(this.message.source,null,2)}},n}(o.BaseWindowController);n.SourceWindowController=s}).call(this,"/app/out/window/source/SourceWindowController.js","/app/out/window/source")},{"../base/BaseWindowController":527}],547:[function(e,t,n){arguments[4][1][0].apply(n,arguments)},{"./asn1/api":548,"./asn1/base":550,"./asn1/constants":554,"./asn1/decoders":556,"./asn1/encoders":559,"bn.js":562,dup:1}],548:[function(e,t,n){arguments[4][2][0].apply(n,arguments)},{"../asn1":547,dup:2,inherits:640,vm:690}],549:[function(e,t,n){arguments[4][3][0].apply(n,arguments)},{"../base":550,buffer:590,dup:3,inherits:640}],550:[function(e,t,n){arguments[4][4][0].apply(n,arguments)},{"./buffer":549,"./node":551,"./reporter":552,dup:4}],551:[function(e,t,n){arguments[4][5][0].apply(n,arguments)},{"../base":550,dup:5,"minimalistic-assert":643}],552:[function(e,t,n){arguments[4][6][0].apply(n,arguments)},{dup:6,inherits:640}],553:[function(e,t,n){arguments[4][7][0].apply(n,arguments)},{"../constants":554,dup:7}],554:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{"./der":553,dup:8}],555:[function(e,t,n){arguments[4][9][0].apply(n,arguments)},{"../../asn1":547,dup:9,inherits:640}],556:[function(e,t,n){arguments[4][10][0].apply(n,arguments)},{"./der":555,"./pem":557,dup:10}],557:[function(e,t,n){arguments[4][11][0].apply(n,arguments)},{"./der":555,buffer:590,dup:11,inherits:640}],558:[function(e,t,n){arguments[4][12][0].apply(n,arguments)},{"../../asn1":547,buffer:590,dup:12,inherits:640}],559:[function(e,t,n){arguments[4][13][0].apply(n,arguments)},{"./der":558,"./pem":560,dup:13}],560:[function(e,t,n){arguments[4][14][0].apply(n,arguments)},{"./der":558,dup:14,inherits:640}],561:[function(e,t,n){(function(n){"use strict";function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return n.Buffer&&"function"==typeof n.Buffer.isBuffer?n.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function o(e){return Object.prototype.toString.call(e)}function s(e){return!i(e)&&("function"==typeof n.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function a(e){if(w.isFunction(e)){if(S)return e.name;var t=e.toString(),n=t.match(C);return n&&n[1]}}function u(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function c(e){if(S||!w.isFunction(e))return w.inspect(e);var t=a(e),n=t?": "+t:"";return"[Function"+n+"]"}function f(e){return u(c(e.actual),128)+" "+e.operator+" "+u(c(e.expected),128)}function l(e,t,n,r,i){throw new k.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function h(e,t){e||l(e,!0,t,"==",k.ok)}function p(e,t,n,a){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(w.isDate(e)&&w.isDate(t))return e.getTime()===t.getTime();if(w.isRegExp(e)&&w.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(s(e)&&s(t)&&o(e)===o(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;a=a||{actual:[],expected:[]};var u=a.actual.indexOf(e);return u!==-1&&u===a.expected.indexOf(t)||(a.actual.push(e),a.expected.push(t),g(e,t,n,a))}return n?e===t:e==t}function d(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function g(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(w.isPrimitive(e)||w.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=d(e),o=d(t);if(i&&!o||!i&&o)return!1;if(i)return e=_.call(e),t=_.call(t),p(e,t,n);var s,a,u=x(e),c=x(t);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!==c[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!p(e[s],t[s],n,r))return!1;return!0}function y(e,t,n){p(e,t,!0)&&l(e,t,n,"notDeepStrictEqual",y)}function m(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(n){}return!Error.isPrototypeOf(t)&&t.call({},e)===!0}function v(e){var t;try{e()}catch(n){t=n}return t}function b(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=v(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&l(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!e&&w.isError(i),a=!e&&i&&!n;if((s&&o&&m(i,n)||a)&&l(i,n,"Got unwanted exception"+r),e&&i&&n&&!m(i,n)||!e&&i)throw i}var w=e("util/"),E=Object.prototype.hasOwnProperty,_=Array.prototype.slice,S=function(){return"foo"===function(){}.name}(),k=t.exports=h,C=/\s*function\s+([^\(\s]*)\s*/;k.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=f(this),this.generatedMessage=!0);var t=e.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=a(t),o=r.indexOf("\n"+i);if(o>=0){var s=r.indexOf("\n",o+1);r=r.substring(s+1)}this.stack=r}}},w.inherits(k.AssertionError,Error),k.fail=l,k.ok=h,k.equal=function(e,t,n){e!=t&&l(e,t,n,"==",k.equal)},k.notEqual=function(e,t,n){e==t&&l(e,t,n,"!=",k.notEqual)},k.deepEqual=function(e,t,n){p(e,t,!1)||l(e,t,n,"deepEqual",k.deepEqual)},k.deepStrictEqual=function(e,t,n){p(e,t,!0)||l(e,t,n,"deepStrictEqual",k.deepStrictEqual)},k.notDeepEqual=function(e,t,n){p(e,t,!1)&&l(e,t,n,"notDeepEqual",k.notDeepEqual)},k.notDeepStrictEqual=y,k.strictEqual=function(e,t,n){e!==t&&l(e,t,n,"===",k.strictEqual)},k.notStrictEqual=function(e,t,n){e===t&&l(e,t,n,"!==",k.notStrictEqual)},k["throws"]=function(e,t,n){b(!0,e,t,n)},k.doesNotThrow=function(e,t,n){b(!1,e,t,n)},k.ifError=function(e){if(e)throw e};var x=Object.keys||function(e){var t=[];for(var n in e)E.call(e,n)&&t.push(n);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":689}],562:[function(e,t,n){arguments[4][26][0].apply(n,arguments)},{dup:26}],563:[function(e,t,n){arguments[4][27][0].apply(n,arguments)},{crypto:564,dup:27}],564:[function(e,t,n){},{}],565:[function(e,t,n){(function(Buffer){function e(e){var t,n;return t=e>s||e<0?(n=Math.abs(e)%s,e<0?s-n:n):e}function t(e){for(var t=0;t<e.length;e++)e[t]=0;return!1}function r(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function i(e){for(var t=e.length/4,n=new Array(t),r=-1;++r<t;)n[r]=e.readUInt32BE(4*r);return n}function o(e){this._key=i(e),this._doReset()}var s=Math.pow(2,32);r.prototype.init=function(){var e,t,n,r,i,o,s,a,u,c;for(e=function(){var e,n;for(n=[],t=e=0;e<256;t=++e)t<128?n.push(t<<1):n.push(t<<1^283);return n}(),i=0,u=0,t=c=0;c<256;t=++c)n=u^u<<1^u<<2^u<<3^u<<4,n=n>>>8^255&n^99,this.SBOX[i]=n,this.INV_SBOX[n]=i,o=e[i],s=e[o],a=e[s],r=257*e[n]^16843008*n,this.SUB_MIX[0][i]=r<<24|r>>>8,this.SUB_MIX[1][i]=r<<16|r>>>16,this.SUB_MIX[2][i]=r<<8|r>>>24,this.SUB_MIX[3][i]=r,r=16843009*a^65537*s^257*o^16843008*i,this.INV_SUB_MIX[0][n]=r<<24|r>>>8,this.INV_SUB_MIX[1][n]=r<<16|r>>>16,this.INV_SUB_MIX[2][n]=r<<8|r>>>24,this.INV_SUB_MIX[3][n]=r,0===i?i=u=1:(i=o^e[e[e[a^o]]],u^=e[e[u]]);return!0};var a=new r;o.blockSize=16,o.prototype.blockSize=o.blockSize,o.keySize=32,o.prototype.keySize=o.keySize,o.prototype._doReset=function(){var e,t,n,r,i,o;for(n=this._key,t=n.length,this._nRounds=t+6,i=4*(this._nRounds+1),this._keySchedule=[],r=0;r<i;r++)this._keySchedule[r]=r<t?n[r]:(o=this._keySchedule[r-1],r%t===0?(o=o<<8|o>>>24,o=a.SBOX[o>>>24]<<24|a.SBOX[o>>>16&255]<<16|a.SBOX[o>>>8&255]<<8|a.SBOX[255&o],o^=a.RCON[r/t|0]<<24):t>6&&r%t===4?o=a.SBOX[o>>>24]<<24|a.SBOX[o>>>16&255]<<16|a.SBOX[o>>>8&255]<<8|a.SBOX[255&o]:void 0,this._keySchedule[r-t]^o);for(this._invKeySchedule=[],e=0;e<i;e++)r=i-e,o=this._keySchedule[r-(e%4?0:4)],this._invKeySchedule[e]=e<4||r<=4?o:a.INV_SUB_MIX[0][a.SBOX[o>>>24]]^a.INV_SUB_MIX[1][a.SBOX[o>>>16&255]]^a.INV_SUB_MIX[2][a.SBOX[o>>>8&255]]^a.INV_SUB_MIX[3][a.SBOX[255&o]];return!0},o.prototype.encryptBlock=function(e){e=i(new Buffer(e));var t=this._doCryptBlock(e,this._keySchedule,a.SUB_MIX,a.SBOX),n=new Buffer(16);return n.writeUInt32BE(t[0],0),n.writeUInt32BE(t[1],4),n.writeUInt32BE(t[2],8),n.writeUInt32BE(t[3],12),n},o.prototype.decryptBlock=function(e){e=i(new Buffer(e));var t=[e[3],e[1]];e[1]=t[0],e[3]=t[1];var n=this._doCryptBlock(e,this._invKeySchedule,a.INV_SUB_MIX,a.INV_SBOX),r=new Buffer(16);return r.writeUInt32BE(n[0],0),r.writeUInt32BE(n[3],4),r.writeUInt32BE(n[2],8),r.writeUInt32BE(n[1],12),r},o.prototype.scrub=function(){t(this._keySchedule),t(this._invKeySchedule),t(this._key)},o.prototype._doCryptBlock=function(t,n,r,i){var o,s,a,u,c,f,l,h,p;s=t[0]^n[0],a=t[1]^n[1],u=t[2]^n[2],c=t[3]^n[3],o=4;for(var d=1;d<this._nRounds;d++)f=r[0][s>>>24]^r[1][a>>>16&255]^r[2][u>>>8&255]^r[3][255&c]^n[o++],l=r[0][a>>>24]^r[1][u>>>16&255]^r[2][c>>>8&255]^r[3][255&s]^n[o++],h=r[0][u>>>24]^r[1][c>>>16&255]^r[2][s>>>8&255]^r[3][255&a]^n[o++],p=r[0][c>>>24]^r[1][s>>>16&255]^r[2][a>>>8&255]^r[3][255&u]^n[o++],s=f,a=l,u=h,c=p;return f=(i[s>>>24]<<24|i[a>>>16&255]<<16|i[u>>>8&255]<<8|i[255&c])^n[o++],l=(i[a>>>24]<<24|i[u>>>16&255]<<16|i[c>>>8&255]<<8|i[255&s])^n[o++],h=(i[u>>>24]<<24|i[c>>>16&255]<<16|i[s>>>8&255]<<8|i[255&a])^n[o++],p=(i[c>>>24]<<24|i[s>>>16&255]<<16|i[a>>>8&255]<<8|i[255&u])^n[o++],[e(f),e(l),e(h),e(p)]},n.AES=o}).call(this,e("buffer").Buffer)},{buffer:590}],566:[function(e,t,n){(function(Buffer){function n(e,t,r,s){if(!(this instanceof n))return new n(e,t,r);o.call(this),this._finID=Buffer.concat([r,new Buffer([0,0,0,1])]),r=Buffer.concat([r,new Buffer([0,0,0,2])]),this._cipher=new i.AES(t),this._prev=new Buffer(r.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=s,this._alen=0,this._len=0,r.copy(this._prev),this._mode=e;var u=new Buffer(4);u.fill(0),this._ghash=new a(this._cipher.encryptBlock(u)),this._authTag=null,this._called=!1}function r(e,t){var n=0;e.length!==t.length&&n++;for(var r=Math.min(e.length,t.length),i=-1;++i<r;)n+=e[i]^t[i];return n}var i=e("./aes"),o=e("cipher-base"),s=e("inherits"),a=e("./ghash"),u=e("buffer-xor");s(n,o),t.exports=n,n.prototype._update=function(e){if(!this._called&&this._alen){
var t=16-this._alen%16;t<16&&(t=new Buffer(t),t.fill(0),this._ghash.update(t))}this._called=!0;var n=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(n),this._len+=e.length,n},n.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=u(this._ghash["final"](8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(r(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=e;this._cipher.scrub()},n.prototype.getAuthTag=function(){if(!this._decrypt&&Buffer.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},n.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},n.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length}}).call(this,e("buffer").Buffer)},{"./aes":565,"./ghash":570,buffer:590,"buffer-xor":593,"cipher-base":594,inherits:640}],567:[function(e,t,n){arguments[4][30][0].apply(n,arguments)},{"./decrypter":568,"./encrypter":569,"./modes":571,dup:30}],568:[function(e,t,n){(function(Buffer){function t(e,n,i){return this instanceof t?(u.call(this),this._cache=new r,this._last=void 0,this._cipher=new a.AES(n),this._prev=new Buffer(i.length),i.copy(this._prev),this._mode=e,void(this._autopadding=!0)):new t(e,n,i)}function r(){return this instanceof r?void(this.cache=new Buffer("")):new r}function i(e){for(var t=e[15],n=-1;++n<t;)if(e[n+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}function o(e,n,r){var i=f[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=new Buffer(r)),"string"==typeof n&&(n=new Buffer(n)),n.length!==i.key/8)throw new TypeError("invalid key length "+n.length);if(r.length!==i.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===i.type?new l(d[i.mode],n,r,(!0)):"auth"===i.type?new h(d[i.mode],n,r,(!0)):new t(d[i.mode],n,r)}function s(e,t){var n=f[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=p(t,!1,n.key,n.iv);return o(e,r.key,r.iv)}var a=e("./aes"),u=e("cipher-base"),c=e("inherits"),f=e("./modes"),l=e("./streamCipher"),h=e("./authCipher"),p=e("evp_bytestokey");c(t,u),t.prototype._update=function(e){this._cache.add(e);for(var t,n,r=[];t=this._cache.get(this._autopadding);)n=this._mode.decrypt(this,t),r.push(n);return Buffer.concat(r)},t.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return i(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},t.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},r.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},r.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},r.prototype.flush=function(){if(this.cache.length)return this.cache};var d={ECB:e("./modes/ecb"),CBC:e("./modes/cbc"),CFB:e("./modes/cfb"),CFB8:e("./modes/cfb8"),CFB1:e("./modes/cfb1"),OFB:e("./modes/ofb"),CTR:e("./modes/ctr"),GCM:e("./modes/ctr")};n.createDecipher=s,n.createDecipheriv=o}).call(this,e("buffer").Buffer)},{"./aes":565,"./authCipher":566,"./modes":571,"./modes/cbc":572,"./modes/cfb":573,"./modes/cfb1":574,"./modes/cfb8":575,"./modes/ctr":576,"./modes/ecb":577,"./modes/ofb":578,"./streamCipher":579,buffer:590,"cipher-base":594,evp_bytestokey:631,inherits:640}],569:[function(e,t,n){(function(Buffer){function t(e,n,i){return this instanceof t?(a.call(this),this._cache=new r,this._cipher=new s.AES(n),this._prev=new Buffer(i.length),i.copy(this._prev),this._mode=e,void(this._autopadding=!0)):new t(e,n,i)}function r(){return this instanceof r?void(this.cache=new Buffer("")):new r}function i(e,n,r){var i=c[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=new Buffer(r)),"string"==typeof n&&(n=new Buffer(n)),n.length!==i.key/8)throw new TypeError("invalid key length "+n.length);if(r.length!==i.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===i.type?new l(p[i.mode],n,r):"auth"===i.type?new h(p[i.mode],n,r):new t(p[i.mode],n,r)}function o(e,t){var n=c[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=f(t,!1,n.key,n.iv);return i(e,r.key,r.iv)}var s=e("./aes"),a=e("cipher-base"),u=e("inherits"),c=e("./modes"),f=e("evp_bytestokey"),l=e("./streamCipher"),h=e("./authCipher");u(t,a),t.prototype._update=function(e){this._cache.add(e);for(var t,n,r=[];t=this._cache.get();)n=this._mode.encrypt(this,t),r.push(n);return Buffer.concat(r)},t.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if("10101010101010101010101010101010"!==e.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},t.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},r.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},r.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},r.prototype.flush=function(){for(var e=16-this.cache.length,t=new Buffer(e),n=-1;++n<e;)t.writeUInt8(e,n);var r=Buffer.concat([this.cache,t]);return r};var p={ECB:e("./modes/ecb"),CBC:e("./modes/cbc"),CFB:e("./modes/cfb"),CFB8:e("./modes/cfb8"),CFB1:e("./modes/cfb1"),OFB:e("./modes/ofb"),CTR:e("./modes/ctr"),GCM:e("./modes/ctr")};n.createCipheriv=i,n.createCipher=o}).call(this,e("buffer").Buffer)},{"./aes":565,"./authCipher":566,"./modes":571,"./modes/cbc":572,"./modes/cfb":573,"./modes/cfb1":574,"./modes/cfb8":575,"./modes/ctr":576,"./modes/ecb":577,"./modes/ofb":578,"./streamCipher":579,buffer:590,"cipher-base":594,evp_bytestokey:631,inherits:640}],570:[function(e,t,n){(function(Buffer){function e(e){this.h=e,this.state=new Buffer(16),this.state.fill(0),this.cache=new Buffer("")}function n(e){return[e.readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)]}function r(e){e=e.map(i);var t=new Buffer(16);return t.writeUInt32BE(e[0],0),t.writeUInt32BE(e[1],4),t.writeUInt32BE(e[2],8),t.writeUInt32BE(e[3],12),t}function i(e){var t,n;return t=e>a||e<0?(n=Math.abs(e)%a,e<0?a-n:n):e}function o(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}var s=new Buffer(16);s.fill(0),t.exports=e,e.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},e.prototype._multiply=function(){for(var e,t,i,s=n(this.h),a=[0,0,0,0],u=-1;++u<128;){for(t=0!==(this.state[~~(u/8)]&1<<7-u%8),t&&(a=o(a,s)),i=0!==(1&s[3]),e=3;e>0;e--)s[e]=s[e]>>>1|(1&s[e-1])<<31;s[0]=s[0]>>>1,i&&(s[0]=s[0]^225<<24)}this.state=r(a)},e.prototype.update=function(e){this.cache=Buffer.concat([this.cache,e]);for(var t;this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},e.prototype["final"]=function(e,t){return this.cache.length&&this.ghash(Buffer.concat([this.cache,s],16)),this.ghash(r([0,e,0,t])),this.state};var a=Math.pow(2,32)}).call(this,e("buffer").Buffer)},{buffer:590}],571:[function(e,t,n){arguments[4][34][0].apply(n,arguments)},{dup:34}],572:[function(e,t,n){arguments[4][35][0].apply(n,arguments)},{"buffer-xor":593,dup:35}],573:[function(e,t,n){(function(Buffer){function t(e,t,n){var i=t.length,o=r(t,e._cache);return e._cache=e._cache.slice(i),e._prev=Buffer.concat([e._prev,n?t:o]),o}var r=e("buffer-xor");n.encrypt=function(e,n,r){for(var i,o=new Buffer("");n.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=new Buffer("")),!(e._cache.length<=n.length)){o=Buffer.concat([o,t(e,n,r)]);break}i=e._cache.length,o=Buffer.concat([o,t(e,n.slice(0,i),r)]),n=n.slice(i)}return o}}).call(this,e("buffer").Buffer)},{buffer:590,"buffer-xor":593}],574:[function(e,t,n){(function(Buffer){function e(e,n,r){for(var i,o,s,a=-1,u=8,c=0;++a<u;)i=e._cipher.encryptBlock(e._prev),o=n&1<<7-a?128:0,s=i[0]^o,c+=(128&s)>>a%8,e._prev=t(e._prev,r?o:s);return c}function t(e,t){var n=e.length,r=-1,i=new Buffer(e.length);for(e=Buffer.concat([e,new Buffer([t])]);++r<n;)i[r]=e[r]<<1|e[r+1]>>7;return i}n.encrypt=function(t,n,r){for(var i=n.length,o=new Buffer(i),s=-1;++s<i;)o[s]=e(t,n[s],r);return o}}).call(this,e("buffer").Buffer)},{buffer:590}],575:[function(e,t,n){(function(Buffer){function e(e,t,n){var r=e._cipher.encryptBlock(e._prev),i=r[0]^t;return e._prev=Buffer.concat([e._prev.slice(1),new Buffer([n?t:i])]),i}n.encrypt=function(t,n,r){for(var i=n.length,o=new Buffer(i),s=-1;++s<i;)o[s]=e(t,n[s],r);return o}}).call(this,e("buffer").Buffer)},{buffer:590}],576:[function(e,t,n){(function(Buffer){function t(e){for(var t,n=e.length;n--;){if(t=e.readUInt8(n),255!==t){t++,e.writeUInt8(t,n);break}e.writeUInt8(0,n)}}function r(e){var n=e._cipher.encryptBlock(e._prev);return t(e._prev),n}var i=e("buffer-xor");n.encrypt=function(e,t){for(;e._cache.length<t.length;)e._cache=Buffer.concat([e._cache,r(e)]);var n=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,n)}}).call(this,e("buffer").Buffer)},{buffer:590,"buffer-xor":593}],577:[function(e,t,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],578:[function(e,t,n){(function(Buffer){function t(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}var r=e("buffer-xor");n.encrypt=function(e,n){for(;e._cache.length<n.length;)e._cache=Buffer.concat([e._cache,t(e)]);var i=e._cache.slice(0,n.length);return e._cache=e._cache.slice(n.length),r(n,i)}}).call(this,e("buffer").Buffer)},{buffer:590,"buffer-xor":593}],579:[function(e,t,n){(function(Buffer){function n(e,t,o,s){return this instanceof n?(i.call(this),this._cipher=new r.AES(t),this._prev=new Buffer(o.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=s,o.copy(this._prev),void(this._mode=e)):new n(e,t,o)}var r=e("./aes"),i=e("cipher-base"),o=e("inherits");o(n,i),t.exports=n,n.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},n.prototype._final=function(){this._cipher.scrub()}}).call(this,e("buffer").Buffer)},{"./aes":565,buffer:590,"cipher-base":594,inherits:640}],580:[function(e,t,n){function r(e,t){var n,r;if(e=e.toLowerCase(),h[e])n=h[e].key,r=h[e].iv;else{if(!l[e])throw new TypeError("invalid suite type");n=8*l[e].key,r=l[e].iv}var i=u(t,!1,n,r);return o(e,i.key,i.iv)}function i(e,t){var n,r;if(e=e.toLowerCase(),h[e])n=h[e].key,r=h[e].iv;else{if(!l[e])throw new TypeError("invalid suite type");n=8*l[e].key,r=l[e].iv}var i=u(t,!1,n,r);return s(e,i.key,i.iv)}function o(e,t,n){if(e=e.toLowerCase(),h[e])return c.createCipheriv(e,t,n);if(l[e])return new f({key:t,iv:n,mode:e});throw new TypeError("invalid suite type")}function s(e,t,n){if(e=e.toLowerCase(),h[e])return c.createDecipheriv(e,t,n);if(l[e])return new f({key:t,iv:n,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}function a(){return Object.keys(l).concat(c.getCiphers())}var u=e("evp_bytestokey"),c=e("browserify-aes/browser"),f=e("browserify-des"),l=e("browserify-des/modes"),h=e("browserify-aes/modes");n.createCipher=n.Cipher=r,n.createCipheriv=n.Cipheriv=o,n.createDecipher=n.Decipher=i,n.createDecipheriv=n.Decipheriv=s,n.listCiphers=n.getCiphers=a},{"browserify-aes/browser":567,"browserify-aes/modes":571,"browserify-des":581,"browserify-des/modes":582,evp_bytestokey:631}],581:[function(e,t,n){(function(Buffer){function n(e){r.call(this);var t,n=e.mode.toLowerCase(),i=s[n];t=e.decrypt?"decrypt":"encrypt";var o=e.key;"des-ede"!==n&&"des-ede-cbc"!==n||(o=Buffer.concat([o,o.slice(0,8)]));var a=e.iv;this._des=i.create({key:o,iv:a,type:t})}var r=e("cipher-base"),i=e("des.js"),o=e("inherits"),s={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};s.des=s["des-cbc"],s.des3=s["des-ede3-cbc"],t.exports=n,o(n,r),n.prototype._update=function(e){return new Buffer(this._des.update(e))},n.prototype._final=function(){return new Buffer(this._des["final"]())}}).call(this,e("buffer").Buffer)},{buffer:590,"cipher-base":594,"des.js":603,inherits:640}],582:[function(e,t,n){n["des-ecb"]={key:8,iv:0},n["des-cbc"]=n.des={key:8,iv:8},n["des-ede3-cbc"]=n.des3={key:24,iv:8},n["des-ede3"]={key:24,iv:0},n["des-ede-cbc"]={key:16,iv:8},n["des-ede"]={key:16,iv:0}},{}],583:[function(e,t,n){(function(Buffer){function n(e){var t=i(e),n=t.toRed(o.mont(e.modulus)).redPow(new o(e.publicExponent)).fromRed();return{blinder:n,unblinder:t.invm(e.modulus)}}function r(e,t){var r=n(t),i=t.modulus.byteLength(),s=(o.mont(t.modulus),new o(e).mul(r.blinder).umod(t.modulus)),a=s.toRed(o.mont(t.prime1)),u=s.toRed(o.mont(t.prime2)),c=t.coefficient,f=t.prime1,l=t.prime2,h=a.redPow(t.exponent1),p=u.redPow(t.exponent2);h=h.fromRed(),p=p.fromRed();var d=h.isub(p).imul(c).umod(f);return d.imul(l),p.iadd(d),new Buffer(p.imul(r.unblinder).umod(t.modulus).toArray(!1,i))}function i(e){for(var t=e.modulus.byteLength(),n=new o(s(t));n.cmp(e.modulus)>=0||!n.umod(e.prime1)||!n.umod(e.prime2);)n=new o(s(t));return n}var o=e("bn.js"),s=e("randombytes");t.exports=r,r.getr=i}).call(this,e("buffer").Buffer)},{"bn.js":562,buffer:590,randombytes:658}],584:[function(e,t,n){(function(Buffer){"use strict";n["RSA-SHA224"]=n.sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:new Buffer("302d300d06096086480165030402040500041c","hex")},n["RSA-SHA256"]=n.sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:new Buffer("3031300d060960864801650304020105000420","hex")},n["RSA-SHA384"]=n.sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:new Buffer("3041300d060960864801650304020205000430","hex")},n["RSA-SHA512"]=n.sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:new Buffer("3051300d060960864801650304020305000440","hex")},n["RSA-SHA1"]={sign:"rsa",hash:"sha1",id:new Buffer("3021300906052b0e03021a05000414","hex")},n["ecdsa-with-SHA1"]={sign:"ecdsa",hash:"sha1",id:new Buffer("","hex")},n.DSA=n["DSA-SHA1"]=n["DSA-SHA"]={sign:"dsa",hash:"sha1",id:new Buffer("","hex")},n["DSA-SHA224"]=n["DSA-WITH-SHA224"]={sign:"dsa",hash:"sha224",id:new Buffer("","hex")},n["DSA-SHA256"]=n["DSA-WITH-SHA256"]={sign:"dsa",hash:"sha256",id:new Buffer("","hex")},n["DSA-SHA384"]=n["DSA-WITH-SHA384"]={sign:"dsa",hash:"sha384",id:new Buffer("","hex")},n["DSA-SHA512"]=n["DSA-WITH-SHA512"]={sign:"dsa",hash:"sha512",id:new Buffer("","hex")},n["DSA-RIPEMD160"]={sign:"dsa",hash:"rmd160",id:new Buffer("","hex")},n["RSA-RIPEMD160"]=n.ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:new Buffer("3021300906052b2403020105000414","hex")},n["RSA-MD5"]=n.md5WithRSAEncryption={sign:"rsa",hash:"md5",id:new Buffer("3020300c06082a864886f70d020505000410","hex")}}).call(this,e("buffer").Buffer)},{buffer:590}],585:[function(e,t,n){(function(Buffer){function n(e){f.Writable.call(this);var t=h[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=a(t.hash),this._tag=t.id,this._signType=t.sign}function r(e){f.Writable.call(this);var t=h[e];if(!t)throw new Error("Unknown message digest");this._hash=a(t.hash),this._tag=t.id,this._signType=t.sign}function i(e){return new n(e)}function o(e){return new r(e)}var s=e("./algos"),a=e("create-hash"),u=e("inherits"),c=e("./sign"),f=e("stream"),l=e("./verify"),h={};Object.keys(s).forEach(function(e){h[e]=h[e.toLowerCase()]=s[e]}),u(n,f.Writable),n.prototype._write=function(e,t,n){this._hash.update(e),n()},n.prototype.update=function(e,t){return"string"==typeof e&&(e=new Buffer(e,t)),this._hash.update(e),this},n.prototype.sign=function(e,t){this.end();var n=this._hash.digest(),r=c(Buffer.concat([this._tag,n]),e,this._hashType,this._signType);return t?r.toString(t):r},u(r,f.Writable),r.prototype._write=function(e,t,n){this._hash.update(e),n()},r.prototype.update=function(e,t){return"string"==typeof e&&(e=new Buffer(e,t)),this._hash.update(e),this},r.prototype.verify=function(e,t,n){"string"==typeof t&&(t=new Buffer(t,n)),this.end();var r=this._hash.digest();return l(t,Buffer.concat([this._tag,r]),e,this._signType)},t.exports={Sign:i,Verify:o,createSign:i,createVerify:o}}).call(this,e("buffer").Buffer)},{"./algos":584,"./sign":587,"./verify":588,buffer:590,"create-hash":598,inherits:640,stream:669}],586:[function(e,t,n){"use strict";n["1.3.132.0.10"]="secp256k1",n["1.3.132.0.33"]="p224",n["1.2.840.10045.3.1.1"]="p192",n["1.2.840.10045.3.1.7"]="p256",n["1.3.132.0.34"]="p384",n["1.3.132.0.35"]="p521"},{}],587:[function(e,t,n){(function(Buffer){function n(e,t,n,o){var s=g(t);if(s.curve){if("ecdsa"!==o)throw new Error("wrong private key type");return r(e,s)}if("dsa"===s.type){if("dsa"!==o)throw new Error("wrong private key type");return i(e,s,n)}if("rsa"!==o)throw new Error("wrong private key type");for(var a=s.modulus.byteLength(),u=[0,1];e.length+u.length+1<a;)u.push(255);u.push(0);for(var c=-1;++c<e.length;)u.push(e[c]);var f=h(u,s);return f}function r(e,t){var n=p[t.curve.join(".")];if(!n)throw new Error("unknown curve "+t.curve.join("."));var r=new y(n),i=r.genKeyPair();i._importPrivate(t.privateKey);var o=i.sign(e);return new Buffer(o.toDER())}function i(e,t,n){for(var r,i=t.params.priv_key,u=t.params.p,l=t.params.q,h=t.params.g,p=new BN(0),d=a(e,l).mod(l),g=!1,y=s(i,l,e,n);g===!1;)r=c(l,y,n),p=f(h,r,u,l),g=r.invm(l).imul(d.add(i.mul(p))).mod(l),g.cmpn(0)||(g=!1,p=new BN(0));return o(p,g)}function o(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e)),128&t[0]&&(t=[0].concat(t));var n=e.length+t.length+4,r=[48,n,2,e.length];return r=r.concat(e,[2,t.length],t),new Buffer(r)}function s(e,t,n,r){if(e=new Buffer(e.toArray()),e.length<t.byteLength()){var i=new Buffer(t.byteLength()-e.length);i.fill(0),e=Buffer.concat([i,e])}var o=n.length,s=u(n,t),a=new Buffer(o);a.fill(1);var c=new Buffer(o);return c.fill(0),c=l(r,c).update(a).update(new Buffer([0])).update(e).update(s).digest(),a=l(r,c).update(a).digest(),c=l(r,c).update(a).update(new Buffer([1])).update(e).update(s).digest(),a=l(r,c).update(a).digest(),{k:c,v:a}}function a(e,t){var n=new BN(e),r=(e.length<<3)-t.bitLength();return r>0&&n.ishrn(r),n}function u(e,t){e=a(e,t),e=e.mod(t);var n=new Buffer(e.toArray());if(n.length<t.byteLength()){var r=new Buffer(t.byteLength()-n.length);r.fill(0),n=Buffer.concat([r,n])}return n}function c(e,t,n){var r,i;do{for(r=new Buffer("");8*r.length<e.bitLength();)t.v=l(n,t.k).update(t.v).digest(),r=Buffer.concat([r,t.v]);i=a(r,e),t.k=l(n,t.k).update(t.v).update(new Buffer([0])).digest(),t.v=l(n,t.k).update(t.v).digest()}while(i.cmp(e)!==-1);return i}function f(e,t,n,r){return e.toRed(BN.mont(n)).redPow(t).fromRed().mod(r)}var l=e("create-hmac"),h=e("browserify-rsa"),p=e("./curves"),d=e("elliptic"),g=e("parse-asn1"),BN=e("bn.js"),y=d.ec;t.exports=n,t.exports.getKey=s,t.exports.makeKey=c}).call(this,e("buffer").Buffer)},{"./curves":586,"bn.js":562,"browserify-rsa":583,buffer:590,"create-hmac":601,elliptic:613,"parse-asn1":647}],588:[function(e,t,n){(function(Buffer){function n(e,t,n,o){var s=u(n);if("ec"===s.type){if("ecdsa"!==o)throw new Error("wrong public key type");return r(e,t,s)}if("dsa"===s.type){if("dsa"!==o)throw new Error("wrong public key type");return i(e,t,s)}if("rsa"!==o)throw new Error("wrong public key type");for(var a=s.modulus.byteLength(),c=[1],f=0;t.length+c.length+2<a;)c.push(255),f++;c.push(0);for(var l=-1;++l<t.length;)c.push(t[l]);c=new Buffer(c);var h=BN.mont(s.modulus);e=new BN(e).toRed(h),e=e.redPow(new BN(s.publicExponent)),e=new Buffer(e.fromRed().toArray());var p=0;for(f<8&&(p=1),a=Math.min(e.length,c.length),e.length!==c.length&&(p=1),l=-1;++l<a;)p|=e[l]^c[l];return 0===p}function r(e,t,n){var r=s[n.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var i=new c(r),o=n.data.subjectPrivateKey.data;return i.verify(t,e,o)}function i(e,t,n){var r=n.data.p,i=n.data.q,s=n.data.g,a=n.data.pub_key,c=u.signature.decode(e,"der"),f=c.s,l=c.r;o(f,i),o(l,i);var h=BN.mont(r),p=f.invm(i),d=s.toRed(h).redPow(new BN(t).mul(p).mod(i)).fromRed().mul(a.toRed(h).redPow(l.mul(p).mod(i)).fromRed()).mod(r).mod(i);return!d.cmp(l)}function o(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}var s=e("./curves"),a=e("elliptic"),u=e("parse-asn1"),BN=e("bn.js"),c=a.ec;t.exports=n}).call(this,e("buffer").Buffer)},{"./curves":586,"bn.js":562,buffer:590,elliptic:613,"parse-asn1":647}],589:[function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function i(e){return 3*e.length/4-r(e)}function o(e){var t,n,i,o,s,a=e.length;o=r(e),s=new l(3*a/4-o),n=o>0?a-4:a;var u=0;for(t=0;t<n;t+=4)i=f[e.charCodeAt(t)]<<18|f[e.charCodeAt(t+1)]<<12|f[e.charCodeAt(t+2)]<<6|f[e.charCodeAt(t+3)],s[u++]=i>>16&255,s[u++]=i>>8&255,s[u++]=255&i;return 2===o?(i=f[e.charCodeAt(t)]<<2|f[e.charCodeAt(t+1)]>>4,s[u++]=255&i):1===o&&(i=f[e.charCodeAt(t)]<<10|f[e.charCodeAt(t+1)]<<4|f[e.charCodeAt(t+2)]>>2,s[u++]=i>>8&255,s[u++]=255&i),s}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(s(r));return i.join("")}function u(e){for(var t,n=e.length,r=n%3,i="",o=[],s=16383,u=0,f=n-r;u<f;u+=s)o.push(a(e,u,u+s>f?f:u+s));return 1===r?(t=e[n-1],i+=c[t>>2],i+=c[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=c[t>>10],i+=c[t>>4&63],i+=c[t<<2&63],i+="="),o.push(i),o.join("")}n.byteLength=i,n.toByteArray=o,n.fromByteArray=u;for(var c=[],f=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=h.length;p<d;++p)c[p]=h[p],f[h.charCodeAt(p)]=p;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},{}],590:[function(e,t,n){(function(t){"use strict";function r(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function i(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=Buffer.prototype):(null===e&&(e=new Buffer(t)),e.length=t),e}function Buffer(e,t,n){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,n,r):"string"==typeof t?f(e,t,n):p(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return a(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function c(e,t){if(a(t),e=o(e,t<0?0:0|d(t)),!Buffer.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!Buffer.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|y(t,n);e=o(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function l(e,t){var n=t.length<0?0:0|d(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),Buffer.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=Buffer.prototype):e=l(e,t),e}function p(e,t){if(Buffer.isBuffer(t)){var n=0|d(t.length);return e=o(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?o(e,0):l(e,t);if("Buffer"===t.type&&Q(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function y(e,t){if(Buffer.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return q(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return M(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=Buffer.from(t,r)),Buffer.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"==typeof t)return t=255&t,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}var c;if(i){var f=-1;for(c=n;c<a;c++)if(o(e,c)===o(t,f===-1?0:c-f)){if(f===-1&&(f=c),c-f+1===u)return f*s}else f!==-1&&(c-=c-f),f=-1}else for(n+u>a&&(n=a-u),c=n;c>=0;c--){for(var l=!0,h=0;h<u;h++)if(o(e,c+h)!==o(t,h)){l=!1;break}if(l)return c}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function _(e,t,n,r){return Y(q(t,e.length-n),e,n,r)}function S(e,t,n,r){return Y(V(t),e,n,r)}function k(e,t,n,r){return S(e,t,n,r)}function C(e,t,n,r){return Y(G(t),e,n,r)}function x(e,t,n,r){return Y(W(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function A(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=n){var u,c,f,l;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[i+1],128===(192&u)&&(l=(31&o)<<6|63&u,l>127&&(s=l));break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(l=(15&o)<<12|(63&u)<<6|63&c,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:u=e[i+1],c=e[i+2],f=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&f)&&(l=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&f,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=a}return P(r)}function P(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Z));return n}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=H(e[o]);return i}function O(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function B(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,o){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function F(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,i){return i||F(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,i){return i||F(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,n,r,52,8),n+8}function z(e){if(e=K(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function K(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function W(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function G(e){return $.toByteArray(z(e))}function Y(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function X(e){return e!==e}var $=e("base64-js"),J=e("ieee754"),Q=e("isarray");n.Buffer=Buffer,n.SlowBuffer=g,n.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),n.kMaxLength=i(),Buffer.poolSize=8192,Buffer._augment=function(e){return e.__proto__=Buffer.prototype,e},Buffer.from=function(e,t,n){return s(null,e,t,n)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(e,t,n){return u(null,e,t,n)},Buffer.allocUnsafe=function(e){return c(null,e)},Buffer.allocUnsafeSlow=function(e){return c(null,e)},Buffer.isBuffer=function(e){return!(null==e||!e._isBuffer)},Buffer.compare=function(e,t){if(!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");
if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=Buffer.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!Buffer.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},Buffer.byteLength=y,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},Buffer.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?A(this,0,e):m.apply(this,arguments)},Buffer.prototype.equals=function(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},Buffer.prototype.compare=function(e,t,n,r,i){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,a=Math.min(o,s),u=this.slice(r,i),c=e.slice(t,n),f=0;f<a;++f)if(u[f]!==c[f]){o=u[f],s=c[f];break}return o<s?-1:s<o?1:0},Buffer.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},Buffer.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},Buffer.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},Buffer.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return S(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;Buffer.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);var r;if(Buffer.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=Buffer.prototype;else{var i=t-e;r=new Buffer(i,(void 0));for(var o=0;o<i;++o)r[o]=this[o+e]}return r},Buffer.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||B(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},Buffer.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||B(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},Buffer.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||B(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},Buffer.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||B(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},Buffer.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},Buffer.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Buffer.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Buffer.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),J.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),J.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),J.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),J.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var i=Math.pow(2,8*n)-1;D(this,e,t,n,i,0)}var o=1,s=0;for(this[t]=255&e;++s<n&&(o*=256);)this[t+s]=e/o&255;return t+n},Buffer.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var i=Math.pow(2,8*n)-1;D(this,e,t,n,i,0)}var o=n-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+n},Buffer.prototype.writeUInt8=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Buffer.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},Buffer.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},Buffer.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},Buffer.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},Buffer.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},Buffer.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},Buffer.prototype.writeInt8=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer.prototype.writeInt16LE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},Buffer.prototype.writeInt16BE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},Buffer.prototype.writeInt32LE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},Buffer.prototype.writeInt32BE=function(e,t,n){return e=+e,t=0|t,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},Buffer.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},Buffer.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},Buffer.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},Buffer.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},Buffer.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},Buffer.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Buffer.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e=255&e);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=Buffer.isBuffer(e)?e:q(new Buffer(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":589,ieee754:638,isarray:591}],591:[function(e,t,n){arguments[4][20][0].apply(n,arguments)},{dup:20}],592:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){y&&d&&(y=!1,d.length?g=d.concat(g):m=-1,g.length&&u())}function u(){if(!y){var e=o(a);y=!0;for(var t=g.length;t;){for(d=g,g=[];++m<t;)d&&d[m].run();m=-1,t=g.length}d=null,y=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function f(){}var l,h,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,g=[],y=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new c(e,t)),1!==g.length||y||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=f,p.addListener=f,p.once=f,p.off=f,p.removeListener=f,p.removeAllListeners=f,p.emit=f,p.prependListener=f,p.prependOnceListener=f,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],593:[function(e,t,n){(function(Buffer){t.exports=function(e,t){for(var n=Math.min(e.length,t.length),r=new Buffer(n),i=0;i<n;++i)r[i]=e[i]^t[i];return r}}).call(this,e("buffer").Buffer)},{buffer:590}],594:[function(e,t,n){(function(Buffer){function n(e){r.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this["final"]=this._finalOrDigest,this._decoder=null,this._encoding=null}var r=e("stream").Transform,i=e("inherits"),o=e("string_decoder").StringDecoder;t.exports=n,i(n,r),n.prototype.update=function(e,t,n){"string"==typeof e&&(e=new Buffer(e,t));var r=this._update(e);return this.hashMode?this:(n&&(r=this._toString(r,n)),r)},n.prototype.setAutoPadding=function(){},n.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},n.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},n.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},n.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(i){r=i}finally{n(r)}},n.prototype._flush=function(e){var t;try{this.push(this._final())}catch(n){t=n}finally{e(t)}},n.prototype._finalOrDigest=function(e){var t=this._final()||new Buffer("");return e&&(t=this._toString(t,e,!0)),t},n.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new o(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r}}).call(this,e("buffer").Buffer)},{buffer:590,inherits:640,stream:669,string_decoder:685}],595:[function(e,t,n){t.exports={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGSYS:12,SSL_OP_ALL:2147486719,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:32,SSL_OP_MICROSOFT_SESS_ID_BUG:1,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:536870912,SSL_OP_NETSCAPE_CHALLENGE_BUG:2,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:1073741824,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:8,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:16777216,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_SINGLE_DH_USE:1048576,SSL_OP_SINGLE_ECDH_USE:524288,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:128,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:512,SSL_OP_TLS_D5_BUG:256,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_ECDH:16,ENGINE_METHOD_ECDSA:32,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_STORE:256,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_UDP_REUSEADDR:4}},{}],596:[function(e,t,n){(function(Buffer){function e(e){return Array.isArray?Array.isArray(e):"[object Array]"===g(e)}function t(e){return"boolean"==typeof e}function r(e){return null===e}function i(e){return null==e}function o(e){return"number"==typeof e}function s(e){return"string"==typeof e}function a(e){return"symbol"==typeof e}function u(e){return void 0===e}function c(e){return"[object RegExp]"===g(e)}function f(e){return"object"==typeof e&&null!==e}function l(e){return"[object Date]"===g(e)}function h(e){return"[object Error]"===g(e)||e instanceof Error}function p(e){return"function"==typeof e}function d(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function g(e){return Object.prototype.toString.call(e)}n.isArray=e,n.isBoolean=t,n.isNull=r,n.isNullOrUndefined=i,n.isNumber=o,n.isString=s,n.isSymbol=a,n.isUndefined=u,n.isRegExp=c,n.isObject=f,n.isDate=l,n.isError=h,n.isFunction=p,n.isPrimitive=d,n.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":641}],597:[function(e,t,n){(function(Buffer){function n(e){this.curveType=o[e],this.curveType||(this.curveType={name:e}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function r(e,t,n){Array.isArray(e)||(e=e.toArray());var r=new Buffer(e);if(n&&r.length<n){var i=new Buffer(n-r.length);i.fill(0),r=Buffer.concat([i,r])}return t?r.toString(t):r}var i=e("elliptic"),BN=e("bn.js");t.exports=function(e){return new n(e)};var o={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};o.p224=o.secp224r1,o.p256=o.secp256r1=o.prime256v1,o.p192=o.secp192r1=o.prime192v1,o.p384=o.secp384r1,o.p521=o.secp521r1,n.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},n.prototype.computeSecret=function(e,t,n){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var i=this.curve.keyFromPublic(e).getPublic(),o=i.mul(this.keys.getPrivate()).getX();return r(o,n,this.curveType.byteLength)},n.prototype.getPublicKey=function(e,t){var n=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(n[n.length-1]%2?n[0]=7:n[0]=6),r(n,e)},n.prototype.getPrivateKey=function(e){return r(this.keys.getPrivate(),e)},n.prototype.setPublicKey=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.keys._importPublic(e),this},n.prototype.setPrivateKey=function(e,t){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var n=new BN(e);return n=n.toString(16),this.keys._importPrivate(n),this}}).call(this,e("buffer").Buffer)},{"bn.js":562,buffer:590,elliptic:613}],598:[function(e,t,n){(function(Buffer){"use strict";function n(e){u.call(this,"digest"),this._hash=e,this.buffers=[]}function r(e){u.call(this,"digest"),this._hash=e}var i=e("inherits"),o=e("./md5"),s=e("ripemd160"),a=e("sha.js"),u=e("cipher-base");i(n,u),n.prototype._update=function(e){this.buffers.push(e)},n.prototype._final=function(){var e=Buffer.concat(this.buffers),t=this._hash(e);return this.buffers=null,t},i(r,u),r.prototype._update=function(e){this._hash.update(e)},r.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return e=e.toLowerCase(),"md5"===e?new n(o):"rmd160"===e||"ripemd160"===e?new n(s):new r(a(e))}}).call(this,e("buffer").Buffer)},{"./md5":600,buffer:590,"cipher-base":594,inherits:640,ripemd160:659,"sha.js":662}],599:[function(e,t,n){(function(Buffer){"use strict";function e(e,t){if(e.length%i!==0){var n=e.length+(i-e.length%i);e=Buffer.concat([e,o],n)}for(var r=[],s=t?e.readInt32BE:e.readInt32LE,a=0;a<e.length;a+=i)r.push(s.call(e,a));return r}function t(e,t,n){for(var r=new Buffer(t),i=n?r.writeInt32BE:r.writeInt32LE,o=0;o<e.length;o++)i.call(r,e[o],4*o,!0);return r}function r(n,r,i,o){Buffer.isBuffer(n)||(n=new Buffer(n));var a=r(e(n,o),n.length*s);return t(a,i,o)}var i=4,o=new Buffer(i);o.fill(0);var s=8;n.hash=r}).call(this,e("buffer").Buffer)},{buffer:590}],600:[function(e,t,n){arguments[4][53][0].apply(n,arguments)},{"./helpers":599,dup:53}],601:[function(e,t,n){(function(Buffer){"use strict";function n(e,t){o.call(this),"string"==typeof t&&(t=new Buffer(t));var n="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=t,t.length>n?t=r(e).update(t).digest():t.length<n&&(t=Buffer.concat([t,s],n));for(var i=this._ipad=new Buffer(n),a=this._opad=new Buffer(n),u=0;u<n;u++)i[u]=54^t[u],a[u]=92^t[u];this._hash=r(e).update(i)}var r=e("create-hash/browser"),i=e("inherits"),o=e("stream").Transform,s=new Buffer(128);s.fill(0),i(n,o),n.prototype.update=function(e,t){return this._hash.update(e,t),this},n.prototype._transform=function(e,t,n){this._hash.update(e),n()},n.prototype._flush=function(e){this.push(this.digest()),e()},n.prototype.digest=function(e){var t=this._hash.digest();return r(this._alg).update(this._opad).update(t).digest(e)},t.exports=function(e,t){return new n(e,t)}}).call(this,e("buffer").Buffer)},{buffer:590,"create-hash/browser":598,inherits:640,stream:669}],602:[function(e,t,n){"use strict";n.randomBytes=n.rng=n.pseudoRandomBytes=n.prng=e("randombytes"),n.createHash=n.Hash=e("create-hash"),n.createHmac=n.Hmac=e("create-hmac");var r=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(e("browserify-sign/algos")));n.getHashes=function(){return r};var i=e("pbkdf2");n.pbkdf2=i.pbkdf2,n.pbkdf2Sync=i.pbkdf2Sync;var o=e("browserify-cipher");["Cipher","createCipher","Cipheriv","createCipheriv","Decipher","createDecipher","Decipheriv","createDecipheriv","getCiphers","listCiphers"].forEach(function(e){n[e]=o[e]});var s=e("diffie-hellman");["DiffieHellmanGroup","createDiffieHellmanGroup","getDiffieHellman","createDiffieHellman","DiffieHellman"].forEach(function(e){n[e]=s[e]});var a=e("browserify-sign");["createSign","Sign","createVerify","Verify"].forEach(function(e){n[e]=a[e]}),n.createECDH=e("create-ecdh");var u=e("public-encrypt");["publicEncrypt","privateEncrypt","publicDecrypt","privateDecrypt"].forEach(function(e){n[e]=u[e]}),["createCredentials"].forEach(function(e){n[e]=function(){throw new Error(["sorry, "+e+" is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))}})},{"browserify-cipher":580,"browserify-sign":585,"browserify-sign/algos":584,"create-ecdh":597,"create-hash":598,"create-hmac":601,"diffie-hellman":609,pbkdf2:649,"public-encrypt":652,randombytes:658}],603:[function(e,t,n){"use strict";n.utils=e("./des/utils"),n.Cipher=e("./des/cipher"),n.DES=e("./des/des"),n.CBC=e("./des/cbc"),n.EDE=e("./des/ede")},{"./des/cbc":604,"./des/cipher":605,"./des/des":606,"./des/ede":607,"./des/utils":608}],604:[function(e,t,n){"use strict";function r(e){o.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}function i(e){function t(t){e.call(this,t),this._cbcInit()}s(t,e);for(var n=Object.keys(a),r=0;r<n.length;r++){var i=n[r];t.prototype[i]=a[i]}return t.create=function(e){return new t(e)},t}var o=e("minimalistic-assert"),s=e("inherits"),a={};n.instantiate=i,a._cbcInit=function(){var e=new r(this.options.iv);this._cbcState=e},a._update=function(e,t,n,r){var i=this._cbcState,o=this.constructor.super_.prototype,s=i.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)s[a]^=e[t+a];o._update.call(this,s,0,n,r);for(var a=0;a<this.blockSize;a++)s[a]=n[r+a]}else{o._update.call(this,e,t,n,r);for(var a=0;a<this.blockSize;a++)n[r+a]^=s[a];for(var a=0;a<this.blockSize;a++)s[a]=e[t+a]}}},{inherits:640,"minimalistic-assert":643}],605:[function(e,t,n){"use strict";function r(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var i=e("minimalistic-assert");t.exports=r,r.prototype._init=function(){},r.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},r.prototype._buffer=function(e,t){for(var n=Math.min(this.buffer.length-this.bufferOff,e.length-t),r=0;r<n;r++)this.buffer[this.bufferOff+r]=e[t+r];return this.bufferOff+=n,n},r.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},r.prototype._updateEncrypt=function(e){var t=0,n=0,r=(this.bufferOff+e.length)/this.blockSize|0,i=new Array(r*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(i,n)));for(var o=e.length-(e.length-t)%this.blockSize;t<o;t+=this.blockSize)this._update(e,t,i,n),n+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},r.prototype._updateDecrypt=function(e){for(var t=0,n=0,r=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,i=new Array(r*this.blockSize);r>0;r--)t+=this._buffer(e,t),n+=this._flushBuffer(i,n);return t+=this._buffer(e,t),i},r.prototype["final"]=function(e){var t;e&&(t=this.update(e));var n;return n="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(n):n},r.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},r.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},r.prototype._unpad=function(e){return e},r.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},{"minimalistic-assert":643}],606:[function(e,t,n){"use strict";function r(){this.tmp=new Array(2),this.keys=null}function i(e){c.call(this,e);var t=new r;this._desState=t,this.deriveKeys(t,e.key)}var o=e("minimalistic-assert"),s=e("inherits"),a=e("../des"),u=a.utils,c=a.Cipher;s(i,c),t.exports=i,i.create=function(e){return new i(e)};var f=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];i.prototype.deriveKeys=function(e,t){e.keys=new Array(32),o.equal(t.length,this.blockSize,"Invalid key length");var n=u.readUInt32BE(t,0),r=u.readUInt32BE(t,4);u.pc1(n,r,e.tmp,0),n=e.tmp[0],r=e.tmp[1];for(var i=0;i<e.keys.length;i+=2){var s=f[i>>>1];n=u.r28shl(n,s),r=u.r28shl(r,s),u.pc2(n,r,e.keys,i)}},i.prototype._update=function(e,t,n,r){var i=this._desState,o=u.readUInt32BE(e,t),s=u.readUInt32BE(e,t+4);u.ip(o,s,i.tmp,0),o=i.tmp[0],s=i.tmp[1],"encrypt"===this.type?this._encrypt(i,o,s,i.tmp,0):this._decrypt(i,o,s,i.tmp,0),o=i.tmp[0],s=i.tmp[1],u.writeUInt32BE(n,o,r),u.writeUInt32BE(n,s,r+4)},i.prototype._pad=function(e,t){for(var n=e.length-t,r=t;r<e.length;r++)e[r]=n;return!0},i.prototype._unpad=function(e){for(var t=e[e.length-1],n=e.length-t;n<e.length;n++)o.equal(e[n],t);return e.slice(0,e.length-t)},i.prototype._encrypt=function(e,t,n,r,i){for(var o=t,s=n,a=0;a<e.keys.length;a+=2){var c=e.keys[a],f=e.keys[a+1];u.expand(s,e.tmp,0),c^=e.tmp[0],f^=e.tmp[1];var l=u.substitute(c,f),h=u.permute(l),p=s;s=(o^h)>>>0,o=p}u.rip(s,o,r,i)},i.prototype._decrypt=function(e,t,n,r,i){for(var o=n,s=t,a=e.keys.length-2;a>=0;a-=2){var c=e.keys[a],f=e.keys[a+1];u.expand(o,e.tmp,0),c^=e.tmp[0],f^=e.tmp[1];var l=u.substitute(c,f),h=u.permute(l),p=o;o=(s^h)>>>0,s=p}u.rip(o,s,r,i)}},{"../des":603,inherits:640,"minimalistic-assert":643}],607:[function(e,t,n){"use strict";function r(e,t){o.equal(t.length,24,"Invalid key length");var n=t.slice(0,8),r=t.slice(8,16),i=t.slice(16,24);"encrypt"===e?this.ciphers=[c.create({type:"encrypt",key:n}),c.create({type:"decrypt",key:r}),c.create({type:"encrypt",key:i})]:this.ciphers=[c.create({type:"decrypt",key:i}),c.create({type:"encrypt",key:r}),c.create({type:"decrypt",key:n})]}function i(e){u.call(this,e);var t=new r(this.type,this.options.key);this._edeState=t}var o=e("minimalistic-assert"),s=e("inherits"),a=e("../des"),u=a.Cipher,c=a.DES;s(i,u),t.exports=i,i.create=function(e){return new i(e)},i.prototype._update=function(e,t,n,r){var i=this._edeState;i.ciphers[0]._update(e,t,n,r),i.ciphers[1]._update(n,r,n,r),i.ciphers[2]._update(n,r,n,r)},i.prototype._pad=c.prototype._pad,i.prototype._unpad=c.prototype._unpad},{"../des":603,inherits:640,"minimalistic-assert":643}],608:[function(e,t,n){"use strict";n.readUInt32BE=function(e,t){var n=e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t];return n>>>0},n.writeUInt32BE=function(e,t,n){e[0+n]=t>>>24,e[1+n]=t>>>16&255,e[2+n]=t>>>8&255,e[3+n]=255&t},n.ip=function(e,t,n,r){for(var i=0,o=0,s=6;s>=0;s-=2){for(var a=0;a<=24;a+=8)i<<=1,i|=t>>>a+s&1;for(var a=0;a<=24;a+=8)i<<=1,i|=e>>>a+s&1}for(var s=6;s>=0;s-=2){for(var a=1;a<=25;a+=8)o<<=1,o|=t>>>a+s&1;for(var a=1;a<=25;a+=8)o<<=1,o|=e>>>a+s&1}n[r+0]=i>>>0,n[r+1]=o>>>0},n.rip=function(e,t,n,r){for(var i=0,o=0,s=0;s<4;s++)for(var a=24;a>=0;a-=8)i<<=1,i|=t>>>a+s&1,i<<=1,i|=e>>>a+s&1;for(var s=4;s<8;s++)for(var a=24;a>=0;a-=8)o<<=1,o|=t>>>a+s&1,o<<=1,o|=e>>>a+s&1;n[r+0]=i>>>0,n[r+1]=o>>>0},n.pc1=function(e,t,n,r){for(var i=0,o=0,s=7;s>=5;s--){for(var a=0;a<=24;a+=8)i<<=1,i|=t>>a+s&1;for(var a=0;a<=24;a+=8)i<<=1,i|=e>>a+s&1}for(var a=0;a<=24;a+=8)i<<=1,i|=t>>a+s&1;for(var s=1;s<=3;s++){for(var a=0;a<=24;a+=8)o<<=1,o|=t>>a+s&1;for(var a=0;a<=24;a+=8)o<<=1,o|=e>>a+s&1}for(var a=0;a<=24;a+=8)o<<=1,o|=e>>a+s&1;n[r+0]=i>>>0,n[r+1]=o>>>0},n.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];n.pc2=function(e,t,n,i){for(var o=0,s=0,a=r.length>>>1,u=0;u<a;u++)o<<=1,o|=e>>>r[u]&1;for(var u=a;u<r.length;u++)s<<=1,s|=t>>>r[u]&1;n[i+0]=o>>>0,n[i+1]=s>>>0},n.expand=function(e,t,n){var r=0,i=0;r=(1&e)<<5|e>>>27;for(var o=23;o>=15;o-=4)r<<=6,r|=e>>>o&63;for(var o=11;o>=3;o-=4)i|=e>>>o&63,i<<=6;i|=(31&e)<<1|e>>>31,t[n+0]=r>>>0,t[n+1]=i>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];
n.substitute=function(e,t){for(var n=0,r=0;r<4;r++){var o=e>>>18-6*r&63,s=i[64*r+o];n<<=4,n|=s}for(var r=0;r<4;r++){var o=t>>>18-6*r&63,s=i[256+64*r+o];n<<=4,n|=s}return n>>>0};var o=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];n.permute=function(e){for(var t=0,n=0;n<o.length;n++)t<<=1,t|=e>>>o[n]&1;return t>>>0},n.padSplit=function(e,t,n){for(var r=e.toString(2);r.length<t;)r="0"+r;for(var i=[],o=0;o<t;o+=n)i.push(r.slice(o,o+n));return i.join(" ")}},{}],609:[function(e,t,n){(function(Buffer){function t(e){var t=new Buffer(o[e].prime,"hex"),n=new Buffer(o[e].gen,"hex");return new s(t,n)}function r(e,t,n,o){return Buffer.isBuffer(t)||void 0===a[t]?r(e,"binary",t,n):(t=t||"binary",o=o||"binary",n=n||new Buffer([2]),Buffer.isBuffer(n)||(n=new Buffer(n,o)),"number"==typeof e?new s(i(e,n),n,(!0)):(Buffer.isBuffer(e)||(e=new Buffer(e,t)),new s(e,n,(!0))))}var i=e("./lib/generatePrime"),o=e("./lib/primes.json"),s=e("./lib/dh"),a={binary:!0,hex:!0,base64:!0};n.DiffieHellmanGroup=n.createDiffieHellmanGroup=n.getDiffieHellman=t,n.createDiffieHellman=n.DiffieHellman=r}).call(this,e("buffer").Buffer)},{"./lib/dh":610,"./lib/generatePrime":611,"./lib/primes.json":612,buffer:590}],610:[function(e,t,n){(function(Buffer){function n(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this._pub=new BN(e),this}function r(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this._priv=new BN(e),this}function i(e,t){var n=t.toString("hex"),r=[n,e.toString(16)].join("_");if(r in y)return y[r];var i=0;if(e.isEven()||!d.simpleSieve||!d.fermatTest(e)||!u.test(e))return i+=1,i+="02"===n||"05"===n?8:4,y[r]=i,i;u.test(e.shrn(1))||(i+=2);var o;switch(n){case"02":e.mod(c).cmp(f)&&(i+=8);break;case"05":o=e.mod(l),o.cmp(h)&&o.cmp(p)&&(i+=8);break;default:i+=4}return y[r]=i,i}function o(e,t,i){this.setGenerator(t),this.__prime=new BN(e),this._prime=BN.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,i?(this.setPublicKey=n,this.setPrivateKey=r):this._primeCode=8}function s(e,t){var n=new Buffer(e.toArray());return t?n.toString(t):n}var BN=e("bn.js"),a=e("miller-rabin"),u=new a,c=new BN(24),f=new BN(11),l=new BN(10),h=new BN(3),p=new BN(7),d=e("./generatePrime"),g=e("randombytes");t.exports=o;var y={};Object.defineProperty(o.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=i(this.__prime,this.__gen)),this._primeCode}}),o.prototype.generateKeys=function(){return this._priv||(this._priv=new BN(g(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},o.prototype.computeSecret=function(e){e=new BN(e),e=e.toRed(this._prime);var t=e.redPow(this._priv).fromRed(),n=new Buffer(t.toArray()),r=this.getPrime();if(n.length<r.length){var i=new Buffer(r.length-n.length);i.fill(0),n=Buffer.concat([i,n])}return n},o.prototype.getPublicKey=function(e){return s(this._pub,e)},o.prototype.getPrivateKey=function(e){return s(this._priv,e)},o.prototype.getPrime=function(e){return s(this.__prime,e)},o.prototype.getGenerator=function(e){return s(this._gen,e)},o.prototype.setGenerator=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.__gen=e,this._gen=new BN(e),this}}).call(this,e("buffer").Buffer)},{"./generatePrime":611,"bn.js":562,buffer:590,"miller-rabin":642,randombytes:658}],611:[function(e,t,n){function r(){if(null!==v)return v;var e=1048576,t=[];t[0]=2;for(var n=1,r=3;r<e;r+=2){for(var i=Math.ceil(Math.sqrt(r)),o=0;o<n&&t[o]<=i&&r%t[o]!==0;o++);n!==o&&t[o]<=i||(t[n++]=r)}return v=t,t}function i(e){for(var t=r(),n=0;n<t.length;n++)if(0===e.modn(t[n]))return 0===e.cmpn(t[n]);return!0}function o(e){var t=BN.mont(e);return 0===h.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function s(e,t){if(e<16)return new BN(2===t||5===t?[140,123]:[140,39]);t=new BN(t);for(var n,r;;){for(n=new BN(a(Math.ceil(e/8)));n.bitLength()>e;)n.ishrn(1);if(n.isEven()&&n.iadd(l),n.testn(1)||n.iadd(h),t.cmp(h)){if(!t.cmp(p))for(;n.mod(d).cmp(g);)n.iadd(m)}else for(;n.mod(u).cmp(y);)n.iadd(m);if(r=n.shrn(1),i(r)&&i(n)&&o(r)&&o(n)&&f.test(r)&&f.test(n))return n}}var a=e("randombytes");t.exports=s,s.simpleSieve=i,s.fermatTest=o;var BN=e("bn.js"),u=new BN(24),c=e("miller-rabin"),f=new c,l=new BN(1),h=new BN(2),p=new BN(5),d=(new BN(16),new BN(8),new BN(10)),g=new BN(3),y=(new BN(7),new BN(11)),m=new BN(4),v=(new BN(12),null)},{"bn.js":562,"miller-rabin":642,randombytes:658}],612:[function(e,t,n){t.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],613:[function(e,t,n){arguments[4][56][0].apply(n,arguments)},{"../package.json":629,"./elliptic/curve":616,"./elliptic/curves":619,"./elliptic/ec":620,"./elliptic/eddsa":623,"./elliptic/hmac-drbg":626,"./elliptic/utils":628,brorand:563,dup:56}],614:[function(e,t,n){arguments[4][57][0].apply(n,arguments)},{"../../elliptic":613,"bn.js":562,dup:57}],615:[function(e,t,n){arguments[4][58][0].apply(n,arguments)},{"../../elliptic":613,"../curve":616,"bn.js":562,dup:58,inherits:640}],616:[function(e,t,n){arguments[4][59][0].apply(n,arguments)},{"./base":614,"./edwards":615,"./mont":617,"./short":618,dup:59}],617:[function(e,t,n){arguments[4][60][0].apply(n,arguments)},{"../../elliptic":613,"../curve":616,"bn.js":562,dup:60,inherits:640}],618:[function(e,t,n){arguments[4][61][0].apply(n,arguments)},{"../../elliptic":613,"../curve":616,"bn.js":562,dup:61,inherits:640}],619:[function(e,t,n){arguments[4][62][0].apply(n,arguments)},{"../elliptic":613,"./precomputed/secp256k1":627,dup:62,"hash.js":632}],620:[function(e,t,n){arguments[4][63][0].apply(n,arguments)},{"../../elliptic":613,"./key":621,"./signature":622,"bn.js":562,dup:63}],621:[function(e,t,n){arguments[4][64][0].apply(n,arguments)},{"bn.js":562,dup:64}],622:[function(e,t,n){arguments[4][65][0].apply(n,arguments)},{"../../elliptic":613,"bn.js":562,dup:65}],623:[function(e,t,n){arguments[4][66][0].apply(n,arguments)},{"../../elliptic":613,"./key":624,"./signature":625,dup:66,"hash.js":632}],624:[function(e,t,n){arguments[4][67][0].apply(n,arguments)},{"../../elliptic":613,dup:67}],625:[function(e,t,n){arguments[4][68][0].apply(n,arguments)},{"../../elliptic":613,"bn.js":562,dup:68}],626:[function(e,t,n){arguments[4][69][0].apply(n,arguments)},{"../elliptic":613,dup:69,"hash.js":632}],627:[function(e,t,n){arguments[4][70][0].apply(n,arguments)},{dup:70}],628:[function(e,t,n){arguments[4][71][0].apply(n,arguments)},{"bn.js":562,dup:71}],629:[function(e,t,n){t.exports={_args:[["elliptic@http://prezydent.local/sinopia/elliptic/-/elliptic-6.2.8.tgz","/home/lukas/Work/Projects/privfs/privfs-mail-client"]],_from:"elliptic@>=6.2.3 <6.3.0",_id:"elliptic@6.2.8",_inCache:!0,_location:"/elliptic",_phantomChildren:{},_requested:{name:"elliptic",raw:"elliptic@http://prezydent.local/sinopia/elliptic/-/elliptic-6.2.8.tgz",rawSpec:"http://prezydent.local/sinopia/elliptic/-/elliptic-6.2.8.tgz",scope:null,spec:"http://prezydent.local/sinopia/elliptic/-/elliptic-6.2.8.tgz",type:"remote"},_requiredBy:["/browserify-sign","/create-ecdh"],_resolved:"http://prezydent.local/sinopia/elliptic/-/elliptic-6.2.8.tgz",_shasum:"44a25b3d1550bebb74d0b6d22d89940206b51739",_shrinkwrap:null,_spec:"elliptic@http://prezydent.local/sinopia/elliptic/-/elliptic-6.2.8.tgz",_where:"/home/lukas/Work/Projects/privfs/privfs-mail-client",author:{email:"fedor@indutny.com",name:"Fedor Indutny"},bugs:{url:"https://github.com/indutny/elliptic/issues"},dependencies:{"bn.js":"^4.0.0",brorand:"^1.0.1","hash.js":"^1.0.0",inherits:"^2.0.1"},description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["Cryptography","EC","Elliptic","curve"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.2.8"}},{}],630:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(n=this._events[e],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(s(n))for(o=Array.prototype.slice.call(arguments,1),c=n.slice(),r=c.length,u=0;u<r;u++)c[u].apply(this,o);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=o;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],631:[function(e,t,n){(function(Buffer){function n(e,t,n,i){Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),t&&!Buffer.isBuffer(t)&&(t=new Buffer(t,"binary")),n/=8,i=i||0;for(var o,s,a=0,u=0,c=new Buffer(n),f=new Buffer(i),l=0,h=[];;){if(l++>0&&h.push(o),h.push(e),t&&h.push(t),o=r(Buffer.concat(h)),h=[],s=0,n>0)for(;;){if(0===n)break;if(s===o.length)break;c[a++]=o[s],n--,s++}if(i>0&&s!==o.length)for(;;){if(0===i)break;if(s===o.length)break;f[u++]=o[s],i--,s++}if(0===n&&0===i)break}for(s=0;s<o.length;s++)o[s]=0;return{key:c,iv:f}}var r=e("create-hash/md5");t.exports=n}).call(this,e("buffer").Buffer)},{buffer:590,"create-hash/md5":600}],632:[function(e,t,n){arguments[4][77][0].apply(n,arguments)},{"./hash/common":633,"./hash/hmac":634,"./hash/ripemd":635,"./hash/sha":636,"./hash/utils":637,dup:77}],633:[function(e,t,n){arguments[4][78][0].apply(n,arguments)},{"../hash":632,dup:78}],634:[function(e,t,n){arguments[4][79][0].apply(n,arguments)},{"../hash":632,dup:79}],635:[function(e,t,n){arguments[4][80][0].apply(n,arguments)},{"../hash":632,dup:80}],636:[function(e,t,n){arguments[4][81][0].apply(n,arguments)},{"../hash":632,dup:81}],637:[function(e,t,n){arguments[4][82][0].apply(n,arguments)},{dup:82,inherits:640}],638:[function(e,t,n){n.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,l=n?i-1:0,h=n?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+e[t+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+e[t+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+l>=1?h/u:h*Math.pow(2,1-l),t*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*u-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+p]=255&s,p+=d,s/=256,c-=8);e[n+p-d]|=128*g}},{}],639:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],640:[function(e,t,n){arguments[4][102][0].apply(n,arguments)},{dup:102}],641:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],642:[function(e,t,n){function r(e){this.rand=e||new o.Rand}var i=e("bn.js"),o=e("brorand");t.exports=r,r.create=function(e){return new r(e)},r.prototype._rand=function(e){var t=e.bitLength(),n=this.rand.generate(Math.ceil(t/8));n[0]|=3;var r=7&t;return 0!==r&&(n[n.length-1]>>=7-r),new i(n)},r.prototype.test=function(e,t,n){var r=e.bitLength(),o=i.mont(e),s=new i(1).toRed(o);t||(t=Math.max(1,r/48|0));for(var a=e.subn(1),u=a.subn(1),c=0;!a.testn(c);c++);for(var f=e.shrn(c),l=a.toRed(o),h=!0;t>0;t--){var p=this._rand(u);n&&n(p);var d=p.toRed(o).redPow(f);if(0!==d.cmp(s)&&0!==d.cmp(l)){for(var g=1;g<c;g++){if(d=d.redSqr(),0===d.cmp(s))return!1;if(0===d.cmp(l))break}if(g===c)return!1}}return h},r.prototype.getDivisor=function(e,t){var n=e.bitLength(),r=i.mont(e),o=new i(1).toRed(r);t||(t=Math.max(1,n/48|0));for(var s=e.subn(1),a=s.subn(1),u=0;!s.testn(u);u++);for(var c=e.shrn(u),f=s.toRed(r);t>0;t--){var l=this._rand(a),h=e.gcd(l);if(0!==h.cmpn(1))return h;var p=l.toRed(r).redPow(c);if(0!==p.cmp(o)&&0!==p.cmp(f)){for(var d=1;d<u;d++){if(p=p.redSqr(),0===p.cmp(o))return p.fromRed().subn(1).gcd(e);if(0===p.cmp(f))break}if(d===u)return p=p.redSqr(),p.fromRed().subn(1).gcd(e)}}return!1}},{"bn.js":562,brorand:563}],643:[function(e,t,n){arguments[4][134][0].apply(n,arguments)},{dup:134}],644:[function(e,t,n){arguments[4][137][0].apply(n,arguments)},{dup:137}],645:[function(e,t,n){arguments[4][138][0].apply(n,arguments)},{"asn1.js":547,dup:138}],646:[function(e,t,n){(function(Buffer){var n=/Proc-Type: 4,ENCRYPTED\r?\nDEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\r?\n\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n/m,r=/^-----BEGIN (.*) KEY-----\r?\n/m,i=/^-----BEGIN (.*) KEY-----\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n-----END \1 KEY-----$/m,o=e("evp_bytestokey"),s=e("browserify-aes");t.exports=function(e,t){var a,u=e.toString(),c=u.match(n);if(c){var f="aes"+c[1],l=new Buffer(c[2],"hex"),h=new Buffer(c[3].replace(/\r?\n/g,""),"base64"),p=o(t,l.slice(0,8),parseInt(c[1],10)).key,d=[],g=s.createDecipheriv(f,p,l);d.push(g.update(h)),d.push(g["final"]()),a=Buffer.concat(d)}else{var y=u.match(i);a=new Buffer(y[2].replace(/\r?\n/g,""),"base64")}var m=u.match(r)[1]+" KEY";return{tag:m,data:a}}}).call(this,e("buffer").Buffer)},{"browserify-aes":567,buffer:590,evp_bytestokey:631}],647:[function(e,t,n){(function(Buffer){function n(e){var t;"object"!=typeof e||Buffer.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=new Buffer(e));var n,o,a=s(e,t),u=a.tag,c=a.data;switch(u){case"PUBLIC KEY":switch(o=i.PublicKey.decode(c,"der"),n=o.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(o.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return o.subjectPrivateKey=o.subjectPublicKey,{type:"ec",data:o};case"1.2.840.10040.4.1":return o.algorithm.params.pub_key=i.DSAparam.decode(o.subjectPublicKey.data,"der"),{type:"dsa",data:o.algorithm.params};default:throw new Error("unknown key id "+n)}throw new Error("unknown key type "+u);case"ENCRYPTED PRIVATE KEY":c=i.EncryptedPrivateKey.decode(c,"der"),c=r(c,t);case"PRIVATE KEY":switch(o=i.PrivateKey.decode(c,"der"),n=o.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(o.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:o.algorithm.curve,privateKey:i.ECPrivateKey.decode(o.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return o.algorithm.params.priv_key=i.DSAparam.decode(o.subjectPrivateKey,"der"),{type:"dsa",params:o.algorithm.params};default:throw new Error("unknown key id "+n)}throw new Error("unknown key type "+u);case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(c,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(c,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(c,"der")};case"EC PRIVATE KEY":return c=i.ECPrivateKey.decode(c,"der"),{curve:c.parameters.value,privateKey:c.privateKey};default:throw new Error("unknown key type "+u)}}function r(e,t){var n=e.algorithm.decrypt.kde.kdeparams.salt,r=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),i=o[e.algorithm.decrypt.cipher.algo.join(".")],s=e.algorithm.decrypt.cipher.iv,c=e.subjectPrivateKey,f=parseInt(i.split("-")[1],10)/8,l=u.pbkdf2Sync(t,n,r,f),h=a.createDecipheriv(i,l,s),p=[];return p.push(h.update(c)),p.push(h["final"]()),Buffer.concat(p)}var i=e("./asn1"),o=e("./aesid.json"),s=e("./fixProc"),a=e("browserify-aes"),u=e("pbkdf2");t.exports=n,n.signature=i.signature}).call(this,e("buffer").Buffer)},{"./aesid.json":644,"./asn1":645,"./fixProc":646,"browserify-aes":567,buffer:590,pbkdf2:649}],648:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return i.exec(e).slice(1)};n.resolve=function(){for(var n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(n=s+"/"+n,i="/"===s.charAt(0))}return n=t(r(n.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+n||"."},n.normalize=function(e){var i=n.isAbsolute(e),o="/"===s(e,-1);return e=t(r(e.split("/"),function(e){return!!e}),!i).join("/"),e||i||(e="."),e&&o&&(e+="/"),(i?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var i=r(e.split("/")),o=r(t.split("/")),s=Math.min(i.length,o.length),a=s,u=0;u<s;u++)if(i[u]!==o[u]){a=u;break}for(var c=[],u=a;u<i.length;u++)c.push("..");return c=c.concat(o.slice(a)),c.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=o(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(e,t){var n=o(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return o(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,e("_process"))},{_process:592}],649:[function(e,t,n){(function(t,Buffer){var r=e("create-hmac"),i=e("./precondition");n.pbkdf2=function(e,t,r,o,s,a){if("function"==typeof s&&(a=s,s=void 0),i(r,o),"function"!=typeof a)throw new Error("No callback provided to pbkdf2");setTimeout(function(){a(null,n.pbkdf2Sync(e,t,r,o,s))})};var o;if(t.browser)o="utf-8";else{var s=parseInt(t.version.split(".")[0].slice(1),10);o=s>=6?"utf-8":"binary"}n.pbkdf2Sync=function(e,t,n,s,a){Buffer.isBuffer(e)||(e=new Buffer(e,o)),Buffer.isBuffer(t)||(t=new Buffer(t,o)),i(n,s),a=a||"sha1";var u,c=1,f=new Buffer(s),l=new Buffer(t.length+4);t.copy(l,0,0,t.length);for(var h,p,d=1;d<=c;d++){l.writeUInt32BE(d,t.length);var g=r(a,e).update(l).digest();u||(u=g.length,p=new Buffer(u),c=Math.ceil(s/u),h=s-(c-1)*u),g.copy(p,0,0,u);for(var y=1;y<n;y++){g=r(a,e).update(g).digest();for(var m=0;m<u;m++)p[m]^=g[m]}var v=(d-1)*u,b=d===c?h:u;p.copy(f,v,0,b)}return f}}).call(this,e("_process"),e("buffer").Buffer)},{"./precondition":650,_process:592,buffer:590,"create-hmac":601}],650:[function(e,t,n){arguments[4][143][0].apply(n,arguments)},{dup:143}],651:[function(e,t,n){(function(e){"use strict";function n(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=n:t.exports=e.nextTick}).call(this,e("_process"))},{_process:592}],652:[function(e,t,n){n.publicEncrypt=e("./publicEncrypt"),n.privateDecrypt=e("./privateDecrypt"),n.privateEncrypt=function(e,t){return n.publicEncrypt(e,t,!0)},n.publicDecrypt=function(e,t){return n.privateDecrypt(e,t,!0)}},{"./privateDecrypt":654,"./publicEncrypt":655}],653:[function(e,t,n){(function(Buffer){function n(e){var t=new Buffer(4);return t.writeUInt32BE(e,0),t}var r=e("create-hash");t.exports=function(e,t){for(var i,o=new Buffer(""),s=0;o.length<t;)i=n(s++),o=Buffer.concat([o,r("sha1").update(e).update(i).digest()]);return o.slice(0,t)}}).call(this,e("buffer").Buffer)},{buffer:590,"create-hash":598}],654:[function(e,t,n){(function(Buffer){function n(e,t){var n=(e.modulus,e.modulus.byteLength()),r=(t.length,f("sha1").update(new Buffer("")).digest()),o=r.length;if(0!==t[0])throw new Error("decryption error");var u=t.slice(1,o+1),c=t.slice(o+1),l=a(u,s(c,o)),h=a(c,s(l,n-o-1));if(i(r,h.slice(0,o)))throw new Error("decryption error");for(var p=o;0===h[p];)p++;if(1!==h[p++])throw new Error("decryption error");return h.slice(p)}function r(e,t,n){for(var r=t.slice(0,2),i=2,o=0;0!==t[i++];)if(i>=t.length){o++;break}var s=t.slice(2,i-1);t.slice(i-1,i);if(("0002"!==r.toString("hex")&&!n||"0001"!==r.toString("hex")&&n)&&o++,s.length<8&&o++,o)throw new Error("decryption error");return t.slice(i)}function i(e,t){e=new Buffer(e),t=new Buffer(t);var n=0,r=e.length;e.length!==t.length&&(n++,r=Math.min(e.length,t.length));for(var i=-1;++i<r;)n+=e[i]^t[i];return n}var o=e("parse-asn1"),s=e("./mgf"),a=e("./xor"),u=e("bn.js"),c=e("browserify-rsa"),f=e("create-hash"),l=e("./withPublic");t.exports=function(e,t,i){var s;s=e.padding?e.padding:i?1:4;var a=o(e),f=a.modulus.byteLength();if(t.length>f||new u(t).cmp(a.modulus)>=0)throw new Error("decryption error");var h;h=i?l(new u(t),a):c(t,a);var p=new Buffer(f-h.length);if(p.fill(0),h=Buffer.concat([p,h],f),4===s)return n(a,h);if(1===s)return r(a,h,i);
if(3===s)return h;throw new Error("unknown padding")}}).call(this,e("buffer").Buffer)},{"./mgf":653,"./withPublic":656,"./xor":657,"bn.js":562,"browserify-rsa":583,buffer:590,"create-hash":598,"parse-asn1":647}],655:[function(e,t,n){(function(Buffer){function n(e,t){var n=e.modulus.byteLength(),r=t.length,i=a("sha1").update(new Buffer("")).digest(),o=i.length,l=2*o;if(r>n-l-2)throw new Error("message too long");var h=new Buffer(n-r-l-2);h.fill(0);var p=n-o-1,d=s(o),g=c(Buffer.concat([i,h,new Buffer([1]),t],p),u(d,p)),y=c(d,u(g,o));return new f(Buffer.concat([new Buffer([0]),y,g],n))}function r(e,t,n){var r=t.length,o=e.modulus.byteLength();if(r>o-11)throw new Error("message too long");var s;return n?(s=new Buffer(o-r-3),s.fill(255)):s=i(o-r-3),new f(Buffer.concat([new Buffer([0,n?1:2]),s,new Buffer([0]),t],o))}function i(e,t){for(var n,r=new Buffer(e),i=0,o=s(2*e),a=0;i<e;)a===o.length&&(o=s(2*e),a=0),n=o[a++],n&&(r[i++]=n);return r}var o=e("parse-asn1"),s=e("randombytes"),a=e("create-hash"),u=e("./mgf"),c=e("./xor"),f=e("bn.js"),l=e("./withPublic"),h=e("browserify-rsa");t.exports=function(e,t,i){var s;s=e.padding?e.padding:i?1:4;var a,u=o(e);if(4===s)a=n(u,t);else if(1===s)a=r(u,t,i);else{if(3!==s)throw new Error("unknown padding");if(a=new f(t),a.cmp(u.modulus)>=0)throw new Error("data too long for modulus")}return i?h(a,u):l(a,u)}}).call(this,e("buffer").Buffer)},{"./mgf":653,"./withPublic":656,"./xor":657,"bn.js":562,"browserify-rsa":583,buffer:590,"create-hash":598,"parse-asn1":647,randombytes:658}],656:[function(e,t,n){(function(Buffer){function n(e,t){return new Buffer(e.toRed(r.mont(t.modulus)).redPow(new r(t.publicExponent)).fromRed().toArray())}var r=e("bn.js");t.exports=n}).call(this,e("buffer").Buffer)},{"bn.js":562,buffer:590}],657:[function(e,t,n){t.exports=function(e,t){for(var n=e.length,r=-1;++r<n;)e[r]^=t[r];return e}},{}],658:[function(e,t,n){(function(e,n,Buffer){"use strict";function r(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function i(t,r){if(t>65536)throw new Error("requested too many random bytes");var i=new n.Uint8Array(t);t>0&&o.getRandomValues(i);var s=new Buffer(i.buffer);return"function"==typeof r?e.nextTick(function(){r(null,s)}):s}var o=n.crypto||n.msCrypto;o&&o.getRandomValues?t.exports=i:t.exports=r}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{_process:592,buffer:590}],659:[function(e,t,n){(function(Buffer){function e(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t}function n(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t}function r(e,t,n){for(var r=0;r<16;r++){var f=n+r,m=t[f];t[f]=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8)}var v,b,w,E,_,S,k,C,x,I;S=v=e[0],k=b=e[1],C=w=e[2],x=E=e[3],I=_=e[4];var A;for(r=0;r<80;r+=1)A=v+t[n+l[r]]|0,A+=r<16?i(b,w,E)+g[0]:r<32?o(b,w,E)+g[1]:r<48?s(b,w,E)+g[2]:r<64?a(b,w,E)+g[3]:u(b,w,E)+g[4],A=0|A,A=c(A,p[r]),A=A+_|0,v=_,_=E,E=c(w,10),w=b,b=A,A=S+t[n+h[r]]|0,A+=r<16?u(k,C,x)+y[0]:r<32?a(k,C,x)+y[1]:r<48?s(k,C,x)+y[2]:r<64?o(k,C,x)+y[3]:i(k,C,x)+y[4],A=0|A,A=c(A,d[r]),A=A+I|0,S=I,I=x,x=c(C,10),C=k,k=A;A=e[1]+w+x|0,e[1]=e[2]+E+I|0,e[2]=e[3]+_+S|0,e[3]=e[4]+v+k|0,e[4]=e[0]+b+C|0,e[0]=A}function i(e,t,n){return e^t^n}function o(e,t,n){return e&t|~e&n}function s(e,t,n){return(e|~t)^n}function a(e,t,n){return e&n|t&~n}function u(e,t,n){return e^(t|~n)}function c(e,t){return e<<t|e>>>32-t}function f(t){var i=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof t&&(t=new Buffer(t,"utf8"));var o=e(t),s=8*t.length,a=8*t.length;o[s>>>5]|=128<<24-s%32,o[(s+64>>>9<<4)+14]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);for(var u=0;u<o.length;u+=16)r(i,o,u);for(u=0;u<5;u++){var c=i[u];i[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var f=n(i);return new Buffer(f)}var l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],d=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],g=[0,1518500249,1859775393,2400959708,2840853838],y=[1352829926,1548603684,1836072691,2053994217,0];t.exports=f}).call(this,e("buffer").Buffer)},{buffer:590}],660:[function(e,t,n){function r(e,t){for(var n in e)t[n]=e[n]}function i(e,t,n){return Buffer(e,t,n)}var o=e("buffer"),Buffer=o.Buffer;Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?t.exports=o:(r(o,n),n.Buffer=i),r(Buffer,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return Buffer(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=Buffer(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return Buffer(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o.SlowBuffer(e)}},{buffer:590}],661:[function(e,t,n){(function(Buffer){function e(e,t){this._block=new Buffer(e),this._finalSize=t,this._blockSize=e,this._len=0,this._s=0}e.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=new Buffer(e,t));for(var n=this._len+=e.length,r=this._s||0,i=0,o=this._block;r<n;){for(var s=Math.min(e.length,i+this._blockSize-r%this._blockSize),a=s-i,u=0;u<a;u++)o[r%this._blockSize+u]=e[u+i];r+=a,i+=a,r%this._blockSize===0&&this._update(o)}return this._s=r,this},e.prototype.digest=function(e){var t=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),t%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(t,this._blockSize-4);var n=this._update(this._block)||this._hash();return e?n.toString(e):n},e.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=e}).call(this,e("buffer").Buffer)},{buffer:590}],662:[function(e,t,n){arguments[4][340][0].apply(n,arguments)},{"./sha":663,"./sha1":664,"./sha224":665,"./sha256":666,"./sha384":667,"./sha512":668,dup:340}],663:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=c,a.call(this,64,56)}function r(e){return e<<5|e>>>27}function i(e){return e<<30|e>>>2}function o(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var s=e("inherits"),a=e("./hash"),u=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);s(n,a),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._a,s=0|this._b,a=0|this._c,c=0|this._d,f=0|this._e,l=0;l<16;++l)t[l]=e.readInt32BE(4*l);for(;l<80;++l)t[l]=t[l-3]^t[l-8]^t[l-14]^t[l-16];for(var h=0;h<80;++h){var p=~~(h/20),d=r(n)+o(p,s,a,c)+f+t[h]+u[p]|0;f=c,c=a,a=i(s),s=n,n=d}this._a=n+this._a|0,this._b=s+this._b|0,this._c=a+this._c|0,this._d=c+this._d|0,this._e=f+this._e|0},n.prototype._hash=function(){var e=new Buffer(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":661,buffer:590,inherits:640}],664:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=f,u.call(this,64,56)}function r(e){return e<<1|e>>>31}function i(e){return e<<5|e>>>27}function o(e){return e<<30|e>>>2}function s(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var a=e("inherits"),u=e("./hash"),c=[1518500249,1859775393,-1894007588,-899497514],f=new Array(80);a(n,u),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._a,a=0|this._b,u=0|this._c,f=0|this._d,l=0|this._e,h=0;h<16;++h)t[h]=e.readInt32BE(4*h);for(;h<80;++h)t[h]=r(t[h-3]^t[h-8]^t[h-14]^t[h-16]);for(var p=0;p<80;++p){var d=~~(p/20),g=i(n)+s(d,a,u,f)+l+t[p]+c[d]|0;l=f,f=u,u=o(a),a=n,n=g}this._a=n+this._a|0,this._b=a+this._b|0,this._c=u+this._c|0,this._d=f+this._d|0,this._e=l+this._e|0},n.prototype._hash=function(){var e=new Buffer(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":661,buffer:590,inherits:640}],665:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=s,o.call(this,64,56)}var r=e("inherits"),i=e("./sha256"),o=e("./hash"),s=new Array(64);r(n,i),n.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},n.prototype._hash=function(){var e=new Buffer(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":661,"./sha256":666,buffer:590,inherits:640}],666:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=h,f.call(this,64,56)}function r(e,t,n){return n^e&(t^n)}function i(e,t,n){return e&t|n&(e|t)}function o(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function s(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function a(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function u(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}var c=e("inherits"),f=e("./hash"),l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],h=new Array(64);c(n,f),n.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._a,c=0|this._b,f=0|this._c,h=0|this._d,p=0|this._e,d=0|this._f,g=0|this._g,y=0|this._h,m=0;m<16;++m)t[m]=e.readInt32BE(4*m);for(;m<64;++m)t[m]=u(t[m-2])+t[m-7]+a(t[m-15])+t[m-16]|0;for(var v=0;v<64;++v){var b=y+s(p)+r(p,d,g)+l[v]+t[v]|0,w=o(n)+i(n,c,f)|0;y=g,g=d,d=p,p=h+b|0,h=f,f=c,c=n,n=b+w|0}this._a=n+this._a|0,this._b=c+this._b|0,this._c=f+this._c|0,this._d=h+this._d|0,this._e=p+this._e|0,this._f=d+this._f|0,this._g=g+this._g|0,this._h=y+this._h|0},n.prototype._hash=function(){var e=new Buffer(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":661,buffer:590,inherits:640}],667:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=s,o.call(this,128,112)}var r=e("inherits"),i=e("./sha512"),o=e("./hash"),s=new Array(160);r(n,i),n.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},n.prototype._hash=function(){function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}var t=new Buffer(48);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":661,"./sha512":668,buffer:590,inherits:640}],668:[function(e,t,n){(function(Buffer){function n(){this.init(),this._w=g,p.call(this,128,112)}function r(e,t,n){return n^e&(t^n)}function i(e,t,n){return e&t|n&(e|t)}function o(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function s(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function a(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function u(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function c(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function f(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function l(e,t){return e>>>0<t>>>0?1:0}var h=e("inherits"),p=e("./hash"),d=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],g=new Array(160);h(n,p),n.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},n.prototype._update=function(e){for(var t=this._w,n=0|this._ah,h=0|this._bh,p=0|this._ch,g=0|this._dh,y=0|this._eh,m=0|this._fh,v=0|this._gh,b=0|this._hh,w=0|this._al,E=0|this._bl,_=0|this._cl,S=0|this._dl,k=0|this._el,C=0|this._fl,x=0|this._gl,I=0|this._hl,A=0;A<32;A+=2)t[A]=e.readInt32BE(4*A),t[A+1]=e.readInt32BE(4*A+4);for(;A<160;A+=2){var P=t[A-30],T=t[A-30+1],M=a(P,T),R=u(T,P);P=t[A-4],T=t[A-4+1];var O=c(P,T),B=f(T,P),D=t[A-14],N=t[A-14+1],L=t[A-32],F=t[A-32+1],U=R+N|0,j=M+D+l(U,R)|0;U=U+B|0,j=j+O+l(U,B)|0,U=U+F|0,j=j+L+l(U,F)|0,t[A]=j,t[A+1]=U}for(var z=0;z<160;z+=2){j=t[z],U=t[z+1];var K=i(n,h,p),H=i(w,E,_),q=o(n,w),V=o(w,n),W=s(y,k),G=s(k,y),Y=d[z],X=d[z+1],$=r(y,m,v),J=r(k,C,x),Q=I+G|0,Z=b+W+l(Q,I)|0;Q=Q+J|0,Z=Z+$+l(Q,J)|0,Q=Q+X|0,Z=Z+Y+l(Q,X)|0,Q=Q+U|0,Z=Z+j+l(Q,U)|0;var ee=V+H|0,te=q+K+l(ee,V)|0;b=v,I=x,v=m,x=C,m=y,C=k,k=S+Q|0,y=g+Z+l(k,S)|0,g=p,S=_,p=h,_=E,h=n,E=w,w=Q+ee|0,n=Z+te+l(w,Q)|0}this._al=this._al+w|0,this._bl=this._bl+E|0,this._cl=this._cl+_|0,this._dl=this._dl+S|0,this._el=this._el+k|0,this._fl=this._fl+C|0,this._gl=this._gl+x|0,this._hl=this._hl+I|0,this._ah=this._ah+n+l(this._al,w)|0,this._bh=this._bh+h+l(this._bl,E)|0,this._ch=this._ch+p+l(this._cl,_)|0,this._dh=this._dh+g+l(this._dl,S)|0,this._eh=this._eh+y+l(this._el,k)|0,this._fh=this._fh+m+l(this._fl,C)|0,this._gh=this._gh+v+l(this._gl,x)|0,this._hh=this._hh+b+l(this._hl,I)|0},n.prototype._hash=function(){function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}var t=new Buffer(64);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=n}).call(this,e("buffer").Buffer)},{"./hash":661,buffer:590,inherits:640}],669:[function(e,t,n){function r(){i.call(this)}t.exports=r;var i=e("events").EventEmitter,o=e("inherits");o(r,i),r.Readable=e("readable-stream/readable.js"),r.Writable=e("readable-stream/writable.js"),r.Duplex=e("readable-stream/duplex.js"),r.Transform=e("readable-stream/transform.js"),r.PassThrough=e("readable-stream/passthrough.js"),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&c.pause&&c.pause()}function r(){c.readable&&c.resume&&c.resume()}function o(){f||(f=!0,e.end())}function s(){f||(f=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){c.removeListener("data",n),e.removeListener("drain",r),c.removeListener("end",o),c.removeListener("close",s),c.removeListener("error",a),e.removeListener("error",a),c.removeListener("end",u),c.removeListener("close",u),e.removeListener("close",u)}var c=this;c.on("data",n),e.on("drain",r),e._isStdio||t&&t.end===!1||(c.on("end",o),c.on("close",s));var f=!1;return c.on("error",a),e.on("error",a),c.on("end",u),c.on("close",u),e.on("close",u),e.emit("pipe",c),e}},{events:630,inherits:640,"readable-stream/duplex.js":671,"readable-stream/passthrough.js":680,"readable-stream/readable.js":681,"readable-stream/transform.js":682,"readable-stream/writable.js":683}],670:[function(e,t,n){arguments[4][20][0].apply(n,arguments)},{dup:20}],671:[function(e,t,n){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":672}],672:[function(e,t,n){"use strict";function r(e){return this instanceof r?(c.call(this,e),f.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||s(o,this)}function o(e){e.end()}var s=e("process-nextick-args"),a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=r;var u=e("core-util-is");u.inherits=e("inherits");var c=e("./_stream_readable"),f=e("./_stream_writable");u.inherits(r,c);for(var l=a(f.prototype),h=0;h<l.length;h++){var p=l[h];r.prototype[p]||(r.prototype[p]=f.prototype[p])}Object.defineProperty(r.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),r.prototype._destroy=function(e,t){this.push(null),this.end(),s(t,e)}},{"./_stream_readable":674,"./_stream_writable":676,"core-util-is":596,inherits:640,"process-nextick-args":651}],673:[function(e,t,n){"use strict";function r(e){return this instanceof r?void i.call(this,e):new r(e)}t.exports=r;var i=e("./_stream_transform"),o=e("core-util-is");o.inherits=e("inherits"),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":675,"core-util-is":596,inherits:640}],674:[function(e,t,n){(function(n,r){"use strict";function i(e){return Buffer.from(e)}function o(e){return Buffer.isBuffer(e)||e instanceof L}function s(e,t,n){return"function"==typeof e.prependListener?e.prependListener(t,n):void(e._events&&e._events[t]?B(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n))}function a(t,n){O=O||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof O&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new K,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(z||(z=e("string_decoder/").StringDecoder),this.decoder=new z(t.encoding),this.encoding=t.encoding)}function u(t){return O=O||e("./_stream_duplex"),this instanceof u?(this._readableState=new a(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),void N.call(this)):new u(t)}function c(e,t,n,r,o){var s=e._readableState;if(null===t)s.reading=!1,g(e,s);else{var a;o||(a=l(s,t)),a?e.emit("error",a):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=i(t)),r?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):f(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?f(e,s,t,!1):v(e,s)):f(e,s,t,!1))):r||(s.reading=!1)}return h(s)}function f(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&y(e)),v(e,t)}function l(e,t){var n;return o(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function h(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function p(e){return e>=V?e=V:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function d(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=p(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function g(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,y(e)}}function y(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(j("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?R(m,e):m(e))}function m(e){j("emit readable"),e.emit("readable"),k(e)}function v(e,t){t.readingMore||(t.readingMore=!0,R(b,e,t))}function b(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(j("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function w(e){return function(){var t=e._readableState;j("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&D(e,"data")&&(t.flowing=!0,k(e))}}function E(e){j("readable nexttick read 0"),e.read(0)}function _(e,t){t.resumeScheduled||(t.resumeScheduled=!0,R(S,e,t))}function S(e,t){t.reading||(j("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),k(e),t.flowing&&!t.reading&&e.read(0)}function k(e){var t=e._readableState;for(j("flow",t.flowing);t.flowing&&null!==e.read(););}function C(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=x(e,t.buffer,t.decoder),n}function x(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?I(e,t):A(e,t),r}function I(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(i+=s===o.length?o:o.slice(0,e),e-=s,0===e){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}function A(e,t){var n=Buffer.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,s),e-=s,0===e){s===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}function P(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,R(T,t,e))}function T(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function M(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}var R=e("process-nextick-args");t.exports=u;var O,B=e("isarray");u.ReadableState=a;var D=(e("events").EventEmitter,function(e,t){return e.listeners(t).length}),N=e("./internal/streams/stream"),Buffer=e("safe-buffer").Buffer,L=r.Uint8Array||function(){},F=e("core-util-is");F.inherits=e("inherits");var U=e("util"),j=void 0;j=U&&U.debuglog?U.debuglog("stream"):function(){};var z,K=e("./internal/streams/BufferList"),H=e("./internal/streams/destroy");F.inherits(u,N);var q=["error","close","destroy","pause","resume"];Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),u.prototype.destroy=H.destroy,u.prototype._undestroy=H.undestroy,u.prototype._destroy=function(e,t){this.push(null),t(e)},u.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&(t=t||r.defaultEncoding,t!==r.encoding&&(e=Buffer.from(e,t),t=""),n=!0),c(this,e,t,!1,n)},u.prototype.unshift=function(e){return c(this,e,null,!0,!1)},u.prototype.isPaused=function(){return this._readableState.flowing===!1},u.prototype.setEncoding=function(t){return z||(z=e("string_decoder/").StringDecoder),this._readableState.decoder=new z(t),this._readableState.encoding=t,this};var V=8388608;u.prototype.read=function(e){j("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return j("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?P(this):y(this),null;if(e=d(e,t),0===e&&t.ended)return 0===t.length&&P(this),null;var r=t.needReadable;j("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,j("length less than watermark",r)),t.ended||t.reading?(r=!1,j("reading or ended",r)):r&&(j("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=d(n,t)));var i;return i=e>0?C(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&P(this)),null!==i&&this.emit("data",i),i},u.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},u.prototype.pipe=function(e,t){function r(e,t){j("onunpipe"),e===h&&t&&t.hasUnpiped===!1&&(t.hasUnpiped=!0,o())}function i(){j("onend"),e.end()}function o(){j("cleanup"),e.removeListener("close",c),e.removeListener("finish",f),e.removeListener("drain",y),e.removeListener("error",u),e.removeListener("unpipe",r),h.removeListener("end",i),h.removeListener("end",l),h.removeListener("data",a),m=!0,!p.awaitDrain||e._writableState&&!e._writableState.needDrain||y()}function a(t){j("ondata"),v=!1;var n=e.write(t);!1!==n||v||((1===p.pipesCount&&p.pipes===e||p.pipesCount>1&&M(p.pipes,e)!==-1)&&!m&&(j("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,v=!0),h.pause())}function u(t){j("onerror",t),l(),e.removeListener("error",u),0===D(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",f),l()}function f(){j("onfinish"),e.removeListener("close",c),l()}function l(){j("unpipe"),h.unpipe(e)}var h=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=e;break;case 1:p.pipes=[p.pipes,e];break;default:p.pipes.push(e)}p.pipesCount+=1,j("pipe count=%d opts=%j",p.pipesCount,t);var d=(!t||t.end!==!1)&&e!==n.stdout&&e!==n.stderr,g=d?i:l;p.endEmitted?R(g):h.once("end",g),e.on("unpipe",r);var y=w(h);e.on("drain",y);var m=!1,v=!1;return h.on("data",a),s(e,"error",u),e.once("close",c),e.once("finish",f),e.emit("pipe",h),p.flowing||(j("pipe resume"),h.resume()),e},u.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=M(t.pipes,e);return s===-1?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},u.prototype.on=function(e,t){var n=N.prototype.on.call(this,e,t);if("data"===e)this._readableState.flowing!==!1&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&y(this):R(E,this))}return n},u.prototype.addListener=u.prototype.on,u.prototype.resume=function(){var e=this._readableState;return e.flowing||(j("resume"),e.flowing=!0,_(this,e)),this},u.prototype.pause=function(){return j("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(j("pause"),this._readableState.flowing=!1,this.emit("pause")),this},u.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(j("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(j("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){var o=r.push(i);o||(n=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<q.length;o++)e.on(q[o],r.emit.bind(r,q[o]));return r._read=function(t){j("wrapped _read",t),n&&(n=!1,e.resume())},r},u._fromList=C}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":672,"./internal/streams/BufferList":677,"./internal/streams/destroy":678,"./internal/streams/stream":679,_process:592,"core-util-is":596,events:630,inherits:640,isarray:670,"process-nextick-args":651,"safe-buffer":660,"string_decoder/":684,util:564}],675:[function(e,t,n){"use strict";function r(e){this.afterTransform=function(t,n){return i(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark);
}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e),this._transformState=new r(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,n){s(t,e,n)}):s(t)})}function s(e,t,n){if(t)return e.emit("error",t);null!==n&&void 0!==n&&e.push(n);var r=e._writableState,i=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}t.exports=o;var a=e("./_stream_duplex"),u=e("core-util-is");u.inherits=e("inherits"),u.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;a.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},{"./_stream_duplex":672,"core-util-is":596,inherits:640}],676:[function(e,t,n){(function(n,r){"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){x(t,e)}}function o(e){return Buffer.from(e)}function s(e){return Buffer.isBuffer(e)||e instanceof O}function a(){}function u(t,n){A=A||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof A&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){m(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function c(t){return A=A||e("./_stream_duplex"),D.call(c,this)||this instanceof A?(this._writableState=new u(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t["final"]&&(this._final=t["final"])),void R.call(this)):new c(t)}function f(e,t){var n=new Error("write after end");e.emit("error",n),I(t,n)}function l(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),I(r,o),i=!1),i}function h(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=Buffer.from(t,n)),t}function p(e,t,n,r,i,o){if(!n){var s=h(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else d(e,t,!1,a,r,i,o);return u}function d(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function g(e,t,n,r,i){--t.pendingcb,n?(I(i,r),I(k,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),k(e,t))}function y(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function m(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(y(n),t)g(e,n,r,t,i);else{var o=E(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),r?P(v,e,n,o,i):v(e,n,o,i)}}function v(e,t,n,r){n||b(e,t),t.pendingcb--,r(),k(e,t)}function b(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),s=t.corkedRequestsFree;s.entry=n;for(var a=0,u=!0;n;)o[a]=n,n.isBuf||(u=!1),n=n.next,a+=1;o.allBuffers=u,d(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t)}else{for(;n;){var c=n.chunk,f=n.encoding,l=n.callback,h=t.objectMode?1:c.length;if(d(e,t,!1,h,c,f,l),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function _(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),k(e,t)})}function S(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,I(_,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function k(e,t){var n=E(t);return n&&(S(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function C(e,t,n){t.ending=!0,k(e,t),n&&(t.finished?I(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function x(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var I=e("process-nextick-args");t.exports=c;var A,P=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?setImmediate:I;c.WritableState=u;var T=e("core-util-is");T.inherits=e("inherits");var M={deprecate:e("util-deprecate")},R=e("./internal/streams/stream"),Buffer=e("safe-buffer").Buffer,O=r.Uint8Array||function(){},B=e("./internal/streams/destroy");T.inherits(c,R),u.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(u.prototype,"buffer",{get:M.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var D;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(D=Function.prototype[Symbol.hasInstance],Object.defineProperty(c,Symbol.hasInstance,{value:function(e){return!!D.call(this,e)||e&&e._writableState instanceof u}})):D=function(e){return e instanceof this},c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},c.prototype.write=function(e,t,n){var r=this._writableState,i=!1,u=s(e)&&!r.objectMode;return u&&!Buffer.isBuffer(e)&&(e=o(e)),"function"==typeof t&&(n=t,t=null),u?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=a),r.ended?f(this,n):(u||l(this,r,e,n))&&(r.pendingcb++,i=p(this,r,u,e,t,n)),i},c.prototype.cork=function(){var e=this._writableState;e.corked++},c.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},c.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},c.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},c.prototype._writev=null,c.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||C(this,r,n)},Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),c.prototype.destroy=B.destroy,c.prototype._undestroy=B.undestroy,c.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":672,"./internal/streams/destroy":678,"./internal/streams/stream":679,_process:592,"core-util-is":596,inherits:640,"process-nextick-args":651,"safe-buffer":660,"util-deprecate":686}],677:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){e.copy(t,n)}var Buffer=e("safe-buffer").Buffer;t.exports=function(){function e(){r(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var t=Buffer.allocUnsafe(e>>>0),n=this.head,r=0;n;)i(n.data,t,r),r+=n.data.length,n=n.next;return t},e}()},{"safe-buffer":660}],678:[function(e,t,n){"use strict";function r(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?void(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||s(o,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),void this._destroy(e||null,function(e){!t&&e?(s(o,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}))}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(e,t){e.emit("error",t)}var s=e("process-nextick-args");t.exports={destroy:r,undestroy:i}},{"process-nextick-args":651}],679:[function(e,t,n){t.exports=e("events").EventEmitter},{events:630}],680:[function(e,t,n){t.exports=e("./readable").PassThrough},{"./readable":681}],681:[function(e,t,n){n=t.exports=e("./lib/_stream_readable.js"),n.Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":672,"./lib/_stream_passthrough.js":673,"./lib/_stream_readable.js":674,"./lib/_stream_transform.js":675,"./lib/_stream_writable.js":676}],682:[function(e,t,n){t.exports=e("./readable").Transform},{"./readable":681}],683:[function(e,t,n){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":676}],684:[function(e,t,n){"use strict";function r(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function i(e){var t=r(e);if("string"!=typeof t&&(Buffer.isEncoding===v||!v(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){this.encoding=i(e);var t;switch(this.encoding){case"utf16le":this.text=h,this.end=p,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=d,this.end=g,t=3;break;default:return this.write=y,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(t)}function s(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:-1}function a(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n?0:(i=s(t[r]),i>=0?(i>0&&(e.lastNeed=i-2),i):--r<n?0:(i=s(t[r]),i>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0))}function u(e,t,n){if(128!==(192&t[0]))return e.lastNeed=0,"".repeat(n);if(e.lastNeed>1&&t.length>1){if(128!==(192&t[1]))return e.lastNeed=1,"".repeat(n+1);if(e.lastNeed>2&&t.length>2&&128!==(192&t[2]))return e.lastNeed=2,"".repeat(n+2)}}function c(e){var t=this.lastTotal-this.lastNeed,n=u(this,e,t);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function f(e,t){var n=a(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"".repeat(this.lastTotal-this.lastNeed):t}function h(e,t){if((e.length-t)%2===0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function d(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function g(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function y(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}var Buffer=e("safe-buffer").Buffer,v=Buffer.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};n.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(t=this.fillLast(e),void 0===t)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=l,o.prototype.text=f,o.prototype.fillLast=function(e){return this.lastNeed<=e.length?(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),void(this.lastNeed-=e.length))}},{"safe-buffer":660}],685:[function(e,t,n){arguments[4][375][0].apply(n,arguments)},{buffer:590,dup:375}],686:[function(e,t,n){(function(e){function n(e,t){function n(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(r("noDeprecation"))return e;var i=!1;return n}function r(t){try{if(!e.localStorage)return!1}catch(n){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],687:[function(e,t,n){arguments[4][102][0].apply(n,arguments)},{dup:102}],688:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],689:[function(e,t,n){(function(t,r){function i(e,t){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(t)?r.showHidden=t:t&&n._extend(r,t),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function u(e,t,r){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return b(i)||(i=u(e,i,r)),i}var o=c(e,t);if(o)return o;var s=Object.keys(t),g=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),C(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(t);if(0===s.length){if(x(t)){var y=t.name?": "+t.name:"";return e.stylize("[Function"+y+"]","special")}if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(C(t))return f(t)}var m="",v=!1,w=["{","}"];if(d(t)&&(v=!0,w=["[","]"]),x(t)){var E=t.name?": "+t.name:"";m=" [Function"+E+"]"}if(_(t)&&(m=" "+RegExp.prototype.toString.call(t)),k(t)&&(m=" "+Date.prototype.toUTCString.call(t)),C(t)&&(m=" "+f(t)),0===s.length&&(!v||0==t.length))return w[0]+m+w[1];if(r<0)return _(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var S;return S=v?l(e,t,r,g,s):s.map(function(n){return h(e,t,r,g,n,v)}),e.seen.pop(),p(S,m,w)}function c(e,t){if(E(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return v(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)M(t,String(s))?o.push(h(e,t,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(e,t,n,r,i,!0))}),o}function h(e,t,n,r,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),M(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=y(n)?u(e,c.value,null):u(e,c.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),E(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function m(e){return null==e}function v(e){return"number"==typeof e}function b(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function E(e){return void 0===e}function _(e){return S(e)&&"[object RegExp]"===A(e)}function S(e){return"object"==typeof e&&null!==e}function k(e){return S(e)&&"[object Date]"===A(e)}function C(e){return S(e)&&("[object Error]"===A(e)||e instanceof Error)}function x(e){return"function"==typeof e}function I(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function A(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}function T(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var R=/%[sdj%]/g;n.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(e).replace(R,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),a=r[n];n<o;a=r[++n])s+=y(a)||!S(a)?" "+a:" "+i(a);return s},n.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(E(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(t.noDeprecation===!0)return e;var s=!1;return o};var O,B={};n.debuglog=function(e){if(E(O)&&(O=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!B[e])if(new RegExp("\\b"+e+"\\b","i").test(O)){var r=t.pid;B[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else B[e]=function(){};return B[e]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=y,n.isNullOrUndefined=m,n.isNumber=v,n.isString=b,n.isSymbol=w,n.isUndefined=E,n.isRegExp=_,n.isObject=S,n.isDate=k,n.isError=C,n.isFunction=x,n.isPrimitive=I,n.isBuffer=e("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",T(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!S(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":688,_process:592,inherits:687}],690:[function(require,module,exports){function Context(){}var indexOf=require("indexof"),Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,n){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:n})}}catch(e){return function(e,t,n){e[t]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(e){return this instanceof Script?void(this.code=e):new Script(e)};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var n=t.contentWindow,r=n.eval,i=n.execScript;!r&&i&&(i.call(n,"null"),r=n.eval),forEach(Object_keys(e),function(t){n[t]=e[t]}),forEach(globals,function(t){e[t]&&(n[t]=e[t])});var o=Object_keys(n),s=r.call(n,this.code);return forEach(Object_keys(n),function(t){(t in e||indexOf(o,t)===-1)&&(e[t]=n[t])}),forEach(globals,function(t){t in e||defineProp(e,t,n[t])}),document.body.removeChild(t),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),n=this.runInContext(t);return forEach(Object_keys(t),function(n){e[n]=t[n]}),n},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(t){var n=Script(t);return n[e].apply(n,[].slice.call(arguments,1))}}),exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),function(n){t[n]=e[n]}),t}},{indexof:639}],mail:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("q");n.Q=r;var i=e("simplito-logger");n.Logger=i;var o=e("privfs-client");n.privfs=o;var s=e("../app/browser/WebApplication");n.WebApplication=s.WebApplication;var a=e("../pages/TalkPage");n.TalkPage=a},{"../app/browser/WebApplication":403,"../pages/TalkPage":466,"privfs-client":204,q:327,"simplito-logger":357}]},{},[16,72]);
//# sourceMappingURL=mail.js.map
